var KJ=Object.defineProperty;var ZJ=(e,t,r)=>t in e?KJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var st=(e,t,r)=>(ZJ(e,typeof t!="symbol"?t+"":t,r),r);function JJ(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var yy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ug(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function oW(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}var lW={exports:{}},YE={},cW={exports:{}},or={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sw=Symbol.for("react.element"),eee=Symbol.for("react.portal"),tee=Symbol.for("react.fragment"),ree=Symbol.for("react.strict_mode"),iee=Symbol.for("react.profiler"),nee=Symbol.for("react.provider"),see=Symbol.for("react.context"),aee=Symbol.for("react.forward_ref"),oee=Symbol.for("react.suspense"),lee=Symbol.for("react.memo"),cee=Symbol.for("react.lazy"),jN=Symbol.iterator;function uee(e){return e===null||typeof e!="object"?null:(e=jN&&e[jN]||e["@@iterator"],typeof e=="function"?e:null)}var uW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hW=Object.assign,dW={};function jg(e,t,r){this.props=e,this.context=t,this.refs=dW,this.updater=r||uW}jg.prototype.isReactComponent={};jg.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};jg.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function pW(){}pW.prototype=jg.prototype;function aR(e,t,r){this.props=e,this.context=t,this.refs=dW,this.updater=r||uW}var oR=aR.prototype=new pW;oR.constructor=aR;hW(oR,jg.prototype);oR.isPureReactComponent=!0;var VN=Array.isArray,fW=Object.prototype.hasOwnProperty,lR={current:null},mW={key:!0,ref:!0,__self:!0,__source:!0};function gW(e,t,r){var i,n={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)fW.call(t,i)&&!mW.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:Sw,type:e,key:s,ref:a,props:n,_owner:lR.current}}function hee(e,t){return{$$typeof:Sw,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function cR(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sw}function dee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var HN=/\/+/g;function NC(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dee(""+e.key):t.toString(36)}function Pb(e,t,r,i,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Sw:case eee:a=!0}}if(a)return a=e,n=n(a),e=i===""?"."+NC(a,0):i,VN(n)?(r="",e!=null&&(r=e.replace(HN,"$&/")+"/"),Pb(n,t,r,"",function(c){return c})):n!=null&&(cR(n)&&(n=hee(n,r+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(HN,"$&/")+"/")+e)),t.push(n)),1;if(a=0,i=i===""?".":i+":",VN(e))for(var o=0;o<e.length;o++){s=e[o];var l=i+NC(s,o);a+=Pb(s,t,r,l,n)}else if(l=uee(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=i+NC(s,o++),a+=Pb(s,t,r,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Tx(e,t,r){if(e==null)return e;var i=[],n=0;return Pb(e,i,"","",function(s){return t.call(r,s,n++)}),i}function pee(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hs={current:null},Db={transition:null},fee={ReactCurrentDispatcher:Hs,ReactCurrentBatchConfig:Db,ReactCurrentOwner:lR};or.Children={map:Tx,forEach:function(e,t,r){Tx(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Tx(e,function(){t++}),t},toArray:function(e){return Tx(e,function(t){return t})||[]},only:function(e){if(!cR(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};or.Component=jg;or.Fragment=tee;or.Profiler=iee;or.PureComponent=aR;or.StrictMode=ree;or.Suspense=oee;or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fee;or.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=hW({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=lR.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)fW.call(t,l)&&!mW.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:Sw,type:e.type,key:n,ref:s,props:i,_owner:a}};or.createContext=function(e){return e={$$typeof:see,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nee,_context:e},e.Consumer=e};or.createElement=gW;or.createFactory=function(e){var t=gW.bind(null,e);return t.type=e,t};or.createRef=function(){return{current:null}};or.forwardRef=function(e){return{$$typeof:aee,render:e}};or.isValidElement=cR;or.lazy=function(e){return{$$typeof:cee,_payload:{_status:-1,_result:e},_init:pee}};or.memo=function(e,t){return{$$typeof:lee,type:e,compare:t===void 0?null:t}};or.startTransition=function(e){var t=Db.transition;Db.transition={};try{e()}finally{Db.transition=t}};or.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};or.useCallback=function(e,t){return Hs.current.useCallback(e,t)};or.useContext=function(e){return Hs.current.useContext(e)};or.useDebugValue=function(){};or.useDeferredValue=function(e){return Hs.current.useDeferredValue(e)};or.useEffect=function(e,t){return Hs.current.useEffect(e,t)};or.useId=function(){return Hs.current.useId()};or.useImperativeHandle=function(e,t,r){return Hs.current.useImperativeHandle(e,t,r)};or.useInsertionEffect=function(e,t){return Hs.current.useInsertionEffect(e,t)};or.useLayoutEffect=function(e,t){return Hs.current.useLayoutEffect(e,t)};or.useMemo=function(e,t){return Hs.current.useMemo(e,t)};or.useReducer=function(e,t,r){return Hs.current.useReducer(e,t,r)};or.useRef=function(e){return Hs.current.useRef(e)};or.useState=function(e){return Hs.current.useState(e)};or.useSyncExternalStore=function(e,t,r){return Hs.current.useSyncExternalStore(e,t,r)};or.useTransition=function(){return Hs.current.useTransition()};or.version="18.3.0";cW.exports=or;var te=cW.exports;const fe=Ug(te),uR=JJ({__proto__:null,default:fe},[te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mee=te,gee=Symbol.for("react.element"),vee=Symbol.for("react.fragment"),yee=Object.prototype.hasOwnProperty,wee=mee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xee={key:!0,ref:!0,__self:!0,__source:!0};function vW(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)yee.call(t,i)&&!xee.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:gee,type:e,key:s,ref:a,props:n,_owner:wee.current}}YE.Fragment=vee;YE.jsx=vW;YE.jsxs=vW;lW.exports=YE;var k=lW.exports,nD={},yW={exports:{}},Pa={},wW={exports:{}},xW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(L,W){var G=L.length;L.push(W);e:for(;0<G;){var X=G-1>>>1,Q=L[X];if(0<n(Q,W))L[X]=W,L[G]=Q,G=X;else break e}}function r(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var W=L[0],G=L.pop();if(G!==W){L[0]=G;e:for(var X=0,Q=L.length,ie=Q>>>1;X<ie;){var J=2*(X+1)-1,se=L[J],ee=J+1,ue=L[ee];if(0>n(se,G))ee<Q&&0>n(ue,se)?(L[X]=ue,L[ee]=G,X=ee):(L[X]=se,L[J]=G,X=J);else if(ee<Q&&0>n(ue,G))L[X]=ue,L[ee]=G,X=ee;else break e}}return W}function n(L,W){var G=L.sortIndex-W.sortIndex;return G!==0?G:L.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(L){for(var W=r(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=L)i(c),W.sortIndex=W.expirationTime,t(l,W);else break;W=r(c)}}function b(L){if(m=!1,w(L),!f)if(r(l)!==null)f=!0,V(E);else{var W=r(c);W!==null&&N(b,W.startTime-L)}}function E(L,W){f=!1,m&&(m=!1,v(x),x=-1),p=!0;var G=d;try{for(w(W),h=r(l);h!==null&&(!(h.expirationTime>W)||L&&!M());){var X=h.callback;if(typeof X=="function"){h.callback=null,d=h.priorityLevel;var Q=X(h.expirationTime<=W);W=e.unstable_now(),typeof Q=="function"?h.callback=Q:h===r(l)&&i(l),w(W)}else i(l);h=r(l)}if(h!==null)var ie=!0;else{var J=r(c);J!==null&&N(b,J.startTime-W),ie=!1}return ie}finally{h=null,d=G,p=!1}}var _=!1,C=null,x=-1,A=5,T=-1;function M(){return!(e.unstable_now()-T<A)}function D(){if(C!==null){var L=e.unstable_now();T=L;var W=!0;try{W=C(!0,L)}finally{W?P():(_=!1,C=null)}}else _=!1}var P;if(typeof y=="function")P=function(){y(D)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,B=I.port2;I.port1.onmessage=D,P=function(){B.postMessage(null)}}else P=function(){g(D,0)};function V(L){C=L,_||(_=!0,P())}function N(L,W){x=g(function(){L(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,V(E))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(L){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var G=d;d=W;try{return L()}finally{d=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,W){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var G=d;d=L;try{return W()}finally{d=G}},e.unstable_scheduleCallback=function(L,W,G){var X=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?X+G:X):G=X,L){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=G+Q,L={id:u++,callback:W,priorityLevel:L,startTime:G,expirationTime:Q,sortIndex:-1},G>X?(L.sortIndex=G,t(c,L),r(l)===null&&L===r(c)&&(m?(v(x),x=-1):m=!0,N(b,G-X))):(L.sortIndex=Q,t(l,L),f||p||(f=!0,V(E))),L},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(L){var W=d;return function(){var G=d;d=W;try{return L.apply(this,arguments)}finally{d=G}}}})(xW);wW.exports=xW;var bee=wW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _ee=te,Aa=bee;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bW=new Set,g0={};function zp(e,t){Zm(e,t),Zm(e+"Capture",t)}function Zm(e,t){for(g0[e]=t,e=0;e<t.length;e++)bW.add(t[e])}var iu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sD=Object.prototype.hasOwnProperty,See=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,WN={},GN={};function Eee(e){return sD.call(GN,e)?!0:sD.call(WN,e)?!1:See.test(e)?GN[e]=!0:(WN[e]=!0,!1)}function Tee(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Cee(e,t,r,i){if(t===null||typeof t>"u"||Tee(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ws(e,t,r,i,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var $n={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$n[e]=new Ws(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$n[t]=new Ws(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$n[e]=new Ws(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$n[e]=new Ws(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$n[e]=new Ws(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$n[e]=new Ws(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$n[e]=new Ws(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$n[e]=new Ws(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$n[e]=new Ws(e,5,!1,e.toLowerCase(),null,!1,!1)});var hR=/[\-:]([a-z])/g;function dR(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hR,dR);$n[t]=new Ws(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hR,dR);$n[t]=new Ws(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hR,dR);$n[t]=new Ws(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$n[e]=new Ws(e,1,!1,e.toLowerCase(),null,!1,!1)});$n.xlinkHref=new Ws("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$n[e]=new Ws(e,1,!1,e.toLowerCase(),null,!0,!0)});function pR(e,t,r,i){var n=$n.hasOwnProperty(t)?$n[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Cee(t,r,n,i)&&(r=null),i||n===null?Eee(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var mu=_ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cx=Symbol.for("react.element"),rm=Symbol.for("react.portal"),im=Symbol.for("react.fragment"),fR=Symbol.for("react.strict_mode"),aD=Symbol.for("react.profiler"),_W=Symbol.for("react.provider"),SW=Symbol.for("react.context"),mR=Symbol.for("react.forward_ref"),oD=Symbol.for("react.suspense"),lD=Symbol.for("react.suspense_list"),gR=Symbol.for("react.memo"),ju=Symbol.for("react.lazy"),EW=Symbol.for("react.offscreen"),qN=Symbol.iterator;function Mv(e){return e===null||typeof e!="object"?null:(e=qN&&e[qN]||e["@@iterator"],typeof e=="function"?e:null)}var fi=Object.assign,zC;function wy(e){if(zC===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);zC=t&&t[1]||""}return`
`+zC+e}var BC=!1;function FC(e,t){if(!e||BC)return"";BC=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var n=c.stack.split(`
`),s=i.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{BC=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?wy(e):""}function Aee(e){switch(e.tag){case 5:return wy(e.type);case 16:return wy("Lazy");case 13:return wy("Suspense");case 19:return wy("SuspenseList");case 0:case 2:case 15:return e=FC(e.type,!1),e;case 11:return e=FC(e.type.render,!1),e;case 1:return e=FC(e.type,!0),e;default:return""}}function cD(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case im:return"Fragment";case rm:return"Portal";case aD:return"Profiler";case fR:return"StrictMode";case oD:return"Suspense";case lD:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case SW:return(e.displayName||"Context")+".Consumer";case _W:return(e._context.displayName||"Context")+".Provider";case mR:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case gR:return t=e.displayName||null,t!==null?t:cD(e.type)||"Memo";case ju:t=e._payload,e=e._init;try{return cD(e(t))}catch{}}return null}function Mee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cD(t);case 8:return t===fR?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function TW(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Pee(e){var t=TW(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ax(e){e._valueTracker||(e._valueTracker=Pee(e))}function CW(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=TW(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function __(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function uD(e,t){var r=t.checked;return fi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function YN(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=Fh(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function AW(e,t){t=t.checked,t!=null&&pR(e,"checked",t,!1)}function hD(e,t){AW(e,t);var r=Fh(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?dD(e,t.type,r):t.hasOwnProperty("defaultValue")&&dD(e,t.type,Fh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function XN(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function dD(e,t,r){(t!=="number"||__(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var xy=Array.isArray;function _m(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+Fh(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function pD(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return fi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $N(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ge(92));if(xy(r)){if(1<r.length)throw Error(Ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fh(r)}}function MW(e,t){var r=Fh(t.value),i=Fh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function QN(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function PW(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fD(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?PW(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Mx,DW=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Mx=Mx||document.createElement("div"),Mx.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Mx.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function v0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dee=["Webkit","ms","Moz","O"];Object.keys(Fy).forEach(function(e){Dee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fy[t]=Fy[e]})});function IW(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fy.hasOwnProperty(e)&&Fy[e]?(""+t).trim():t+"px"}function OW(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=IW(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var Iee=fi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mD(e,t){if(t){if(Iee[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function gD(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vD=null;function vR(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yD=null,Sm=null,Em=null;function KN(e){if(e=Cw(e)){if(typeof yD!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=ZE(t),yD(e.stateNode,e.type,t))}}function RW(e){Sm?Em?Em.push(e):Em=[e]:Sm=e}function kW(){if(Sm){var e=Sm,t=Em;if(Em=Sm=null,KN(e),t)for(e=0;e<t.length;e++)KN(t[e])}}function LW(e,t){return e(t)}function NW(){}var UC=!1;function zW(e,t,r){if(UC)return e(t,r);UC=!0;try{return LW(e,t,r)}finally{UC=!1,(Sm!==null||Em!==null)&&(NW(),kW())}}function y0(e,t){var r=e.stateNode;if(r===null)return null;var i=ZE(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ge(231,t,typeof r));return r}var wD=!1;if(iu)try{var Pv={};Object.defineProperty(Pv,"passive",{get:function(){wD=!0}}),window.addEventListener("test",Pv,Pv),window.removeEventListener("test",Pv,Pv)}catch{wD=!1}function Oee(e,t,r,i,n,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Uy=!1,S_=null,E_=!1,xD=null,Ree={onError:function(e){Uy=!0,S_=e}};function kee(e,t,r,i,n,s,a,o,l){Uy=!1,S_=null,Oee.apply(Ree,arguments)}function Lee(e,t,r,i,n,s,a,o,l){if(kee.apply(this,arguments),Uy){if(Uy){var c=S_;Uy=!1,S_=null}else throw Error(Ge(198));E_||(E_=!0,xD=c)}}function Bp(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function BW(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ZN(e){if(Bp(e)!==e)throw Error(Ge(188))}function Nee(e){var t=e.alternate;if(!t){if(t=Bp(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return ZN(n),e;if(s===i)return ZN(n),t;s=s.sibling}throw Error(Ge(188))}if(r.return!==i.return)r=n,i=s;else{for(var a=!1,o=n.child;o;){if(o===r){a=!0,r=n,i=s;break}if(o===i){a=!0,i=n,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,i=n;break}if(o===i){a=!0,i=s,r=n;break}o=o.sibling}if(!a)throw Error(Ge(189))}}if(r.alternate!==i)throw Error(Ge(190))}if(r.tag!==3)throw Error(Ge(188));return r.stateNode.current===r?e:t}function FW(e){return e=Nee(e),e!==null?UW(e):null}function UW(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=UW(e);if(t!==null)return t;e=e.sibling}return null}var jW=Aa.unstable_scheduleCallback,JN=Aa.unstable_cancelCallback,zee=Aa.unstable_shouldYield,Bee=Aa.unstable_requestPaint,Di=Aa.unstable_now,Fee=Aa.unstable_getCurrentPriorityLevel,yR=Aa.unstable_ImmediatePriority,VW=Aa.unstable_UserBlockingPriority,T_=Aa.unstable_NormalPriority,Uee=Aa.unstable_LowPriority,HW=Aa.unstable_IdlePriority,XE=null,Ol=null;function jee(e){if(Ol&&typeof Ol.onCommitFiberRoot=="function")try{Ol.onCommitFiberRoot(XE,e,void 0,(e.current.flags&128)===128)}catch{}}var ko=Math.clz32?Math.clz32:Wee,Vee=Math.log,Hee=Math.LN2;function Wee(e){return e>>>=0,e===0?32:31-(Vee(e)/Hee|0)|0}var Px=64,Dx=4194304;function by(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function C_(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~n;o!==0?i=by(o):(s&=a,s!==0&&(i=by(s)))}else a=r&~n,a!==0?i=by(a):s!==0&&(i=by(s));if(i===0)return 0;if(t!==0&&t!==i&&!(t&n)&&(n=i&-i,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-ko(t),n=1<<r,i|=e[r],t&=~n;return i}function Gee(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qee(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-ko(s),o=1<<a,l=n[a];l===-1?(!(o&r)||o&i)&&(n[a]=Gee(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function bD(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function WW(){var e=Px;return Px<<=1,!(Px&4194240)&&(Px=64),e}function jC(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ew(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ko(t),e[t]=r}function Yee(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-ko(r),s=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~s}}function wR(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-ko(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var Nr=0;function GW(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var qW,xR,YW,XW,$W,_D=!1,Ix=[],bh=null,_h=null,Sh=null,w0=new Map,x0=new Map,Yu=[],Xee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ez(e,t){switch(e){case"focusin":case"focusout":bh=null;break;case"dragenter":case"dragleave":_h=null;break;case"mouseover":case"mouseout":Sh=null;break;case"pointerover":case"pointerout":w0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":x0.delete(t.pointerId)}}function Dv(e,t,r,i,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},t!==null&&(t=Cw(t),t!==null&&xR(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function $ee(e,t,r,i,n){switch(t){case"focusin":return bh=Dv(bh,e,t,r,i,n),!0;case"dragenter":return _h=Dv(_h,e,t,r,i,n),!0;case"mouseover":return Sh=Dv(Sh,e,t,r,i,n),!0;case"pointerover":var s=n.pointerId;return w0.set(s,Dv(w0.get(s)||null,e,t,r,i,n)),!0;case"gotpointercapture":return s=n.pointerId,x0.set(s,Dv(x0.get(s)||null,e,t,r,i,n)),!0}return!1}function QW(e){var t=Od(e.target);if(t!==null){var r=Bp(t);if(r!==null){if(t=r.tag,t===13){if(t=BW(r),t!==null){e.blockedOn=t,$W(e.priority,function(){YW(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ib(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=SD(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);vD=i,r.target.dispatchEvent(i),vD=null}else return t=Cw(r),t!==null&&xR(t),e.blockedOn=r,!1;t.shift()}return!0}function tz(e,t,r){Ib(e)&&r.delete(t)}function Qee(){_D=!1,bh!==null&&Ib(bh)&&(bh=null),_h!==null&&Ib(_h)&&(_h=null),Sh!==null&&Ib(Sh)&&(Sh=null),w0.forEach(tz),x0.forEach(tz)}function Iv(e,t){e.blockedOn===t&&(e.blockedOn=null,_D||(_D=!0,Aa.unstable_scheduleCallback(Aa.unstable_NormalPriority,Qee)))}function b0(e){function t(n){return Iv(n,e)}if(0<Ix.length){Iv(Ix[0],e);for(var r=1;r<Ix.length;r++){var i=Ix[r];i.blockedOn===e&&(i.blockedOn=null)}}for(bh!==null&&Iv(bh,e),_h!==null&&Iv(_h,e),Sh!==null&&Iv(Sh,e),w0.forEach(t),x0.forEach(t),r=0;r<Yu.length;r++)i=Yu[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Yu.length&&(r=Yu[0],r.blockedOn===null);)QW(r),r.blockedOn===null&&Yu.shift()}var Tm=mu.ReactCurrentBatchConfig,A_=!0;function Kee(e,t,r,i){var n=Nr,s=Tm.transition;Tm.transition=null;try{Nr=1,bR(e,t,r,i)}finally{Nr=n,Tm.transition=s}}function Zee(e,t,r,i){var n=Nr,s=Tm.transition;Tm.transition=null;try{Nr=4,bR(e,t,r,i)}finally{Nr=n,Tm.transition=s}}function bR(e,t,r,i){if(A_){var n=SD(e,t,r,i);if(n===null)KC(e,t,i,M_,r),ez(e,i);else if($ee(n,e,t,r,i))i.stopPropagation();else if(ez(e,i),t&4&&-1<Xee.indexOf(e)){for(;n!==null;){var s=Cw(n);if(s!==null&&qW(s),s=SD(e,t,r,i),s===null&&KC(e,t,i,M_,r),s===n)break;n=s}n!==null&&i.stopPropagation()}else KC(e,t,i,null,r)}}var M_=null;function SD(e,t,r,i){if(M_=null,e=vR(i),e=Od(e),e!==null)if(t=Bp(e),t===null)e=null;else if(r=t.tag,r===13){if(e=BW(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return M_=e,null}function KW(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fee()){case yR:return 1;case VW:return 4;case T_:case Uee:return 16;case HW:return 536870912;default:return 16}default:return 16}}var ih=null,_R=null,Ob=null;function ZW(){if(Ob)return Ob;var e,t=_R,r=t.length,i,n="value"in ih?ih.value:ih.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var a=r-e;for(i=1;i<=a&&t[r-i]===n[s-i];i++);return Ob=n.slice(e,1<i?1-i:void 0)}function Rb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ox(){return!0}function rz(){return!1}function Da(e){function t(r,i,n,s,a){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ox:rz,this.isPropagationStopped=rz,this}return fi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ox)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ox)},persist:function(){},isPersistent:Ox}),t}var Vg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},SR=Da(Vg),Tw=fi({},Vg,{view:0,detail:0}),Jee=Da(Tw),VC,HC,Ov,$E=fi({},Tw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ER,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ov&&(Ov&&e.type==="mousemove"?(VC=e.screenX-Ov.screenX,HC=e.screenY-Ov.screenY):HC=VC=0,Ov=e),VC)},movementY:function(e){return"movementY"in e?e.movementY:HC}}),iz=Da($E),ete=fi({},$E,{dataTransfer:0}),tte=Da(ete),rte=fi({},Tw,{relatedTarget:0}),WC=Da(rte),ite=fi({},Vg,{animationName:0,elapsedTime:0,pseudoElement:0}),nte=Da(ite),ste=fi({},Vg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ate=Da(ste),ote=fi({},Vg,{data:0}),nz=Da(ote),lte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ute={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hte(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ute[e])?!!t[e]:!1}function ER(){return hte}var dte=fi({},Tw,{key:function(e){if(e.key){var t=lte[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Rb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cte[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ER,charCode:function(e){return e.type==="keypress"?Rb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Rb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),pte=Da(dte),fte=fi({},$E,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sz=Da(fte),mte=fi({},Tw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ER}),gte=Da(mte),vte=fi({},Vg,{propertyName:0,elapsedTime:0,pseudoElement:0}),yte=Da(vte),wte=fi({},$E,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xte=Da(wte),bte=[9,13,27,32],TR=iu&&"CompositionEvent"in window,jy=null;iu&&"documentMode"in document&&(jy=document.documentMode);var _te=iu&&"TextEvent"in window&&!jy,JW=iu&&(!TR||jy&&8<jy&&11>=jy),az=" ",oz=!1;function eG(e,t){switch(e){case"keyup":return bte.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tG(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nm=!1;function Ste(e,t){switch(e){case"compositionend":return tG(t);case"keypress":return t.which!==32?null:(oz=!0,az);case"textInput":return e=t.data,e===az&&oz?null:e;default:return null}}function Ete(e,t){if(nm)return e==="compositionend"||!TR&&eG(e,t)?(e=ZW(),Ob=_R=ih=null,nm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return JW&&t.locale!=="ko"?null:t.data;default:return null}}var Tte={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Tte[e.type]:t==="textarea"}function rG(e,t,r,i){RW(i),t=P_(t,"onChange"),0<t.length&&(r=new SR("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Vy=null,_0=null;function Cte(e){pG(e,0)}function QE(e){var t=om(e);if(CW(t))return e}function Ate(e,t){if(e==="change")return t}var iG=!1;if(iu){var GC;if(iu){var qC="oninput"in document;if(!qC){var cz=document.createElement("div");cz.setAttribute("oninput","return;"),qC=typeof cz.oninput=="function"}GC=qC}else GC=!1;iG=GC&&(!document.documentMode||9<document.documentMode)}function uz(){Vy&&(Vy.detachEvent("onpropertychange",nG),_0=Vy=null)}function nG(e){if(e.propertyName==="value"&&QE(_0)){var t=[];rG(t,_0,e,vR(e)),zW(Cte,t)}}function Mte(e,t,r){e==="focusin"?(uz(),Vy=t,_0=r,Vy.attachEvent("onpropertychange",nG)):e==="focusout"&&uz()}function Pte(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return QE(_0)}function Dte(e,t){if(e==="click")return QE(t)}function Ite(e,t){if(e==="input"||e==="change")return QE(t)}function Ote(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jo=typeof Object.is=="function"?Object.is:Ote;function S0(e,t){if(jo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!sD.call(t,n)||!jo(e[n],t[n]))return!1}return!0}function hz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dz(e,t){var r=hz(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hz(r)}}function sG(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?sG(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function aG(){for(var e=window,t=__();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=__(e.document)}return t}function CR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Rte(e){var t=aG(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&sG(r.ownerDocument.documentElement,r)){if(i!==null&&CR(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!e.extend&&s>i&&(n=i,i=s,s=n),n=dz(r,s);var a=dz(r,i);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kte=iu&&"documentMode"in document&&11>=document.documentMode,sm=null,ED=null,Hy=null,TD=!1;function pz(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;TD||sm==null||sm!==__(i)||(i=sm,"selectionStart"in i&&CR(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Hy&&S0(Hy,i)||(Hy=i,i=P_(ED,"onSelect"),0<i.length&&(t=new SR("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=sm)))}function Rx(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var am={animationend:Rx("Animation","AnimationEnd"),animationiteration:Rx("Animation","AnimationIteration"),animationstart:Rx("Animation","AnimationStart"),transitionend:Rx("Transition","TransitionEnd")},YC={},oG={};iu&&(oG=document.createElement("div").style,"AnimationEvent"in window||(delete am.animationend.animation,delete am.animationiteration.animation,delete am.animationstart.animation),"TransitionEvent"in window||delete am.transitionend.transition);function KE(e){if(YC[e])return YC[e];if(!am[e])return e;var t=am[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in oG)return YC[e]=t[r];return e}var lG=KE("animationend"),cG=KE("animationiteration"),uG=KE("animationstart"),hG=KE("transitionend"),dG=new Map,fz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jh(e,t){dG.set(e,t),zp(t,[e])}for(var XC=0;XC<fz.length;XC++){var $C=fz[XC],Lte=$C.toLowerCase(),Nte=$C[0].toUpperCase()+$C.slice(1);Jh(Lte,"on"+Nte)}Jh(lG,"onAnimationEnd");Jh(cG,"onAnimationIteration");Jh(uG,"onAnimationStart");Jh("dblclick","onDoubleClick");Jh("focusin","onFocus");Jh("focusout","onBlur");Jh(hG,"onTransitionEnd");Zm("onMouseEnter",["mouseout","mouseover"]);Zm("onMouseLeave",["mouseout","mouseover"]);Zm("onPointerEnter",["pointerout","pointerover"]);Zm("onPointerLeave",["pointerout","pointerover"]);zp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zp("onBeforeInput",["compositionend","keypress","textInput","paste"]);zp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _y="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zte=new Set("cancel close invalid load scroll toggle".split(" ").concat(_y));function mz(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,Lee(i,t,void 0,e),e.currentTarget=null}function pG(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;mz(n,o,c),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;mz(n,o,c),s=l}}}if(E_)throw e=xD,E_=!1,xD=null,e}function Kr(e,t){var r=t[DD];r===void 0&&(r=t[DD]=new Set);var i=e+"__bubble";r.has(i)||(fG(t,e,2,!1),r.add(i))}function QC(e,t,r){var i=0;t&&(i|=4),fG(r,e,i,t)}var kx="_reactListening"+Math.random().toString(36).slice(2);function E0(e){if(!e[kx]){e[kx]=!0,bW.forEach(function(r){r!=="selectionchange"&&(zte.has(r)||QC(r,!1,e),QC(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[kx]||(t[kx]=!0,QC("selectionchange",!1,t))}}function fG(e,t,r,i){switch(KW(t)){case 1:var n=Kee;break;case 4:n=Zee;break;default:n=bR}r=n.bind(null,t,r,e),n=void 0,!wD||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function KC(e,t,r,i,n){var s=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=Od(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}zW(function(){var c=s,u=vR(r),h=[];e:{var d=dG.get(e);if(d!==void 0){var p=SR,f=e;switch(e){case"keypress":if(Rb(r)===0)break e;case"keydown":case"keyup":p=pte;break;case"focusin":f="focus",p=WC;break;case"focusout":f="blur",p=WC;break;case"beforeblur":case"afterblur":p=WC;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=iz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=tte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=gte;break;case lG:case cG:case uG:p=nte;break;case hG:p=yte;break;case"scroll":p=Jee;break;case"wheel":p=xte;break;case"copy":case"cut":case"paste":p=ate;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=sz}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var y=c,w;y!==null;){w=y;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,v!==null&&(b=y0(y,v),b!=null&&m.push(T0(y,b,w)))),g)break;y=y.return}0<m.length&&(d=new p(d,f,null,r,u),h.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==vD&&(f=r.relatedTarget||r.fromElement)&&(Od(f)||f[nu]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=r.relatedTarget||r.toElement,p=c,f=f?Od(f):null,f!==null&&(g=Bp(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=c),p!==f)){if(m=iz,b="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=sz,b="onPointerLeave",v="onPointerEnter",y="pointer"),g=p==null?d:om(p),w=f==null?d:om(f),d=new m(b,y+"leave",p,r,u),d.target=g,d.relatedTarget=w,b=null,Od(u)===c&&(m=new m(v,y+"enter",f,r,u),m.target=w,m.relatedTarget=g,b=m),g=b,p&&f)t:{for(m=p,v=f,y=0,w=m;w;w=lf(w))y++;for(w=0,b=v;b;b=lf(b))w++;for(;0<y-w;)m=lf(m),y--;for(;0<w-y;)v=lf(v),w--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=lf(m),v=lf(v)}m=null}else m=null;p!==null&&gz(h,d,p,m,!1),f!==null&&g!==null&&gz(h,g,f,m,!0)}}e:{if(d=c?om(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var E=Ate;else if(lz(d))if(iG)E=Ite;else{E=Pte;var _=Mte}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=Dte);if(E&&(E=E(e,c))){rG(h,E,r,u);break e}_&&_(e,d,c),e==="focusout"&&(_=d._wrapperState)&&_.controlled&&d.type==="number"&&dD(d,"number",d.value)}switch(_=c?om(c):window,e){case"focusin":(lz(_)||_.contentEditable==="true")&&(sm=_,ED=c,Hy=null);break;case"focusout":Hy=ED=sm=null;break;case"mousedown":TD=!0;break;case"contextmenu":case"mouseup":case"dragend":TD=!1,pz(h,r,u);break;case"selectionchange":if(kte)break;case"keydown":case"keyup":pz(h,r,u)}var C;if(TR)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else nm?eG(e,r)&&(x="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(JW&&r.locale!=="ko"&&(nm||x!=="onCompositionStart"?x==="onCompositionEnd"&&nm&&(C=ZW()):(ih=u,_R="value"in ih?ih.value:ih.textContent,nm=!0)),_=P_(c,x),0<_.length&&(x=new nz(x,e,null,r,u),h.push({event:x,listeners:_}),C?x.data=C:(C=tG(r),C!==null&&(x.data=C)))),(C=_te?Ste(e,r):Ete(e,r))&&(c=P_(c,"onBeforeInput"),0<c.length&&(u=new nz("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=C))}pG(h,t)})}function T0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function P_(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=y0(e,r),s!=null&&i.unshift(T0(e,s,n)),s=y0(e,t),s!=null&&i.push(T0(e,s,n))),e=e.return}return i}function lf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gz(e,t,r,i,n){for(var s=t._reactName,a=[];r!==null&&r!==i;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&c!==null&&(o=c,n?(l=y0(r,s),l!=null&&a.unshift(T0(r,l,o))):n||(l=y0(r,s),l!=null&&a.push(T0(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Bte=/\r\n?/g,Fte=/\u0000|\uFFFD/g;function vz(e){return(typeof e=="string"?e:""+e).replace(Bte,`
`).replace(Fte,"")}function Lx(e,t,r){if(t=vz(t),vz(e)!==t&&r)throw Error(Ge(425))}function D_(){}var CD=null,AD=null;function MD(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var PD=typeof setTimeout=="function"?setTimeout:void 0,Ute=typeof clearTimeout=="function"?clearTimeout:void 0,yz=typeof Promise=="function"?Promise:void 0,jte=typeof queueMicrotask=="function"?queueMicrotask:typeof yz<"u"?function(e){return yz.resolve(null).then(e).catch(Vte)}:PD;function Vte(e){setTimeout(function(){throw e})}function ZC(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),b0(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);b0(t)}function Eh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function wz(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Hg=Math.random().toString(36).slice(2),_l="__reactFiber$"+Hg,C0="__reactProps$"+Hg,nu="__reactContainer$"+Hg,DD="__reactEvents$"+Hg,Hte="__reactListeners$"+Hg,Wte="__reactHandles$"+Hg;function Od(e){var t=e[_l];if(t)return t;for(var r=e.parentNode;r;){if(t=r[nu]||r[_l]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=wz(e);e!==null;){if(r=e[_l])return r;e=wz(e)}return t}e=r,r=e.parentNode}return null}function Cw(e){return e=e[_l]||e[nu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function om(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function ZE(e){return e[C0]||null}var ID=[],lm=-1;function ed(e){return{current:e}}function ri(e){0>lm||(e.current=ID[lm],ID[lm]=null,lm--)}function Gr(e,t){lm++,ID[lm]=e.current,e.current=t}var Uh={},gs=ed(Uh),aa=ed(!1),cp=Uh;function Jm(e,t){var r=e.type.contextTypes;if(!r)return Uh;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function oa(e){return e=e.childContextTypes,e!=null}function I_(){ri(aa),ri(gs)}function xz(e,t,r){if(gs.current!==Uh)throw Error(Ge(168));Gr(gs,t),Gr(aa,r)}function mG(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(Ge(108,Mee(e)||"Unknown",n));return fi({},r,i)}function O_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uh,cp=gs.current,Gr(gs,e),Gr(aa,aa.current),!0}function bz(e,t,r){var i=e.stateNode;if(!i)throw Error(Ge(169));r?(e=mG(e,t,cp),i.__reactInternalMemoizedMergedChildContext=e,ri(aa),ri(gs),Gr(gs,e)):ri(aa),Gr(aa,r)}var Cc=null,JE=!1,JC=!1;function gG(e){Cc===null?Cc=[e]:Cc.push(e)}function Gte(e){JE=!0,gG(e)}function td(){if(!JC&&Cc!==null){JC=!0;var e=0,t=Nr;try{var r=Cc;for(Nr=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}Cc=null,JE=!1}catch(n){throw Cc!==null&&(Cc=Cc.slice(e+1)),jW(yR,td),n}finally{Nr=t,JC=!1}}return null}var cm=[],um=0,R_=null,k_=0,Xa=[],$a=0,up=null,Lc=1,Nc="";function yd(e,t){cm[um++]=k_,cm[um++]=R_,R_=e,k_=t}function vG(e,t,r){Xa[$a++]=Lc,Xa[$a++]=Nc,Xa[$a++]=up,up=e;var i=Lc;e=Nc;var n=32-ko(i)-1;i&=~(1<<n),r+=1;var s=32-ko(t)+n;if(30<s){var a=n-n%5;s=(i&(1<<a)-1).toString(32),i>>=a,n-=a,Lc=1<<32-ko(t)+n|r<<n|i,Nc=s+e}else Lc=1<<s|r<<n|i,Nc=e}function AR(e){e.return!==null&&(yd(e,1),vG(e,1,0))}function MR(e){for(;e===R_;)R_=cm[--um],cm[um]=null,k_=cm[--um],cm[um]=null;for(;e===up;)up=Xa[--$a],Xa[$a]=null,Nc=Xa[--$a],Xa[$a]=null,Lc=Xa[--$a],Xa[$a]=null}var Ta=null,wa=null,oi=!1,Co=null;function yG(e,t){var r=Ka(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _z(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ta=e,wa=Eh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ta=e,wa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=up!==null?{id:Lc,overflow:Nc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ka(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ta=e,wa=null,!0):!1;default:return!1}}function OD(e){return(e.mode&1)!==0&&(e.flags&128)===0}function RD(e){if(oi){var t=wa;if(t){var r=t;if(!_z(e,t)){if(OD(e))throw Error(Ge(418));t=Eh(r.nextSibling);var i=Ta;t&&_z(e,t)?yG(i,r):(e.flags=e.flags&-4097|2,oi=!1,Ta=e)}}else{if(OD(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,oi=!1,Ta=e}}}function Sz(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ta=e}function Nx(e){if(e!==Ta)return!1;if(!oi)return Sz(e),oi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!MD(e.type,e.memoizedProps)),t&&(t=wa)){if(OD(e))throw wG(),Error(Ge(418));for(;t;)yG(e,t),t=Eh(t.nextSibling)}if(Sz(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){wa=Eh(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}wa=null}}else wa=Ta?Eh(e.stateNode.nextSibling):null;return!0}function wG(){for(var e=wa;e;)e=Eh(e.nextSibling)}function eg(){wa=Ta=null,oi=!1}function PR(e){Co===null?Co=[e]:Co.push(e)}var qte=mu.ReactCurrentBatchConfig;function Rv(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ge(309));var i=r.stateNode}if(!i)throw Error(Ge(147,e));var n=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ge(284));if(!r._owner)throw Error(Ge(290,e))}return e}function zx(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ez(e){var t=e._init;return t(e._payload)}function xG(e){function t(v,y){if(e){var w=v.deletions;w===null?(v.deletions=[y],v.flags|=16):w.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function n(v,y){return v=Mh(v,y),v.index=0,v.sibling=null,v}function s(v,y,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<y?(v.flags|=2,y):w):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,w,b){return y===null||y.tag!==6?(y=aA(w,v.mode,b),y.return=v,y):(y=n(y,w),y.return=v,y)}function l(v,y,w,b){var E=w.type;return E===im?u(v,y,w.props.children,b,w.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ju&&Ez(E)===y.type)?(b=n(y,w.props),b.ref=Rv(v,y,w),b.return=v,b):(b=Ub(w.type,w.key,w.props,null,v.mode,b),b.ref=Rv(v,y,w),b.return=v,b)}function c(v,y,w,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=oA(w,v.mode,b),y.return=v,y):(y=n(y,w.children||[]),y.return=v,y)}function u(v,y,w,b,E){return y===null||y.tag!==7?(y=Yd(w,v.mode,b,E),y.return=v,y):(y=n(y,w),y.return=v,y)}function h(v,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=aA(""+y,v.mode,w),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Cx:return w=Ub(y.type,y.key,y.props,null,v.mode,w),w.ref=Rv(v,null,y),w.return=v,w;case rm:return y=oA(y,v.mode,w),y.return=v,y;case ju:var b=y._init;return h(v,b(y._payload),w)}if(xy(y)||Mv(y))return y=Yd(y,v.mode,w,null),y.return=v,y;zx(v,y)}return null}function d(v,y,w,b){var E=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:o(v,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Cx:return w.key===E?l(v,y,w,b):null;case rm:return w.key===E?c(v,y,w,b):null;case ju:return E=w._init,d(v,y,E(w._payload),b)}if(xy(w)||Mv(w))return E!==null?null:u(v,y,w,b,null);zx(v,w)}return null}function p(v,y,w,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(w)||null,o(y,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Cx:return v=v.get(b.key===null?w:b.key)||null,l(y,v,b,E);case rm:return v=v.get(b.key===null?w:b.key)||null,c(y,v,b,E);case ju:var _=b._init;return p(v,y,w,_(b._payload),E)}if(xy(b)||Mv(b))return v=v.get(w)||null,u(y,v,b,E,null);zx(y,b)}return null}function f(v,y,w,b){for(var E=null,_=null,C=y,x=y=0,A=null;C!==null&&x<w.length;x++){C.index>x?(A=C,C=null):A=C.sibling;var T=d(v,C,w[x],b);if(T===null){C===null&&(C=A);break}e&&C&&T.alternate===null&&t(v,C),y=s(T,y,x),_===null?E=T:_.sibling=T,_=T,C=A}if(x===w.length)return r(v,C),oi&&yd(v,x),E;if(C===null){for(;x<w.length;x++)C=h(v,w[x],b),C!==null&&(y=s(C,y,x),_===null?E=C:_.sibling=C,_=C);return oi&&yd(v,x),E}for(C=i(v,C);x<w.length;x++)A=p(C,v,x,w[x],b),A!==null&&(e&&A.alternate!==null&&C.delete(A.key===null?x:A.key),y=s(A,y,x),_===null?E=A:_.sibling=A,_=A);return e&&C.forEach(function(M){return t(v,M)}),oi&&yd(v,x),E}function m(v,y,w,b){var E=Mv(w);if(typeof E!="function")throw Error(Ge(150));if(w=E.call(w),w==null)throw Error(Ge(151));for(var _=E=null,C=y,x=y=0,A=null,T=w.next();C!==null&&!T.done;x++,T=w.next()){C.index>x?(A=C,C=null):A=C.sibling;var M=d(v,C,T.value,b);if(M===null){C===null&&(C=A);break}e&&C&&M.alternate===null&&t(v,C),y=s(M,y,x),_===null?E=M:_.sibling=M,_=M,C=A}if(T.done)return r(v,C),oi&&yd(v,x),E;if(C===null){for(;!T.done;x++,T=w.next())T=h(v,T.value,b),T!==null&&(y=s(T,y,x),_===null?E=T:_.sibling=T,_=T);return oi&&yd(v,x),E}for(C=i(v,C);!T.done;x++,T=w.next())T=p(C,v,x,T.value,b),T!==null&&(e&&T.alternate!==null&&C.delete(T.key===null?x:T.key),y=s(T,y,x),_===null?E=T:_.sibling=T,_=T);return e&&C.forEach(function(D){return t(v,D)}),oi&&yd(v,x),E}function g(v,y,w,b){if(typeof w=="object"&&w!==null&&w.type===im&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Cx:e:{for(var E=w.key,_=y;_!==null;){if(_.key===E){if(E=w.type,E===im){if(_.tag===7){r(v,_.sibling),y=n(_,w.props.children),y.return=v,v=y;break e}}else if(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ju&&Ez(E)===_.type){r(v,_.sibling),y=n(_,w.props),y.ref=Rv(v,_,w),y.return=v,v=y;break e}r(v,_);break}else t(v,_);_=_.sibling}w.type===im?(y=Yd(w.props.children,v.mode,b,w.key),y.return=v,v=y):(b=Ub(w.type,w.key,w.props,null,v.mode,b),b.ref=Rv(v,y,w),b.return=v,v=b)}return a(v);case rm:e:{for(_=w.key;y!==null;){if(y.key===_)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(v,y.sibling),y=n(y,w.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=oA(w,v.mode,b),y.return=v,v=y}return a(v);case ju:return _=w._init,g(v,y,_(w._payload),b)}if(xy(w))return f(v,y,w,b);if(Mv(w))return m(v,y,w,b);zx(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(v,y.sibling),y=n(y,w),y.return=v,v=y):(r(v,y),y=aA(w,v.mode,b),y.return=v,v=y),a(v)):r(v,y)}return g}var tg=xG(!0),bG=xG(!1),L_=ed(null),N_=null,hm=null,DR=null;function IR(){DR=hm=N_=null}function OR(e){var t=L_.current;ri(L_),e._currentValue=t}function kD(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Cm(e,t){N_=e,DR=hm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ra=!0),e.firstContext=null)}function so(e){var t=e._currentValue;if(DR!==e)if(e={context:e,memoizedValue:t,next:null},hm===null){if(N_===null)throw Error(Ge(308));hm=e,N_.dependencies={lanes:0,firstContext:e}}else hm=hm.next=e;return t}var Rd=null;function RR(e){Rd===null?Rd=[e]:Rd.push(e)}function _G(e,t,r,i){var n=t.interleaved;return n===null?(r.next=r,RR(t)):(r.next=n.next,n.next=r),t.interleaved=r,su(e,i)}function su(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Vu=!1;function kR(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SG(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Th(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,fr&2){var n=i.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),i.pending=t,su(e,r)}return n=i.interleaved,n===null?(t.next=t,RR(i)):(t.next=n.next,n.next=t),i.interleaved=t,su(e,r)}function kb(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,wR(e,r)}}function Tz(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function z_(e,t,r,i){var n=e.updateQueue;Vu=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(d=t,p=r,m.tag){case 1:if(f=m.payload,typeof f=="function"){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,d=typeof f=="function"?f.call(p,h,d):f,d==null)break e;h=fi({},h,d);break e;case 2:Vu=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(!0);if(u===null&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);dp|=a,e.lanes=a,e.memoizedState=h}}function Cz(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(Ge(191,n));n.call(i)}}}var Aw={},Rl=ed(Aw),A0=ed(Aw),M0=ed(Aw);function kd(e){if(e===Aw)throw Error(Ge(174));return e}function LR(e,t){switch(Gr(M0,t),Gr(A0,e),Gr(Rl,Aw),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fD(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fD(t,e)}ri(Rl),Gr(Rl,t)}function rg(){ri(Rl),ri(A0),ri(M0)}function EG(e){kd(M0.current);var t=kd(Rl.current),r=fD(t,e.type);t!==r&&(Gr(A0,e),Gr(Rl,r))}function NR(e){A0.current===e&&(ri(Rl),ri(A0))}var ci=ed(0);function B_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var eA=[];function zR(){for(var e=0;e<eA.length;e++)eA[e]._workInProgressVersionPrimary=null;eA.length=0}var Lb=mu.ReactCurrentDispatcher,tA=mu.ReactCurrentBatchConfig,hp=0,di=null,nn=null,vn=null,F_=!1,Wy=!1,P0=0,Yte=0;function es(){throw Error(Ge(321))}function BR(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!jo(e[r],t[r]))return!1;return!0}function FR(e,t,r,i,n,s){if(hp=s,di=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lb.current=e===null||e.memoizedState===null?Kte:Zte,e=r(i,n),Wy){s=0;do{if(Wy=!1,P0=0,25<=s)throw Error(Ge(301));s+=1,vn=nn=null,t.updateQueue=null,Lb.current=Jte,e=r(i,n)}while(Wy)}if(Lb.current=U_,t=nn!==null&&nn.next!==null,hp=0,vn=nn=di=null,F_=!1,t)throw Error(Ge(300));return e}function UR(){var e=P0!==0;return P0=0,e}function ml(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?di.memoizedState=vn=e:vn=vn.next=e,vn}function ao(){if(nn===null){var e=di.alternate;e=e!==null?e.memoizedState:null}else e=nn.next;var t=vn===null?di.memoizedState:vn.next;if(t!==null)vn=t,nn=e;else{if(e===null)throw Error(Ge(310));nn=e,e={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},vn===null?di.memoizedState=vn=e:vn=vn.next=e}return vn}function D0(e,t){return typeof t=="function"?t(e):t}function rA(e){var t=ao(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var i=nn,n=i.baseQueue,s=r.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}i.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,i=i.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((hp&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=i):l=l.next=h,di.lanes|=u,dp|=u}c=c.next}while(c!==null&&c!==s);l===null?a=i:l.next=o,jo(i,t.memoizedState)||(ra=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do s=n.lane,di.lanes|=s,dp|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function iA(e){var t=ao(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);jo(s,t.memoizedState)||(ra=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function TG(){}function CG(e,t){var r=di,i=ao(),n=t(),s=!jo(i.memoizedState,n);if(s&&(i.memoizedState=n,ra=!0),i=i.queue,jR(PG.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||vn!==null&&vn.memoizedState.tag&1){if(r.flags|=2048,I0(9,MG.bind(null,r,i,n,t),void 0,null),En===null)throw Error(Ge(349));hp&30||AG(r,t,n)}return n}function AG(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=di.updateQueue,t===null?(t={lastEffect:null,stores:null},di.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function MG(e,t,r,i){t.value=r,t.getSnapshot=i,DG(t)&&IG(e)}function PG(e,t,r){return r(function(){DG(t)&&IG(e)})}function DG(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!jo(e,r)}catch{return!0}}function IG(e){var t=su(e,1);t!==null&&Lo(t,e,1,-1)}function Az(e){var t=ml();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:D0,lastRenderedState:e},t.queue=e,e=e.dispatch=Qte.bind(null,di,e),[t.memoizedState,e]}function I0(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=di.updateQueue,t===null?(t={lastEffect:null,stores:null},di.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function OG(){return ao().memoizedState}function Nb(e,t,r,i){var n=ml();di.flags|=e,n.memoizedState=I0(1|t,r,void 0,i===void 0?null:i)}function eT(e,t,r,i){var n=ao();i=i===void 0?null:i;var s=void 0;if(nn!==null){var a=nn.memoizedState;if(s=a.destroy,i!==null&&BR(i,a.deps)){n.memoizedState=I0(t,r,s,i);return}}di.flags|=e,n.memoizedState=I0(1|t,r,s,i)}function Mz(e,t){return Nb(8390656,8,e,t)}function jR(e,t){return eT(2048,8,e,t)}function RG(e,t){return eT(4,2,e,t)}function kG(e,t){return eT(4,4,e,t)}function LG(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function NG(e,t,r){return r=r!=null?r.concat([e]):null,eT(4,4,LG.bind(null,t,e),r)}function VR(){}function zG(e,t){var r=ao();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&BR(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function BG(e,t){var r=ao();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&BR(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function FG(e,t,r){return hp&21?(jo(r,t)||(r=WW(),di.lanes|=r,dp|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ra=!0),e.memoizedState=r)}function Xte(e,t){var r=Nr;Nr=r!==0&&4>r?r:4,e(!0);var i=tA.transition;tA.transition={};try{e(!1),t()}finally{Nr=r,tA.transition=i}}function UG(){return ao().memoizedState}function $te(e,t,r){var i=Ah(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},jG(e))VG(t,r);else if(r=_G(e,t,r,i),r!==null){var n=Bs();Lo(r,e,i,n),HG(r,t,i)}}function Qte(e,t,r){var i=Ah(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(jG(e))VG(t,n);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(n.hasEagerState=!0,n.eagerState=o,jo(o,a)){var l=t.interleaved;l===null?(n.next=n,RR(t)):(n.next=l.next,l.next=n),t.interleaved=n;return}}catch{}finally{}r=_G(e,t,n,i),r!==null&&(n=Bs(),Lo(r,e,i,n),HG(r,t,i))}}function jG(e){var t=e.alternate;return e===di||t!==null&&t===di}function VG(e,t){Wy=F_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function HG(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,wR(e,r)}}var U_={readContext:so,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},Kte={readContext:so,useCallback:function(e,t){return ml().memoizedState=[e,t===void 0?null:t],e},useContext:so,useEffect:Mz,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Nb(4194308,4,LG.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Nb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Nb(4,2,e,t)},useMemo:function(e,t){var r=ml();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=ml();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=$te.bind(null,di,e),[i.memoizedState,e]},useRef:function(e){var t=ml();return e={current:e},t.memoizedState=e},useState:Az,useDebugValue:VR,useDeferredValue:function(e){return ml().memoizedState=e},useTransition:function(){var e=Az(!1),t=e[0];return e=Xte.bind(null,e[1]),ml().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=di,n=ml();if(oi){if(r===void 0)throw Error(Ge(407));r=r()}else{if(r=t(),En===null)throw Error(Ge(349));hp&30||AG(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Mz(PG.bind(null,i,s,e),[e]),i.flags|=2048,I0(9,MG.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=ml(),t=En.identifierPrefix;if(oi){var r=Nc,i=Lc;r=(i&~(1<<32-ko(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=P0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Yte++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zte={readContext:so,useCallback:zG,useContext:so,useEffect:jR,useImperativeHandle:NG,useInsertionEffect:RG,useLayoutEffect:kG,useMemo:BG,useReducer:rA,useRef:OG,useState:function(){return rA(D0)},useDebugValue:VR,useDeferredValue:function(e){var t=ao();return FG(t,nn.memoizedState,e)},useTransition:function(){var e=rA(D0)[0],t=ao().memoizedState;return[e,t]},useMutableSource:TG,useSyncExternalStore:CG,useId:UG,unstable_isNewReconciler:!1},Jte={readContext:so,useCallback:zG,useContext:so,useEffect:jR,useImperativeHandle:NG,useInsertionEffect:RG,useLayoutEffect:kG,useMemo:BG,useReducer:iA,useRef:OG,useState:function(){return iA(D0)},useDebugValue:VR,useDeferredValue:function(e){var t=ao();return nn===null?t.memoizedState=e:FG(t,nn.memoizedState,e)},useTransition:function(){var e=iA(D0)[0],t=ao().memoizedState;return[e,t]},useMutableSource:TG,useSyncExternalStore:CG,useId:UG,unstable_isNewReconciler:!1};function So(e,t){if(e&&e.defaultProps){t=fi({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function LD(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:fi({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tT={isMounted:function(e){return(e=e._reactInternals)?Bp(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=Bs(),n=Ah(e),s=qc(i,n);s.payload=t,r!=null&&(s.callback=r),t=Th(e,s,n),t!==null&&(Lo(t,e,n,i),kb(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=Bs(),n=Ah(e),s=qc(i,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Th(e,s,n),t!==null&&(Lo(t,e,n,i),kb(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Bs(),i=Ah(e),n=qc(r,i);n.tag=2,t!=null&&(n.callback=t),t=Th(e,n,i),t!==null&&(Lo(t,e,i,r),kb(t,e,i))}};function Pz(e,t,r,i,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!S0(r,i)||!S0(n,s):!0}function WG(e,t,r){var i=!1,n=Uh,s=t.contextType;return typeof s=="object"&&s!==null?s=so(s):(n=oa(t)?cp:gs.current,i=t.contextTypes,s=(i=i!=null)?Jm(e,n):Uh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tT,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function Dz(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&tT.enqueueReplaceState(t,t.state,null)}function ND(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},kR(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=so(s):(s=oa(t)?cp:gs.current,n.context=Jm(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(LD(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&tT.enqueueReplaceState(n,n.state,null),z_(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function ig(e,t){try{var r="",i=t;do r+=Aee(i),i=i.return;while(i);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n,digest:null}}function nA(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function zD(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ere=typeof WeakMap=="function"?WeakMap:Map;function GG(e,t,r){r=qc(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){V_||(V_=!0,YD=i),zD(e,t)},r}function qG(e,t,r){r=qc(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){zD(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){zD(e,t),typeof i!="function"&&(Ch===null?Ch=new Set([this]):Ch.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Iz(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new ere;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=fre.bind(null,e,t,r),t.then(e,e))}function Oz(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rz(e,t,r,i,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qc(-1,1),t.tag=2,Th(r,t,1))),r.lanes|=1),e)}var tre=mu.ReactCurrentOwner,ra=!1;function Is(e,t,r,i){t.child=e===null?bG(t,null,r,i):tg(t,e.child,r,i)}function kz(e,t,r,i,n){r=r.render;var s=t.ref;return Cm(t,n),i=FR(e,t,r,i,s,n),r=UR(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,au(e,t,n)):(oi&&r&&AR(t),t.flags|=1,Is(e,t,i,n),t.child)}function Lz(e,t,r,i,n){if(e===null){var s=r.type;return typeof s=="function"&&!QR(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,YG(e,t,s,i,n)):(e=Ub(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&n)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:S0,r(a,i)&&e.ref===t.ref)return au(e,t,n)}return t.flags|=1,e=Mh(s,i),e.ref=t.ref,e.return=t,t.child=e}function YG(e,t,r,i,n){if(e!==null){var s=e.memoizedProps;if(S0(s,i)&&e.ref===t.ref)if(ra=!1,t.pendingProps=i=s,(e.lanes&n)!==0)e.flags&131072&&(ra=!0);else return t.lanes=e.lanes,au(e,t,n)}return BD(e,t,r,i,n)}function XG(e,t,r){var i=t.pendingProps,n=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gr(pm,fa),fa|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Gr(pm,fa),fa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:r,Gr(pm,fa),fa|=i}else s!==null?(i=s.baseLanes|r,t.memoizedState=null):i=r,Gr(pm,fa),fa|=i;return Is(e,t,n,r),t.child}function $G(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function BD(e,t,r,i,n){var s=oa(r)?cp:gs.current;return s=Jm(t,s),Cm(t,n),r=FR(e,t,r,i,s,n),i=UR(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,au(e,t,n)):(oi&&i&&AR(t),t.flags|=1,Is(e,t,r,n),t.child)}function Nz(e,t,r,i,n){if(oa(r)){var s=!0;O_(t)}else s=!1;if(Cm(t,n),t.stateNode===null)zb(e,t),WG(t,r,i),ND(t,r,i,n),i=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=so(c):(c=oa(r)?cp:gs.current,c=Jm(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==c)&&Dz(t,a,i,c),Vu=!1;var d=t.memoizedState;a.state=d,z_(t,i,a,n),l=t.memoizedState,o!==i||d!==l||aa.current||Vu?(typeof u=="function"&&(LD(t,r,u,i),l=t.memoizedState),(o=Vu||Pz(t,r,o,i,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,SG(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:So(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=so(l):(l=oa(r)?cp:gs.current,l=Jm(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Dz(t,a,i,l),Vu=!1,d=t.memoizedState,a.state=d,z_(t,i,a,n);var f=t.memoizedState;o!==h||d!==f||aa.current||Vu?(typeof p=="function"&&(LD(t,r,p,i),f=t.memoizedState),(c=Vu||Pz(t,r,c,i,d,f,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,f,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return FD(e,t,r,i,s,n)}function FD(e,t,r,i,n,s){$G(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return n&&bz(t,r,!1),au(e,t,s);i=t.stateNode,tre.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=tg(t,e.child,null,s),t.child=tg(t,null,o,s)):Is(e,t,o,s),t.memoizedState=i.state,n&&bz(t,r,!0),t.child}function QG(e){var t=e.stateNode;t.pendingContext?xz(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xz(e,t.context,!1),LR(e,t.containerInfo)}function zz(e,t,r,i,n){return eg(),PR(n),t.flags|=256,Is(e,t,r,i),t.child}var UD={dehydrated:null,treeContext:null,retryLane:0};function jD(e){return{baseLanes:e,cachePool:null,transitions:null}}function KG(e,t,r){var i=t.pendingProps,n=ci.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),Gr(ci,n&1),e===null)return RD(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=nT(a,i,0,null),e=Yd(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=jD(r),t.memoizedState=UD,e):HR(t,a));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return rre(e,t,a,i,o,n,r);if(s){s=i.fallback,a=t.mode,n=e.child,o=n.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&t.child!==n?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=Mh(n,l),i.subtreeFlags=n.subtreeFlags&14680064),o!==null?s=Mh(o,s):(s=Yd(s,a,r,null),s.flags|=2),s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=e.child.memoizedState,a=a===null?jD(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=UD,i}return s=e.child,e=s.sibling,i=Mh(s,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function HR(e,t){return t=nT({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bx(e,t,r,i){return i!==null&&PR(i),tg(t,e.child,null,r),e=HR(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rre(e,t,r,i,n,s,a){if(r)return t.flags&256?(t.flags&=-257,i=nA(Error(Ge(422))),Bx(e,t,a,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=nT({mode:"visible",children:i.children},n,0,null),s=Yd(s,n,a,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,t.mode&1&&tg(t,e.child,null,a),t.child.memoizedState=jD(a),t.memoizedState=UD,s);if(!(t.mode&1))return Bx(e,t,a,null);if(n.data==="$!"){if(i=n.nextSibling&&n.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(Ge(419)),i=nA(s,i,void 0),Bx(e,t,a,i)}if(o=(a&e.childLanes)!==0,ra||o){if(i=En,i!==null){switch(a&-a){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(i.suspendedLanes|a)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,su(e,n),Lo(i,e,n,-1))}return $R(),i=nA(Error(Ge(421))),Bx(e,t,a,i)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=mre.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,wa=Eh(n.nextSibling),Ta=t,oi=!0,Co=null,e!==null&&(Xa[$a++]=Lc,Xa[$a++]=Nc,Xa[$a++]=up,Lc=e.id,Nc=e.overflow,up=t),t=HR(t,i.children),t.flags|=4096,t)}function Bz(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),kD(e.return,t,r)}function sA(e,t,r,i,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n)}function ZG(e,t,r){var i=t.pendingProps,n=i.revealOrder,s=i.tail;if(Is(e,t,i.children,r),i=ci.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Bz(e,r,t);else if(e.tag===19)Bz(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Gr(ci,i),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&B_(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),sA(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&B_(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}sA(t,!0,r,null,s);break;case"together":sA(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function au(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),dp|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,r=Mh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Mh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ire(e,t,r){switch(t.tag){case 3:QG(t),eg();break;case 5:EG(t);break;case 1:oa(t.type)&&O_(t);break;case 4:LR(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;Gr(L_,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Gr(ci,ci.current&1),t.flags|=128,null):r&t.child.childLanes?KG(e,t,r):(Gr(ci,ci.current&1),e=au(e,t,r),e!==null?e.sibling:null);Gr(ci,ci.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return ZG(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Gr(ci,ci.current),i)break;return null;case 22:case 23:return t.lanes=0,XG(e,t,r)}return au(e,t,r)}var JG,VD,e9,t9;JG=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};VD=function(){};e9=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,kd(Rl.current);var s=null;switch(r){case"input":n=uD(e,n),i=uD(e,i),s=[];break;case"select":n=fi({},n,{value:void 0}),i=fi({},i,{value:void 0}),s=[];break;case"textarea":n=pD(e,n),i=pD(e,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=D_)}mD(r,i);var a;r=null;for(c in n)if(!i.hasOwnProperty(c)&&n.hasOwnProperty(c)&&n[c]!=null)if(c==="style"){var o=n[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(g0.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(o=n!=null?n[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(g0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Kr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};t9=function(e,t,r,i){r!==i&&(t.flags|=4)};function kv(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ts(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function nre(e,t,r){var i=t.pendingProps;switch(MR(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(t),null;case 1:return oa(t.type)&&I_(),ts(t),null;case 3:return i=t.stateNode,rg(),ri(aa),ri(gs),zR(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Nx(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Co!==null&&(QD(Co),Co=null))),VD(e,t),ts(t),null;case 5:NR(t);var n=kd(M0.current);if(r=t.type,e!==null&&t.stateNode!=null)e9(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Ge(166));return ts(t),null}if(e=kd(Rl.current),Nx(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[_l]=t,i[C0]=s,e=(t.mode&1)!==0,r){case"dialog":Kr("cancel",i),Kr("close",i);break;case"iframe":case"object":case"embed":Kr("load",i);break;case"video":case"audio":for(n=0;n<_y.length;n++)Kr(_y[n],i);break;case"source":Kr("error",i);break;case"img":case"image":case"link":Kr("error",i),Kr("load",i);break;case"details":Kr("toggle",i);break;case"input":YN(i,s),Kr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Kr("invalid",i);break;case"textarea":$N(i,s),Kr("invalid",i)}mD(r,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&Lx(i.textContent,o,e),n=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Lx(i.textContent,o,e),n=["children",""+o]):g0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Kr("scroll",i)}switch(r){case"input":Ax(i),XN(i,s,!0);break;case"textarea":Ax(i),QN(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=D_)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=PW(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(r,{is:i.is}):(e=a.createElement(r),r==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,r),e[_l]=t,e[C0]=i,JG(e,t,!1,!1),t.stateNode=e;e:{switch(a=gD(r,i),r){case"dialog":Kr("cancel",e),Kr("close",e),n=i;break;case"iframe":case"object":case"embed":Kr("load",e),n=i;break;case"video":case"audio":for(n=0;n<_y.length;n++)Kr(_y[n],e);n=i;break;case"source":Kr("error",e),n=i;break;case"img":case"image":case"link":Kr("error",e),Kr("load",e),n=i;break;case"details":Kr("toggle",e),n=i;break;case"input":YN(e,i),n=uD(e,i),Kr("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=fi({},i,{value:void 0}),Kr("invalid",e);break;case"textarea":$N(e,i),n=pD(e,i),Kr("invalid",e);break;default:n=i}mD(r,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?OW(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&DW(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&v0(e,l):typeof l=="number"&&v0(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(g0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Kr("scroll",e):l!=null&&pR(e,s,l,a))}switch(r){case"input":Ax(e),XN(e,i,!1);break;case"textarea":Ax(e),QN(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Fh(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?_m(e,!!i.multiple,s,!1):i.defaultValue!=null&&_m(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=D_)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ts(t),null;case 6:if(e&&t.stateNode!=null)t9(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Ge(166));if(r=kd(M0.current),kd(Rl.current),Nx(t)){if(i=t.stateNode,r=t.memoizedProps,i[_l]=t,(s=i.nodeValue!==r)&&(e=Ta,e!==null))switch(e.tag){case 3:Lx(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Lx(i.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[_l]=t,t.stateNode=i}return ts(t),null;case 13:if(ri(ci),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(oi&&wa!==null&&t.mode&1&&!(t.flags&128))wG(),eg(),t.flags|=98560,s=!1;else if(s=Nx(t),i!==null&&i.dehydrated!==null){if(e===null){if(!s)throw Error(Ge(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ge(317));s[_l]=t}else eg(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ts(t),s=!1}else Co!==null&&(QD(Co),Co=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||ci.current&1?on===0&&(on=3):$R())),t.updateQueue!==null&&(t.flags|=4),ts(t),null);case 4:return rg(),VD(e,t),e===null&&E0(t.stateNode.containerInfo),ts(t),null;case 10:return OR(t.type._context),ts(t),null;case 17:return oa(t.type)&&I_(),ts(t),null;case 19:if(ri(ci),s=t.memoizedState,s===null)return ts(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)kv(s,!1);else{if(on!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=B_(e),a!==null){for(t.flags|=128,kv(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)s=r,e=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Gr(ci,ci.current&1|2),t.child}e=e.sibling}s.tail!==null&&Di()>ng&&(t.flags|=128,i=!0,kv(s,!1),t.lanes=4194304)}else{if(!i)if(e=B_(a),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),kv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!oi)return ts(t),null}else 2*Di()-s.renderingStartTime>ng&&r!==1073741824&&(t.flags|=128,i=!0,kv(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Di(),t.sibling=null,r=ci.current,Gr(ci,i?r&1|2:r&1),t):(ts(t),null);case 22:case 23:return XR(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?fa&1073741824&&(ts(t),t.subtreeFlags&6&&(t.flags|=8192)):ts(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function sre(e,t){switch(MR(t),t.tag){case 1:return oa(t.type)&&I_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return rg(),ri(aa),ri(gs),zR(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return NR(t),null;case 13:if(ri(ci),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));eg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ri(ci),null;case 4:return rg(),null;case 10:return OR(t.type._context),null;case 22:case 23:return XR(),null;case 24:return null;default:return null}}var Fx=!1,os=!1,are=typeof WeakSet=="function"?WeakSet:Set,ct=null;function dm(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){bi(e,t,i)}else r.current=null}function HD(e,t,r){try{r()}catch(i){bi(e,t,i)}}var Fz=!1;function ore(e,t){if(CD=A_,e=aG(),CR(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var p;h!==r||n!==0&&h.nodeType!==3||(o=a+n),h!==s||i!==0&&h.nodeType!==3||(l=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===r&&++c===n&&(o=a),d===s&&++u===i&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(AD={focusedElem:e,selectionRange:r},A_=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:So(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(b){bi(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return f=Fz,Fz=!1,f}function Gy(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&HD(t,r,s)}n=n.next}while(n!==i)}}function rT(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function WD(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function r9(e){var t=e.alternate;t!==null&&(e.alternate=null,r9(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_l],delete t[C0],delete t[DD],delete t[Hte],delete t[Wte])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function i9(e){return e.tag===5||e.tag===3||e.tag===4}function Uz(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||i9(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function GD(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=D_));else if(i!==4&&(e=e.child,e!==null))for(GD(e,t,r),e=e.sibling;e!==null;)GD(e,t,r),e=e.sibling}function qD(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(qD(e,t,r),e=e.sibling;e!==null;)qD(e,t,r),e=e.sibling}var Nn=null,To=!1;function Su(e,t,r){for(r=r.child;r!==null;)n9(e,t,r),r=r.sibling}function n9(e,t,r){if(Ol&&typeof Ol.onCommitFiberUnmount=="function")try{Ol.onCommitFiberUnmount(XE,r)}catch{}switch(r.tag){case 5:os||dm(r,t);case 6:var i=Nn,n=To;Nn=null,Su(e,t,r),Nn=i,To=n,Nn!==null&&(To?(e=Nn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Nn.removeChild(r.stateNode));break;case 18:Nn!==null&&(To?(e=Nn,r=r.stateNode,e.nodeType===8?ZC(e.parentNode,r):e.nodeType===1&&ZC(e,r),b0(e)):ZC(Nn,r.stateNode));break;case 4:i=Nn,n=To,Nn=r.stateNode.containerInfo,To=!0,Su(e,t,r),Nn=i,To=n;break;case 0:case 11:case 14:case 15:if(!os&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&HD(r,t,a),n=n.next}while(n!==i)}Su(e,t,r);break;case 1:if(!os&&(dm(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(o){bi(r,t,o)}Su(e,t,r);break;case 21:Su(e,t,r);break;case 22:r.mode&1?(os=(i=os)||r.memoizedState!==null,Su(e,t,r),os=i):Su(e,t,r);break;default:Su(e,t,r)}}function jz(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new are),t.forEach(function(i){var n=gre.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function ho(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Nn=o.stateNode,To=!1;break e;case 3:Nn=o.stateNode.containerInfo,To=!0;break e;case 4:Nn=o.stateNode.containerInfo,To=!0;break e}o=o.return}if(Nn===null)throw Error(Ge(160));n9(s,a,n),Nn=null,To=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(c){bi(n,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)s9(t,e),t=t.sibling}function s9(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ho(t,e),tl(e),i&4){try{Gy(3,e,e.return),rT(3,e)}catch(m){bi(e,e.return,m)}try{Gy(5,e,e.return)}catch(m){bi(e,e.return,m)}}break;case 1:ho(t,e),tl(e),i&512&&r!==null&&dm(r,r.return);break;case 5:if(ho(t,e),tl(e),i&512&&r!==null&&dm(r,r.return),e.flags&32){var n=e.stateNode;try{v0(n,"")}catch(m){bi(e,e.return,m)}}if(i&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&AW(n,s),gD(o,a);var c=gD(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?OW(n,h):u==="dangerouslySetInnerHTML"?DW(n,h):u==="children"?v0(n,h):pR(n,u,h,c)}switch(o){case"input":hD(n,s);break;case"textarea":MW(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?_m(n,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?_m(n,!!s.multiple,s.defaultValue,!0):_m(n,!!s.multiple,s.multiple?[]:"",!1))}n[C0]=s}catch(m){bi(e,e.return,m)}}break;case 6:if(ho(t,e),tl(e),i&4){if(e.stateNode===null)throw Error(Ge(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(m){bi(e,e.return,m)}}break;case 3:if(ho(t,e),tl(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{b0(t.containerInfo)}catch(m){bi(e,e.return,m)}break;case 4:ho(t,e),tl(e);break;case 13:ho(t,e),tl(e),n=e.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(qR=Di())),i&4&&jz(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(os=(c=os)||u,ho(t,e),os=c):ho(t,e),tl(e),i&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ct=e,u=e.child;u!==null;){for(h=ct=u;ct!==null;){switch(d=ct,p=d.child,d.tag){case 0:case 11:case 14:case 15:Gy(4,d,d.return);break;case 1:dm(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){i=d,r=d.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){bi(i,r,m)}}break;case 5:dm(d,d.return);break;case 22:if(d.memoizedState!==null){Hz(h);continue}}p!==null?(p.return=d,ct=p):Hz(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,c?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=IW("display",a))}catch(m){bi(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){bi(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ho(t,e),tl(e),i&4&&jz(e);break;case 21:break;default:ho(t,e),tl(e)}}function tl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(i9(r)){var i=r;break e}r=r.return}throw Error(Ge(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(v0(n,""),i.flags&=-33);var s=Uz(e);qD(e,s,n);break;case 3:case 4:var a=i.stateNode.containerInfo,o=Uz(e);GD(e,o,a);break;default:throw Error(Ge(161))}}catch(l){bi(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function lre(e,t,r){ct=e,a9(e)}function a9(e,t,r){for(var i=(e.mode&1)!==0;ct!==null;){var n=ct,s=n.child;if(n.tag===22&&i){var a=n.memoizedState!==null||Fx;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||os;o=Fx;var c=os;if(Fx=a,(os=l)&&!c)for(ct=n;ct!==null;)a=ct,l=a.child,a.tag===22&&a.memoizedState!==null?Wz(n):l!==null?(l.return=a,ct=l):Wz(n);for(;s!==null;)ct=s,a9(s),s=s.sibling;ct=n,Fx=o,os=c}Vz(e)}else n.subtreeFlags&8772&&s!==null?(s.return=n,ct=s):Vz(e)}}function Vz(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:os||rT(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!os)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:So(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Cz(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Cz(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&b0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}os||t.flags&512&&WD(t)}catch(d){bi(t,t.return,d)}}if(t===e){ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,ct=r;break}ct=t.return}}function Hz(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ct=r;break}ct=t.return}}function Wz(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rT(4,t)}catch(l){bi(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){bi(t,n,l)}}var s=t.return;try{WD(t)}catch(l){bi(t,s,l)}break;case 5:var a=t.return;try{WD(t)}catch(l){bi(t,a,l)}}}catch(l){bi(t,t.return,l)}if(t===e){ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ct=o;break}ct=t.return}}var cre=Math.ceil,j_=mu.ReactCurrentDispatcher,WR=mu.ReactCurrentOwner,Ja=mu.ReactCurrentBatchConfig,fr=0,En=null,Wi=null,Wn=0,fa=0,pm=ed(0),on=0,O0=null,dp=0,iT=0,GR=0,qy=null,Ks=null,qR=0,ng=1/0,Sc=null,V_=!1,YD=null,Ch=null,Ux=!1,nh=null,H_=0,Yy=0,XD=null,Bb=-1,Fb=0;function Bs(){return fr&6?Di():Bb!==-1?Bb:Bb=Di()}function Ah(e){return e.mode&1?fr&2&&Wn!==0?Wn&-Wn:qte.transition!==null?(Fb===0&&(Fb=WW()),Fb):(e=Nr,e!==0||(e=window.event,e=e===void 0?16:KW(e.type)),e):1}function Lo(e,t,r,i){if(50<Yy)throw Yy=0,XD=null,Error(Ge(185));Ew(e,r,i),(!(fr&2)||e!==En)&&(e===En&&(!(fr&2)&&(iT|=r),on===4&&Xu(e,Wn)),la(e,i),r===1&&fr===0&&!(t.mode&1)&&(ng=Di()+500,JE&&td()))}function la(e,t){var r=e.callbackNode;qee(e,t);var i=C_(e,e===En?Wn:0);if(i===0)r!==null&&JN(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&JN(r),t===1)e.tag===0?Gte(Gz.bind(null,e)):gG(Gz.bind(null,e)),jte(function(){!(fr&6)&&td()}),r=null;else{switch(GW(i)){case 1:r=yR;break;case 4:r=VW;break;case 16:r=T_;break;case 536870912:r=HW;break;default:r=T_}r=f9(r,o9.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function o9(e,t){if(Bb=-1,Fb=0,fr&6)throw Error(Ge(327));var r=e.callbackNode;if(Am()&&e.callbackNode!==r)return null;var i=C_(e,e===En?Wn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=W_(e,i);else{t=i;var n=fr;fr|=2;var s=c9();(En!==e||Wn!==t)&&(Sc=null,ng=Di()+500,qd(e,t));do try{dre();break}catch(o){l9(e,o)}while(!0);IR(),j_.current=s,fr=n,Wi!==null?t=0:(En=null,Wn=0,t=on)}if(t!==0){if(t===2&&(n=bD(e),n!==0&&(i=n,t=$D(e,n))),t===1)throw r=O0,qd(e,0),Xu(e,i),la(e,Di()),r;if(t===6)Xu(e,i);else{if(n=e.current.alternate,!(i&30)&&!ure(n)&&(t=W_(e,i),t===2&&(s=bD(e),s!==0&&(i=s,t=$D(e,s))),t===1))throw r=O0,qd(e,0),Xu(e,i),la(e,Di()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(Ge(345));case 2:wd(e,Ks,Sc);break;case 3:if(Xu(e,i),(i&130023424)===i&&(t=qR+500-Di(),10<t)){if(C_(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){Bs(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=PD(wd.bind(null,e,Ks,Sc),t);break}wd(e,Ks,Sc);break;case 4:if(Xu(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var a=31-ko(i);s=1<<a,a=t[a],a>n&&(n=a),i&=~s}if(i=n,i=Di()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*cre(i/1960))-i,10<i){e.timeoutHandle=PD(wd.bind(null,e,Ks,Sc),i);break}wd(e,Ks,Sc);break;case 5:wd(e,Ks,Sc);break;default:throw Error(Ge(329))}}}return la(e,Di()),e.callbackNode===r?o9.bind(null,e):null}function $D(e,t){var r=qy;return e.current.memoizedState.isDehydrated&&(qd(e,t).flags|=256),e=W_(e,t),e!==2&&(t=Ks,Ks=r,t!==null&&QD(t)),e}function QD(e){Ks===null?Ks=e:Ks.push.apply(Ks,e)}function ure(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],s=n.getSnapshot;n=n.value;try{if(!jo(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xu(e,t){for(t&=~GR,t&=~iT,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ko(t),i=1<<r;e[r]=-1,t&=~i}}function Gz(e){if(fr&6)throw Error(Ge(327));Am();var t=C_(e,0);if(!(t&1))return la(e,Di()),null;var r=W_(e,t);if(e.tag!==0&&r===2){var i=bD(e);i!==0&&(t=i,r=$D(e,i))}if(r===1)throw r=O0,qd(e,0),Xu(e,t),la(e,Di()),r;if(r===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wd(e,Ks,Sc),la(e,Di()),null}function YR(e,t){var r=fr;fr|=1;try{return e(t)}finally{fr=r,fr===0&&(ng=Di()+500,JE&&td())}}function pp(e){nh!==null&&nh.tag===0&&!(fr&6)&&Am();var t=fr;fr|=1;var r=Ja.transition,i=Nr;try{if(Ja.transition=null,Nr=1,e)return e()}finally{Nr=i,Ja.transition=r,fr=t,!(fr&6)&&td()}}function XR(){fa=pm.current,ri(pm)}function qd(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Ute(r)),Wi!==null)for(r=Wi.return;r!==null;){var i=r;switch(MR(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&I_();break;case 3:rg(),ri(aa),ri(gs),zR();break;case 5:NR(i);break;case 4:rg();break;case 13:ri(ci);break;case 19:ri(ci);break;case 10:OR(i.type._context);break;case 22:case 23:XR()}r=r.return}if(En=e,Wi=e=Mh(e.current,null),Wn=fa=t,on=0,O0=null,GR=iT=dp=0,Ks=qy=null,Rd!==null){for(t=0;t<Rd.length;t++)if(r=Rd[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,s=r.pending;if(s!==null){var a=s.next;s.next=n,i.next=a}r.pending=i}Rd=null}return e}function l9(e,t){do{var r=Wi;try{if(IR(),Lb.current=U_,F_){for(var i=di.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}F_=!1}if(hp=0,vn=nn=di=null,Wy=!1,P0=0,WR.current=null,r===null||r.return===null){on=1,O0=t,Wi=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Wn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Oz(a);if(p!==null){p.flags&=-257,Rz(p,a,o,s,t),p.mode&1&&Iz(s,c,t),t=p,l=c;var f=t.updateQueue;if(f===null){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}else{if(!(t&1)){Iz(s,c,t),$R();break e}l=Error(Ge(426))}}else if(oi&&o.mode&1){var g=Oz(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Rz(g,a,o,s,t),PR(ig(l,o));break e}}s=l=ig(l,o),on!==4&&(on=2),qy===null?qy=[s]:qy.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=GG(s,l,t);Tz(s,v);break e;case 1:o=l;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ch===null||!Ch.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=qG(s,o,t);Tz(s,b);break e}}s=s.return}while(s!==null)}h9(r)}catch(E){t=E,Wi===r&&r!==null&&(Wi=r=r.return);continue}break}while(!0)}function c9(){var e=j_.current;return j_.current=U_,e===null?U_:e}function $R(){(on===0||on===3||on===2)&&(on=4),En===null||!(dp&268435455)&&!(iT&268435455)||Xu(En,Wn)}function W_(e,t){var r=fr;fr|=2;var i=c9();(En!==e||Wn!==t)&&(Sc=null,qd(e,t));do try{hre();break}catch(n){l9(e,n)}while(!0);if(IR(),fr=r,j_.current=i,Wi!==null)throw Error(Ge(261));return En=null,Wn=0,on}function hre(){for(;Wi!==null;)u9(Wi)}function dre(){for(;Wi!==null&&!zee();)u9(Wi)}function u9(e){var t=p9(e.alternate,e,fa);e.memoizedProps=e.pendingProps,t===null?h9(e):Wi=t,WR.current=null}function h9(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=sre(r,t),r!==null){r.flags&=32767,Wi=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{on=6,Wi=null;return}}else if(r=nre(r,t,fa),r!==null){Wi=r;return}if(t=t.sibling,t!==null){Wi=t;return}Wi=t=e}while(t!==null);on===0&&(on=5)}function wd(e,t,r){var i=Nr,n=Ja.transition;try{Ja.transition=null,Nr=1,pre(e,t,r,i)}finally{Ja.transition=n,Nr=i}return null}function pre(e,t,r,i){do Am();while(nh!==null);if(fr&6)throw Error(Ge(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Yee(e,s),e===En&&(Wi=En=null,Wn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ux||(Ux=!0,f9(T_,function(){return Am(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ja.transition,Ja.transition=null;var a=Nr;Nr=1;var o=fr;fr|=4,WR.current=null,ore(e,r),s9(r,e),Rte(AD),A_=!!CD,AD=CD=null,e.current=r,lre(r),Bee(),fr=o,Nr=a,Ja.transition=s}else e.current=r;if(Ux&&(Ux=!1,nh=e,H_=n),s=e.pendingLanes,s===0&&(Ch=null),jee(r.stateNode),la(e,Di()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],i(n.value,{componentStack:n.stack,digest:n.digest});if(V_)throw V_=!1,e=YD,YD=null,e;return H_&1&&e.tag!==0&&Am(),s=e.pendingLanes,s&1?e===XD?Yy++:(Yy=0,XD=e):Yy=0,td(),null}function Am(){if(nh!==null){var e=GW(H_),t=Ja.transition,r=Nr;try{if(Ja.transition=null,Nr=16>e?16:e,nh===null)var i=!1;else{if(e=nh,nh=null,H_=0,fr&6)throw Error(Ge(331));var n=fr;for(fr|=4,ct=e.current;ct!==null;){var s=ct,a=s.child;if(ct.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ct=c;ct!==null;){var u=ct;switch(u.tag){case 0:case 11:case 15:Gy(8,u,s)}var h=u.child;if(h!==null)h.return=u,ct=h;else for(;ct!==null;){u=ct;var d=u.sibling,p=u.return;if(r9(u),u===c){ct=null;break}if(d!==null){d.return=p,ct=d;break}ct=p}}}var f=s.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ct=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ct=a;else e:for(;ct!==null;){if(s=ct,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Gy(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ct=v;break e}ct=s.return}}var y=e.current;for(ct=y;ct!==null;){a=ct;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,ct=w;else e:for(a=y;ct!==null;){if(o=ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rT(9,o)}}catch(E){bi(o,o.return,E)}if(o===a){ct=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,ct=b;break e}ct=o.return}}if(fr=n,td(),Ol&&typeof Ol.onPostCommitFiberRoot=="function")try{Ol.onPostCommitFiberRoot(XE,e)}catch{}i=!0}return i}finally{Nr=r,Ja.transition=t}}return!1}function qz(e,t,r){t=ig(r,t),t=GG(e,t,1),e=Th(e,t,1),t=Bs(),e!==null&&(Ew(e,1,t),la(e,t))}function bi(e,t,r){if(e.tag===3)qz(e,e,r);else for(;t!==null;){if(t.tag===3){qz(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ch===null||!Ch.has(i))){e=ig(r,e),e=qG(t,e,1),t=Th(t,e,1),e=Bs(),t!==null&&(Ew(t,1,e),la(t,e));break}}t=t.return}}function fre(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=Bs(),e.pingedLanes|=e.suspendedLanes&r,En===e&&(Wn&r)===r&&(on===4||on===3&&(Wn&130023424)===Wn&&500>Di()-qR?qd(e,0):GR|=r),la(e,t)}function d9(e,t){t===0&&(e.mode&1?(t=Dx,Dx<<=1,!(Dx&130023424)&&(Dx=4194304)):t=1);var r=Bs();e=su(e,t),e!==null&&(Ew(e,t,r),la(e,r))}function mre(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),d9(e,r)}function gre(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Ge(314))}i!==null&&i.delete(t),d9(e,r)}var p9;p9=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||aa.current)ra=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ra=!1,ire(e,t,r);ra=!!(e.flags&131072)}else ra=!1,oi&&t.flags&1048576&&vG(t,k_,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;zb(e,t),e=t.pendingProps;var n=Jm(t,gs.current);Cm(t,r),n=FR(null,t,i,e,n,r);var s=UR();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,oa(i)?(s=!0,O_(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,kR(t),n.updater=tT,t.stateNode=n,n._reactInternals=t,ND(t,i,e,r),t=FD(null,t,i,!0,s,r)):(t.tag=0,oi&&s&&AR(t),Is(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(zb(e,t),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=yre(i),e=So(i,e),n){case 0:t=BD(null,t,i,e,r);break e;case 1:t=Nz(null,t,i,e,r);break e;case 11:t=kz(null,t,i,e,r);break e;case 14:t=Lz(null,t,i,So(i.type,e),r);break e}throw Error(Ge(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:So(i,n),BD(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:So(i,n),Nz(e,t,i,n,r);case 3:e:{if(QG(t),e===null)throw Error(Ge(387));i=t.pendingProps,s=t.memoizedState,n=s.element,SG(e,t),z_(t,i,null,r);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=ig(Error(Ge(423)),t),t=zz(e,t,i,r,n);break e}else if(i!==n){n=ig(Error(Ge(424)),t),t=zz(e,t,i,r,n);break e}else for(wa=Eh(t.stateNode.containerInfo.firstChild),Ta=t,oi=!0,Co=null,r=bG(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(eg(),i===n){t=au(e,t,r);break e}Is(e,t,i,r)}t=t.child}return t;case 5:return EG(t),e===null&&RD(t),i=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,MD(i,n)?a=null:s!==null&&MD(i,s)&&(t.flags|=32),$G(e,t),Is(e,t,a,r),t.child;case 6:return e===null&&RD(t),null;case 13:return KG(e,t,r);case 4:return LR(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=tg(t,null,i,r):Is(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:So(i,n),kz(e,t,i,n,r);case 7:return Is(e,t,t.pendingProps,r),t.child;case 8:return Is(e,t,t.pendingProps.children,r),t.child;case 12:return Is(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,Gr(L_,i._currentValue),i._currentValue=a,s!==null)if(jo(s.value,a)){if(s.children===n.children&&!aa.current){t=au(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=qc(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),kD(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ge(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),kD(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Is(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,Cm(t,r),n=so(n),i=i(n),t.flags|=1,Is(e,t,i,r),t.child;case 14:return i=t.type,n=So(i,t.pendingProps),n=So(i.type,n),Lz(e,t,i,n,r);case 15:return YG(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:So(i,n),zb(e,t),t.tag=1,oa(i)?(e=!0,O_(t)):e=!1,Cm(t,r),WG(t,i,n),ND(t,i,n,r),FD(null,t,i,!0,e,r);case 19:return ZG(e,t,r);case 22:return XG(e,t,r)}throw Error(Ge(156,t.tag))};function f9(e,t){return jW(e,t)}function vre(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ka(e,t,r,i){return new vre(e,t,r,i)}function QR(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yre(e){if(typeof e=="function")return QR(e)?1:0;if(e!=null){if(e=e.$$typeof,e===mR)return 11;if(e===gR)return 14}return 2}function Mh(e,t){var r=e.alternate;return r===null?(r=Ka(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ub(e,t,r,i,n,s){var a=2;if(i=e,typeof e=="function")QR(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case im:return Yd(r.children,n,s,t);case fR:a=8,n|=8;break;case aD:return e=Ka(12,r,t,n|2),e.elementType=aD,e.lanes=s,e;case oD:return e=Ka(13,r,t,n),e.elementType=oD,e.lanes=s,e;case lD:return e=Ka(19,r,t,n),e.elementType=lD,e.lanes=s,e;case EW:return nT(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case _W:a=10;break e;case SW:a=9;break e;case mR:a=11;break e;case gR:a=14;break e;case ju:a=16,i=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=Ka(a,r,t,n),t.elementType=e,t.type=i,t.lanes=s,t}function Yd(e,t,r,i){return e=Ka(7,e,i,t),e.lanes=r,e}function nT(e,t,r,i){return e=Ka(22,e,i,t),e.elementType=EW,e.lanes=r,e.stateNode={isHidden:!1},e}function aA(e,t,r){return e=Ka(6,e,null,t),e.lanes=r,e}function oA(e,t,r){return t=Ka(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function wre(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jC(0),this.expirationTimes=jC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jC(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function KR(e,t,r,i,n,s,a,o,l){return e=new wre(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ka(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},kR(s),e}function xre(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rm,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function m9(e){if(!e)return Uh;e=e._reactInternals;e:{if(Bp(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var r=e.type;if(oa(r))return mG(e,r,t)}return t}function g9(e,t,r,i,n,s,a,o,l){return e=KR(r,i,!0,e,n,s,a,o,l),e.context=m9(null),r=e.current,i=Bs(),n=Ah(r),s=qc(i,n),s.callback=t??null,Th(r,s,n),e.current.lanes=n,Ew(e,n,i),la(e,i),e}function sT(e,t,r,i){var n=t.current,s=Bs(),a=Ah(n);return r=m9(r),t.context===null?t.context=r:t.pendingContext=r,t=qc(s,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Th(n,t,a),e!==null&&(Lo(e,n,a,s),kb(e,n,a)),a}function G_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yz(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ZR(e,t){Yz(e,t),(e=e.alternate)&&Yz(e,t)}function bre(){return null}var v9=typeof reportError=="function"?reportError:function(e){console.error(e)};function JR(e){this._internalRoot=e}aT.prototype.render=JR.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));sT(e,t,null,null)};aT.prototype.unmount=JR.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pp(function(){sT(null,e,null,null)}),t[nu]=null}};function aT(e){this._internalRoot=e}aT.prototype.unstable_scheduleHydration=function(e){if(e){var t=XW();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Yu.length&&t!==0&&t<Yu[r].priority;r++);Yu.splice(r,0,e),r===0&&QW(e)}};function e3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oT(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xz(){}function _re(e,t,r,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var c=G_(a);s.call(c)}}var a=g9(t,i,e,0,null,!1,!1,"",Xz);return e._reactRootContainer=a,e[nu]=a.current,E0(e.nodeType===8?e.parentNode:e),pp(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var o=i;i=function(){var c=G_(l);o.call(c)}}var l=KR(e,0,!1,null,null,!1,!1,"",Xz);return e._reactRootContainer=l,e[nu]=l.current,E0(e.nodeType===8?e.parentNode:e),pp(function(){sT(t,l,r,i)}),l}function lT(e,t,r,i,n){var s=r._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=G_(a);o.call(l)}}sT(t,a,e,n)}else a=_re(r,t,e,n,i);return G_(a)}qW=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=by(t.pendingLanes);r!==0&&(wR(t,r|1),la(t,Di()),!(fr&6)&&(ng=Di()+500,td()))}break;case 13:pp(function(){var i=su(e,1);if(i!==null){var n=Bs();Lo(i,e,1,n)}}),ZR(e,1)}};xR=function(e){if(e.tag===13){var t=su(e,134217728);if(t!==null){var r=Bs();Lo(t,e,134217728,r)}ZR(e,134217728)}};YW=function(e){if(e.tag===13){var t=Ah(e),r=su(e,t);if(r!==null){var i=Bs();Lo(r,e,t,i)}ZR(e,t)}};XW=function(){return Nr};$W=function(e,t){var r=Nr;try{return Nr=e,t()}finally{Nr=r}};yD=function(e,t,r){switch(t){case"input":if(hD(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=ZE(i);if(!n)throw Error(Ge(90));CW(i),hD(i,n)}}}break;case"textarea":MW(e,r);break;case"select":t=r.value,t!=null&&_m(e,!!r.multiple,t,!1)}};LW=YR;NW=pp;var Sre={usingClientEntryPoint:!1,Events:[Cw,om,ZE,RW,kW,YR]},Lv={findFiberByHostInstance:Od,bundleType:0,version:"18.3.0",rendererPackageName:"react-dom"},Ere={bundleType:Lv.bundleType,version:Lv.version,rendererPackageName:Lv.rendererPackageName,rendererConfig:Lv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=FW(e),e===null?null:e.stateNode},findFiberByHostInstance:Lv.findFiberByHostInstance||bre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.0-next-8a015b68cc-20240425"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jx.isDisabled&&jx.supportsFiber)try{XE=jx.inject(Ere),Ol=jx}catch{}}Pa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sre;Pa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e3(t))throw Error(Ge(200));return xre(e,t,null,r)};Pa.createRoot=function(e,t){if(!e3(e))throw Error(Ge(299));var r=!1,i="",n=v9;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=KR(e,1,!1,null,null,r,!1,i,n),e[nu]=t.current,E0(e.nodeType===8?e.parentNode:e),new JR(t)};Pa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=FW(t),e=e===null?null:e.stateNode,e};Pa.flushSync=function(e){return pp(e)};Pa.hydrate=function(e,t,r){if(!oT(t))throw Error(Ge(200));return lT(null,e,t,!0,r)};Pa.hydrateRoot=function(e,t,r){if(!e3(e))throw Error(Ge(405));var i=r!=null&&r.hydratedSources||null,n=!1,s="",a=v9;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=g9(t,null,e,1,r??null,n,!1,s,a),e[nu]=t.current,E0(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new aT(t)};Pa.render=function(e,t,r){if(!oT(t))throw Error(Ge(200));return lT(null,e,t,!1,r)};Pa.unmountComponentAtNode=function(e){if(!oT(e))throw Error(Ge(40));return e._reactRootContainer?(pp(function(){lT(null,null,e,!1,function(){e._reactRootContainer=null,e[nu]=null})}),!0):!1};Pa.unstable_batchedUpdates=YR;Pa.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!oT(r))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return lT(e,t,r,!1,i)};Pa.version="18.3.0-next-8a015b68cc-20240425";function y9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y9)}catch(e){console.error(e)}}y9(),yW.exports=Pa;var Mw=yW.exports;const Tre=Ug(Mw);var $z=Mw;nD.createRoot=$z.createRoot,nD.hydrateRoot=$z.hydrateRoot;/**
 * @remix-run/router v1.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function R0(){return R0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},R0.apply(this,arguments)}var sh;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sh||(sh={}));const Qz="popstate";function Cre(e){e===void 0&&(e={});function t(n,s){let{pathname:a="/",search:o="",hash:l=""}=Fp(n.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),KD("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){let a=n.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=n.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof s=="string"?s:q_(s))}function i(n,s){t3(n.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return Mre(t,r,i,e)}function Xi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function t3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Are(){return Math.random().toString(36).substr(2,8)}function Kz(e,t){return{usr:e.state,key:e.key,idx:t}}function KD(e,t,r,i){return r===void 0&&(r=null),R0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Fp(t):t,{state:r,key:t&&t.key||i||Are()})}function q_(e){let{pathname:t="/",search:r="",hash:i=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function Fp(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function Mre(e,t,r,i){i===void 0&&(i={});let{window:n=document.defaultView,v5Compat:s=!1}=i,a=n.history,o=sh.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(R0({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=sh.Pop;let g=u(),v=g==null?null:g-c;c=g,l&&l({action:o,location:m.location,delta:v})}function d(g,v){o=sh.Push;let y=KD(m.location,g,v);r&&r(y,g),c=u()+1;let w=Kz(y,c),b=m.createHref(y);try{a.pushState(w,"",b)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;n.location.assign(b)}s&&l&&l({action:o,location:m.location,delta:1})}function p(g,v){o=sh.Replace;let y=KD(m.location,g,v);r&&r(y,g),c=u();let w=Kz(y,c),b=m.createHref(y);a.replaceState(w,"",b),s&&l&&l({action:o,location:m.location,delta:0})}function f(g){let v=n.location.origin!=="null"?n.location.origin:n.location.href,y=typeof g=="string"?g:q_(g);return y=y.replace(/ $/,"%20"),Xi(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return e(n,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(Qz,h),l=g,()=>{n.removeEventListener(Qz,h),l=null}},createHref(g){return t(n,g)},createURL:f,encodeLocation(g){let v=f(g);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:p,go(g){return a.go(g)}};return m}var Zz;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Zz||(Zz={}));function Pre(e,t,r){r===void 0&&(r="/");let i=typeof t=="string"?Fp(t):t,n=r3(i.pathname||"/",r);if(n==null)return null;let s=w9(e);Dre(s);let a=null;for(let o=0;a==null&&o<s.length;++o){let l=Vre(n);a=Fre(s[o],l)}return a}function w9(e,t,r,i){t===void 0&&(t=[]),r===void 0&&(r=[]),i===void 0&&(i="");let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Xi(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=Ph([i,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Xi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),w9(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:zre(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))n(s,a);else for(let l of x9(s.path))n(s,a,l)}),t}function x9(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(i.length===0)return n?[s,""]:[s];let a=x9(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Dre(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Bre(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const Ire=/^:[\w-]+$/,Ore=3,Rre=2,kre=1,Lre=10,Nre=-2,Jz=e=>e==="*";function zre(e,t){let r=e.split("/"),i=r.length;return r.some(Jz)&&(i+=Nre),t&&(i+=Rre),r.filter(n=>!Jz(n)).reduce((n,s)=>n+(Ire.test(s)?Ore:s===""?kre:Lre),i)}function Bre(e,t){return e.length===t.length&&e.slice(0,-1).every((i,n)=>i===t[n])?e[e.length-1]-t[t.length-1]:0}function Fre(e,t){let{routesMeta:r}=e,i={},n="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=n==="/"?t:t.slice(n.length)||"/",u=Ure({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(i,u.params);let h=o.route;s.push({params:i,pathname:Ph([n,u.pathname]),pathnameBase:qre(Ph([n,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(n=Ph([n,u.pathnameBase]))}return s}function Ure(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=jre(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((c,u,h)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const f=o[h];return p&&!f?c[d]=void 0:c[d]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:e}}function jre(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),t3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(i.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function Vre(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return t3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function r3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function Hre(e,t){t===void 0&&(t="/");let{pathname:r,search:i="",hash:n=""}=typeof e=="string"?Fp(e):e;return{pathname:r?r.startsWith("/")?r:Wre(r,t):t,search:Yre(i),hash:Xre(n)}}function Wre(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function lA(e,t,r,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Gre(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function b9(e,t){let r=Gre(e);return t?r.map((i,n)=>n===e.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function _9(e,t,r,i){i===void 0&&(i=!1);let n;typeof e=="string"?n=Fp(e):(n=R0({},e),Xi(!n.pathname||!n.pathname.includes("?"),lA("?","pathname","search",n)),Xi(!n.pathname||!n.pathname.includes("#"),lA("#","pathname","hash",n)),Xi(!n.search||!n.search.includes("#"),lA("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=r;else{let h=t.length-1;if(!i&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}o=h>=0?t[h]:"/"}let l=Hre(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ph=e=>e.join("/").replace(/\/\/+/g,"/"),qre=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Yre=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Xre=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $re(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const S9=["post","put","patch","delete"];new Set(S9);const Qre=["get",...S9];new Set(Qre);/**
 * React Router v6.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},k0.apply(this,arguments)}const i3=te.createContext(null),Kre=te.createContext(null),Up=te.createContext(null),cT=te.createContext(null),jp=te.createContext({outlet:null,matches:[],isDataRoute:!1}),E9=te.createContext(null);function Zre(e,t){let{relative:r}=t===void 0?{}:t;Pw()||Xi(!1);let{basename:i,navigator:n}=te.useContext(Up),{hash:s,pathname:a,search:o}=C9(e,{relative:r}),l=a;return i!=="/"&&(l=a==="/"?i:Ph([i,a])),n.createHref({pathname:l,search:o,hash:s})}function Pw(){return te.useContext(cT)!=null}function Dw(){return Pw()||Xi(!1),te.useContext(cT).location}function T9(e){te.useContext(Up).static||te.useLayoutEffect(e)}function rd(){let{isDataRoute:e}=te.useContext(jp);return e?hie():Jre()}function Jre(){Pw()||Xi(!1);let e=te.useContext(i3),{basename:t,future:r,navigator:i}=te.useContext(Up),{matches:n}=te.useContext(jp),{pathname:s}=Dw(),a=JSON.stringify(b9(n,r.v7_relativeSplatPath)),o=te.useRef(!1);return T9(()=>{o.current=!0}),te.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){i.go(c);return}let h=_9(c,JSON.parse(a),s,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ph([t,h.pathname])),(u.replace?i.replace:i.push)(h,u.state,u)},[t,i,a,s,e])}function C9(e,t){let{relative:r}=t===void 0?{}:t,{future:i}=te.useContext(Up),{matches:n}=te.useContext(jp),{pathname:s}=Dw(),a=JSON.stringify(b9(n,i.v7_relativeSplatPath));return te.useMemo(()=>_9(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function eie(e,t){return tie(e,t)}function tie(e,t,r,i){Pw()||Xi(!1);let{navigator:n}=te.useContext(Up),{matches:s}=te.useContext(jp),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Dw(),u;if(t){var h;let g=typeof t=="string"?Fp(t):t;l==="/"||(h=g.pathname)!=null&&h.startsWith(l)||Xi(!1),u=g}else u=c;let d=u.pathname||"/",p=d;if(l!=="/"){let g=l.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let f=Pre(e,{pathname:p}),m=aie(f&&f.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:Ph([l,n.encodeLocation?n.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Ph([l,n.encodeLocation?n.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),s,r,i);return t&&m?te.createElement(cT.Provider,{value:{location:k0({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:sh.Pop}},m):m}function rie(){let e=uie(),t=$re(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},t),r?te.createElement("pre",{style:n},r):null,null)}const iie=te.createElement(rie,null);class nie extends te.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?te.createElement(jp.Provider,{value:this.props.routeContext},te.createElement(E9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function sie(e){let{routeContext:t,match:r,children:i}=e,n=te.useContext(i3);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),te.createElement(jp.Provider,{value:t},i)}function aie(e,t,r,i){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),i===void 0&&(i=null),e==null){var s;if((s=r)!=null&&s.errors)e=r.matches;else return null}let a=e,o=(n=r)==null?void 0:n.errors;if(o!=null){let u=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Xi(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&i&&i.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:p}=r,f=h.route.loader&&d[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||f){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,h,d)=>{let p,f=!1,m=null,g=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||iie,l&&(c<0&&d===0?(die("route-fallback",!1),f=!0,g=null):c===d&&(f=!0,g=h.route.hydrateFallbackElement||null)));let v=t.concat(a.slice(0,d+1)),y=()=>{let w;return p?w=m:f?w=g:h.route.Component?w=te.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,te.createElement(sie,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?te.createElement(nie,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var A9=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(A9||{}),Y_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Y_||{});function oie(e){let t=te.useContext(i3);return t||Xi(!1),t}function lie(e){let t=te.useContext(Kre);return t||Xi(!1),t}function cie(e){let t=te.useContext(jp);return t||Xi(!1),t}function M9(e){let t=cie(),r=t.matches[t.matches.length-1];return r.route.id||Xi(!1),r.route.id}function uie(){var e;let t=te.useContext(E9),r=lie(Y_.UseRouteError),i=M9(Y_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[i]}function hie(){let{router:e}=oie(A9.UseNavigateStable),t=M9(Y_.UseNavigateStable),r=te.useRef(!1);return T9(()=>{r.current=!0}),te.useCallback(function(n,s){s===void 0&&(s={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,k0({fromRouteId:t},s)))},[e,t])}const eB={};function die(e,t,r){!t&&!eB[e]&&(eB[e]=!0)}function pl(e){Xi(!1)}function pie(e){let{basename:t="/",children:r=null,location:i,navigationType:n=sh.Pop,navigator:s,static:a=!1,future:o}=e;Pw()&&Xi(!1);let l=t.replace(/^\/*/,"/"),c=te.useMemo(()=>({basename:l,navigator:s,static:a,future:k0({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof i=="string"&&(i=Fp(i));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:f="default"}=i,m=te.useMemo(()=>{let g=r3(u,l);return g==null?null:{location:{pathname:g,search:h,hash:d,state:p,key:f},navigationType:n}},[l,u,h,d,p,f,n]);return m==null?null:te.createElement(Up.Provider,{value:c},te.createElement(cT.Provider,{children:r,value:m}))}function tB(e){let{children:t,location:r}=e;return eie(ZD(t),r)}new Promise(()=>{});function ZD(e,t){t===void 0&&(t=[]);let r=[];return te.Children.forEach(e,(i,n)=>{if(!te.isValidElement(i))return;let s=[...t,n];if(i.type===te.Fragment){r.push.apply(r,ZD(i.props.children,s));return}i.type!==pl&&Xi(!1),!i.props.index||!i.props.children||Xi(!1);let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=ZD(i.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function JD(){return JD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},JD.apply(this,arguments)}function fie(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function mie(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function gie(e,t){return e.button===0&&(!t||t==="_self")&&!mie(e)}const vie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],yie="6";try{window.__reactRouterVersion=yie}catch{}const wie="startTransition",rB=uR[wie];function xie(e){let{basename:t,children:r,future:i,window:n}=e,s=te.useRef();s.current==null&&(s.current=Cre({window:n,v5Compat:!0}));let a=s.current,[o,l]=te.useState({action:a.action,location:a.location}),{v7_startTransition:c}=i||{},u=te.useCallback(h=>{c&&rB?rB(()=>l(h)):l(h)},[l,c]);return te.useLayoutEffect(()=>a.listen(u),[a,u]),te.createElement(pie,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:i})}const bie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_ie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,n3=te.forwardRef(function(t,r){let{onClick:i,relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,unstable_viewTransition:h}=t,d=fie(t,vie),{basename:p}=te.useContext(Up),f,m=!1;if(typeof c=="string"&&_ie.test(c)&&(f=c,bie))try{let w=new URL(window.location.href),b=c.startsWith("//")?new URL(w.protocol+c):new URL(c),E=r3(b.pathname,p);b.origin===w.origin&&E!=null?c=E+b.search+b.hash:m=!0}catch{}let g=Zre(c,{relative:n}),v=Sie(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n,unstable_viewTransition:h});function y(w){i&&i(w),w.defaultPrevented||v(w)}return te.createElement("a",JD({},d,{href:f||g,onClick:m||s?i:y,ref:r,target:l}))});var iB;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(iB||(iB={}));var nB;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nB||(nB={}));function Sie(e,t){let{target:r,replace:i,state:n,preventScrollReset:s,relative:a,unstable_viewTransition:o}=t===void 0?{}:t,l=rd(),c=Dw(),u=C9(e,{relative:a});return te.useCallback(h=>{if(gie(h,r)){h.preventDefault();let d=i!==void 0?i:q_(c)===q_(u);l(e,{replace:d,state:n,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[c,l,u,i,n,r,e,s,a,o])}var P9={exports:{}};(function(e,t){(function(r,i){e.exports=i()})(yy,function(){return function(r){function i(s){if(n[s])return n[s].exports;var a=n[s]={exports:{},id:s,loaded:!1};return r[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var n={};return i.m=r,i.c=n,i.p="dist/",i(0)}([function(r,i,n){function s(I){return I&&I.__esModule?I:{default:I}}var a=Object.assign||function(I){for(var B=1;B<arguments.length;B++){var V=arguments[B];for(var N in V)Object.prototype.hasOwnProperty.call(V,N)&&(I[N]=V[N])}return I},o=n(1),l=(s(o),n(6)),c=s(l),u=n(7),h=s(u),d=n(8),p=s(d),f=n(9),m=s(f),g=n(10),v=s(g),y=n(11),w=s(y),b=n(14),E=s(b),_=[],C=!1,x={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},A=function(){var I=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(I&&(C=!0),C)return _=(0,w.default)(_,x),(0,v.default)(_,x.once),_},T=function(){_=(0,E.default)(),A()},M=function(){_.forEach(function(I,B){I.node.removeAttribute("data-aos"),I.node.removeAttribute("data-aos-easing"),I.node.removeAttribute("data-aos-duration"),I.node.removeAttribute("data-aos-delay")})},D=function(I){return I===!0||I==="mobile"&&m.default.mobile()||I==="phone"&&m.default.phone()||I==="tablet"&&m.default.tablet()||typeof I=="function"&&I()===!0},P=function(I){x=a(x,I),_=(0,E.default)();var B=document.all&&!window.atob;return D(x.disable)||B?M():(x.disableMutationObserver||p.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),x.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",x.easing),document.querySelector("body").setAttribute("data-aos-duration",x.duration),document.querySelector("body").setAttribute("data-aos-delay",x.delay),x.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?A(!0):x.startEvent==="load"?window.addEventListener(x.startEvent,function(){A(!0)}):document.addEventListener(x.startEvent,function(){A(!0)}),window.addEventListener("resize",(0,h.default)(A,x.debounceDelay,!0)),window.addEventListener("orientationchange",(0,h.default)(A,x.debounceDelay,!0)),window.addEventListener("scroll",(0,c.default)(function(){(0,v.default)(_,x.once)},x.throttleDelay)),x.disableMutationObserver||p.default.ready("[data-aos]",T),_)};r.exports={init:P,refresh:A,refreshHard:T}},function(r,i){},,,,,function(r,i){(function(n){function s(D,P,I){function B(Le){var Oe=J,Ye=se;return J=se=void 0,de=Le,ue=D.apply(Ye,Oe)}function V(Le){return de=Le,oe=setTimeout(W,P),xe?B(Le):ue}function N(Le){var Oe=Le-le,Ye=Le-de,$e=P-Oe;return _e?T($e,ee-Ye):$e}function L(Le){var Oe=Le-le,Ye=Le-de;return le===void 0||Oe>=P||Oe<0||_e&&Ye>=ee}function W(){var Le=M();return L(Le)?G(Le):void(oe=setTimeout(W,N(Le)))}function G(Le){return oe=void 0,Se&&J?B(Le):(J=se=void 0,ue)}function X(){oe!==void 0&&clearTimeout(oe),de=0,J=le=se=oe=void 0}function Q(){return oe===void 0?ue:G(M())}function ie(){var Le=M(),Oe=L(Le);if(J=arguments,se=this,le=Le,Oe){if(oe===void 0)return V(le);if(_e)return oe=setTimeout(W,P),B(le)}return oe===void 0&&(oe=setTimeout(W,P)),ue}var J,se,ee,ue,oe,le,de=0,xe=!1,_e=!1,Se=!0;if(typeof D!="function")throw new TypeError(d);return P=u(P)||0,o(I)&&(xe=!!I.leading,_e="maxWait"in I,ee=_e?A(u(I.maxWait)||0,P):ee,Se="trailing"in I?!!I.trailing:Se),ie.cancel=X,ie.flush=Q,ie}function a(D,P,I){var B=!0,V=!0;if(typeof D!="function")throw new TypeError(d);return o(I)&&(B="leading"in I?!!I.leading:B,V="trailing"in I?!!I.trailing:V),s(D,P,{leading:B,maxWait:P,trailing:V})}function o(D){var P=typeof D>"u"?"undefined":h(D);return!!D&&(P=="object"||P=="function")}function l(D){return!!D&&(typeof D>"u"?"undefined":h(D))=="object"}function c(D){return(typeof D>"u"?"undefined":h(D))=="symbol"||l(D)&&x.call(D)==f}function u(D){if(typeof D=="number")return D;if(c(D))return p;if(o(D)){var P=typeof D.valueOf=="function"?D.valueOf():D;D=o(P)?P+"":P}if(typeof D!="string")return D===0?D:+D;D=D.replace(m,"");var I=v.test(D);return I||y.test(D)?w(D.slice(2),I?2:8):g.test(D)?p:+D}var h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},d="Expected a function",p=NaN,f="[object Symbol]",m=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,y=/^0o[0-7]+$/i,w=parseInt,b=(typeof n>"u"?"undefined":h(n))=="object"&&n&&n.Object===Object&&n,E=(typeof self>"u"?"undefined":h(self))=="object"&&self&&self.Object===Object&&self,_=b||E||Function("return this")(),C=Object.prototype,x=C.toString,A=Math.max,T=Math.min,M=function(){return _.Date.now()};r.exports=a}).call(i,function(){return this}())},function(r,i){(function(n){function s(M,D,P){function I(Se){var Le=ie,Oe=J;return ie=J=void 0,le=Se,ee=M.apply(Oe,Le)}function B(Se){return le=Se,ue=setTimeout(L,D),de?I(Se):ee}function V(Se){var Le=Se-oe,Oe=Se-le,Ye=D-Le;return xe?A(Ye,se-Oe):Ye}function N(Se){var Le=Se-oe,Oe=Se-le;return oe===void 0||Le>=D||Le<0||xe&&Oe>=se}function L(){var Se=T();return N(Se)?W(Se):void(ue=setTimeout(L,V(Se)))}function W(Se){return ue=void 0,_e&&ie?I(Se):(ie=J=void 0,ee)}function G(){ue!==void 0&&clearTimeout(ue),le=0,ie=oe=J=ue=void 0}function X(){return ue===void 0?ee:W(T())}function Q(){var Se=T(),Le=N(Se);if(ie=arguments,J=this,oe=Se,Le){if(ue===void 0)return B(oe);if(xe)return ue=setTimeout(L,D),I(oe)}return ue===void 0&&(ue=setTimeout(L,D)),ee}var ie,J,se,ee,ue,oe,le=0,de=!1,xe=!1,_e=!0;if(typeof M!="function")throw new TypeError(h);return D=c(D)||0,a(P)&&(de=!!P.leading,xe="maxWait"in P,se=xe?x(c(P.maxWait)||0,D):se,_e="trailing"in P?!!P.trailing:_e),Q.cancel=G,Q.flush=X,Q}function a(M){var D=typeof M>"u"?"undefined":u(M);return!!M&&(D=="object"||D=="function")}function o(M){return!!M&&(typeof M>"u"?"undefined":u(M))=="object"}function l(M){return(typeof M>"u"?"undefined":u(M))=="symbol"||o(M)&&C.call(M)==p}function c(M){if(typeof M=="number")return M;if(l(M))return d;if(a(M)){var D=typeof M.valueOf=="function"?M.valueOf():M;M=a(D)?D+"":D}if(typeof M!="string")return M===0?M:+M;M=M.replace(f,"");var P=g.test(M);return P||v.test(M)?y(M.slice(2),P?2:8):m.test(M)?d:+M}var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},h="Expected a function",d=NaN,p="[object Symbol]",f=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,v=/^0o[0-7]+$/i,y=parseInt,w=(typeof n>"u"?"undefined":u(n))=="object"&&n&&n.Object===Object&&n,b=(typeof self>"u"?"undefined":u(self))=="object"&&self&&self.Object===Object&&self,E=w||b||Function("return this")(),_=Object.prototype,C=_.toString,x=Math.max,A=Math.min,T=function(){return E.Date.now()};r.exports=s}).call(i,function(){return this}())},function(r,i){function n(u){var h=void 0,d=void 0;for(h=0;h<u.length;h+=1)if(d=u[h],d.dataset&&d.dataset.aos||d.children&&n(d.children))return!0;return!1}function s(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function a(){return!!s()}function o(u,h){var d=window.document,p=s(),f=new p(l);c=h,f.observe(d.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function l(u){u&&u.forEach(function(h){var d=Array.prototype.slice.call(h.addedNodes),p=Array.prototype.slice.call(h.removedNodes),f=d.concat(p);if(n(f))return c()})}Object.defineProperty(i,"__esModule",{value:!0});var c=function(){};i.default={isSupported:a,ready:o}},function(r,i){function n(d,p){if(!(d instanceof p))throw new TypeError("Cannot call a class as a function")}function s(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function d(p,f){for(var m=0;m<f.length;m++){var g=f[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,f,m){return f&&d(p.prototype,f),m&&d(p,m),p}}(),o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,l=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,c=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,u=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,h=function(){function d(){n(this,d)}return a(d,[{key:"phone",value:function(){var p=s();return!(!o.test(p)&&!l.test(p.substr(0,4)))}},{key:"mobile",value:function(){var p=s();return!(!c.test(p)&&!u.test(p.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),d}();i.default=new h},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(a,o,l){var c=a.node.getAttribute("data-aos-once");o>a.position?a.node.classList.add("aos-animate"):typeof c<"u"&&(c==="false"||!l&&c!=="true")&&a.node.classList.remove("aos-animate")},s=function(a,o){var l=window.pageYOffset,c=window.innerHeight;a.forEach(function(u,h){n(u,c+l,o)})};i.default=s},function(r,i,n){function s(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(i,"__esModule",{value:!0});var a=n(12),o=s(a),l=function(c,u){return c.forEach(function(h,d){h.node.classList.add("aos-init"),h.position=(0,o.default)(h.node,u.offset)}),c};i.default=l},function(r,i,n){function s(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(i,"__esModule",{value:!0});var a=n(13),o=s(a),l=function(c,u){var h=0,d=0,p=window.innerHeight,f={offset:c.getAttribute("data-aos-offset"),anchor:c.getAttribute("data-aos-anchor"),anchorPlacement:c.getAttribute("data-aos-anchor-placement")};switch(f.offset&&!isNaN(f.offset)&&(d=parseInt(f.offset)),f.anchor&&document.querySelectorAll(f.anchor)&&(c=document.querySelectorAll(f.anchor)[0]),h=(0,o.default)(c).top,f.anchorPlacement){case"top-bottom":break;case"center-bottom":h+=c.offsetHeight/2;break;case"bottom-bottom":h+=c.offsetHeight;break;case"top-center":h+=p/2;break;case"bottom-center":h+=p/2+c.offsetHeight;break;case"center-center":h+=p/2+c.offsetHeight/2;break;case"top-top":h+=p;break;case"bottom-top":h+=c.offsetHeight+p;break;case"center-top":h+=c.offsetHeight/2+p}return f.anchorPlacement||f.offset||isNaN(u)||(d=u),h+d};i.default=l},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(s){for(var a=0,o=0;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a+=s.offsetLeft-(s.tagName!="BODY"?s.scrollLeft:0),o+=s.offsetTop-(s.tagName!="BODY"?s.scrollTop:0),s=s.offsetParent;return{top:o,left:a}};i.default=n},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(s){return s=s||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(s,function(a){return{node:a}})};i.default=n}])})})(P9);var Eie=P9.exports;const s3=Ug(Eie),Tie="modulepreload",Cie=function(e){return"/YoloTravelerAsia/"+e},sB={},id=function(t,r,i){let n=Promise.resolve();if(r&&r.length>0){const s=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.all(r.map(l=>{if(l=Cie(l),l in sB)return;sB[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(!!i)for(let p=s.length-1;p>=0;p--){const f=s[p];if(f.href===l&&(!c||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Tie,c||(d.as="script",d.crossOrigin=""),d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((p,f)=>{d.addEventListener("load",p),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}return n.then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var Aie=Object.create,uT=Object.defineProperty,Mie=Object.getOwnPropertyDescriptor,Pie=Object.getOwnPropertyNames,Die=Object.getPrototypeOf,Iie=Object.prototype.hasOwnProperty,Oie=(e,t,r)=>t in e?uT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gu=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Rie=(e,t)=>{for(var r in t)uT(e,r,{get:t[r],enumerable:!0})},kie=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Pie(t))!Iie.call(e,n)&&n!==r&&uT(e,n,{get:()=>t[n],enumerable:!(i=Mie(t,n))||i.enumerable});return e},vu=(e,t,r)=>(r=e!=null?Aie(Die(e)):{},kie(t||!e||!e.__esModule?uT(r,"default",{value:e,enumerable:!0}):r,e)),Sy=(e,t,r)=>(Oie(e,typeof t!="symbol"?t+"":t,r),r),Lie=gu((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var s=new r;return s.importState(n),s},r;function r(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var c=i();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<n.length;u++)s-=c(n[u]),s<0&&(s+=1),a-=c(n[u]),a<0&&(a+=1),o-=c(n[u]),o<0&&(o+=1);c=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=n,h.exportState=function(){return[s,a,o,l]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),D9=gu((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,u,h,d,p,f,m,g,v,y,w,b=i[0].length,E=i.length;if(E<b)throw new TypeError("Invalid matrix: m < n");for(var _=[],C=[],x=[],A=n==="f"?E:b,T=v=f=0;T<E;T++)C[T]=new Array(A).fill(0);for(T=0;T<b;T++)x[T]=new Array(b).fill(0);var M,D=new Array(b).fill(0);for(T=0;T<E;T++)for(l=0;l<b;l++)C[T][l]=i[T][l];for(T=0;T<b;T++){for(_[T]=f,g=0,u=T+1,l=T;l<E;l++)g+=Math.pow(C[l][T],2);if(g<o)f=0;else for(m=(p=C[T][T])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,C[T][T]=p-f,l=u;l<b;l++){for(g=0,c=T;c<E;c++)g+=C[c][T]*C[c][l];for(p=g/m,c=T;c<E;c++)C[c][l]=C[c][l]+p*C[c][T]}for(D[T]=f,g=0,l=u;l<b;l++)g+=Math.pow(C[T][l],2);if(g<o)f=0;else{for(m=(p=C[T][T+1])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,C[T][T+1]=p-f,l=u;l<b;l++)_[l]=C[T][l]/m;for(l=u;l<E;l++){for(g=0,c=u;c<b;c++)g+=C[l][c]*C[T][c];for(c=u;c<b;c++)C[l][c]=C[l][c]+g*_[c]}}v<(y=Math.abs(D[T])+Math.abs(_[T]))&&(v=y)}if(s)for(T=b-1;0<=T;T--){if(f!==0){for(m=C[T][T+1]*f,l=u;l<b;l++)x[l][T]=C[T][l]/m;for(l=u;l<b;l++){for(g=0,c=u;c<b;c++)g+=C[T][c]*x[c][l];for(c=u;c<b;c++)x[c][l]=x[c][l]+g*x[c][T]}}for(l=u;l<b;l++)x[T][l]=0,x[l][T]=0;x[T][T]=1,f=_[T],u=T}if(n){if(n==="f")for(T=b;T<E;T++){for(l=b;l<E;l++)C[T][l]=0;C[T][T]=1}for(T=b-1;0<=T;T--){for(u=T+1,f=D[T],l=u;l<A;l++)C[T][l]=0;if(f!==0){for(m=C[T][T]*f,l=u;l<A;l++){for(g=0,c=u;c<E;c++)g+=C[c][T]*C[c][l];for(p=g/m,c=T;c<E;c++)C[c][l]=C[c][l]+p*C[c][T]}for(l=T;l<E;l++)C[l][T]=C[l][T]/f}else for(l=T;l<E;l++)C[l][T]=0;C[T][T]=C[T][T]+1}}for(a*=v,c=b-1;0<=c;c--)for(var P=0;P<50;P++){for(M=!1,u=c;0<=u;u--){if(Math.abs(_[u])<=a){M=!0;break}if(Math.abs(D[u-1])<=a)break}if(!M){for(d=0,h=u-(g=1),T=u;T<c+1&&(p=g*_[T],_[T]=d*_[T],!(Math.abs(p)<=a));T++)if(f=D[T],D[T]=Math.sqrt(p*p+f*f),d=f/(m=D[T]),g=-p/m,n)for(l=0;l<E;l++)y=C[l][h],w=C[l][T],C[l][h]=y*d+w*g,C[l][T]=-y*g+w*d}if(w=D[c],u===c){if(w<0&&(D[c]=-w,s))for(l=0;l<b;l++)x[l][c]=-x[l][c];break}for(v=D[u],p=(((y=D[c-1])-w)*(y+w)+((f=_[c-1])-(m=_[c]))*(f+m))/(2*m*y),f=Math.sqrt(p*p+1),p=((v-w)*(v+w)+m*(y/(p<0?p-f:p+f)-m))/v,T=u+(g=d=1);T<c+1;T++){if(f=_[T],y=D[T],m=g*f,f*=d,w=Math.sqrt(p*p+m*m),p=v*(d=p/(_[T-1]=w))+f*(g=m/w),f=-v*g+f*d,m=y*g,y*=d,s)for(l=0;l<b;l++)v=x[l][T-1],w=x[l][T],x[l][T-1]=v*d+w*g,x[l][T]=-v*g+w*d;if(w=Math.sqrt(p*p+m*m),p=(d=p/(D[T-1]=w))*f+(g=m/w)*y,v=-g*f+d*y,n)for(l=0;l<E;l++)y=C[l][T-1],w=C[l][T],C[l][T-1]=y*d+w*g,C[l][T]=-y*g+w*d}_[u]=0,_[c]=p,D[c]=v}for(T=0;T<b;T++)D[T]<a&&(D[T]=0);return{u:C,q:D,v:x}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),Nie=gu((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?t.exports=i():typeof define=="function"&&define.amd?define(i):(r=r||self,r.TinyQueue=i())})(e,function(){var r=function(n,s){if(n===void 0&&(n=[]),s===void 0&&(s=i),this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};r.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(n){for(var s=this,a=s.data,o=s.compare,l=a[n];n>0;){var c=n-1>>1,u=a[c];if(o(l,u)>=0)break;a[n]=u,n=c}a[n]=l},r.prototype._down=function(n){for(var s=this,a=s.data,o=s.compare,l=this.length>>1,c=a[n];n<l;){var u=(n<<1)+1,h=a[u],d=u+1;if(d<this.length&&o(a[d],h)<0&&(u=d,h=a[d]),o(h,c)>=0)break;a[n]=h,n=u}a[n]=c};function i(n,s){return n<s?-1:n>s?1:0}return r})}),zie=gu((e,t)=>{var r=Nie();r.default&&(r=r.default),t.exports=i,t.exports.default=i;function i(c,u,h){u=u||1;for(var d,p,f,m,g=0;g<c[0].length;g++){var v=c[0][g];(!g||v[0]<d)&&(d=v[0]),(!g||v[1]<p)&&(p=v[1]),(!g||v[0]>f)&&(f=v[0]),(!g||v[1]>m)&&(m=v[1])}var y=f-d,w=m-p,b=Math.min(y,w),E=b/2;if(b===0){var _=[d,p];return _.distance=0,_}for(var C=new r(void 0,n),x=d;x<f;x+=b)for(var A=p;A<m;A+=b)C.push(new s(x+E,A+E,E,c));var T=o(c),M=new s(d+y/2,p+w/2,0,c);M.d>T.d&&(T=M);for(var D=C.length;C.length;){var P=C.pop();P.d>T.d&&(T=P,h&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,D)),!(P.max-T.d<=u)&&(E=P.h/2,C.push(new s(P.x-E,P.y-E,E,c)),C.push(new s(P.x+E,P.y-E,E,c)),C.push(new s(P.x-E,P.y+E,E,c)),C.push(new s(P.x+E,P.y+E,E,c)),D+=4)}h&&(console.log("num probes: "+D),console.log("best distance: "+T.d));var I=[T.x,T.y];return I.distance=T.d,I}function n(c,u){return u.max-c.max}function s(c,u,h,d){this.x=c,this.y=u,this.h=h,this.d=a(c,u,d),this.max=this.d+this.h*Math.SQRT2}function a(c,u,h){for(var d=!1,p=1/0,f=0;f<h.length;f++)for(var m=h[f],g=0,v=m.length,y=v-1;g<v;y=g++){var w=m[g],b=m[y];w[1]>u!=b[1]>u&&c<(b[0]-w[0])*(u-w[1])/(b[1]-w[1])+w[0]&&(d=!d),p=Math.min(p,l(c,u,w,b))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function o(c){for(var u=0,h=0,d=0,p=c[0],f=0,m=p.length,g=m-1;f<m;g=f++){var v=p[f],y=p[g],w=v[0]*y[1]-y[0]*v[1];h+=(v[0]+y[0])*w,d+=(v[1]+y[1])*w,u+=w*3}return u===0?new s(p[0][0],p[0][1],0,c):new s(h/u,d/u,0,c)}function l(c,u,h,d){var p=h[0],f=h[1],m=d[0]-p,g=d[1]-f;if(m!==0||g!==0){var v=((c-p)*m+(u-f)*g)/(m*m+g*g);v>1?(p=d[0],f=d[1]):v>0&&(p+=m*v,f+=g*v)}return m=c-p,g=u-f,m*m+g*g}}),Bie=gu((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),Fie=gu((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}t.exports=e.default}),Uie=gu((e,t)=>{function r(s,a){function o(){this.constructor=s}o.prototype=a.prototype,s.prototype=new o}function i(s,a,o,l){this.message=s,this.expected=a,this.found=o,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}r(i,Error),i.buildMessage=function(s,a){var o={literal:function(f){return'"'+c(f.text)+'"'},class:function(f){var m="",g;for(g=0;g<f.parts.length;g++)m+=f.parts[g]instanceof Array?u(f.parts[g][0])+"-"+u(f.parts[g][1]):u(f.parts[g]);return"["+(f.inverted?"^":"")+m+"]"},any:function(f){return"any character"},end:function(f){return"end of input"},other:function(f){return f.description}};function l(f){return f.charCodeAt(0).toString(16).toUpperCase()}function c(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function u(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function h(f){return o[f.type](f)}function d(f){var m=new Array(f.length),g,v;for(g=0;g<f.length;g++)m[g]=h(f[g]);if(m.sort(),m.length>0){for(g=1,v=1;g<m.length;g++)m[g-1]!==m[g]&&(m[v]=m[g],v++);m.length=v}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function p(f){return f?'"'+c(f)+'"':"end of input"}return"Expected "+d(s)+" but "+p(a)+" found."};function n(s,a){a=a!==void 0?a:{};var o={},l={svg_path:Xr},c=Xr,u=function(F){if(!F)return[];for(var H=[],ne=0;ne<F.length;ne++)H=H.concat.apply(H,F[ne]);var $=H[0];return $&&$.code=="m"&&(delete $.relative,$.code="M"),H},h=function(F,H){return bs(F,H)},d=/^[Mm]/,p=et(["M","m"],!1,!1),f=function(F,H,ne){var $=ka(F,[H]);return ne&&($=$.concat(ka(F=="M"?"L":"l",ne[1]))),$},m=/^[Zz]/,g=et(["Z","z"],!1,!1),v=function(){return ka("Z")},y=/^[Ll]/,w=et(["L","l"],!1,!1),b=function(F,H){return ka(F,H)},E=/^[Hh]/,_=et(["H","h"],!1,!1),C=function(F,H){return ka(F,H.map(function(ne){return{x:ne}}))},x=/^[Vv]/,A=et(["V","v"],!1,!1),T=function(F,H){return ka(F,H.map(function(ne){return{y:ne}}))},M=/^[Cc]/,D=et(["C","c"],!1,!1),P=function(F,H,ne){return{x1:F.x,y1:F.y,x2:H.x,y2:H.y,x:ne.x,y:ne.y}},I=/^[Ss]/,B=et(["S","s"],!1,!1),V=function(F,H){return{x2:F.x,y2:F.y,x:H.x,y:H.y}},N=/^[Qq]/,L=et(["Q","q"],!1,!1),W=function(F,H){return{x1:F.x,y1:F.y,x:H.x,y:H.y}},G=/^[Tt]/,X=et(["T","t"],!1,!1),Q=/^[Aa]/,ie=et(["A","a"],!1,!1),J=function(F,H,ne,$,ce,Ve){return{rx:F,ry:H,xAxisRotation:ne,largeArc:$,sweep:ce,x:Ve.x,y:Ve.y}},se=function(F,H){return{x:F,y:H}},ee=function(F){return F*1},ue=function(F){return F.join("")*1},oe=/^[01]/,le=et(["0","1"],!1,!1),de=function(F){return F=="1"},xe=function(){return""},_e=",",Se=Je(",",!1),Le=function(F){return F.join("")},Oe=".",Ye=Je(".",!1),$e=/^[eE]/,He=et(["e","E"],!1,!1),je=/^[+\-]/,lt=et(["+","-"],!1,!1),pe=/^[0-9]/,q=et([["0","9"]],!1,!1),j=function(F){return F.join("")},ve=/^[ \t\n\r]/,ze=et([" ","	",`
`,"\r"],!1,!1),U=0,Fe=[{line:1,column:1}],he=0,Ee=[],me;if("startRule"in a){if(!(a.startRule in l))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');c=l[a.startRule]}function Je(F,H){return{type:"literal",text:F,ignoreCase:H}}function et(F,H,ne){return{type:"class",parts:F,inverted:H,ignoreCase:ne}}function at(){return{type:"end"}}function gt(F){var H=Fe[F],ne;if(H)return H;for(ne=F-1;!Fe[ne];)ne--;for(H=Fe[ne],H={line:H.line,column:H.column};ne<F;)s.charCodeAt(ne)===10?(H.line++,H.column=1):H.column++,ne++;return Fe[F]=H,H}function ft(F,H){var ne=gt(F),$=gt(H);return{start:{offset:F,line:ne.line,column:ne.column},end:{offset:H,line:$.line,column:$.column}}}function mt(F){U<he||(U>he&&(he=U,Ee=[]),Ee.push(F))}function Er(F,H,ne){return new i(i.buildMessage(F,H),F,H,ne)}function Xr(){var F,H,ne,$,ce;for(F=U,H=[],ne=Vt();ne!==o;)H.push(ne),ne=Vt();if(H!==o)if(ne=ae(),ne===o&&(ne=null),ne!==o){for($=[],ce=Vt();ce!==o;)$.push(ce),ce=Vt();$!==o?(H=u(ne),F=H):(U=F,F=o)}else U=F,F=o;else U=F,F=o;return F}function ae(){var F,H,ne,$,ce,Ve;if(F=U,H=Pe(),H!==o){for(ne=[],$=U,ce=[],Ve=Vt();Ve!==o;)ce.push(Ve),Ve=Vt();for(ce!==o?(Ve=Pe(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;){for(ne.push($),$=U,ce=[],Ve=Vt();Ve!==o;)ce.push(Ve),Ve=Vt();ce!==o?(Ve=Pe(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o)}ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Pe(){var F,H,ne,$,ce,Ve;if(F=U,H=Ke(),H!==o){for(ne=[],$=U,ce=[],Ve=Vt();Ve!==o;)ce.push(Ve),Ve=Vt();for(ce!==o?(Ve=Ne(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;){for(ne.push($),$=U,ce=[],Ve=Vt();Ve!==o;)ce.push(Ve),Ve=Vt();ce!==o?(Ve=Ne(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o)}ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Ne(){var F;return F=yt(),F===o&&(F=Kt(),F===o&&(F=Ci(),F===o&&(F=Mr(),F===o&&(F=In(),F===o&&(F=tf(),F===o&&(F=K(),F===o&&(F=we(),F===o&&(F=ut())))))))),F}function Ke(){var F,H,ne,$,ce,Ve,La;if(F=U,d.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(p)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=vt(),$!==o?(ce=U,Ve=Nt(),Ve===o&&(Ve=null),Ve!==o?(La=Ar(),La!==o?(Ve=[Ve,La],ce=Ve):(U=ce,ce=o)):(U=ce,ce=o),ce===o&&(ce=null),ce!==o?(H=f(H,$,ce),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function yt(){var F,H;return F=U,m.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(g)),H!==o&&(H=v()),F=H,F}function Kt(){var F,H,ne,$;if(F=U,y.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(w)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=Ar(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function Ar(){var F,H,ne,$,ce,Ve;if(F=U,H=vt(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Ci(){var F,H,ne,$;if(F=U,E.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(_)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=ws(),$!==o?(H=C(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function ws(){var F,H,ne,$,ce,Ve;if(F=U,H=$t(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=$t(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=$t(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Mr(){var F,H,ne,$;if(F=U,x.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(A)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=ws(),$!==o?(H=T(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function In(){var F,H,ne,$;if(F=U,M.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(D)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=On(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function On(){var F,H,ne,$,ce,Ve;if(F=U,H=vi(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vi(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vi(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function vi(){var F,H,ne,$,ce,Ve;return F=U,H=vt(),H!==o?(ne=Nt(),ne===o&&(ne=null),ne!==o?($=vt(),$!==o?(ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vt(),Ve!==o?(H=P(H,$,Ve),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o),F}function tf(){var F,H,ne,$;if(F=U,I.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(B)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=nc(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function nc(){var F,H,ne,$,ce,Ve;if(F=U,H=co(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=co(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=co(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function co(){var F,H,ne,$;return F=U,H=vt(),H!==o?(ne=Nt(),ne===o&&(ne=null),ne!==o?($=vt(),$!==o?(H=V(H,$),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o),F}function K(){var F,H,ne,$;if(F=U,N.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(L)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=be(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function be(){var F,H,ne,$,ce,Ve;if(F=U,H=Me(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=Me(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=Me(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Me(){var F,H,ne,$;return F=U,H=vt(),H!==o?(ne=Nt(),ne===o&&(ne=null),ne!==o?($=vt(),$!==o?(H=W(H,$),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o),F}function we(){var F,H,ne,$;if(F=U,G.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(X)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=Ie(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function Ie(){var F,H,ne,$,ce,Ve;if(F=U,H=vt(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=vt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function ut(){var F,H,ne,$;if(F=U,Q.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(ie)),H!==o){for(ne=[],$=Vt();$!==o;)ne.push($),$=Vt();ne!==o?($=Ot(),$!==o?(H=b(H,$),F=H):(U=F,F=o)):(U=F,F=o)}else U=F,F=o;return F}function Ot(){var F,H,ne,$,ce,Ve;if(F=U,H=Lt(),H!==o){for(ne=[],$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=Lt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);$!==o;)ne.push($),$=U,ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=Lt(),Ve!==o?(ce=[ce,Ve],$=ce):(U=$,$=o)):(U=$,$=o);ne!==o?(H=h(H,ne),F=H):(U=F,F=o)}else U=F,F=o;return F}function Lt(){var F,H,ne,$,ce,Ve,La,yv,rf,nf,ld,wv;return F=U,H=er(),H!==o?(ne=Nt(),ne===o&&(ne=null),ne!==o?($=er(),$!==o?(ce=Nt(),ce===o&&(ce=null),ce!==o?(Ve=$t(),Ve!==o?(La=Nt(),La!==o?(yv=Zt(),yv!==o?(rf=Nt(),rf===o&&(rf=null),rf!==o?(nf=Zt(),nf!==o?(ld=Nt(),ld===o&&(ld=null),ld!==o?(wv=vt(),wv!==o?(H=J(H,$,Ve,yv,nf,wv),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o)):(U=F,F=o),F}function vt(){var F,H,ne,$;return F=U,H=$t(),H!==o?(ne=Nt(),ne===o&&(ne=null),ne!==o?($=$t(),$!==o?(H=se(H,$),F=H):(U=F,F=o)):(U=F,F=o)):(U=F,F=o),F}function er(){var F,H;return F=U,H=xs(),H===o&&(H=qs()),H!==o&&(H=ee(H)),F=H,F}function $t(){var F,H,ne,$;return F=U,H=U,ne=Yt(),ne===o&&(ne=null),ne!==o?($=xs(),$!==o?(ne=[ne,$],H=ne):(U=H,H=o)):(U=H,H=o),H===o&&(H=U,ne=Yt(),ne===o&&(ne=null),ne!==o?($=qs(),$!==o?(ne=[ne,$],H=ne):(U=H,H=o)):(U=H,H=o)),H!==o&&(H=ue(H)),F=H,F}function Zt(){var F,H;return F=U,oe.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(le)),H!==o&&(H=de(H)),F=H,F}function Nt(){var F,H,ne,$,ce;if(F=U,H=[],ne=Vt(),ne!==o)for(;ne!==o;)H.push(ne),ne=Vt();else H=o;if(H!==o)if(ne=Bi(),ne===o&&(ne=null),ne!==o){for($=[],ce=Vt();ce!==o;)$.push(ce),ce=Vt();$!==o?(H=[H,ne,$],F=H):(U=F,F=o)}else U=F,F=o;else U=F,F=o;if(F===o){if(F=U,H=U,ne=Bi(),ne!==o){for($=[],ce=Vt();ce!==o;)$.push(ce),ce=Vt();$!==o?(ne=[ne,$],H=ne):(U=H,H=o)}else U=H,H=o;H!==o&&(H=xe()),F=H}return F}function Bi(){var F;return s.charCodeAt(U)===44?(F=_e,U++):(F=o,mt(Se)),F}function xs(){var F,H,ne,$;return F=U,H=U,ne=Oa(),ne!==o?($=$r(),$===o&&($=null),$!==o?(ne=[ne,$],H=ne):(U=H,H=o)):(U=H,H=o),H===o&&(H=U,ne=qs(),ne!==o?($=$r(),$!==o?(ne=[ne,$],H=ne):(U=H,H=o)):(U=H,H=o)),H!==o&&(H=Le(H)),F=H,F}function Oa(){var F,H,ne,$,ce;return F=U,H=U,ne=qs(),ne===o&&(ne=null),ne!==o?(s.charCodeAt(U)===46?($=Oe,U++):($=o,mt(Ye)),$!==o?(ce=qs(),ce!==o?(ne=[ne,$,ce],H=ne):(U=H,H=o)):(U=H,H=o)):(U=H,H=o),H===o&&(H=U,ne=qs(),ne!==o?(s.charCodeAt(U)===46?($=Oe,U++):($=o,mt(Ye)),$!==o?(ne=[ne,$],H=ne):(U=H,H=o)):(U=H,H=o)),H!==o&&(H=Le(H)),F=H,F}function $r(){var F,H,ne,$,ce;return F=U,H=U,$e.test(s.charAt(U))?(ne=s.charAt(U),U++):(ne=o,mt(He)),ne!==o?($=Yt(),$===o&&($=null),$!==o?(ce=qs(),ce!==o?(ne=[ne,$,ce],H=ne):(U=H,H=o)):(U=H,H=o)):(U=H,H=o),H!==o&&(H=Le(H)),F=H,F}function Yt(){var F;return je.test(s.charAt(U))?(F=s.charAt(U),U++):(F=o,mt(lt)),F}function qs(){var F,H,ne;if(F=U,H=[],pe.test(s.charAt(U))?(ne=s.charAt(U),U++):(ne=o,mt(q)),ne!==o)for(;ne!==o;)H.push(ne),pe.test(s.charAt(U))?(ne=s.charAt(U),U++):(ne=o,mt(q));else H=o;return H!==o&&(H=j(H)),F=H,F}function Vt(){var F,H;return F=U,ve.test(s.charAt(U))?(H=s.charAt(U),U++):(H=o,mt(ze)),H!==o&&(H=xe()),F=H,F}function bs(F,H){if(!H)return[F];for(var ne=[F],$=0,ce=H.length;$<ce;$++)ne[$+1]=H[$][1];return ne}var _s={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Ra in _s)_s[Ra.toUpperCase()]=_s[Ra];function ka(F,H){H||(H=[{}]);for(var ne=H.length;ne--;){var $={code:F,command:_s[F]};F==F.toLowerCase()&&($.relative=!0);for(var ce in H[ne])$[ce]=H[ne][ce];H[ne]=$}return H}if(me=c(),me!==o&&U===s.length)return me;throw me!==o&&U<s.length&&mt(at()),Er(Ee,he<s.length?s.charAt(he):null,he<s.length?ft(he,he+1):ft(he,he))}t.exports={SyntaxError:i,parse:n}}),I9=gu((e,t)=>{var r=Uie().parse;r.parseSVG=r,r.makeAbsolute=i,t.exports=r;function i(n){var s,a={x:0,y:0},o={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(s=l),l.x0=a.x,l.y0=a.y;for(var c in o)c in l&&(l[c]+=l.relative?l[o[c]]:0);"x"in l||(l.x=a.x),"y"in l||(l.y=a.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=s.x,l.y=s.y),a=l}),n}}),jie=gu((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),s=i.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),Wg="149",Na={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Vie=0,aB=1,Hie=2,a3=1,Wie=2,Ey=3,Vo=0,_n=1,ia=2,$i=0,Xd=1,oB=2,lB=3,cB=4,Gie=5,Wf=100,qie=101,Yie=102,uB=103,hB=104,Xie=200,$ie=201,Qie=202,Kie=203,O9=204,R9=205,Zie=206,Jie=207,ene=208,tne=209,rne=210,ine=0,nne=1,sne=2,e2=3,ane=4,one=5,lne=6,cne=7,k9=0,une=1,hne=2,kl=0,dne=1,pne=2,fne=3,mne=4,gne=5,L9=300,fp=301,mp=302,t2=303,r2=304,Iw=306,zc=1e3,ti=1001,i2=1002,_r=1003,dB=1004,cA=1005,qt=1006,vne=1007,sg=1008,vs=1009,yne=1010,wne=1011,N9=1012,xne=1013,Bc=1014,Yi=1015,ou=1016,bne=1017,_ne=1018,$d=1020,Sne=1021,xn=1023,Ene=1024,Tne=1025,Qd=1026,gp=1027,Cne=1028,Ane=1029,X_=1030,Mne=1031,z9=1033,uA=33776,hA=33777,dA=33778,pA=33779,pB=35840,fB=35841,mB=35842,gB=35843,Pne=36196,vB=37492,yB=37496,wB=37808,xB=37809,bB=37810,_B=37811,SB=37812,EB=37813,TB=37814,CB=37815,AB=37816,MB=37817,PB=37818,DB=37819,IB=37820,OB=37821,fA=36492,Dne=36283,RB=36284,kB=36285,LB=36286,B9=2200,F9=2201,o3=2202,$_=2300,Q_=2301,mA=2302,fm=2400,mm=2401,K_=2402,l3=2500,Ine=2501,Ho=3e3,jt=3001,yu=3200,U9=3201,One=0,Rne=1,gl="srgb",Z_="srgb-linear",gA=7680,kne=519,n2=35044,Lne=35048,NB="300 es",s2=1035,Kn=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},rs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],zB=1234567,Xy=Math.PI/180,L0=180/Math.PI;function eo(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(rs[e&255]+rs[e>>8&255]+rs[e>>16&255]+rs[e>>24&255]+"-"+rs[t&255]+rs[t>>8&255]+"-"+rs[t>>16&15|64]+rs[t>>24&255]+"-"+rs[r&63|128]+rs[r>>8&255]+"-"+rs[r>>16&255]+rs[r>>24&255]+rs[i&255]+rs[i>>8&255]+rs[i>>16&255]+rs[i>>24&255]).toLowerCase()}function Hi(e,t,r){return Math.max(t,Math.min(r,e))}function c3(e,t){return(e%t+t)%t}function Nne(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function zne(e,t,r){return e!==t?(r-e)/(t-e):0}function $y(e,t,r){return(1-r)*e+r*t}function Bne(e,t,r,i){return $y(e,t,1-Math.exp(-r*i))}function Fne(e,t=1){return t-Math.abs(c3(e,t*2)-t)}function Une(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function jne(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function Vne(e,t){return e+Math.floor(Math.random()*(t-e+1))}function Hne(e,t){return e+Math.random()*(t-e)}function Wne(e){return e*(.5-Math.random())}function Gne(e){e!==void 0&&(zB=e);let t=zB+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function qne(e){return e*Xy}function Yne(e){return e*L0}function a2(e){return(e&e-1)===0&&e!==0}function j9(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function J_(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function Xne(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+i)/2),u=a((t+i)/2),h=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(n){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Fc(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Vr(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var rt=Object.freeze({__proto__:null,DEG2RAD:Xy,RAD2DEG:L0,ceilPowerOfTwo:j9,clamp:Hi,damp:Bne,degToRad:qne,denormalize:Fc,euclideanModulo:c3,floorPowerOfTwo:J_,generateUUID:eo,inverseLerp:zne,isPowerOfTwo:a2,lerp:$y,mapLinear:Nne,normalize:Vr,pingpong:Fne,radToDeg:Yne,randFloat:Hne,randFloatSpread:Wne,randInt:Vne,seededRandom:Gne,setQuaternionFromProperEuler:Xne,smootherstep:jne,smoothstep:Une}),re=class{constructor(e=0,t=0){re.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},ln=class{constructor(){ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=n,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],p=r[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],w=i[7],b=i[2],E=i[5],_=i[8];return n[0]=s*f+a*v+o*b,n[3]=s*m+a*y+o*E,n[6]=s*g+a*w+o*_,n[1]=l*f+c*v+u*b,n[4]=l*m+c*y+u*E,n[7]=l*g+c*w+u*_,n[2]=h*f+d*v+p*b,n[5]=h*m+d*y+p*E,n[8]=h*g+d*w+p*_,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*n*c+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*n,d=l*n-s*o,p=t*u+r*h+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(i*l-c*r)*f,e[2]=(a*r-i*s)*f,e[3]=h*f,e[4]=(c*t-i*o)*f,e[5]=(i*n-a*t)*f,e[6]=d*f,e[7]=(r*o-l*t)*f,e[8]=(s*t-r*n)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(vA.makeScale(e,t)),this}rotate(e){return this.premultiply(vA.makeRotation(-e)),this}translate(e,t){return this.premultiply(vA.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},vA=new ln;function V9(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var $ne={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Vx(e,t){return new $ne[e](t)}function N0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Kd(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function jb(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var yA={[gl]:{[Z_]:Kd},[Z_]:{[gl]:jb}},Ss={legacyMode:!0,get workingColorSpace(){return Z_},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(yA[t]&&yA[t][r]!==void 0){let i=yA[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},H9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ji={r:0,g:0,b:0},po={h:0,s:0,l:0},Hx={h:0,s:0,l:0};function wA(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function Wx(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var bt=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=gl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ss.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Ss.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ss.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Ss.workingColorSpace){if(e=c3(e,1),t=Hi(t,0,1),r=Hi(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,s=2*r-n;this.r=wA(s,n,e+1/3),this.g=wA(s,n,e),this.b=wA(s,n,e-1/3)}return Ss.toWorkingColorSpace(this,i),this}setStyle(e,t=gl){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,Ss.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,Ss.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let o=parseFloat(n[1])/360,l=parseFloat(n[2])/100,c=parseFloat(n[3])/100;return r(n[4]),this.setHSL(o,l,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,Ss.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,Ss.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=gl){let r=H9[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Kd(e.r),this.g=Kd(e.g),this.b=Kd(e.b),this}copyLinearToSRGB(e){return this.r=jb(e.r),this.g=jb(e.g),this.b=jb(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=gl){return Ss.fromWorkingColorSpace(Wx(this,Ji),e),Hi(Ji.r*255,0,255)<<16^Hi(Ji.g*255,0,255)<<8^Hi(Ji.b*255,0,255)<<0}getHexString(e=gl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ss.workingColorSpace){Ss.fromWorkingColorSpace(Wx(this,Ji),t);let r=Ji.r,i=Ji.g,n=Ji.b,s=Math.max(r,i,n),a=Math.min(r,i,n),o,l,c=(a+s)/2;if(a===s)o=0,l=0;else{let u=s-a;switch(l=c<=.5?u/(s+a):u/(2-s-a),s){case r:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-r)/u+2;break;case n:o=(r-i)/u+4;break}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=Ss.workingColorSpace){return Ss.fromWorkingColorSpace(Wx(this,Ji),t),e.r=Ji.r,e.g=Ji.g,e.b=Ji.b,e}getStyle(e=gl){return Ss.fromWorkingColorSpace(Wx(this,Ji),e),e!==gl?`color(${e} ${Ji.r} ${Ji.g} ${Ji.b})`:`rgb(${Ji.r*255|0},${Ji.g*255|0},${Ji.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(po),po.h+=e,po.s+=t,po.l+=r,this.setHSL(po.h,po.s,po.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(po),e.getHSL(Hx);let r=$y(po.h,Hx.h,t),i=$y(po.s,Hx.s,t),n=$y(po.l,Hx.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};bt.NAMES=H9;var cf,W9=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{cf===void 0&&(cf=N0("canvas")),cf.width=e.width,cf.height=e.height;let r=cf.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=cf}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=N0("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=Kd(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Kd(t[r]/255)*255):t[r]=Kd(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},G9=class{constructor(e=null){this.isSource=!0,this.uuid=eo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(xA(i[s].image)):n.push(xA(i[s]))}else n=xA(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function xA(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?W9.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Qne=0,pi=class extends Kn{constructor(e=pi.DEFAULT_IMAGE,t=pi.DEFAULT_MAPPING,r=ti,i=ti,n=qt,s=sg,a=xn,o=vs,l=pi.DEFAULT_ANISOTROPY,c=Ho){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Qne++}),this.uuid=eo(),this.name="",this.source=new G9(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new re(0,0),this.repeat=new re(1,1),this.center=new re(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==L9)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zc:e.x=e.x-Math.floor(e.x);break;case ti:e.x=e.x<0?0:1;break;case i2:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case zc:e.y=e.y-Math.floor(e.y);break;case ti:e.y=e.y<0?0:1;break;case i2:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};pi.DEFAULT_IMAGE=null;pi.DEFAULT_MAPPING=L9;pi.DEFAULT_ANISOTROPY=1;var It=class{constructor(e=0,t=0,r=0,i=1){It.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let g=(a+1)/2,v=(u+1)/2,y=(f+1)/2,w=(o+c)/4,b=(l+d)/4,E=(h+p)/4;return g>v&&g>y?g<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(g),i=w/r,n=b/r):v>y?v<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(v),r=w/i,n=E/i):y<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(y),r=b/n,i=E/n),this.set(r,i,n,t),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(c-o)/m,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},vr=class extends Kn{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new It(0,0,e,t),this.scissorTest=!1,this.viewport=new It(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new pi(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:qt,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new G9(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},q9=class extends pi{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=_r,this.minFilter=_r,this.wrapR=ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Kne=class extends pi{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=_r,this.minFilter=_r,this.wrapR=ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Zne=class extends vr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<r;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Dt=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3],h=n[s+0],d=n[s+1],p=n[s+2],f=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=f;return}if(u!==f||o!==h||l!==d||c!==p){let m=1-a,g=o*h+l*d+c*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let b=Math.sqrt(y),E=Math.atan2(b,g*v);m=Math.sin(m*E)/b,a=Math.sin(a*E)/b}let w=a*v;if(o=o*m+h*w,l=l*m+d*w,c=c*m+p*w,u=u*m+f*w,m===1-a){let b=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=b,l*=b,c*=b,u*=b}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],c=r[i+3],u=n[s],h=n[s+1],d=n[s+2],p=n[s+3];return e[t]=a*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-o*u,e[t+3]=c*p-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(i/2),u=a(n/2),h=o(r/2),d=o(i/2),p=o(n/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=r+a+u;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-o)*d,this._y=(n-l)*d,this._z=(s-i)*d}else if(r>a&&r>u){let d=2*Math.sqrt(1+r-a-u);this._w=(c-o)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(n+l)/d}else if(a>u){let d=2*Math.sqrt(1+a-r-u);this._w=(n-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(o+c)/d}else{let d=2*Math.sqrt(1+u-r-a);this._w=(s-i)/d,this._x=(n+l)/d,this._y=(o+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Hi(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+i*l-n*o,this._y=i*c+s*o+n*a-r*l,this._z=n*c+s*l+r*o-i*a,this._w=s*c-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=i*u+this._y*h,this._z=n*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},R=class{constructor(e=0,t=0,r=0){R.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(BB.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(BB.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*r,c=o*r+a*t-n*i,u=o*i+n*r-s*t,h=-n*t-s*r-a*i;return this.x=l*o+h*-n+c*-a-u*-s,this.y=c*o+h*-s+u*-n-l*-a,this.z=u*o+h*-a+l*-s-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return bA.copy(this).projectOnVector(e),this.sub(bA)}reflect(e){return this.sub(bA.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Hi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},bA=new R,BB=new Dt,Ni=class{constructor(e=new R(1/0,1/0,1/0),t=new R(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let c=e[o],u=e[o+1],h=e[o+2];c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let c=e.getX(o),u=e.getY(o),h=e.getZ(o);c<t&&(t=c),u<r&&(r=u),h<i&&(i=h),c>n&&(n=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=hd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let s=0,a=n.count;s<a;s++)hd.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(hd)}else r.boundingBox===null&&r.computeBoundingBox(),_A.copy(r.boundingBox),_A.applyMatrix4(e.matrixWorld),this.union(_A);let i=e.children;for(let n=0,s=i.length;n<s;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,hd),hd.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Nv),Gx.subVectors(this.max,Nv),uf.subVectors(e.a,Nv),hf.subVectors(e.b,Nv),df.subVectors(e.c,Nv),Eu.subVectors(hf,uf),Tu.subVectors(df,hf),dd.subVectors(uf,df);let t=[0,-Eu.z,Eu.y,0,-Tu.z,Tu.y,0,-dd.z,dd.y,Eu.z,0,-Eu.x,Tu.z,0,-Tu.x,dd.z,0,-dd.x,-Eu.y,Eu.x,0,-Tu.y,Tu.x,0,-dd.y,dd.x,0];return!SA(t,uf,hf,df,Gx)||(t=[1,0,0,0,1,0,0,0,1],!SA(t,uf,hf,df,Gx))?!1:(qx.crossVectors(Eu,Tu),t=[qx.x,qx.y,qx.z],SA(t,uf,hf,df,Gx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return hd.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(hd).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(oc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),oc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),oc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),oc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),oc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),oc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),oc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),oc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(oc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},oc=[new R,new R,new R,new R,new R,new R,new R,new R],hd=new R,_A=new Ni,uf=new R,hf=new R,df=new R,Eu=new R,Tu=new R,dd=new R,Nv=new R,Gx=new R,qx=new R,pd=new R;function SA(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){pd.fromArray(e,s);let o=n.x*Math.abs(pd.x)+n.y*Math.abs(pd.y)+n.z*Math.abs(pd.z),l=t.dot(pd),c=r.dot(pd),u=i.dot(pd);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}var Jne=new Ni,zv=new R,EA=new R,ca=class{constructor(e=new R,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):Jne.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;zv.subVectors(e,this.center);let t=zv.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(zv,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(EA.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(zv.copy(e.center).add(EA)),this.expandByPoint(zv.copy(e.center).sub(EA))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},lc=new R,TA=new R,Yx=new R,Cu=new R,CA=new R,Xx=new R,AA=new R,Gg=class{constructor(e=new R,t=new R(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,lc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=lc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(lc.copy(this.direction).multiplyScalar(t).add(this.origin),lc.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){TA.copy(e).add(t).multiplyScalar(.5),Yx.copy(t).sub(e).normalize(),Cu.copy(this.origin).sub(TA);let n=e.distanceTo(t)*.5,s=-this.direction.dot(Yx),a=Cu.dot(this.direction),o=-Cu.dot(Yx),l=Cu.lengthSq(),c=Math.abs(1-s*s),u,h,d,p;if(c>0)if(u=s*o-a,h=s*a-o,p=n*c,u>=0)if(h>=-p)if(h<=p){let f=1/c;u*=f,h*=f,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-s*n+a)),h=u>0?-n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-n,-o),n),d=h*(h+2*o)+l):(u=Math.max(0,-(s*n+a)),h=u>0?n:Math.min(Math.max(-n,-o),n),d=-u*u+h*(h+2*o)+l);else h=s>0?-n:n,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Yx).multiplyScalar(h).add(TA),d}intersectSphere(e,t){lc.subVectors(e.center,this.origin);let r=lc.dot(this.direction),i=lc.dot(lc)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(n=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(n=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||n>i||((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,lc)!==null}intersectTriangle(e,t,r,i,n){CA.subVectors(t,e),Xx.subVectors(r,e),AA.crossVectors(CA,Xx);let s=this.direction.dot(AA),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Cu.subVectors(this.origin,e);let o=a*this.direction.dot(Xx.crossVectors(Cu,Xx));if(o<0)return null;let l=a*this.direction.dot(CA.cross(Cu));if(l<0||o+l>s)return null;let c=-a*Cu.dot(AA);return c<0?null:this.at(c/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Be=class{constructor(){Be.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g){let v=this.elements;return v[0]=t,v[4]=r,v[8]=i,v[12]=n,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=c,v[6]=u,v[10]=h,v[14]=d,v[3]=p,v[7]=f,v[11]=m,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Be().fromArray(this.elements)}copy(t){let r=this.elements,i=t.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this}copyPosition(t){let r=this.elements,i=t.elements;return r[12]=i[12],r[13]=i[13],r[14]=i[14],this}setFromMatrix3(t){let r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this}extractRotation(t){let r=this.elements,i=t.elements,n=1/pf.setFromMatrixColumn(t,0).length(),s=1/pf.setFromMatrixColumn(t,1).length(),a=1/pf.setFromMatrixColumn(t,2).length();return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=0,r[4]=i[4]*s,r[5]=i[5]*s,r[6]=i[6]*s,r[7]=0,r[8]=i[8]*a,r[9]=i[9]*a,r[10]=i[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){let r=this.elements,i=t.x,n=t.y,s=t.z,a=Math.cos(i),o=Math.sin(i),l=Math.cos(n),c=Math.sin(n),u=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){let d=a*u,p=a*h,f=o*u,m=o*h;r[0]=l*u,r[4]=-l*h,r[8]=c,r[1]=p+f*c,r[5]=d-m*c,r[9]=-o*l,r[2]=m-d*c,r[6]=f+p*c,r[10]=a*l}else if(t.order==="YXZ"){let d=l*u,p=l*h,f=c*u,m=c*h;r[0]=d+m*o,r[4]=f*o-p,r[8]=a*c,r[1]=a*h,r[5]=a*u,r[9]=-o,r[2]=p*o-f,r[6]=m+d*o,r[10]=a*l}else if(t.order==="ZXY"){let d=l*u,p=l*h,f=c*u,m=c*h;r[0]=d-m*o,r[4]=-a*h,r[8]=f+p*o,r[1]=p+f*o,r[5]=a*u,r[9]=m-d*o,r[2]=-a*c,r[6]=o,r[10]=a*l}else if(t.order==="ZYX"){let d=a*u,p=a*h,f=o*u,m=o*h;r[0]=l*u,r[4]=f*c-p,r[8]=d*c+m,r[1]=l*h,r[5]=m*c+d,r[9]=p*c-f,r[2]=-c,r[6]=o*l,r[10]=a*l}else if(t.order==="YZX"){let d=a*l,p=a*c,f=o*l,m=o*c;r[0]=l*u,r[4]=m-d*h,r[8]=f*h+p,r[1]=h,r[5]=a*u,r[9]=-o*u,r[2]=-c*u,r[6]=p*h+f,r[10]=d-m*h}else if(t.order==="XZY"){let d=a*l,p=a*c,f=o*l,m=o*c;r[0]=l*u,r[4]=-h,r[8]=c*u,r[1]=d*h+m,r[5]=a*u,r[9]=p*h-f,r[2]=f*h-p,r[6]=o*u,r[10]=m*h+d}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(ese,t,tse)}lookAt(t,r,i){let n=this.elements;return da.subVectors(t,r),da.lengthSq()===0&&(da.z=1),da.normalize(),Au.crossVectors(i,da),Au.lengthSq()===0&&(Math.abs(i.z)===1?da.x+=1e-4:da.z+=1e-4,da.normalize(),Au.crossVectors(i,da)),Au.normalize(),$x.crossVectors(da,Au),n[0]=Au.x,n[4]=$x.x,n[8]=da.x,n[1]=Au.y,n[5]=$x.y,n[9]=da.y,n[2]=Au.z,n[6]=$x.z,n[10]=da.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){let i=t.elements,n=r.elements,s=this.elements,a=i[0],o=i[4],l=i[8],c=i[12],u=i[1],h=i[5],d=i[9],p=i[13],f=i[2],m=i[6],g=i[10],v=i[14],y=i[3],w=i[7],b=i[11],E=i[15],_=n[0],C=n[4],x=n[8],A=n[12],T=n[1],M=n[5],D=n[9],P=n[13],I=n[2],B=n[6],V=n[10],N=n[14],L=n[3],W=n[7],G=n[11],X=n[15];return s[0]=a*_+o*T+l*I+c*L,s[4]=a*C+o*M+l*B+c*W,s[8]=a*x+o*D+l*V+c*G,s[12]=a*A+o*P+l*N+c*X,s[1]=u*_+h*T+d*I+p*L,s[5]=u*C+h*M+d*B+p*W,s[9]=u*x+h*D+d*V+p*G,s[13]=u*A+h*P+d*N+p*X,s[2]=f*_+m*T+g*I+v*L,s[6]=f*C+m*M+g*B+v*W,s[10]=f*x+m*D+g*V+v*G,s[14]=f*A+m*P+g*N+v*X,s[3]=y*_+w*T+b*I+E*L,s[7]=y*C+w*M+b*B+E*W,s[11]=y*x+w*D+b*V+E*G,s[15]=y*A+w*P+b*N+E*X,this}multiplyScalar(t){let r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this}determinant(){let t=this.elements,r=t[0],i=t[4],n=t[8],s=t[12],a=t[1],o=t[5],l=t[9],c=t[13],u=t[2],h=t[6],d=t[10],p=t[14],f=t[3],m=t[7],g=t[11],v=t[15];return f*(+s*l*h-n*c*h-s*o*d+i*c*d+n*o*p-i*l*p)+m*(+r*l*p-r*c*d+s*a*d-n*a*p+n*c*u-s*l*u)+g*(+r*c*h-r*o*p-s*a*h+i*a*p+s*o*u-i*c*u)+v*(-n*o*u-r*l*h+r*o*d+n*a*h-i*a*d+i*l*u)}transpose(){let t=this.elements,r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this}setPosition(t,r,i){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=r,n[14]=i),this}invert(){let t=this.elements,r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],v=t[15],y=h*g*c-m*d*c+m*l*p-o*g*p-h*l*v+o*d*v,w=f*d*c-u*g*c-f*l*p+a*g*p+u*l*v-a*d*v,b=u*m*c-f*h*c+f*o*p-a*m*p-u*o*v+a*h*v,E=f*h*l-u*m*l-f*o*d+a*m*d+u*o*g-a*h*g,_=r*y+i*w+n*b+s*E;if(_===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let C=1/_;return t[0]=y*C,t[1]=(m*d*s-h*g*s-m*n*p+i*g*p+h*n*v-i*d*v)*C,t[2]=(o*g*s-m*l*s+m*n*c-i*g*c-o*n*v+i*l*v)*C,t[3]=(h*l*s-o*d*s-h*n*c+i*d*c+o*n*p-i*l*p)*C,t[4]=w*C,t[5]=(u*g*s-f*d*s+f*n*p-r*g*p-u*n*v+r*d*v)*C,t[6]=(f*l*s-a*g*s-f*n*c+r*g*c+a*n*v-r*l*v)*C,t[7]=(a*d*s-u*l*s+u*n*c-r*d*c-a*n*p+r*l*p)*C,t[8]=b*C,t[9]=(f*h*s-u*m*s-f*i*p+r*m*p+u*i*v-r*h*v)*C,t[10]=(a*m*s-f*o*s+f*i*c-r*m*c-a*i*v+r*o*v)*C,t[11]=(u*o*s-a*h*s-u*i*c+r*h*c+a*i*p-r*o*p)*C,t[12]=E*C,t[13]=(u*m*n-f*h*n+f*i*d-r*m*d-u*i*g+r*h*g)*C,t[14]=(f*o*n-a*m*n-f*i*l+r*m*l+a*i*g-r*o*g)*C,t[15]=(a*h*n-u*o*n+u*i*l-r*h*l-a*i*d+r*o*d)*C,this}scale(t){let r=this.elements,i=t.x,n=t.y,s=t.z;return r[0]*=i,r[4]*=n,r[8]*=s,r[1]*=i,r[5]*=n,r[9]*=s,r[2]*=i,r[6]*=n,r[10]*=s,r[3]*=i,r[7]*=n,r[11]*=s,this}getMaxScaleOnAxis(){let t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,i,n))}makeTranslation(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this}makeRotationX(t){let r=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1),this}makeRotationY(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1),this}makeRotationZ(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,r){let i=Math.cos(r),n=Math.sin(r),s=1-i,a=t.x,o=t.y,l=t.z,c=s*a,u=s*o;return this.set(c*a+i,c*o-n*l,c*l+n*o,0,c*o+n*l,u*o+i,u*l-n*a,0,c*l-n*o,u*l+n*a,s*l*l+i,0,0,0,0,1),this}makeScale(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,r,i,n,s,a){return this.set(1,i,s,0,t,1,a,0,r,n,1,0,0,0,0,1),this}compose(t,r,i){let n=this.elements,s=r._x,a=r._y,o=r._z,l=r._w,c=s+s,u=a+a,h=o+o,d=s*c,p=s*u,f=s*h,m=a*u,g=a*h,v=o*h,y=l*c,w=l*u,b=l*h,E=i.x,_=i.y,C=i.z;return n[0]=(1-(m+v))*E,n[1]=(p+b)*E,n[2]=(f-w)*E,n[3]=0,n[4]=(p-b)*_,n[5]=(1-(d+v))*_,n[6]=(g+y)*_,n[7]=0,n[8]=(f+w)*C,n[9]=(g-y)*C,n[10]=(1-(d+m))*C,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,r,i){let n=this.elements,s=pf.set(n[0],n[1],n[2]).length(),a=pf.set(n[4],n[5],n[6]).length(),o=pf.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],fo.copy(this);let l=1/s,c=1/a,u=1/o;return fo.elements[0]*=l,fo.elements[1]*=l,fo.elements[2]*=l,fo.elements[4]*=c,fo.elements[5]*=c,fo.elements[6]*=c,fo.elements[8]*=u,fo.elements[9]*=u,fo.elements[10]*=u,r.setFromRotationMatrix(fo),i.x=s,i.y=a,i.z=o,this}makePerspective(t,r,i,n,s,a){let o=this.elements,l=2*s/(r-t),c=2*s/(i-n),u=(r+t)/(r-t),h=(i+n)/(i-n),d=-(a+s)/(a-s),p=-2*a*s/(a-s);return o[0]=l,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=c,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,r,i,n,s,a){let o=this.elements,l=1/(r-t),c=1/(i-n),u=1/(a-s),h=(r+t)*l,d=(i+n)*c,p=(a+s)*u;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let r=this.elements,i=t.elements;for(let n=0;n<16;n++)if(r[n]!==i[n])return!1;return!0}fromArray(t,r=0){for(let i=0;i<16;i++)this.elements[i]=t[i+r];return this}toArray(t=[],r=0){let i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}},pf=new R,fo=new Be,ese=new R(0,0,0),tse=new R(1,1,1),Au=new R,$x=new R,da=new R,FB=new Be,UB=new Dt,an=class{constructor(e=0,t=0,r=0,i=an.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Hi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Hi(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(Hi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-Hi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Hi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Hi(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return FB.makeRotationFromQuaternion(e),this.setFromRotationMatrix(FB,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return UB.setFromEuler(this),this.setFromQuaternion(UB,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};an.DEFAULT_ORDER="XYZ";var u3=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},rse=0,jB=new R,ff=new Dt,cc=new Be,Qx=new R,Bv=new R,ise=new R,nse=new Dt,VB=new R(1,0,0),HB=new R(0,1,0),WB=new R(0,0,1),sse={type:"added"},GB={type:"removed"},Cr=class extends Kn{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rse++}),this.uuid=eo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Cr.DEFAULT_UP.clone();let e=new R,t=new an,r=new Dt,i=new R(1,1,1);function n(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Be},normalMatrix:{value:new ln}}),this.matrix=new Be,this.matrixWorld=new Be,this.matrixAutoUpdate=Cr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Cr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new u3,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return ff.setFromAxisAngle(e,t),this.quaternion.multiply(ff),this}rotateOnWorldAxis(e,t){return ff.setFromAxisAngle(e,t),this.quaternion.premultiply(ff),this}rotateX(e){return this.rotateOnAxis(VB,e)}rotateY(e){return this.rotateOnAxis(HB,e)}rotateZ(e){return this.rotateOnAxis(WB,e)}translateOnAxis(e,t){return jB.copy(e).applyQuaternion(this.quaternion),this.position.add(jB.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(VB,e)}translateY(e){return this.translateOnAxis(HB,e)}translateZ(e){return this.translateOnAxis(WB,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(cc.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Qx.copy(e):Qx.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),Bv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?cc.lookAt(Bv,Qx,this.up):cc.lookAt(Qx,Bv,this.up),this.quaternion.setFromRotationMatrix(cc),i&&(cc.extractRotation(i.matrixWorld),ff.setFromRotationMatrix(cc),this.quaternion.premultiply(ff.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(sse)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(GB)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(GB)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),cc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),cc.multiply(e.parent.matrixWorld)),e.applyMatrix4(cc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bv,e,ise),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bv,nse,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++){let n=t[r];(n.matrixWorldAutoUpdate===!0||e===!0)&&n.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,s=i.length;n<s;n++){let a=i[n];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,c=o.length;l<c;l++){let u=o[l];n(e.shapes,u)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));i.material=a}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];i.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),c=s(e.images),u=s(e.shapes),h=s(e.skeletons),d=s(e.animations),p=s(e.nodes);a.length>0&&(r.geometries=a),o.length>0&&(r.materials=o),l.length>0&&(r.textures=l),c.length>0&&(r.images=c),u.length>0&&(r.shapes=u),h.length>0&&(r.skeletons=h),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function s(a){let o=[];for(let l in a){let c=a[l];delete c.metadata,o.push(c)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};Cr.DEFAULT_UP=new R(0,1,0);Cr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Cr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var mo=new R,uc=new R,MA=new R,hc=new R,mf=new R,gf=new R,qB=new R,PA=new R,DA=new R,IA=new R,Un=class{constructor(e=new R,t=new R,r=new R){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),mo.subVectors(e,t),i.cross(mo);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){mo.subVectors(i,t),uc.subVectors(r,t),MA.subVectors(e,t);let s=mo.dot(mo),a=mo.dot(uc),o=mo.dot(MA),l=uc.dot(uc),c=uc.dot(MA),u=s*l-a*a;if(u===0)return n.set(-2,-1,-1);let h=1/u,d=(l*o-a*c)*h,p=(s*c-a*o)*h;return n.set(1-d-p,p,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,hc),hc.x>=0&&hc.y>=0&&hc.x+hc.y<=1}static getUV(e,t,r,i,n,s,a,o){return this.getBarycoord(e,t,r,i,hc),o.set(0,0),o.addScaledVector(n,hc.x),o.addScaledVector(s,hc.y),o.addScaledVector(a,hc.z),o}static isFrontFacing(e,t,r,i){return mo.subVectors(r,t),uc.subVectors(e,t),mo.cross(uc).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return mo.subVectors(this.c,this.b),uc.subVectors(this.a,this.b),mo.cross(uc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Un.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Un.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return Un.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return Un.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Un.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,s,a;mf.subVectors(i,r),gf.subVectors(n,r),PA.subVectors(e,r);let o=mf.dot(PA),l=gf.dot(PA);if(o<=0&&l<=0)return t.copy(r);DA.subVectors(e,i);let c=mf.dot(DA),u=gf.dot(DA);if(c>=0&&u<=c)return t.copy(i);let h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(r).addScaledVector(mf,s);IA.subVectors(e,n);let d=mf.dot(IA),p=gf.dot(IA);if(p>=0&&d<=p)return t.copy(n);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(r).addScaledVector(gf,a);let m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return qB.subVectors(n,i),a=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(qB,a);let g=1/(m+f+h);return s=f*g,a=h*g,t.copy(r).addScaledVector(mf,s).addScaledVector(gf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},ase=0,Ow=class extends Kn{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ase++}),this.uuid=eo(),this.name="",this.type="Material",this.blending=Xd,this.side=Vo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=O9,this.blendDst=R9,this.blendEquation=Wf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=e2,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=kne,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gA,this.stencilZFail=gA,this.stencilZPass=gA,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Xd&&(r.blending=this.blending),this.side!==Vo&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Vp=class extends Ow{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=k9,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Fi=new R,Kx=new re,Mt=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=n2,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Kx.fromBufferAttribute(this,t),Kx.applyMatrix3(e),this.setXY(t,Kx.x,Kx.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Fi.fromBufferAttribute(this,t),Fi.applyMatrix3(e),this.setXYZ(t,Fi.x,Fi.y,Fi.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Fi.fromBufferAttribute(this,t),Fi.applyMatrix4(e),this.setXYZ(t,Fi.x,Fi.y,Fi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Fi.fromBufferAttribute(this,t),Fi.applyNormalMatrix(e),this.setXYZ(t,Fi.x,Fi.y,Fi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Fi.fromBufferAttribute(this,t),Fi.transformDirection(e),this.setXYZ(t,Fi.x,Fi.y,Fi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Fc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Vr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Fc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Vr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Fc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Vr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Fc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Vr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array),i=Vr(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array),i=Vr(i,this.array),n=Vr(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==n2&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},Y9=class extends Mt{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Mm=class extends Mt{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Ze=class extends Mt{constructor(t,r,i){super(new Float32Array(t),r,i)}},ose=0,za=new Be,OA=new Cr,vf=new R,pa=new Ni,Fv=new Ni,dn=new R,pt=class extends Kn{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ose++}),this.uuid=eo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(V9(t)?Mm:Y9)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,r){return this.attributes[t]=r,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,r,i=0){this.groups.push({start:t,count:r,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,r){this.drawRange.start=t,this.drawRange.count=r}applyMatrix4(t){let r=this.attributes.position;r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new ln().getNormalMatrix(t);i.applyNormalMatrix(s),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return za.makeRotationFromQuaternion(t),this.applyMatrix4(za),this}rotateX(t){return za.makeRotationX(t),this.applyMatrix4(za),this}rotateY(t){return za.makeRotationY(t),this.applyMatrix4(za),this}rotateZ(t){return za.makeRotationZ(t),this.applyMatrix4(za),this}translate(t,r,i){return za.makeTranslation(t,r,i),this.applyMatrix4(za),this}scale(t,r,i){return za.makeScale(t,r,i),this.applyMatrix4(za),this}lookAt(t){return OA.lookAt(t),OA.updateMatrix(),this.applyMatrix4(OA.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vf).negate(),this.translate(vf.x,vf.y,vf.z),this}setFromPoints(t){let r=[];for(let i=0,n=t.length;i<n;i++){let s=t[i];r.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ze(r,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ni);let t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new R(-1/0,-1/0,-1/0),new R(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r)for(let i=0,n=r.length;i<n;i++){let s=r[i];pa.setFromBufferAttribute(s),this.morphTargetsRelative?(dn.addVectors(this.boundingBox.min,pa.min),this.boundingBox.expandByPoint(dn),dn.addVectors(this.boundingBox.max,pa.max),this.boundingBox.expandByPoint(dn)):(this.boundingBox.expandByPoint(pa.min),this.boundingBox.expandByPoint(pa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ca);let t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new R,1/0);return}if(t){let i=this.boundingSphere.center;if(pa.setFromBufferAttribute(t),r)for(let s=0,a=r.length;s<a;s++){let o=r[s];Fv.setFromBufferAttribute(o),this.morphTargetsRelative?(dn.addVectors(pa.min,Fv.min),pa.expandByPoint(dn),dn.addVectors(pa.max,Fv.max),pa.expandByPoint(dn)):(pa.expandByPoint(Fv.min),pa.expandByPoint(Fv.max))}pa.getCenter(i);let n=0;for(let s=0,a=t.count;s<a;s++)dn.fromBufferAttribute(t,s),n=Math.max(n,i.distanceToSquared(dn));if(r)for(let s=0,a=r.length;s<a;s++){let o=r[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)dn.fromBufferAttribute(o,c),l&&(vf.fromBufferAttribute(t,c),dn.add(vf)),n=Math.max(n,i.distanceToSquared(dn))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,r=this.attributes;if(t===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.array,n=r.position.array,s=r.normal.array,a=r.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Mt(new Float32Array(4*o),4));let l=this.getAttribute("tangent").array,c=[],u=[];for(let T=0;T<o;T++)c[T]=new R,u[T]=new R;let h=new R,d=new R,p=new R,f=new re,m=new re,g=new re,v=new R,y=new R;function w(T,M,D){h.fromArray(n,T*3),d.fromArray(n,M*3),p.fromArray(n,D*3),f.fromArray(a,T*2),m.fromArray(a,M*2),g.fromArray(a,D*2),d.sub(h),p.sub(h),m.sub(f),g.sub(f);let P=1/(m.x*g.y-g.x*m.y);!isFinite(P)||(v.copy(d).multiplyScalar(g.y).addScaledVector(p,-m.y).multiplyScalar(P),y.copy(p).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(P),c[T].add(v),c[M].add(v),c[D].add(v),u[T].add(y),u[M].add(y),u[D].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let T=0,M=b.length;T<M;++T){let D=b[T],P=D.start,I=D.count;for(let B=P,V=P+I;B<V;B+=3)w(i[B+0],i[B+1],i[B+2])}let E=new R,_=new R,C=new R,x=new R;function A(T){C.fromArray(s,T*3),x.copy(C);let M=c[T];E.copy(M),E.sub(C.multiplyScalar(C.dot(M))).normalize(),_.crossVectors(x,M);let D=_.dot(u[T])<0?-1:1;l[T*4]=E.x,l[T*4+1]=E.y,l[T*4+2]=E.z,l[T*4+3]=D}for(let T=0,M=b.length;T<M;++T){let D=b[T],P=D.start,I=D.count;for(let B=P,V=P+I;B<V;B+=3)A(i[B+0]),A(i[B+1]),A(i[B+2])}}computeVertexNormals(){let t=this.index,r=this.getAttribute("position");if(r!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Mt(new Float32Array(r.count*3),3),this.setAttribute("normal",i);else for(let d=0,p=i.count;d<p;d++)i.setXYZ(d,0,0,0);let n=new R,s=new R,a=new R,o=new R,l=new R,c=new R,u=new R,h=new R;if(t)for(let d=0,p=t.count;d<p;d+=3){let f=t.getX(d+0),m=t.getX(d+1),g=t.getX(d+2);n.fromBufferAttribute(r,f),s.fromBufferAttribute(r,m),a.fromBufferAttribute(r,g),u.subVectors(a,s),h.subVectors(n,s),u.cross(h),o.fromBufferAttribute(i,f),l.fromBufferAttribute(i,m),c.fromBufferAttribute(i,g),o.add(u),l.add(u),c.add(u),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(m,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,p=r.count;d<p;d+=3)n.fromBufferAttribute(r,d+0),s.fromBufferAttribute(r,d+1),a.fromBufferAttribute(r,d+2),u.subVectors(a,s),h.subVectors(n,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let t=this.attributes.normal;for(let r=0,i=t.count;r<i;r++)dn.fromBufferAttribute(t,r),dn.normalize(),t.setXYZ(r,dn.x,dn.y,dn.z)}toNonIndexed(){function t(o,l){let c=o.array,u=o.itemSize,h=o.normalized,d=new c.constructor(l.length*u),p=0,f=0;for(let m=0,g=l.length;m<g;m++){o.isInterleavedBufferAttribute?p=l[m]*o.data.stride+o.offset:p=l[m]*u;for(let v=0;v<u;v++)d[f++]=c[p++]}return new Mt(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new pt,i=this.index.array,n=this.attributes;for(let o in n){let l=n[o],c=t(l,i);r.setAttribute(o,c)}let s=this.morphAttributes;for(let o in s){let l=[],c=s[o];for(let u=0,h=c.length;u<h;u++){let d=c[u],p=t(d,i);l.push(p)}r.morphAttributes[o]=l}r.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let o=0,l=a.length;o<l;o++){let c=a[o];r.addGroup(c.start,c.count,c.materialIndex)}return r}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};let r=this.index;r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});let i=this.attributes;for(let l in i){let c=i[l];t.data.attributes[l]=c.toJSON(t.data)}let n={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){let p=c[h];u.push(p.toJSON(t.data))}u.length>0&&(n[l]=u,s=!0)}s&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let r={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone(r));let n=t.attributes;for(let c in n){let u=n[c];this.setAttribute(c,u.clone(r))}let s=t.morphAttributes;for(let c in s){let u=[],h=s[c];for(let d=0,p=h.length;d<p;d++)u.push(h[d].clone(r));this.morphAttributes[c]=u}this.morphTargetsRelative=t.morphTargetsRelative;let a=t.groups;for(let c=0,u=a.length;c<u;c++){let h=a[c];this.addGroup(h.start,h.count,h.materialIndex)}let o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());let l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},YB=new Be,yf=new Gg,RA=new ca,Uv=new R,jv=new R,Vv=new R,kA=new R,Zx=new R,Jx=new re,e1=new re,t1=new re,LA=new R,r1=new R,Ii=class extends Cr{constructor(e=new pt,t=new Vp){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(e,t){let r=this.geometry,i=r.attributes.position,n=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(n&&a){Zx.set(0,0,0);for(let o=0,l=n.length;o<l;o++){let c=a[o],u=n[o];c!==0&&(kA.fromBufferAttribute(u,e),s?Zx.addScaledVector(kA,c):Zx.addScaledVector(kA.sub(t),c))}t.add(Zx)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),RA.copy(r.boundingSphere),RA.applyMatrix4(n),e.ray.intersectsSphere(RA)===!1)||(YB.copy(n).invert(),yf.copy(e.ray).applyMatrix4(YB),r.boundingBox!==null&&yf.intersectsBox(r.boundingBox)===!1))return;let s,a=r.index,o=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv2,u=r.groups,h=r.drawRange;if(a!==null)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(a.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,w=v;y<w;y+=3){let b=a.getX(y),E=a.getX(y+1),_=a.getX(y+2);s=i1(this,m,e,yf,l,c,b,E,_),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(a.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=a.getX(f),v=a.getX(f+1),y=a.getX(f+2);s=i1(this,i,e,yf,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(i))for(let d=0,p=u.length;d<p;d++){let f=u[d],m=i[f.materialIndex],g=Math.max(f.start,h.start),v=Math.min(o.count,Math.min(f.start+f.count,h.start+h.count));for(let y=g,w=v;y<w;y+=3){let b=y,E=y+1,_=y+2;s=i1(this,m,e,yf,l,c,b,E,_),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=f,v=f+1,y=f+2;s=i1(this,i,e,yf,l,c,g,v,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}}};function lse(e,t,r,i,n,s,a,o){let l;if(t.side===_n?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side===Vo,o),l===null)return null;r1.copy(o),r1.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(r1);return c<r.near||c>r.far?null:{distance:c,point:r1.clone(),object:e}}function i1(e,t,r,i,n,s,a,o,l){e.getVertexPosition(a,Uv),e.getVertexPosition(o,jv),e.getVertexPosition(l,Vv);let c=lse(e,t,r,i,Uv,jv,Vv,LA);if(c){n&&(Jx.fromBufferAttribute(n,a),e1.fromBufferAttribute(n,o),t1.fromBufferAttribute(n,l),c.uv=Un.getUV(LA,Uv,jv,Vv,Jx,e1,t1,new re)),s&&(Jx.fromBufferAttribute(s,a),e1.fromBufferAttribute(s,o),t1.fromBufferAttribute(s,l),c.uv2=Un.getUV(LA,Uv,jv,Vv,Jx,e1,t1,new re));let u={a,b:o,c:l,normal:new R,materialIndex:0};Un.getNormal(Uv,jv,Vv,u.normal),c.face=u}return c}var Wo=class extends pt{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],c=[],u=[],h=0,d=0;p("z","y","x",-1,-1,r,t,e,s,n,0),p("z","y","x",1,-1,r,t,-e,s,n,1),p("x","z","y",1,1,e,r,t,i,s,2),p("x","z","y",1,-1,e,r,-t,i,s,3),p("x","y","z",1,-1,e,t,r,i,n,4),p("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new Ze(l,3)),this.setAttribute("normal",new Ze(c,3)),this.setAttribute("uv",new Ze(u,2));function p(f,m,g,v,y,w,b,E,_,C,x){let A=w/_,T=b/C,M=w/2,D=b/2,P=E/2,I=_+1,B=C+1,V=0,N=0,L=new R;for(let W=0;W<B;W++){let G=W*T-D;for(let X=0;X<I;X++){let Q=X*A-M;L[f]=Q*v,L[m]=G*y,L[g]=P,l.push(L.x,L.y,L.z),L[f]=0,L[m]=0,L[g]=E>0?1:-1,c.push(L.x,L.y,L.z),u.push(X/_),u.push(1-W/C),V+=1}}for(let W=0;W<C;W++)for(let G=0;G<_;G++){let X=h+G+I*W,Q=h+G+I*(W+1),ie=h+(G+1)+I*(W+1),J=h+(G+1)+I*W;o.push(X,Q,J),o.push(Q,ie,J),N+=6}a.addGroup(d,N,x),d+=N,h+=V}}static fromJSON(e){return new Wo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function ag(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Ds(e){let t={};for(let r=0;r<e.length;r++){let i=ag(e[r]);for(let n in i)t[n]=i[n]}return t}function cse(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function X9(e){return e.getRenderTarget()===null&&e.outputEncoding===jt?gl:Z_}var qg={clone:ag,merge:Ds},use=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hse=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,yr=class extends Ow{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=use,this.fragmentShader=hse,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ag(e.uniforms),this.uniformsGroups=cse(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},Hp=class extends Cr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Be,this.projectionMatrix=new Be,this.projectionMatrixInverse=new Be}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},ls=class extends Hp{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=L0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Xy*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return L0*2*Math.atan(Math.tan(Xy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Xy*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},wf=-90,xf=1,dse=class extends Cr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new ls(wf,xf,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new ls(wf,xf,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new ls(wf,xf,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new ls(wf,xf,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new ls(wf,xf,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new ls(wf,xf,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=kl,e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}},h3=class extends pi{constructor(e,t,r,i,n,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:fp,super(e,t,r,i,n,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},pse=class extends vr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new h3(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:qt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Wo(5,5,5),n=new yr({name:"CubemapFromEquirect",uniforms:ag(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:_n,blending:$i});n.uniforms.tEquirect.value=t;let s=new Ii(i,n),a=t.minFilter;return t.minFilter===sg&&(t.minFilter=qt),new dse(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},NA=new R,fse=new R,mse=new ln,ya=class{constructor(e=new R(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=NA.subVectors(r,t).cross(fse.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(NA),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||mse.getNormalMatrix(e),i=this.coplanarPoint(NA).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},bf=new ca,n1=new R,d3=class{constructor(e=new ya,t=new ya,r=new ya,i=new ya,n=new ya,s=new ya){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return t[0].setComponents(a-i,u-o,f-h,y-m).normalize(),t[1].setComponents(a+i,u+o,f+h,y+m).normalize(),t[2].setComponents(a+n,u+l,f+d,y+g).normalize(),t[3].setComponents(a-n,u-l,f-d,y-g).normalize(),t[4].setComponents(a-s,u-c,f-p,y-v).normalize(),t[5].setComponents(a+s,u+c,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),bf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(bf)}intersectsSprite(e){return bf.center.set(0,0,0),bf.radius=.7071067811865476,bf.applyMatrix4(e.matrixWorld),this.intersectsSphere(bf)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(n1.x=i.normal.x>0?e.max.x:e.min.x,n1.y=i.normal.y>0?e.max.y:e.min.y,n1.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(n1)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function $9(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function gse(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,u){let h=c.array,d=c.usage,p=e.createBuffer();e.bindBuffer(u,p),e.bufferData(u,h,d),c.onUploadCallback();let f;if(h instanceof Float32Array)f=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(h instanceof Int16Array)f=5122;else if(h instanceof Uint32Array)f=5125;else if(h instanceof Int32Array)f=5124;else if(h instanceof Int8Array)f=5120;else if(h instanceof Uint8Array)f=5121;else if(h instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){let d=u.array,p=u.updateRange;e.bindBuffer(h,c),p.count===-1?e.bufferSubData(h,0,d):(r?e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);h===void 0?i.set(c,n(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:a,remove:o,update:l}}var Wp=class extends pt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,c=o+1,u=e/a,h=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){let v=g*h-s;for(let y=0;y<l;y++){let w=y*u-n;p.push(w,-v,0),f.push(0,0,1),m.push(y/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let v=0;v<a;v++){let y=v+l*g,w=v+l*(g+1),b=v+1+l*(g+1),E=v+1+l*g;d.push(y,w,E),d.push(w,b,E)}this.setIndex(d),this.setAttribute("position",new Ze(p,3)),this.setAttribute("normal",new Ze(f,3)),this.setAttribute("uv",new Ze(m,2))}static fromJSON(e){return new Wp(e.width,e.height,e.widthSegments,e.heightSegments)}},vse=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,yse=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wse=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,xse=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,bse=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,_se=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Sse="vec3 transformed = vec3( position );",Ese=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Tse=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Cse=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Ase=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Mse=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Pse=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Dse=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Ise=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Ose=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Rse=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,kse=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Lse=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Nse=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,zse=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Bse=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Fse=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Use=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,jse=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Vse=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Hse="gl_FragColor = linearToOutputTexel( gl_FragColor );",Wse=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Gse=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,qse=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Yse=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Xse=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,$se=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Qse=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Kse=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Zse=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jse=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,eae=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,tae=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,rae=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,iae=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,nae=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,sae=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,aae=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,oae=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lae=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,cae=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,uae=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hae=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,dae=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,pae=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,fae=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,mae=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,gae=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,vae=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,yae=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,wae=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,xae=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,bae=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_ae=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Sae=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Eae=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Tae=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Cae=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Aae=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Mae=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Pae=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Dae=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Iae=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Oae=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Rae=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kae=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Lae=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Nae=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,zae=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Bae=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Fae=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Uae=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,jae=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Vae=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Hae=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Wae=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Gae=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,qae=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Yae=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xae=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,$ae=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Qae=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Kae=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Zae=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Jae=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,eoe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,toe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,roe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ioe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,noe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,soe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,aoe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,ooe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,loe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,coe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uoe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,hoe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,doe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,poe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,foe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,moe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,goe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,voe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,yoe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,woe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xoe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,boe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,_oe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Soe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Eoe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Toe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Coe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Aoe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Moe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Poe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Doe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ioe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ooe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Roe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,koe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Loe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Noe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zoe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Boe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Foe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Uoe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,joe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Voe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hoe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Woe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Goe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qoe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Yoe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xoe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Wt={alphamap_fragment:vse,alphamap_pars_fragment:yse,alphatest_fragment:wse,alphatest_pars_fragment:xse,aomap_fragment:bse,aomap_pars_fragment:_se,begin_vertex:Sse,beginnormal_vertex:Ese,bsdfs:Tse,iridescence_fragment:Cse,bumpmap_pars_fragment:Ase,clipping_planes_fragment:Mse,clipping_planes_pars_fragment:Pse,clipping_planes_pars_vertex:Dse,clipping_planes_vertex:Ise,color_fragment:Ose,color_pars_fragment:Rse,color_pars_vertex:kse,color_vertex:Lse,common:Nse,cube_uv_reflection_fragment:zse,defaultnormal_vertex:Bse,displacementmap_pars_vertex:Fse,displacementmap_vertex:Use,emissivemap_fragment:jse,emissivemap_pars_fragment:Vse,encodings_fragment:Hse,encodings_pars_fragment:Wse,envmap_fragment:Gse,envmap_common_pars_fragment:qse,envmap_pars_fragment:Yse,envmap_pars_vertex:Xse,envmap_physical_pars_fragment:aae,envmap_vertex:$se,fog_vertex:Qse,fog_pars_vertex:Kse,fog_fragment:Zse,fog_pars_fragment:Jse,gradientmap_pars_fragment:eae,lightmap_fragment:tae,lightmap_pars_fragment:rae,lights_lambert_fragment:iae,lights_lambert_pars_fragment:nae,lights_pars_begin:sae,lights_toon_fragment:oae,lights_toon_pars_fragment:lae,lights_phong_fragment:cae,lights_phong_pars_fragment:uae,lights_physical_fragment:hae,lights_physical_pars_fragment:dae,lights_fragment_begin:pae,lights_fragment_maps:fae,lights_fragment_end:mae,logdepthbuf_fragment:gae,logdepthbuf_pars_fragment:vae,logdepthbuf_pars_vertex:yae,logdepthbuf_vertex:wae,map_fragment:xae,map_pars_fragment:bae,map_particle_fragment:_ae,map_particle_pars_fragment:Sae,metalnessmap_fragment:Eae,metalnessmap_pars_fragment:Tae,morphcolor_vertex:Cae,morphnormal_vertex:Aae,morphtarget_pars_vertex:Mae,morphtarget_vertex:Pae,normal_fragment_begin:Dae,normal_fragment_maps:Iae,normal_pars_fragment:Oae,normal_pars_vertex:Rae,normal_vertex:kae,normalmap_pars_fragment:Lae,clearcoat_normal_fragment_begin:Nae,clearcoat_normal_fragment_maps:zae,clearcoat_pars_fragment:Bae,iridescence_pars_fragment:Fae,output_fragment:Uae,packing:jae,premultiplied_alpha_fragment:Vae,project_vertex:Hae,dithering_fragment:Wae,dithering_pars_fragment:Gae,roughnessmap_fragment:qae,roughnessmap_pars_fragment:Yae,shadowmap_pars_fragment:Xae,shadowmap_pars_vertex:$ae,shadowmap_vertex:Qae,shadowmask_pars_fragment:Kae,skinbase_vertex:Zae,skinning_pars_vertex:Jae,skinning_vertex:eoe,skinnormal_vertex:toe,specularmap_fragment:roe,specularmap_pars_fragment:ioe,tonemapping_fragment:noe,tonemapping_pars_fragment:soe,transmission_fragment:aoe,transmission_pars_fragment:ooe,uv_pars_fragment:loe,uv_pars_vertex:coe,uv_vertex:uoe,uv2_pars_fragment:hoe,uv2_pars_vertex:doe,uv2_vertex:poe,worldpos_vertex:foe,background_vert:moe,background_frag:goe,backgroundCube_vert:voe,backgroundCube_frag:yoe,cube_vert:woe,cube_frag:xoe,depth_vert:boe,depth_frag:_oe,distanceRGBA_vert:Soe,distanceRGBA_frag:Eoe,equirect_vert:Toe,equirect_frag:Coe,linedashed_vert:Aoe,linedashed_frag:Moe,meshbasic_vert:Poe,meshbasic_frag:Doe,meshlambert_vert:Ioe,meshlambert_frag:Ooe,meshmatcap_vert:Roe,meshmatcap_frag:koe,meshnormal_vert:Loe,meshnormal_frag:Noe,meshphong_vert:zoe,meshphong_frag:Boe,meshphysical_vert:Foe,meshphysical_frag:Uoe,meshtoon_vert:joe,meshtoon_frag:Voe,points_vert:Hoe,points_frag:Woe,shadow_vert:Goe,shadow_frag:qoe,sprite_vert:Yoe,sprite_frag:Xoe},qe={common:{diffuse:{value:new bt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ln},uv2Transform:{value:new ln},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new re(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ln}},sprite:{diffuse:{value:new bt(16777215)},opacity:{value:1},center:{value:new re(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ln}}},wl={basic:{uniforms:Ds([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.fog]),vertexShader:Wt.meshbasic_vert,fragmentShader:Wt.meshbasic_frag},lambert:{uniforms:Ds([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,qe.lights,{emissive:{value:new bt(0)}}]),vertexShader:Wt.meshlambert_vert,fragmentShader:Wt.meshlambert_frag},phong:{uniforms:Ds([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,qe.lights,{emissive:{value:new bt(0)},specular:{value:new bt(1118481)},shininess:{value:30}}]),vertexShader:Wt.meshphong_vert,fragmentShader:Wt.meshphong_frag},standard:{uniforms:Ds([qe.common,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.roughnessmap,qe.metalnessmap,qe.fog,qe.lights,{emissive:{value:new bt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Wt.meshphysical_vert,fragmentShader:Wt.meshphysical_frag},toon:{uniforms:Ds([qe.common,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.gradientmap,qe.fog,qe.lights,{emissive:{value:new bt(0)}}]),vertexShader:Wt.meshtoon_vert,fragmentShader:Wt.meshtoon_frag},matcap:{uniforms:Ds([qe.common,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,{matcap:{value:null}}]),vertexShader:Wt.meshmatcap_vert,fragmentShader:Wt.meshmatcap_frag},points:{uniforms:Ds([qe.points,qe.fog]),vertexShader:Wt.points_vert,fragmentShader:Wt.points_frag},dashed:{uniforms:Ds([qe.common,qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Wt.linedashed_vert,fragmentShader:Wt.linedashed_frag},depth:{uniforms:Ds([qe.common,qe.displacementmap]),vertexShader:Wt.depth_vert,fragmentShader:Wt.depth_frag},normal:{uniforms:Ds([qe.common,qe.bumpmap,qe.normalmap,qe.displacementmap,{opacity:{value:1}}]),vertexShader:Wt.meshnormal_vert,fragmentShader:Wt.meshnormal_frag},sprite:{uniforms:Ds([qe.sprite,qe.fog]),vertexShader:Wt.sprite_vert,fragmentShader:Wt.sprite_frag},background:{uniforms:{uvTransform:{value:new ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Wt.background_vert,fragmentShader:Wt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Wt.backgroundCube_vert,fragmentShader:Wt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Wt.cube_vert,fragmentShader:Wt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Wt.equirect_vert,fragmentShader:Wt.equirect_frag},distanceRGBA:{uniforms:Ds([qe.common,qe.displacementmap,{referencePosition:{value:new R},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Wt.distanceRGBA_vert,fragmentShader:Wt.distanceRGBA_frag},shadow:{uniforms:Ds([qe.lights,qe.fog,{color:{value:new bt(0)},opacity:{value:1}}]),vertexShader:Wt.shadow_vert,fragmentShader:Wt.shadow_frag}};wl.physical={uniforms:Ds([wl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new re(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new bt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new re},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new bt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new bt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Wt.meshphysical_vert,fragmentShader:Wt.meshphysical_frag};var s1={r:0,b:0,g:0};function $oe(e,t,r,i,n,s,a){let o=new bt(0),l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(g,v){let y=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?r:t).get(w));let b=e.xr,E=b.getSession&&b.getSession();E&&E.environmentBlendMode==="additive"&&(w=null),w===null?m(o,l):w&&w.isColor&&(m(w,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Iw)?(u===void 0&&(u=new Ii(new Wo(1,1,1),new yr({name:"BackgroundCubeMaterial",uniforms:ag(wl.backgroundCube.uniforms),vertexShader:wl.backgroundCube.vertexShader,fragmentShader:wl.backgroundCube.fragmentShader,side:_n,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(_,C,x){this.matrixWorld.copyPosition(x.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=w,u.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=w.encoding!==jt,(h!==w||d!==w.version||p!==e.toneMapping)&&(u.material.needsUpdate=!0,h=w,d=w.version,p=e.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new Ii(new Wp(2,2),new yr({name:"BackgroundMaterial",uniforms:ag(wl.background.uniforms),vertexShader:wl.background.vertexShader,fragmentShader:wl.background.fragmentShader,side:Vo,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=w.encoding!==jt,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(h!==w||d!==w.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,h=w,d=w.version,p=e.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function m(g,v){g.getRGB(s1,X9(e)),i.buffers.color.setClear(s1.r,s1.g,s1.b,v,a)}return{getClearColor:function(){return o},setClearColor:function(g,v=1){o.set(g),l=v,m(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(o,l)},render:f}}function Qoe(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=g(null),c=l,u=!1;function h(I,B,V,N,L){let W=!1;if(a){let G=m(N,V,B);c!==G&&(c=G,p(c.object)),W=v(I,N,V,L),W&&y(I,N,V,L)}else{let G=B.wireframe===!0;(c.geometry!==N.id||c.program!==V.id||c.wireframe!==G)&&(c.geometry=N.id,c.program=V.id,c.wireframe=G,W=!0)}L!==null&&r.update(L,34963),(W||u)&&(u=!1,x(I,B,V,N),L!==null&&e.bindBuffer(34963,r.get(L).buffer))}function d(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function p(I){return i.isWebGL2?e.bindVertexArray(I):s.bindVertexArrayOES(I)}function f(I){return i.isWebGL2?e.deleteVertexArray(I):s.deleteVertexArrayOES(I)}function m(I,B,V){let N=V.wireframe===!0,L=o[I.id];L===void 0&&(L={},o[I.id]=L);let W=L[B.id];W===void 0&&(W={},L[B.id]=W);let G=W[N];return G===void 0&&(G=g(d()),W[N]=G),G}function g(I){let B=[],V=[],N=[];for(let L=0;L<n;L++)B[L]=0,V[L]=0,N[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:V,attributeDivisors:N,object:I,attributes:{},index:null}}function v(I,B,V,N){let L=c.attributes,W=B.attributes,G=0,X=V.getAttributes();for(let Q in X)if(X[Q].location>=0){let ie=L[Q],J=W[Q];if(J===void 0&&(Q==="instanceMatrix"&&I.instanceMatrix&&(J=I.instanceMatrix),Q==="instanceColor"&&I.instanceColor&&(J=I.instanceColor)),ie===void 0||ie.attribute!==J||J&&ie.data!==J.data)return!0;G++}return c.attributesNum!==G||c.index!==N}function y(I,B,V,N){let L={},W=B.attributes,G=0,X=V.getAttributes();for(let Q in X)if(X[Q].location>=0){let ie=W[Q];ie===void 0&&(Q==="instanceMatrix"&&I.instanceMatrix&&(ie=I.instanceMatrix),Q==="instanceColor"&&I.instanceColor&&(ie=I.instanceColor));let J={};J.attribute=ie,ie&&ie.data&&(J.data=ie.data),L[Q]=J,G++}c.attributes=L,c.attributesNum=G,c.index=N}function w(){let I=c.newAttributes;for(let B=0,V=I.length;B<V;B++)I[B]=0}function b(I){E(I,0)}function E(I,B){let V=c.newAttributes,N=c.enabledAttributes,L=c.attributeDivisors;V[I]=1,N[I]===0&&(e.enableVertexAttribArray(I),N[I]=1),L[I]!==B&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](I,B),L[I]=B)}function _(){let I=c.newAttributes,B=c.enabledAttributes;for(let V=0,N=B.length;V<N;V++)B[V]!==I[V]&&(e.disableVertexAttribArray(V),B[V]=0)}function C(I,B,V,N,L,W){i.isWebGL2===!0&&(V===5124||V===5125)?e.vertexAttribIPointer(I,B,V,L,W):e.vertexAttribPointer(I,B,V,N,L,W)}function x(I,B,V,N){if(i.isWebGL2===!1&&(I.isInstancedMesh||N.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;w();let L=N.attributes,W=V.getAttributes(),G=B.defaultAttributeValues;for(let X in W){let Q=W[X];if(Q.location>=0){let ie=L[X];if(ie===void 0&&(X==="instanceMatrix"&&I.instanceMatrix&&(ie=I.instanceMatrix),X==="instanceColor"&&I.instanceColor&&(ie=I.instanceColor)),ie!==void 0){let J=ie.normalized,se=ie.itemSize,ee=r.get(ie);if(ee===void 0)continue;let ue=ee.buffer,oe=ee.type,le=ee.bytesPerElement;if(ie.isInterleavedBufferAttribute){let de=ie.data,xe=de.stride,_e=ie.offset;if(de.isInstancedInterleavedBuffer){for(let Se=0;Se<Q.locationSize;Se++)E(Q.location+Se,de.meshPerAttribute);I.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Se=0;Se<Q.locationSize;Se++)b(Q.location+Se);e.bindBuffer(34962,ue);for(let Se=0;Se<Q.locationSize;Se++)C(Q.location+Se,se/Q.locationSize,oe,J,xe*le,(_e+se/Q.locationSize*Se)*le)}else{if(ie.isInstancedBufferAttribute){for(let de=0;de<Q.locationSize;de++)E(Q.location+de,ie.meshPerAttribute);I.isInstancedMesh!==!0&&N._maxInstanceCount===void 0&&(N._maxInstanceCount=ie.meshPerAttribute*ie.count)}else for(let de=0;de<Q.locationSize;de++)b(Q.location+de);e.bindBuffer(34962,ue);for(let de=0;de<Q.locationSize;de++)C(Q.location+de,se/Q.locationSize,oe,J,se*le,se/Q.locationSize*de*le)}}else if(G!==void 0){let J=G[X];if(J!==void 0)switch(J.length){case 2:e.vertexAttrib2fv(Q.location,J);break;case 3:e.vertexAttrib3fv(Q.location,J);break;case 4:e.vertexAttrib4fv(Q.location,J);break;default:e.vertexAttrib1fv(Q.location,J)}}}}_()}function A(){D();for(let I in o){let B=o[I];for(let V in B){let N=B[V];for(let L in N)f(N[L].object),delete N[L];delete B[V]}delete o[I]}}function T(I){if(o[I.id]===void 0)return;let B=o[I.id];for(let V in B){let N=B[V];for(let L in N)f(N[L].object),delete N[L];delete B[V]}delete o[I.id]}function M(I){for(let B in o){let V=o[B];if(V[I.id]===void 0)continue;let N=V[I.id];for(let L in N)f(N[L].object),delete N[L];delete V[I.id]}}function D(){P(),u=!0,c!==l&&(c=l,p(c.object))}function P(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:D,resetDefaultState:P,dispose:A,releaseStatesOfGeometry:T,releaseStatesOfProgram:M,initAttributes:w,enableAttribute:b,disableUnusedAttributes:_}}function Koe(e,t,r,i){let n=i.isWebGL2,s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),r.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,p;if(n)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,u,h),r.update(u,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function Zoe(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let C=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(C){if(C==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return C==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,h=e.getParameter(34930),d=e.getParameter(35660),p=e.getParameter(3379),f=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),w=d>0,b=a||t.has("OES_texture_float"),E=w&&b,_=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:E,maxSamples:_}}function Joe(e){let t=this,r=null,i=0,n=!1,s=!1,a=new ya,o=new ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||i!==0||n;return n=d,i=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){r=u(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,v=e.get(h);if(!n||f===null||f.length===0||s&&!g)s?u(null):c();else{let y=s?0:i,w=y*4,b=v.clippingState||null;l.value=b,b=u(f,d,w,p);for(let E=0;E!==w;++E)b[E]=r[E];v.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(h,d,p,f){let m=h!==null?h.length:0,g=null;if(m!==0){if(g=l.value,f!==!0||g===null){let v=p+m*4,y=d.matrixWorldInverse;o.getNormalMatrix(y),(g===null||g.length<v)&&(g=new Float32Array(v));for(let w=0,b=p;w!==m;++w,b+=4)a.copy(h[w]).applyMatrix4(y,o),a.normal.toArray(g,b),g[b+3]=a.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,g}}function ele(e){let t=new WeakMap;function r(a,o){return o===t2?a.mapping=fp:o===r2&&(a.mapping=mp),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===t2||o===r2)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new pse(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",n),r(c.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var hT=class extends Hp{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},gm=4,XB=[.125,.215,.35,.446,.526,.582],Ad=20,zA=new hT,$B=new bt,BA=null,xd=(1+Math.sqrt(5))/2,_f=1/xd,QB=[new R(1,1,1),new R(-1,1,1),new R(1,1,-1),new R(-1,1,-1),new R(0,xd,_f),new R(0,xd,-_f),new R(_f,0,xd),new R(-_f,0,xd),new R(xd,_f,0),new R(-xd,_f,0)],KB=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){BA=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=eF(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=JB(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(BA),e.scissorTest=!1,a1(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===fp||e.mapping===mp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),BA=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:qt,minFilter:qt,generateMipmaps:!1,type:ou,format:xn,encoding:Ho,depthBuffer:!1},i=ZB(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=ZB(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=tle(n)),this._blurMaterial=rle(n,e,t)}return i}_compileMaterial(e){let t=new Ii(this._lodPlanes[0],e);this._renderer.compile(t,zA)}_sceneToCubeUV(e,t,r,i){let n=new ls(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor($B),o.toneMapping=kl,o.autoClear=!1;let u=new Vp({name:"PMREM.Background",side:_n,depthWrite:!1,depthTest:!1}),h=new Ii(new Wo,u),d=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy($B),d=!0);for(let f=0;f<6;f++){let m=f%3;m===0?(n.up.set(0,s[f],0),n.lookAt(a[f],0,0)):m===1?(n.up.set(0,0,s[f]),n.lookAt(0,a[f],0)):(n.up.set(0,s[f],0),n.lookAt(0,0,a[f]));let g=this._cubeSize;a1(i,m*g,f>2?g:0,g,g),o.setRenderTarget(i),d&&o.render(h,n),o.render(e,n)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===fp||e.mapping===mp;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=eF()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=JB());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new Ii(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;a1(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,zA)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=QB[(i-1)%QB.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new Ii(this._lodPlanes[i],l),h=l.uniforms,d=this._sizeLods[r]-1,p=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*Ad-1),f=n/p,m=isFinite(n)?1+Math.floor(c*f):Ad;m>Ad&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Ad}`);let g=[],v=0;for(let _=0;_<Ad;++_){let C=_/f,x=Math.exp(-C*C/2);g.push(x),_===0?v+=x:_<m&&(v+=2*x)}for(let _=0;_<g.length;_++)g[_]=g[_]/v;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-r;let w=this._sizeLods[i],b=3*w*(i>y-gm?i-y+gm:0),E=4*(this._cubeSize-w);a1(t,b,E,3*w,2*w),o.setRenderTarget(t),o.render(u,zA)}};function tle(e){let t=[],r=[],i=[],n=e,s=e-gm+1+XB.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-gm?l=XB[a-e+gm-1]:a===0&&(l=0),i.push(l);let c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,m=3,g=2,v=1,y=new Float32Array(m*f*p),w=new Float32Array(g*f*p),b=new Float32Array(v*f*p);for(let _=0;_<p;_++){let C=_%3*2/3-1,x=_>2?0:-1,A=[C,x,0,C+2/3,x,0,C+2/3,x+1,0,C,x,0,C+2/3,x+1,0,C,x+1,0];y.set(A,m*f*_),w.set(d,g*f*_);let T=[_,_,_,_,_,_];b.set(T,v*f*_)}let E=new pt;E.setAttribute("position",new Mt(y,m)),E.setAttribute("uv",new Mt(w,g)),E.setAttribute("faceIndex",new Mt(b,v)),t.push(E),n>gm&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function ZB(e,t,r){let i=new vr(e,t,r);return i.texture.mapping=Iw,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function a1(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function rle(e,t,r){let i=new Float32Array(Ad),n=new R(0,1,0);return new yr({name:"SphericalGaussianBlur",defines:{n:Ad,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:p3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$i,depthTest:!1,depthWrite:!1})}function JB(){return new yr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:p3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$i,depthTest:!1,depthWrite:!1})}function eF(){return new yr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:p3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$i,depthTest:!1,depthWrite:!1})}function p3(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ile(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,c=l===t2||l===r2,u=l===fp||l===mp;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return r===null&&(r=new KB(e)),h=c?r.fromEquirectangular(o,h):r.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{let h=o.image;if(c&&h&&h.height>0||u&&h&&n(h)){r===null&&(r=new KB(e));let d=c?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let l=0,c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function nle(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function sle(e,t,r,i){let n={},s=new WeakMap;function a(h){let d=h.target;d.index!==null&&t.remove(d.index);for(let f in d.attributes)t.remove(d.attributes[f]);d.removeEventListener("dispose",a),delete n[d.id];let p=s.get(d);p&&(t.remove(p),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,r.memory.geometries--}function o(h,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,r.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)t.update(d[f],34962);let p=h.morphAttributes;for(let f in p){let m=p[f];for(let g=0,v=m.length;g<v;g++)t.update(m[g],34962)}}function c(h){let d=[],p=h.index,f=h.attributes.position,m=0;if(p!==null){let y=p.array;m=p.version;for(let w=0,b=y.length;w<b;w+=3){let E=y[w+0],_=y[w+1],C=y[w+2];d.push(E,_,_,C,C,E)}}else{let y=f.array;m=f.version;for(let w=0,b=y.length/3-1;w<b;w+=3){let E=w+0,_=w+1,C=w+2;d.push(E,_,_,C,C,E)}}let g=new(V9(d)?Mm:Y9)(d,1);g.version=m;let v=s.get(h);v&&t.remove(v),s.set(h,g)}function u(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:u}}function ale(e,t,r,i){let n=i.isWebGL2,s;function a(d){s=d}let o,l;function c(d){o=d.type,l=d.bytesPerElement}function u(d,p){e.drawElements(s,p,o,d*l),r.update(p,s,1)}function h(d,p,f){if(f===0)return;let m,g;if(n)m=e,g="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,p,o,d*l,f),r.update(p,s,f)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=h}function ole(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function lle(e,t){return e[0]-t[0]}function cle(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ule(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new It,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,h,d){let p=c.morphTargetInfluences;if(t.isWebGL2===!0){let f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=f!==void 0?f.length:0,g=s.get(u);if(g===void 0||g.count!==m){let w=function(){I.dispose(),s.delete(u),u.removeEventListener("dispose",w)};g!==void 0&&g.texture.dispose();let b=u.morphAttributes.position!==void 0,E=u.morphAttributes.normal!==void 0,_=u.morphAttributes.color!==void 0,C=u.morphAttributes.position||[],x=u.morphAttributes.normal||[],A=u.morphAttributes.color||[],T=0;b===!0&&(T=1),E===!0&&(T=2),_===!0&&(T=3);let M=u.attributes.position.count*T,D=1;M>t.maxTextureSize&&(D=Math.ceil(M/t.maxTextureSize),M=t.maxTextureSize);let P=new Float32Array(M*D*4*m),I=new q9(P,M,D,m);I.type=Yi,I.needsUpdate=!0;let B=T*4;for(let V=0;V<m;V++){let N=C[V],L=x[V],W=A[V],G=M*D*4*V;for(let X=0;X<N.count;X++){let Q=X*B;b===!0&&(a.fromBufferAttribute(N,X),P[G+Q+0]=a.x,P[G+Q+1]=a.y,P[G+Q+2]=a.z,P[G+Q+3]=0),E===!0&&(a.fromBufferAttribute(L,X),P[G+Q+4]=a.x,P[G+Q+5]=a.y,P[G+Q+6]=a.z,P[G+Q+7]=0),_===!0&&(a.fromBufferAttribute(W,X),P[G+Q+8]=a.x,P[G+Q+9]=a.y,P[G+Q+10]=a.z,P[G+Q+11]=W.itemSize===4?a.w:1)}}g={count:m,texture:I,size:new re(M,D)},s.set(u,g),u.addEventListener("dispose",w)}let v=0;for(let w=0;w<p.length;w++)v+=p[w];let y=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(e,"morphTargetBaseInfluence",y),d.getUniforms().setValue(e,"morphTargetInfluences",p),d.getUniforms().setValue(e,"morphTargetsTexture",g.texture,r),d.getUniforms().setValue(e,"morphTargetsTextureSize",g.size)}else{let f=p===void 0?0:p.length,m=i[u.id];if(m===void 0||m.length!==f){m=[];for(let b=0;b<f;b++)m[b]=[b,0];i[u.id]=m}for(let b=0;b<f;b++){let E=m[b];E[0]=b,E[1]=p[b]}m.sort(cle);for(let b=0;b<8;b++)b<f&&m[b][1]?(o[b][0]=m[b][0],o[b][1]=m[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(lle);let g=u.morphAttributes.position,v=u.morphAttributes.normal,y=0;for(let b=0;b<8;b++){let E=o[b],_=E[0],C=E[1];_!==Number.MAX_SAFE_INTEGER&&C?(g&&u.getAttribute("morphTarget"+b)!==g[_]&&u.setAttribute("morphTarget"+b,g[_]),v&&u.getAttribute("morphNormal"+b)!==v[_]&&u.setAttribute("morphNormal"+b,v[_]),n[b]=C,y+=C):(g&&u.hasAttribute("morphTarget"+b)===!0&&u.deleteAttribute("morphTarget"+b),v&&u.hasAttribute("morphNormal"+b)===!0&&u.deleteAttribute("morphNormal"+b),n[b]=0)}let w=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(e,"morphTargetBaseInfluence",w),d.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function hle(e,t,r,i){let n=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,h=t.get(l,u);return n.get(h)!==c&&(t.update(h),n.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),h}function a(){n=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:s,dispose:a}}var Q9=new pi,K9=new q9,Z9=new Kne,J9=new h3,tF=[],rF=[],iF=new Float32Array(16),nF=new Float32Array(9),sF=new Float32Array(4);function Yg(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=tF[n];if(s===void 0&&(s=new Float32Array(n),tF[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function cn(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function un(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function dT(e,t){let r=rF[t];r===void 0&&(r=new Int32Array(t),rF[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function dle(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function ple(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(cn(r,t))return;e.uniform2fv(this.addr,t),un(r,t)}}function fle(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(cn(r,t))return;e.uniform3fv(this.addr,t),un(r,t)}}function mle(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(cn(r,t))return;e.uniform4fv(this.addr,t),un(r,t)}}function gle(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(cn(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),un(r,t)}else{if(cn(r,i))return;sF.set(i),e.uniformMatrix2fv(this.addr,!1,sF),un(r,i)}}function vle(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(cn(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),un(r,t)}else{if(cn(r,i))return;nF.set(i),e.uniformMatrix3fv(this.addr,!1,nF),un(r,i)}}function yle(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(cn(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),un(r,t)}else{if(cn(r,i))return;iF.set(i),e.uniformMatrix4fv(this.addr,!1,iF),un(r,i)}}function wle(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function xle(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(cn(r,t))return;e.uniform2iv(this.addr,t),un(r,t)}}function ble(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(cn(r,t))return;e.uniform3iv(this.addr,t),un(r,t)}}function _le(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(cn(r,t))return;e.uniform4iv(this.addr,t),un(r,t)}}function Sle(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Ele(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(cn(r,t))return;e.uniform2uiv(this.addr,t),un(r,t)}}function Tle(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(cn(r,t))return;e.uniform3uiv(this.addr,t),un(r,t)}}function Cle(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(cn(r,t))return;e.uniform4uiv(this.addr,t),un(r,t)}}function Ale(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||Q9,n)}function Mle(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||Z9,n)}function Ple(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||J9,n)}function Dle(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||K9,n)}function Ile(e){switch(e){case 5126:return dle;case 35664:return ple;case 35665:return fle;case 35666:return mle;case 35674:return gle;case 35675:return vle;case 35676:return yle;case 5124:case 35670:return wle;case 35667:case 35671:return xle;case 35668:case 35672:return ble;case 35669:case 35673:return _le;case 5125:return Sle;case 36294:return Ele;case 36295:return Tle;case 36296:return Cle;case 35678:case 36198:case 36298:case 36306:case 35682:return Ale;case 35679:case 36299:case 36307:return Mle;case 35680:case 36300:case 36308:case 36293:return Ple;case 36289:case 36303:case 36311:case 36292:return Dle}}function Ole(e,t){e.uniform1fv(this.addr,t)}function Rle(e,t){let r=Yg(t,this.size,2);e.uniform2fv(this.addr,r)}function kle(e,t){let r=Yg(t,this.size,3);e.uniform3fv(this.addr,r)}function Lle(e,t){let r=Yg(t,this.size,4);e.uniform4fv(this.addr,r)}function Nle(e,t){let r=Yg(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function zle(e,t){let r=Yg(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Ble(e,t){let r=Yg(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function Fle(e,t){e.uniform1iv(this.addr,t)}function Ule(e,t){e.uniform2iv(this.addr,t)}function jle(e,t){e.uniform3iv(this.addr,t)}function Vle(e,t){e.uniform4iv(this.addr,t)}function Hle(e,t){e.uniform1uiv(this.addr,t)}function Wle(e,t){e.uniform2uiv(this.addr,t)}function Gle(e,t){e.uniform3uiv(this.addr,t)}function qle(e,t){e.uniform4uiv(this.addr,t)}function Yle(e,t,r){let i=this.cache,n=t.length,s=dT(r,n);cn(i,s)||(e.uniform1iv(this.addr,s),un(i,s));for(let a=0;a!==n;++a)r.setTexture2D(t[a]||Q9,s[a])}function Xle(e,t,r){let i=this.cache,n=t.length,s=dT(r,n);cn(i,s)||(e.uniform1iv(this.addr,s),un(i,s));for(let a=0;a!==n;++a)r.setTexture3D(t[a]||Z9,s[a])}function $le(e,t,r){let i=this.cache,n=t.length,s=dT(r,n);cn(i,s)||(e.uniform1iv(this.addr,s),un(i,s));for(let a=0;a!==n;++a)r.setTextureCube(t[a]||J9,s[a])}function Qle(e,t,r){let i=this.cache,n=t.length,s=dT(r,n);cn(i,s)||(e.uniform1iv(this.addr,s),un(i,s));for(let a=0;a!==n;++a)r.setTexture2DArray(t[a]||K9,s[a])}function Kle(e){switch(e){case 5126:return Ole;case 35664:return Rle;case 35665:return kle;case 35666:return Lle;case 35674:return Nle;case 35675:return zle;case 35676:return Ble;case 5124:case 35670:return Fle;case 35667:case 35671:return Ule;case 35668:case 35672:return jle;case 35669:case 35673:return Vle;case 5125:return Hle;case 36294:return Wle;case 36295:return Gle;case 36296:return qle;case 35678:case 36198:case 36298:case 36306:case 35682:return Yle;case 35679:case 36299:case 36307:return Xle;case 35680:case 36300:case 36308:case 36293:return $le;case 36289:case 36303:case 36311:case 36292:return Qle}}var Zle=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Ile(t.type)}},Jle=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=Kle(t.type)}},ece=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},FA=/(\w+)(\])?(\[|\.)?/g;function aF(e,t){e.seq.push(t),e.map[t.id]=t}function tce(e,t,r){let i=e.name,n=i.length;for(FA.lastIndex=0;;){let s=FA.exec(i),a=FA.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===n){aF(r,c===void 0?new Zle(o,e,t):new Jle(o,e,t));break}else{let u=r.map[o];u===void 0&&(u=new ece(o),aF(r,u)),r=u}}}var Vb=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);tce(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function oF(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var rce=0;function ice(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function nce(e){switch(e){case Ho:return["Linear","( value )"];case jt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function lF(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+ice(e.getShaderSource(t),a)}else return n}function sce(e,t){let r=nce(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function ace(e,t){let r;switch(t){case dne:r="Linear";break;case pne:r="Reinhard";break;case fne:r="OptimizedCineon";break;case mne:r="ACESFilmic";break;case gne:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function oce(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ty).join(`
`)}function lce(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function cce(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function Ty(e){return e!==""}function cF(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function uF(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var uce=/^[ \t]*#include +<([\w\d./]+)>/gm;function o2(e){return e.replace(uce,hce)}function hce(e,t){let r=Wt[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return o2(r)}var dce=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hF(e){return e.replace(dce,pce)}function pce(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function dF(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function fce(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===a3?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===Wie?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Ey&&(t="SHADOWMAP_TYPE_VSM"),t}function mce(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case fp:case mp:t="ENVMAP_TYPE_CUBE";break;case Iw:t="ENVMAP_TYPE_CUBE_UV";break}return t}function gce(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case mp:t="ENVMAP_MODE_REFRACTION";break}return t}function vce(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case k9:t="ENVMAP_BLENDING_MULTIPLY";break;case une:t="ENVMAP_BLENDING_MIX";break;case hne:t="ENVMAP_BLENDING_ADD";break}return t}function yce(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function wce(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=fce(r),c=mce(r),u=gce(r),h=vce(r),d=yce(r),p=r.isWebGL2?"":oce(r),f=lce(s),m=n.createProgram(),g,v,y=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=[f].filter(Ty).join(`
`),g.length>0&&(g+=`
`),v=[p,f].filter(Ty).join(`
`),v.length>0&&(v+=`
`)):(g=[dF(r),"#define SHADER_NAME "+r.shaderName,f,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ty).join(`
`),v=[p,dF(r),"#define SHADER_NAME "+r.shaderName,f,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==kl?"#define TONE_MAPPING":"",r.toneMapping!==kl?Wt.tonemapping_pars_fragment:"",r.toneMapping!==kl?ace("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Wt.encodings_pars_fragment,sce("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Ty).join(`
`)),a=o2(a),a=cF(a,r),a=uF(a,r),o=o2(o),o=cF(o,r),o=uF(o,r),a=hF(a),o=hF(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",r.glslVersion===NB?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===NB?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let w=y+g+a,b=y+v+o,E=oF(n,35633,w),_=oF(n,35632,b);if(n.attachShader(m,E),n.attachShader(m,_),r.index0AttributeName!==void 0?n.bindAttribLocation(m,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),e.debug.checkShaderErrors){let A=n.getProgramInfoLog(m).trim(),T=n.getShaderInfoLog(E).trim(),M=n.getShaderInfoLog(_).trim(),D=!0,P=!0;if(n.getProgramParameter(m,35714)===!1){D=!1;let I=lF(n,E,"vertex"),B=lF(n,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+A+`
`+I+`
`+B)}else A!==""?console.warn("THREE.WebGLProgram: Program Info Log:",A):(T===""||M==="")&&(P=!1);P&&(this.diagnostics={runnable:D,programLog:A,vertexShader:{log:T,prefix:g},fragmentShader:{log:M,prefix:v}})}n.deleteShader(E),n.deleteShader(_);let C;this.getUniforms=function(){return C===void 0&&(C=new Vb(n,m)),C};let x;return this.getAttributes=function(){return x===void 0&&(x=cce(n,m)),x},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=rce++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=E,this.fragmentShader=_,this}var xce=0,bce=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new _ce(e),t.set(e,r)),r}},_ce=class{constructor(e){this.id=xce++,this.code=e,this.usedTimes=0}};function Sce(e,t,r,i,n,s,a){let o=new u3,l=new bce,c=[],u=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.vertexTextures,p=n.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(x,A,T,M,D){let P=M.fog,I=D.geometry,B=x.isMeshStandardMaterial?M.environment:null,V=(x.isMeshStandardMaterial?r:t).get(x.envMap||B),N=V&&V.mapping===Iw?V.image.height:null,L=f[x.type];x.precision!==null&&(p=n.getMaxPrecision(x.precision),p!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",p,"instead."));let W=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,G=W!==void 0?W.length:0,X=0;I.morphAttributes.position!==void 0&&(X=1),I.morphAttributes.normal!==void 0&&(X=2),I.morphAttributes.color!==void 0&&(X=3);let Q,ie,J,se;if(L){let de=wl[L];Q=de.vertexShader,ie=de.fragmentShader}else Q=x.vertexShader,ie=x.fragmentShader,l.update(x),J=l.getVertexShaderID(x),se=l.getFragmentShaderID(x);let ee=e.getRenderTarget(),ue=x.alphaTest>0,oe=x.clearcoat>0,le=x.iridescence>0;return{isWebGL2:u,shaderID:L,shaderName:x.type,vertexShader:Q,fragmentShader:ie,defines:x.defines,customVertexShaderID:J,customFragmentShaderID:se,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:p,instancing:D.isInstancedMesh===!0,instancingColor:D.isInstancedMesh===!0&&D.instanceColor!==null,supportsVertexTextures:d,outputEncoding:ee===null?e.outputEncoding:ee.isXRRenderTarget===!0?ee.texture.encoding:Ho,map:!!x.map,matcap:!!x.matcap,envMap:!!V,envMapMode:V&&V.mapping,envMapCubeUVHeight:N,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===Rne,tangentSpaceNormalMap:x.normalMapType===One,decodeVideoTexture:!!x.map&&x.map.isVideoTexture===!0&&x.map.encoding===jt,clearcoat:oe,clearcoatMap:oe&&!!x.clearcoatMap,clearcoatRoughnessMap:oe&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:oe&&!!x.clearcoatNormalMap,iridescence:le,iridescenceMap:le&&!!x.iridescenceMap,iridescenceThicknessMap:le&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:x.transparent===!1&&x.blending===Xd,alphaMap:!!x.alphaMap,alphaTest:ue,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!I.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!I.attributes.color&&I.attributes.color.itemSize===4,vertexUvs:!!x.map||!!x.bumpMap||!!x.normalMap||!!x.specularMap||!!x.alphaMap||!!x.emissiveMap||!!x.roughnessMap||!!x.metalnessMap||!!x.clearcoatMap||!!x.clearcoatRoughnessMap||!!x.clearcoatNormalMap||!!x.iridescenceMap||!!x.iridescenceThicknessMap||!!x.displacementMap||!!x.transmissionMap||!!x.thicknessMap||!!x.specularIntensityMap||!!x.specularColorMap||!!x.sheenColorMap||!!x.sheenRoughnessMap,uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap)&&!!x.displacementMap,fog:!!P,useFog:x.fog===!0,fogExp2:P&&P.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:h,skinning:D.isSkinnedMesh===!0,morphTargets:I.morphAttributes.position!==void 0,morphNormals:I.morphAttributes.normal!==void 0,morphColors:I.morphAttributes.color!==void 0,morphTargetsCount:G,morphTextureStride:X,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:x.dithering,shadowMapEnabled:e.shadowMap.enabled&&T.length>0,shadowMapType:e.shadowMap.type,toneMapping:x.toneMapped?e.toneMapping:kl,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===ia,flipSided:x.side===_n,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}}function g(x){let A=[];if(x.shaderID?A.push(x.shaderID):(A.push(x.customVertexShaderID),A.push(x.customFragmentShaderID)),x.defines!==void 0)for(let T in x.defines)A.push(T),A.push(x.defines[T]);return x.isRawShaderMaterial===!1&&(v(A,x),y(A,x),A.push(e.outputEncoding)),A.push(x.customProgramCacheKey),A.join()}function v(x,A){x.push(A.precision),x.push(A.outputEncoding),x.push(A.envMapMode),x.push(A.envMapCubeUVHeight),x.push(A.combine),x.push(A.vertexUvs),x.push(A.fogExp2),x.push(A.sizeAttenuation),x.push(A.morphTargetsCount),x.push(A.morphAttributeCount),x.push(A.numDirLights),x.push(A.numPointLights),x.push(A.numSpotLights),x.push(A.numSpotLightMaps),x.push(A.numHemiLights),x.push(A.numRectAreaLights),x.push(A.numDirLightShadows),x.push(A.numPointLightShadows),x.push(A.numSpotLightShadows),x.push(A.numSpotLightShadowsWithMaps),x.push(A.shadowMapType),x.push(A.toneMapping),x.push(A.numClippingPlanes),x.push(A.numClipIntersection),x.push(A.depthPacking)}function y(x,A){o.disableAll(),A.isWebGL2&&o.enable(0),A.supportsVertexTextures&&o.enable(1),A.instancing&&o.enable(2),A.instancingColor&&o.enable(3),A.map&&o.enable(4),A.matcap&&o.enable(5),A.envMap&&o.enable(6),A.lightMap&&o.enable(7),A.aoMap&&o.enable(8),A.emissiveMap&&o.enable(9),A.bumpMap&&o.enable(10),A.normalMap&&o.enable(11),A.objectSpaceNormalMap&&o.enable(12),A.tangentSpaceNormalMap&&o.enable(13),A.clearcoat&&o.enable(14),A.clearcoatMap&&o.enable(15),A.clearcoatRoughnessMap&&o.enable(16),A.clearcoatNormalMap&&o.enable(17),A.iridescence&&o.enable(18),A.iridescenceMap&&o.enable(19),A.iridescenceThicknessMap&&o.enable(20),A.displacementMap&&o.enable(21),A.specularMap&&o.enable(22),A.roughnessMap&&o.enable(23),A.metalnessMap&&o.enable(24),A.gradientMap&&o.enable(25),A.alphaMap&&o.enable(26),A.alphaTest&&o.enable(27),A.vertexColors&&o.enable(28),A.vertexAlphas&&o.enable(29),A.vertexUvs&&o.enable(30),A.vertexTangents&&o.enable(31),A.uvsVertexOnly&&o.enable(32),x.push(o.mask),o.disableAll(),A.fog&&o.enable(0),A.useFog&&o.enable(1),A.flatShading&&o.enable(2),A.logarithmicDepthBuffer&&o.enable(3),A.skinning&&o.enable(4),A.morphTargets&&o.enable(5),A.morphNormals&&o.enable(6),A.morphColors&&o.enable(7),A.premultipliedAlpha&&o.enable(8),A.shadowMapEnabled&&o.enable(9),A.physicallyCorrectLights&&o.enable(10),A.doubleSided&&o.enable(11),A.flipSided&&o.enable(12),A.useDepthPacking&&o.enable(13),A.dithering&&o.enable(14),A.specularIntensityMap&&o.enable(15),A.specularColorMap&&o.enable(16),A.transmission&&o.enable(17),A.transmissionMap&&o.enable(18),A.thicknessMap&&o.enable(19),A.sheen&&o.enable(20),A.sheenColorMap&&o.enable(21),A.sheenRoughnessMap&&o.enable(22),A.decodeVideoTexture&&o.enable(23),A.opaque&&o.enable(24),x.push(o.mask)}function w(x){let A=f[x.type],T;if(A){let M=wl[A];T=qg.clone(M.uniforms)}else T=x.uniforms;return T}function b(x,A){let T;for(let M=0,D=c.length;M<D;M++){let P=c[M];if(P.cacheKey===A){T=P,++T.usedTimes;break}}return T===void 0&&(T=new wce(e,A,x,s),c.push(T)),T}function E(x){if(--x.usedTimes===0){let A=c.indexOf(x);c[A]=c[c.length-1],c.pop(),x.destroy()}}function _(x){l.remove(x)}function C(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:w,acquireProgram:b,releaseProgram:E,releaseShaderCache:_,programs:c,dispose:C}}function Ece(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function Tce(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function pF(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function fF(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(h,d,p,f,m,g){let v=e[t];return v===void 0?(v={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:m,group:g},e[t]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=p,v.groupOrder=f,v.renderOrder=h.renderOrder,v.z=m,v.group=g),t++,v}function o(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.push(v):p.transparent===!0?n.push(v):r.push(v)}function l(h,d,p,f,m,g){let v=a(h,d,p,f,m,g);p.transmission>0?i.unshift(v):p.transparent===!0?n.unshift(v):r.unshift(v)}function c(h,d){r.length>1&&r.sort(h||Tce),i.length>1&&i.sort(d||pF),n.length>1&&n.sort(d||pF)}function u(){for(let h=t,d=e.length;h<d;h++){let p=e[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:u,sort:c}}function Cce(){let e=new WeakMap;function t(i,n){let s=e.get(i),a;return s===void 0?(a=new fF,e.set(i,[a])):n>=s.length?(a=new fF,s.push(a)):a=s[n],a}function r(){e=new WeakMap}return{get:t,dispose:r}}function Ace(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new R,color:new bt};break;case"SpotLight":r={position:new R,direction:new R,color:new bt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new R,color:new bt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new R,skyColor:new bt,groundColor:new bt};break;case"RectAreaLight":r={color:new bt,position:new R,halfWidth:new R,halfHeight:new R};break}return e[t.id]=r,r}}}function Mce(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var Pce=0;function Dce(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Ice(e,t){let r=new Ace,i=Mce(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)n.probe.push(new R);let s=new R,a=new Be,o=new Be;function l(u,h){let d=0,p=0,f=0;for(let M=0;M<9;M++)n.probe[M].set(0,0,0);let m=0,g=0,v=0,y=0,w=0,b=0,E=0,_=0,C=0,x=0;u.sort(Dce);let A=h!==!0?Math.PI:1;for(let M=0,D=u.length;M<D;M++){let P=u[M],I=P.color,B=P.intensity,V=P.distance,N=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)d+=I.r*B*A,p+=I.g*B*A,f+=I.b*B*A;else if(P.isLightProbe)for(let L=0;L<9;L++)n.probe[L].addScaledVector(P.sh.coefficients[L],B);else if(P.isDirectionalLight){let L=r.get(P);if(L.color.copy(P.color).multiplyScalar(P.intensity*A),P.castShadow){let W=P.shadow,G=i.get(P);G.shadowBias=W.bias,G.shadowNormalBias=W.normalBias,G.shadowRadius=W.radius,G.shadowMapSize=W.mapSize,n.directionalShadow[m]=G,n.directionalShadowMap[m]=N,n.directionalShadowMatrix[m]=P.shadow.matrix,b++}n.directional[m]=L,m++}else if(P.isSpotLight){let L=r.get(P);L.position.setFromMatrixPosition(P.matrixWorld),L.color.copy(I).multiplyScalar(B*A),L.distance=V,L.coneCos=Math.cos(P.angle),L.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),L.decay=P.decay,n.spot[v]=L;let W=P.shadow;if(P.map&&(n.spotLightMap[C]=P.map,C++,W.updateMatrices(P),P.castShadow&&x++),n.spotLightMatrix[v]=W.matrix,P.castShadow){let G=i.get(P);G.shadowBias=W.bias,G.shadowNormalBias=W.normalBias,G.shadowRadius=W.radius,G.shadowMapSize=W.mapSize,n.spotShadow[v]=G,n.spotShadowMap[v]=N,_++}v++}else if(P.isRectAreaLight){let L=r.get(P);L.color.copy(I).multiplyScalar(B),L.halfWidth.set(P.width*.5,0,0),L.halfHeight.set(0,P.height*.5,0),n.rectArea[y]=L,y++}else if(P.isPointLight){let L=r.get(P);if(L.color.copy(P.color).multiplyScalar(P.intensity*A),L.distance=P.distance,L.decay=P.decay,P.castShadow){let W=P.shadow,G=i.get(P);G.shadowBias=W.bias,G.shadowNormalBias=W.normalBias,G.shadowRadius=W.radius,G.shadowMapSize=W.mapSize,G.shadowCameraNear=W.camera.near,G.shadowCameraFar=W.camera.far,n.pointShadow[g]=G,n.pointShadowMap[g]=N,n.pointShadowMatrix[g]=P.shadow.matrix,E++}n.point[g]=L,g++}else if(P.isHemisphereLight){let L=r.get(P);L.skyColor.copy(P.color).multiplyScalar(B*A),L.groundColor.copy(P.groundColor).multiplyScalar(B*A),n.hemi[w]=L,w++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=qe.LTC_FLOAT_1,n.rectAreaLTC2=qe.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=qe.LTC_HALF_1,n.rectAreaLTC2=qe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=f;let T=n.hash;(T.directionalLength!==m||T.pointLength!==g||T.spotLength!==v||T.rectAreaLength!==y||T.hemiLength!==w||T.numDirectionalShadows!==b||T.numPointShadows!==E||T.numSpotShadows!==_||T.numSpotMaps!==C)&&(n.directional.length=m,n.spot.length=v,n.rectArea.length=y,n.point.length=g,n.hemi.length=w,n.directionalShadow.length=b,n.directionalShadowMap.length=b,n.pointShadow.length=E,n.pointShadowMap.length=E,n.spotShadow.length=_,n.spotShadowMap.length=_,n.directionalShadowMatrix.length=b,n.pointShadowMatrix.length=E,n.spotLightMatrix.length=_+C-x,n.spotLightMap.length=C,n.numSpotLightShadowsWithMaps=x,T.directionalLength=m,T.pointLength=g,T.spotLength=v,T.rectAreaLength=y,T.hemiLength=w,T.numDirectionalShadows=b,T.numPointShadows=E,T.numSpotShadows=_,T.numSpotMaps=C,n.version=Pce++)}function c(u,h){let d=0,p=0,f=0,m=0,g=0,v=h.matrixWorldInverse;for(let y=0,w=u.length;y<w;y++){let b=u[y];if(b.isDirectionalLight){let E=n.directional[d];E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),d++}else if(b.isSpotLight){let E=n.spot[f];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),f++}else if(b.isRectAreaLight){let E=n.rectArea[m];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),o.identity(),a.copy(b.matrixWorld),a.premultiply(v),o.extractRotation(a),E.halfWidth.set(b.width*.5,0,0),E.halfHeight.set(0,b.height*.5,0),E.halfWidth.applyMatrix4(o),E.halfHeight.applyMatrix4(o),m++}else if(b.isPointLight){let E=n.point[p];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),p++}else if(b.isHemisphereLight){let E=n.hemi[g];E.direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:n}}function mF(e,t){let r=new Ice(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(u){i.push(u)}function o(u){n.push(u)}function l(u){r.setup(i,u)}function c(u){r.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function Oce(e,t){let r=new WeakMap;function i(s,a=0){let o=r.get(s),l;return o===void 0?(l=new mF(e,t),r.set(s,[l])):a>=o.length?(l=new mF(e,t),o.push(l)):l=o[a],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var e8=class extends Ow{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=yu,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Rce=class extends Ow{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new R,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},kce=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Lce=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Nce(e,t,r){let i=new d3,n=new re,s=new re,a=new It,o=new e8({depthPacking:U9}),l=new Rce,c={},u=r.maxTextureSize,h={[Vo]:_n,[_n]:Vo,[ia]:ia},d=new yr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new re},radius:{value:4}},vertexShader:kce,fragmentShader:Lce}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new pt;f.setAttribute("position",new Mt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new Ii(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=a3,this.render=function(b,E,_){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;let C=e.getRenderTarget(),x=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),T=e.state;T.setBlending($i),T.buffers.color.setClear(1,1,1,1),T.buffers.depth.setTest(!0),T.setScissorTest(!1);for(let M=0,D=b.length;M<D;M++){let P=b[M],I=P.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",P,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;n.copy(I.mapSize);let B=I.getFrameExtents();if(n.multiply(B),s.copy(I.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/B.x),n.x=s.x*B.x,I.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/B.y),n.y=s.y*B.y,I.mapSize.y=s.y)),I.map===null){let N=this.type!==Ey?{minFilter:_r,magFilter:_r}:{};I.map=new vr(n.x,n.y,N),I.map.texture.name=P.name+".shadowMap",I.camera.updateProjectionMatrix()}e.setRenderTarget(I.map),e.clear();let V=I.getViewportCount();for(let N=0;N<V;N++){let L=I.getViewport(N);a.set(s.x*L.x,s.y*L.y,s.x*L.z,s.y*L.w),T.viewport(a),I.updateMatrices(P,N),i=I.getFrustum(),w(E,_,I.camera,P,this.type)}I.isPointLightShadow!==!0&&this.type===Ey&&v(I,_),I.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(C,x,A)};function v(b,E){let _=t.update(m);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,p.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new vr(n.x,n.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(E,null,_,d,m,null),p.uniforms.shadow_pass.value=b.mapPass.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(E,null,_,p,m,null)}function y(b,E,_,C,x,A){let T=null,M=_.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(M!==void 0)T=M;else if(T=_.isPointLight===!0?l:o,e.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){let D=T.uuid,P=E.uuid,I=c[D];I===void 0&&(I={},c[D]=I);let B=I[P];B===void 0&&(B=T.clone(),I[P]=B),T=B}return T.visible=E.visible,T.wireframe=E.wireframe,A===Ey?T.side=E.shadowSide!==null?E.shadowSide:E.side:T.side=E.shadowSide!==null?E.shadowSide:h[E.side],T.alphaMap=E.alphaMap,T.alphaTest=E.alphaTest,T.map=E.map,T.clipShadows=E.clipShadows,T.clippingPlanes=E.clippingPlanes,T.clipIntersection=E.clipIntersection,T.displacementMap=E.displacementMap,T.displacementScale=E.displacementScale,T.displacementBias=E.displacementBias,T.wireframeLinewidth=E.wireframeLinewidth,T.linewidth=E.linewidth,_.isPointLight===!0&&T.isMeshDistanceMaterial===!0&&(T.referencePosition.setFromMatrixPosition(_.matrixWorld),T.nearDistance=C,T.farDistance=x),T}function w(b,E,_,C,x){if(b.visible===!1)return;if(b.layers.test(E.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&x===Ey)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(_.matrixWorldInverse,b.matrixWorld);let T=t.update(b),M=b.material;if(Array.isArray(M)){let D=T.groups;for(let P=0,I=D.length;P<I;P++){let B=D[P],V=M[B.materialIndex];if(V&&V.visible){let N=y(b,V,C,_.near,_.far,x);e.renderBufferDirect(_,null,T,N,b,B)}}}else if(M.visible){let D=y(b,M,C,_.near,_.far,x);e.renderBufferDirect(_,null,T,D,b,null)}}let A=b.children;for(let T=0,M=A.length;T<M;T++)w(A[T],E,_,C,x)}}function zce(e,t,r){let i=r.isWebGL2;function n(){let ae=!1,Pe=new It,Ne=null,Ke=new It(0,0,0,0);return{setMask:function(yt){Ne!==yt&&!ae&&(e.colorMask(yt,yt,yt,yt),Ne=yt)},setLocked:function(yt){ae=yt},setClear:function(yt,Kt,Ar,Ci,ws){ws===!0&&(yt*=Ci,Kt*=Ci,Ar*=Ci),Pe.set(yt,Kt,Ar,Ci),Ke.equals(Pe)===!1&&(e.clearColor(yt,Kt,Ar,Ci),Ke.copy(Pe))},reset:function(){ae=!1,Ne=null,Ke.set(-1,0,0,0)}}}function s(){let ae=!1,Pe=null,Ne=null,Ke=null;return{setTest:function(yt){yt?ue(2929):oe(2929)},setMask:function(yt){Pe!==yt&&!ae&&(e.depthMask(yt),Pe=yt)},setFunc:function(yt){if(Ne!==yt){switch(yt){case ine:e.depthFunc(512);break;case nne:e.depthFunc(519);break;case sne:e.depthFunc(513);break;case e2:e.depthFunc(515);break;case ane:e.depthFunc(514);break;case one:e.depthFunc(518);break;case lne:e.depthFunc(516);break;case cne:e.depthFunc(517);break;default:e.depthFunc(515)}Ne=yt}},setLocked:function(yt){ae=yt},setClear:function(yt){Ke!==yt&&(e.clearDepth(yt),Ke=yt)},reset:function(){ae=!1,Pe=null,Ne=null,Ke=null}}}function a(){let ae=!1,Pe=null,Ne=null,Ke=null,yt=null,Kt=null,Ar=null,Ci=null,ws=null;return{setTest:function(Mr){ae||(Mr?ue(2960):oe(2960))},setMask:function(Mr){Pe!==Mr&&!ae&&(e.stencilMask(Mr),Pe=Mr)},setFunc:function(Mr,In,On){(Ne!==Mr||Ke!==In||yt!==On)&&(e.stencilFunc(Mr,In,On),Ne=Mr,Ke=In,yt=On)},setOp:function(Mr,In,On){(Kt!==Mr||Ar!==In||Ci!==On)&&(e.stencilOp(Mr,In,On),Kt=Mr,Ar=In,Ci=On)},setLocked:function(Mr){ae=Mr},setClear:function(Mr){ws!==Mr&&(e.clearStencil(Mr),ws=Mr)},reset:function(){ae=!1,Pe=null,Ne=null,Ke=null,yt=null,Kt=null,Ar=null,Ci=null,ws=null}}}let o=new n,l=new s,c=new a,u=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,w=null,b=null,E=null,_=null,C=null,x=null,A=!1,T=null,M=null,D=null,P=null,I=null,B=e.getParameter(35661),V=!1,N=0,L=e.getParameter(7938);L.indexOf("WebGL")!==-1?(N=parseFloat(/^WebGL (\d)/.exec(L)[1]),V=N>=1):L.indexOf("OpenGL ES")!==-1&&(N=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),V=N>=2);let W=null,G={},X=e.getParameter(3088),Q=e.getParameter(2978),ie=new It().fromArray(X),J=new It().fromArray(Q);function se(ae,Pe,Ne){let Ke=new Uint8Array(4),yt=e.createTexture();e.bindTexture(ae,yt),e.texParameteri(ae,10241,9728),e.texParameteri(ae,10240,9728);for(let Kt=0;Kt<Ne;Kt++)e.texImage2D(Pe+Kt,0,6408,1,1,0,6408,5121,Ke);return yt}let ee={};ee[3553]=se(3553,3553,1),ee[34067]=se(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ue(2929),l.setFunc(e2),Ye(!1),$e(aB),ue(2884),Le($i);function ue(ae){d[ae]!==!0&&(e.enable(ae),d[ae]=!0)}function oe(ae){d[ae]!==!1&&(e.disable(ae),d[ae]=!1)}function le(ae,Pe){return p[ae]!==Pe?(e.bindFramebuffer(ae,Pe),p[ae]=Pe,i&&(ae===36009&&(p[36160]=Pe),ae===36160&&(p[36009]=Pe)),!0):!1}function de(ae,Pe){let Ne=m,Ke=!1;if(ae)if(Ne=f.get(Pe),Ne===void 0&&(Ne=[],f.set(Pe,Ne)),ae.isWebGLMultipleRenderTargets){let yt=ae.texture;if(Ne.length!==yt.length||Ne[0]!==36064){for(let Kt=0,Ar=yt.length;Kt<Ar;Kt++)Ne[Kt]=36064+Kt;Ne.length=yt.length,Ke=!0}}else Ne[0]!==36064&&(Ne[0]=36064,Ke=!0);else Ne[0]!==1029&&(Ne[0]=1029,Ke=!0);Ke&&(r.isWebGL2?e.drawBuffers(Ne):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ne))}function xe(ae){return g!==ae?(e.useProgram(ae),g=ae,!0):!1}let _e={[Wf]:32774,[qie]:32778,[Yie]:32779};if(i)_e[uB]=32775,_e[hB]=32776;else{let ae=t.get("EXT_blend_minmax");ae!==null&&(_e[uB]=ae.MIN_EXT,_e[hB]=ae.MAX_EXT)}let Se={[Xie]:0,[$ie]:1,[Qie]:768,[O9]:770,[rne]:776,[ene]:774,[Zie]:772,[Kie]:769,[R9]:771,[tne]:775,[Jie]:773};function Le(ae,Pe,Ne,Ke,yt,Kt,Ar,Ci){if(ae===$i){v===!0&&(oe(3042),v=!1);return}if(v===!1&&(ue(3042),v=!0),ae!==Gie){if(ae!==y||Ci!==A){if((w!==Wf||_!==Wf)&&(e.blendEquation(32774),w=Wf,_=Wf),Ci)switch(ae){case Xd:e.blendFuncSeparate(1,771,1,771);break;case oB:e.blendFunc(1,1);break;case lB:e.blendFuncSeparate(0,769,0,1);break;case cB:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}else switch(ae){case Xd:e.blendFuncSeparate(770,771,1,771);break;case oB:e.blendFunc(770,1);break;case lB:e.blendFuncSeparate(0,769,0,1);break;case cB:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}b=null,E=null,C=null,x=null,y=ae,A=Ci}return}yt=yt||Pe,Kt=Kt||Ne,Ar=Ar||Ke,(Pe!==w||yt!==_)&&(e.blendEquationSeparate(_e[Pe],_e[yt]),w=Pe,_=yt),(Ne!==b||Ke!==E||Kt!==C||Ar!==x)&&(e.blendFuncSeparate(Se[Ne],Se[Ke],Se[Kt],Se[Ar]),b=Ne,E=Ke,C=Kt,x=Ar),y=ae,A=!1}function Oe(ae,Pe){ae.side===ia?oe(2884):ue(2884);let Ne=ae.side===_n;Pe&&(Ne=!Ne),Ye(Ne),ae.blending===Xd&&ae.transparent===!1?Le($i):Le(ae.blending,ae.blendEquation,ae.blendSrc,ae.blendDst,ae.blendEquationAlpha,ae.blendSrcAlpha,ae.blendDstAlpha,ae.premultipliedAlpha),l.setFunc(ae.depthFunc),l.setTest(ae.depthTest),l.setMask(ae.depthWrite),o.setMask(ae.colorWrite);let Ke=ae.stencilWrite;c.setTest(Ke),Ke&&(c.setMask(ae.stencilWriteMask),c.setFunc(ae.stencilFunc,ae.stencilRef,ae.stencilFuncMask),c.setOp(ae.stencilFail,ae.stencilZFail,ae.stencilZPass)),je(ae.polygonOffset,ae.polygonOffsetFactor,ae.polygonOffsetUnits),ae.alphaToCoverage===!0?ue(32926):oe(32926)}function Ye(ae){T!==ae&&(ae?e.frontFace(2304):e.frontFace(2305),T=ae)}function $e(ae){ae!==Vie?(ue(2884),ae!==M&&(ae===aB?e.cullFace(1029):ae===Hie?e.cullFace(1028):e.cullFace(1032))):oe(2884),M=ae}function He(ae){ae!==D&&(V&&e.lineWidth(ae),D=ae)}function je(ae,Pe,Ne){ae?(ue(32823),(P!==Pe||I!==Ne)&&(e.polygonOffset(Pe,Ne),P=Pe,I=Ne)):oe(32823)}function lt(ae){ae?ue(3089):oe(3089)}function pe(ae){ae===void 0&&(ae=33984+B-1),W!==ae&&(e.activeTexture(ae),W=ae)}function q(ae,Pe,Ne){Ne===void 0&&(W===null?Ne=33984+B-1:Ne=W);let Ke=G[Ne];Ke===void 0&&(Ke={type:void 0,texture:void 0},G[Ne]=Ke),(Ke.type!==ae||Ke.texture!==Pe)&&(W!==Ne&&(e.activeTexture(Ne),W=Ne),e.bindTexture(ae,Pe||ee[ae]),Ke.type=ae,Ke.texture=Pe)}function j(){let ae=G[W];ae!==void 0&&ae.type!==void 0&&(e.bindTexture(ae.type,null),ae.type=void 0,ae.texture=void 0)}function ve(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ze(){try{e.compressedTexImage3D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function U(){try{e.texSubImage2D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Fe(){try{e.texSubImage3D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function he(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ee(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function me(){try{e.texStorage2D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Je(){try{e.texStorage3D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function et(){try{e.texImage2D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function at(){try{e.texImage3D.apply(e,arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function gt(ae){ie.equals(ae)===!1&&(e.scissor(ae.x,ae.y,ae.z,ae.w),ie.copy(ae))}function ft(ae){J.equals(ae)===!1&&(e.viewport(ae.x,ae.y,ae.z,ae.w),J.copy(ae))}function mt(ae,Pe){let Ne=h.get(Pe);Ne===void 0&&(Ne=new WeakMap,h.set(Pe,Ne));let Ke=Ne.get(ae);Ke===void 0&&(Ke=e.getUniformBlockIndex(Pe,ae.name),Ne.set(ae,Ke))}function Er(ae,Pe){let Ne=h.get(Pe).get(ae);u.get(Pe)!==Ne&&(e.uniformBlockBinding(Pe,Ne,ae.__bindingPointIndex),u.set(Pe,Ne))}function Xr(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},W=null,G={},p={},f=new WeakMap,m=[],g=null,v=!1,y=null,w=null,b=null,E=null,_=null,C=null,x=null,A=!1,T=null,M=null,D=null,P=null,I=null,ie.set(0,0,e.canvas.width,e.canvas.height),J.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ue,disable:oe,bindFramebuffer:le,drawBuffers:de,useProgram:xe,setBlending:Le,setMaterial:Oe,setFlipSided:Ye,setCullFace:$e,setLineWidth:He,setPolygonOffset:je,setScissorTest:lt,activeTexture:pe,bindTexture:q,unbindTexture:j,compressedTexImage2D:ve,compressedTexImage3D:ze,texImage2D:et,texImage3D:at,updateUBOMapping:mt,uniformBlockBinding:Er,texStorage2D:me,texStorage3D:Je,texSubImage2D:U,texSubImage3D:Fe,compressedTexSubImage2D:he,compressedTexSubImage3D:Ee,scissor:gt,viewport:ft,reset:Xr}}function Bce(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,h=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(q,j){return v?new OffscreenCanvas(q,j):N0("canvas")}function w(q,j,ve,ze){let U=1;if((q.width>ze||q.height>ze)&&(U=ze/Math.max(q.width,q.height)),U<1||j===!0)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap){let Fe=j?J_:Math.floor,he=Fe(U*q.width),Ee=Fe(U*q.height);m===void 0&&(m=y(he,Ee));let me=ve?y(he,Ee):m;return me.width=he,me.height=Ee,me.getContext("2d").drawImage(q,0,0,he,Ee),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+he+"x"+Ee+")."),me}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),q;return q}function b(q){return a2(q.width)&&a2(q.height)}function E(q){return o?!1:q.wrapS!==ti||q.wrapT!==ti||q.minFilter!==_r&&q.minFilter!==qt}function _(q,j){return q.generateMipmaps&&j&&q.minFilter!==_r&&q.minFilter!==qt}function C(q){e.generateMipmap(q)}function x(q,j,ve,ze,U=!1){if(o===!1)return j;if(q!==null){if(e[q]!==void 0)return e[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let Fe=j;return j===6403&&(ve===5126&&(Fe=33326),ve===5131&&(Fe=33325),ve===5121&&(Fe=33321)),j===33319&&(ve===5126&&(Fe=33328),ve===5131&&(Fe=33327),ve===5121&&(Fe=33323)),j===6408&&(ve===5126&&(Fe=34836),ve===5131&&(Fe=34842),ve===5121&&(Fe=ze===jt&&U===!1?35907:32856),ve===32819&&(Fe=32854),ve===32820&&(Fe=32855)),(Fe===33325||Fe===33326||Fe===33327||Fe===33328||Fe===34842||Fe===34836)&&t.get("EXT_color_buffer_float"),Fe}function A(q,j,ve){return _(q,ve)===!0||q.isFramebufferTexture&&q.minFilter!==_r&&q.minFilter!==qt?Math.log2(Math.max(j.width,j.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?j.mipmaps.length:1}function T(q){return q===_r||q===dB||q===cA?9728:9729}function M(q){let j=q.target;j.removeEventListener("dispose",M),P(j),j.isVideoTexture&&f.delete(j)}function D(q){let j=q.target;j.removeEventListener("dispose",D),B(j)}function P(q){let j=i.get(q);if(j.__webglInit===void 0)return;let ve=q.source,ze=g.get(ve);if(ze){let U=ze[j.__cacheKey];U.usedTimes--,U.usedTimes===0&&I(q),Object.keys(ze).length===0&&g.delete(ve)}i.remove(q)}function I(q){let j=i.get(q);e.deleteTexture(j.__webglTexture);let ve=q.source,ze=g.get(ve);delete ze[j.__cacheKey],a.memory.textures--}function B(q){let j=q.texture,ve=i.get(q),ze=i.get(j);if(ze.__webglTexture!==void 0&&(e.deleteTexture(ze.__webglTexture),a.memory.textures--),q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let U=0;U<6;U++)e.deleteFramebuffer(ve.__webglFramebuffer[U]),ve.__webglDepthbuffer&&e.deleteRenderbuffer(ve.__webglDepthbuffer[U]);else{if(e.deleteFramebuffer(ve.__webglFramebuffer),ve.__webglDepthbuffer&&e.deleteRenderbuffer(ve.__webglDepthbuffer),ve.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ve.__webglMultisampledFramebuffer),ve.__webglColorRenderbuffer)for(let U=0;U<ve.__webglColorRenderbuffer.length;U++)ve.__webglColorRenderbuffer[U]&&e.deleteRenderbuffer(ve.__webglColorRenderbuffer[U]);ve.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ve.__webglDepthRenderbuffer)}if(q.isWebGLMultipleRenderTargets)for(let U=0,Fe=j.length;U<Fe;U++){let he=i.get(j[U]);he.__webglTexture&&(e.deleteTexture(he.__webglTexture),a.memory.textures--),i.remove(j[U])}i.remove(j),i.remove(q)}let V=0;function N(){V=0}function L(){let q=V;return q>=l&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+l),V+=1,q}function W(q){let j=[];return j.push(q.wrapS),j.push(q.wrapT),j.push(q.wrapR||0),j.push(q.magFilter),j.push(q.minFilter),j.push(q.anisotropy),j.push(q.internalFormat),j.push(q.format),j.push(q.type),j.push(q.generateMipmaps),j.push(q.premultiplyAlpha),j.push(q.flipY),j.push(q.unpackAlignment),j.push(q.encoding),j.join()}function G(q,j){let ve=i.get(q);if(q.isVideoTexture&&lt(q),q.isRenderTargetTexture===!1&&q.version>0&&ve.__version!==q.version){let ze=q.image;if(ze===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ze.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(ve,q,j);return}}r.bindTexture(3553,ve.__webglTexture,33984+j)}function X(q,j){let ve=i.get(q);if(q.version>0&&ve.__version!==q.version){oe(ve,q,j);return}r.bindTexture(35866,ve.__webglTexture,33984+j)}function Q(q,j){let ve=i.get(q);if(q.version>0&&ve.__version!==q.version){oe(ve,q,j);return}r.bindTexture(32879,ve.__webglTexture,33984+j)}function ie(q,j){let ve=i.get(q);if(q.version>0&&ve.__version!==q.version){le(ve,q,j);return}r.bindTexture(34067,ve.__webglTexture,33984+j)}let J={[zc]:10497,[ti]:33071,[i2]:33648},se={[_r]:9728,[dB]:9984,[cA]:9986,[qt]:9729,[vne]:9985,[sg]:9987};function ee(q,j,ve){if(ve?(e.texParameteri(q,10242,J[j.wrapS]),e.texParameteri(q,10243,J[j.wrapT]),(q===32879||q===35866)&&e.texParameteri(q,32882,J[j.wrapR]),e.texParameteri(q,10240,se[j.magFilter]),e.texParameteri(q,10241,se[j.minFilter])):(e.texParameteri(q,10242,33071),e.texParameteri(q,10243,33071),(q===32879||q===35866)&&e.texParameteri(q,32882,33071),(j.wrapS!==ti||j.wrapT!==ti)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(q,10240,T(j.magFilter)),e.texParameteri(q,10241,T(j.minFilter)),j.minFilter!==_r&&j.minFilter!==qt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let ze=t.get("EXT_texture_filter_anisotropic");if(j.magFilter===_r||j.minFilter!==cA&&j.minFilter!==sg||j.type===Yi&&t.has("OES_texture_float_linear")===!1||o===!1&&j.type===ou&&t.has("OES_texture_half_float_linear")===!1)return;(j.anisotropy>1||i.get(j).__currentAnisotropy)&&(e.texParameterf(q,ze.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,n.getMaxAnisotropy())),i.get(j).__currentAnisotropy=j.anisotropy)}}function ue(q,j){let ve=!1;q.__webglInit===void 0&&(q.__webglInit=!0,j.addEventListener("dispose",M));let ze=j.source,U=g.get(ze);U===void 0&&(U={},g.set(ze,U));let Fe=W(j);if(Fe!==q.__cacheKey){U[Fe]===void 0&&(U[Fe]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,ve=!0),U[Fe].usedTimes++;let he=U[q.__cacheKey];he!==void 0&&(U[q.__cacheKey].usedTimes--,he.usedTimes===0&&I(j)),q.__cacheKey=Fe,q.__webglTexture=U[Fe].texture}return ve}function oe(q,j,ve){let ze=3553;(j.isDataArrayTexture||j.isCompressedArrayTexture)&&(ze=35866),j.isData3DTexture&&(ze=32879);let U=ue(q,j),Fe=j.source;r.bindTexture(ze,q.__webglTexture,33984+ve);let he=i.get(Fe);if(Fe.version!==he.__version||U===!0){r.activeTexture(33984+ve),e.pixelStorei(37440,j.flipY),e.pixelStorei(37441,j.premultiplyAlpha),e.pixelStorei(3317,j.unpackAlignment),e.pixelStorei(37443,0);let Ee=E(j)&&b(j.image)===!1,me=w(j.image,Ee,!1,u);me=pe(j,me);let Je=b(me)||o,et=s.convert(j.format,j.encoding),at=s.convert(j.type),gt=x(j.internalFormat,et,at,j.encoding,j.isVideoTexture);ee(ze,j,Je);let ft,mt=j.mipmaps,Er=o&&j.isVideoTexture!==!0,Xr=he.__version===void 0||U===!0,ae=A(j,me,Je);if(j.isDepthTexture)gt=6402,o?j.type===Yi?gt=36012:j.type===Bc?gt=33190:j.type===$d?gt=35056:gt=33189:j.type===Yi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===Qd&&gt===6402&&j.type!==N9&&j.type!==Bc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=Bc,at=s.convert(j.type)),j.format===gp&&gt===6402&&(gt=34041,j.type!==$d&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=$d,at=s.convert(j.type))),Xr&&(Er?r.texStorage2D(3553,1,gt,me.width,me.height):r.texImage2D(3553,0,gt,me.width,me.height,0,et,at,null));else if(j.isDataTexture)if(mt.length>0&&Je){Er&&Xr&&r.texStorage2D(3553,ae,gt,mt[0].width,mt[0].height);for(let Pe=0,Ne=mt.length;Pe<Ne;Pe++)ft=mt[Pe],Er?r.texSubImage2D(3553,Pe,0,0,ft.width,ft.height,et,at,ft.data):r.texImage2D(3553,Pe,gt,ft.width,ft.height,0,et,at,ft.data);j.generateMipmaps=!1}else Er?(Xr&&r.texStorage2D(3553,ae,gt,me.width,me.height),r.texSubImage2D(3553,0,0,0,me.width,me.height,et,at,me.data)):r.texImage2D(3553,0,gt,me.width,me.height,0,et,at,me.data);else if(j.isCompressedTexture)if(j.isCompressedArrayTexture){Er&&Xr&&r.texStorage3D(35866,ae,gt,mt[0].width,mt[0].height,me.depth);for(let Pe=0,Ne=mt.length;Pe<Ne;Pe++)ft=mt[Pe],j.format!==xn?et!==null?Er?r.compressedTexSubImage3D(35866,Pe,0,0,0,ft.width,ft.height,me.depth,et,ft.data,0,0):r.compressedTexImage3D(35866,Pe,gt,ft.width,ft.height,me.depth,0,ft.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Er?r.texSubImage3D(35866,Pe,0,0,0,ft.width,ft.height,me.depth,et,at,ft.data):r.texImage3D(35866,Pe,gt,ft.width,ft.height,me.depth,0,et,at,ft.data)}else{Er&&Xr&&r.texStorage2D(3553,ae,gt,mt[0].width,mt[0].height);for(let Pe=0,Ne=mt.length;Pe<Ne;Pe++)ft=mt[Pe],j.format!==xn?et!==null?Er?r.compressedTexSubImage2D(3553,Pe,0,0,ft.width,ft.height,et,ft.data):r.compressedTexImage2D(3553,Pe,gt,ft.width,ft.height,0,ft.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Er?r.texSubImage2D(3553,Pe,0,0,ft.width,ft.height,et,at,ft.data):r.texImage2D(3553,Pe,gt,ft.width,ft.height,0,et,at,ft.data)}else if(j.isDataArrayTexture)Er?(Xr&&r.texStorage3D(35866,ae,gt,me.width,me.height,me.depth),r.texSubImage3D(35866,0,0,0,0,me.width,me.height,me.depth,et,at,me.data)):r.texImage3D(35866,0,gt,me.width,me.height,me.depth,0,et,at,me.data);else if(j.isData3DTexture)Er?(Xr&&r.texStorage3D(32879,ae,gt,me.width,me.height,me.depth),r.texSubImage3D(32879,0,0,0,0,me.width,me.height,me.depth,et,at,me.data)):r.texImage3D(32879,0,gt,me.width,me.height,me.depth,0,et,at,me.data);else if(j.isFramebufferTexture){if(Xr)if(Er)r.texStorage2D(3553,ae,gt,me.width,me.height);else{let Pe=me.width,Ne=me.height;for(let Ke=0;Ke<ae;Ke++)r.texImage2D(3553,Ke,gt,Pe,Ne,0,et,at,null),Pe>>=1,Ne>>=1}}else if(mt.length>0&&Je){Er&&Xr&&r.texStorage2D(3553,ae,gt,mt[0].width,mt[0].height);for(let Pe=0,Ne=mt.length;Pe<Ne;Pe++)ft=mt[Pe],Er?r.texSubImage2D(3553,Pe,0,0,et,at,ft):r.texImage2D(3553,Pe,gt,et,at,ft);j.generateMipmaps=!1}else Er?(Xr&&r.texStorage2D(3553,ae,gt,me.width,me.height),r.texSubImage2D(3553,0,0,0,et,at,me)):r.texImage2D(3553,0,gt,et,at,me);_(j,Je)&&C(ze),he.__version=Fe.version,j.onUpdate&&j.onUpdate(j)}q.__version=j.version}function le(q,j,ve){if(j.image.length!==6)return;let ze=ue(q,j),U=j.source;r.bindTexture(34067,q.__webglTexture,33984+ve);let Fe=i.get(U);if(U.version!==Fe.__version||ze===!0){r.activeTexture(33984+ve),e.pixelStorei(37440,j.flipY),e.pixelStorei(37441,j.premultiplyAlpha),e.pixelStorei(3317,j.unpackAlignment),e.pixelStorei(37443,0);let he=j.isCompressedTexture||j.image[0].isCompressedTexture,Ee=j.image[0]&&j.image[0].isDataTexture,me=[];for(let Pe=0;Pe<6;Pe++)!he&&!Ee?me[Pe]=w(j.image[Pe],!1,!0,c):me[Pe]=Ee?j.image[Pe].image:j.image[Pe],me[Pe]=pe(j,me[Pe]);let Je=me[0],et=b(Je)||o,at=s.convert(j.format,j.encoding),gt=s.convert(j.type),ft=x(j.internalFormat,at,gt,j.encoding),mt=o&&j.isVideoTexture!==!0,Er=Fe.__version===void 0||ze===!0,Xr=A(j,Je,et);ee(34067,j,et);let ae;if(he){mt&&Er&&r.texStorage2D(34067,Xr,ft,Je.width,Je.height);for(let Pe=0;Pe<6;Pe++){ae=me[Pe].mipmaps;for(let Ne=0;Ne<ae.length;Ne++){let Ke=ae[Ne];j.format!==xn?at!==null?mt?r.compressedTexSubImage2D(34069+Pe,Ne,0,0,Ke.width,Ke.height,at,Ke.data):r.compressedTexImage2D(34069+Pe,Ne,ft,Ke.width,Ke.height,0,Ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):mt?r.texSubImage2D(34069+Pe,Ne,0,0,Ke.width,Ke.height,at,gt,Ke.data):r.texImage2D(34069+Pe,Ne,ft,Ke.width,Ke.height,0,at,gt,Ke.data)}}}else{ae=j.mipmaps,mt&&Er&&(ae.length>0&&Xr++,r.texStorage2D(34067,Xr,ft,me[0].width,me[0].height));for(let Pe=0;Pe<6;Pe++)if(Ee){mt?r.texSubImage2D(34069+Pe,0,0,0,me[Pe].width,me[Pe].height,at,gt,me[Pe].data):r.texImage2D(34069+Pe,0,ft,me[Pe].width,me[Pe].height,0,at,gt,me[Pe].data);for(let Ne=0;Ne<ae.length;Ne++){let Ke=ae[Ne].image[Pe].image;mt?r.texSubImage2D(34069+Pe,Ne+1,0,0,Ke.width,Ke.height,at,gt,Ke.data):r.texImage2D(34069+Pe,Ne+1,ft,Ke.width,Ke.height,0,at,gt,Ke.data)}}else{mt?r.texSubImage2D(34069+Pe,0,0,0,at,gt,me[Pe]):r.texImage2D(34069+Pe,0,ft,at,gt,me[Pe]);for(let Ne=0;Ne<ae.length;Ne++){let Ke=ae[Ne];mt?r.texSubImage2D(34069+Pe,Ne+1,0,0,at,gt,Ke.image[Pe]):r.texImage2D(34069+Pe,Ne+1,ft,at,gt,Ke.image[Pe])}}}_(j,et)&&C(34067),Fe.__version=U.version,j.onUpdate&&j.onUpdate(j)}q.__version=j.version}function de(q,j,ve,ze,U){let Fe=s.convert(ve.format,ve.encoding),he=s.convert(ve.type),Ee=x(ve.internalFormat,Fe,he,ve.encoding);i.get(j).__hasExternalTextures||(U===32879||U===35866?r.texImage3D(U,0,Ee,j.width,j.height,j.depth,0,Fe,he,null):r.texImage2D(U,0,Ee,j.width,j.height,0,Fe,he,null)),r.bindFramebuffer(36160,q),je(j)?d.framebufferTexture2DMultisampleEXT(36160,ze,U,i.get(ve).__webglTexture,0,He(j)):(U===3553||U>=34069&&U<=34074)&&e.framebufferTexture2D(36160,ze,U,i.get(ve).__webglTexture,0),r.bindFramebuffer(36160,null)}function xe(q,j,ve){if(e.bindRenderbuffer(36161,q),j.depthBuffer&&!j.stencilBuffer){let ze=33189;if(ve||je(j)){let U=j.depthTexture;U&&U.isDepthTexture&&(U.type===Yi?ze=36012:U.type===Bc&&(ze=33190));let Fe=He(j);je(j)?d.renderbufferStorageMultisampleEXT(36161,Fe,ze,j.width,j.height):e.renderbufferStorageMultisample(36161,Fe,ze,j.width,j.height)}else e.renderbufferStorage(36161,ze,j.width,j.height);e.framebufferRenderbuffer(36160,36096,36161,q)}else if(j.depthBuffer&&j.stencilBuffer){let ze=He(j);ve&&je(j)===!1?e.renderbufferStorageMultisample(36161,ze,35056,j.width,j.height):je(j)?d.renderbufferStorageMultisampleEXT(36161,ze,35056,j.width,j.height):e.renderbufferStorage(36161,34041,j.width,j.height),e.framebufferRenderbuffer(36160,33306,36161,q)}else{let ze=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let U=0;U<ze.length;U++){let Fe=ze[U],he=s.convert(Fe.format,Fe.encoding),Ee=s.convert(Fe.type),me=x(Fe.internalFormat,he,Ee,Fe.encoding),Je=He(j);ve&&je(j)===!1?e.renderbufferStorageMultisample(36161,Je,me,j.width,j.height):je(j)?d.renderbufferStorageMultisampleEXT(36161,Je,me,j.width,j.height):e.renderbufferStorage(36161,me,j.width,j.height)}}e.bindRenderbuffer(36161,null)}function _e(q,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,q),!(j.depthTexture&&j.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),G(j.depthTexture,0);let ve=i.get(j.depthTexture).__webglTexture,ze=He(j);if(j.depthTexture.format===Qd)je(j)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ve,0,ze):e.framebufferTexture2D(36160,36096,3553,ve,0);else if(j.depthTexture.format===gp)je(j)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ve,0,ze):e.framebufferTexture2D(36160,33306,3553,ve,0);else throw new Error("Unknown depthTexture format")}function Se(q){let j=i.get(q),ve=q.isWebGLCubeRenderTarget===!0;if(q.depthTexture&&!j.__autoAllocateDepthBuffer){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");_e(j.__webglFramebuffer,q)}else if(ve){j.__webglDepthbuffer=[];for(let ze=0;ze<6;ze++)r.bindFramebuffer(36160,j.__webglFramebuffer[ze]),j.__webglDepthbuffer[ze]=e.createRenderbuffer(),xe(j.__webglDepthbuffer[ze],q,!1)}else r.bindFramebuffer(36160,j.__webglFramebuffer),j.__webglDepthbuffer=e.createRenderbuffer(),xe(j.__webglDepthbuffer,q,!1);r.bindFramebuffer(36160,null)}function Le(q,j,ve){let ze=i.get(q);j!==void 0&&de(ze.__webglFramebuffer,q,q.texture,36064,3553),ve!==void 0&&Se(q)}function Oe(q){let j=q.texture,ve=i.get(q),ze=i.get(j);q.addEventListener("dispose",D),q.isWebGLMultipleRenderTargets!==!0&&(ze.__webglTexture===void 0&&(ze.__webglTexture=e.createTexture()),ze.__version=j.version,a.memory.textures++);let U=q.isWebGLCubeRenderTarget===!0,Fe=q.isWebGLMultipleRenderTargets===!0,he=b(q)||o;if(U){ve.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)ve.__webglFramebuffer[Ee]=e.createFramebuffer()}else{if(ve.__webglFramebuffer=e.createFramebuffer(),Fe)if(n.drawBuffers){let Ee=q.texture;for(let me=0,Je=Ee.length;me<Je;me++){let et=i.get(Ee[me]);et.__webglTexture===void 0&&(et.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&q.samples>0&&je(q)===!1){let Ee=Fe?j:[j];ve.__webglMultisampledFramebuffer=e.createFramebuffer(),ve.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer);for(let me=0;me<Ee.length;me++){let Je=Ee[me];ve.__webglColorRenderbuffer[me]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ve.__webglColorRenderbuffer[me]);let et=s.convert(Je.format,Je.encoding),at=s.convert(Je.type),gt=x(Je.internalFormat,et,at,Je.encoding,q.isXRRenderTarget===!0),ft=He(q);e.renderbufferStorageMultisample(36161,ft,gt,q.width,q.height),e.framebufferRenderbuffer(36160,36064+me,36161,ve.__webglColorRenderbuffer[me])}e.bindRenderbuffer(36161,null),q.depthBuffer&&(ve.__webglDepthRenderbuffer=e.createRenderbuffer(),xe(ve.__webglDepthRenderbuffer,q,!0)),r.bindFramebuffer(36160,null)}}if(U){r.bindTexture(34067,ze.__webglTexture),ee(34067,j,he);for(let Ee=0;Ee<6;Ee++)de(ve.__webglFramebuffer[Ee],q,j,36064,34069+Ee);_(j,he)&&C(34067),r.unbindTexture()}else if(Fe){let Ee=q.texture;for(let me=0,Je=Ee.length;me<Je;me++){let et=Ee[me],at=i.get(et);r.bindTexture(3553,at.__webglTexture),ee(3553,et,he),de(ve.__webglFramebuffer,q,et,36064+me,3553),_(et,he)&&C(3553)}r.unbindTexture()}else{let Ee=3553;(q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(o?Ee=q.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ee,ze.__webglTexture),ee(Ee,j,he),de(ve.__webglFramebuffer,q,j,36064,Ee),_(j,he)&&C(Ee),r.unbindTexture()}q.depthBuffer&&Se(q)}function Ye(q){let j=b(q)||o,ve=q.isWebGLMultipleRenderTargets===!0?q.texture:[q.texture];for(let ze=0,U=ve.length;ze<U;ze++){let Fe=ve[ze];if(_(Fe,j)){let he=q.isWebGLCubeRenderTarget?34067:3553,Ee=i.get(Fe).__webglTexture;r.bindTexture(he,Ee),C(he),r.unbindTexture()}}}function $e(q){if(o&&q.samples>0&&je(q)===!1){let j=q.isWebGLMultipleRenderTargets?q.texture:[q.texture],ve=q.width,ze=q.height,U=16384,Fe=[],he=q.stencilBuffer?33306:36096,Ee=i.get(q),me=q.isWebGLMultipleRenderTargets===!0;if(me)for(let Je=0;Je<j.length;Je++)r.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Je,36161,null),r.bindFramebuffer(36160,Ee.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Je,3553,null,0);r.bindFramebuffer(36008,Ee.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ee.__webglFramebuffer);for(let Je=0;Je<j.length;Je++){Fe.push(36064+Je),q.depthBuffer&&Fe.push(he);let et=Ee.__ignoreDepthValues!==void 0?Ee.__ignoreDepthValues:!1;if(et===!1&&(q.depthBuffer&&(U|=256),q.stencilBuffer&&(U|=1024)),me&&e.framebufferRenderbuffer(36008,36064,36161,Ee.__webglColorRenderbuffer[Je]),et===!0&&(e.invalidateFramebuffer(36008,[he]),e.invalidateFramebuffer(36009,[he])),me){let at=i.get(j[Je]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,at,0)}e.blitFramebuffer(0,0,ve,ze,0,0,ve,ze,U,9728),p&&e.invalidateFramebuffer(36008,Fe)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),me)for(let Je=0;Je<j.length;Je++){r.bindFramebuffer(36160,Ee.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Je,36161,Ee.__webglColorRenderbuffer[Je]);let et=i.get(j[Je]).__webglTexture;r.bindFramebuffer(36160,Ee.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Je,3553,et,0)}r.bindFramebuffer(36009,Ee.__webglMultisampledFramebuffer)}}function He(q){return Math.min(h,q.samples)}function je(q){let j=i.get(q);return o&&q.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&j.__useRenderToTexture!==!1}function lt(q){let j=a.render.frame;f.get(q)!==j&&(f.set(q,j),q.update())}function pe(q,j){let ve=q.encoding,ze=q.format,U=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||q.format===s2||ve!==Ho&&(ve===jt?o===!1?t.has("EXT_sRGB")===!0&&ze===xn?(q.format=s2,q.minFilter=qt,q.generateMipmaps=!1):j=W9.sRGBToLinear(j):(ze!==xn||U!==vs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ve)),j}this.allocateTextureUnit=L,this.resetTextureUnits=N,this.setTexture2D=G,this.setTexture2DArray=X,this.setTexture3D=Q,this.setTextureCube=ie,this.rebindTextures=Le,this.setupRenderTarget=Oe,this.updateRenderTargetMipmap=Ye,this.updateMultisampleRenderTarget=$e,this.setupDepthRenderbuffer=Se,this.setupFrameBufferTexture=de,this.useMultisampledRTT=je}function Fce(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===vs)return 5121;if(s===bne)return 32819;if(s===_ne)return 32820;if(s===yne)return 5120;if(s===wne)return 5122;if(s===N9)return 5123;if(s===xne)return 5124;if(s===Bc)return 5125;if(s===Yi)return 5126;if(s===ou)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===Sne)return 6406;if(s===xn)return 6408;if(s===Ene)return 6409;if(s===Tne)return 6410;if(s===Qd)return 6402;if(s===gp)return 34041;if(s===s2)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===Cne)return 6403;if(s===Ane)return 36244;if(s===X_)return 33319;if(s===Mne)return 33320;if(s===z9)return 36249;if(s===uA||s===hA||s===dA||s===pA)if(a===jt)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===uA)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===hA)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===dA)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===pA)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===uA)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===hA)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===dA)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===pA)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===pB||s===fB||s===mB||s===gB)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===pB)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===fB)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===mB)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===gB)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Pne)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===vB||s===yB)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===vB)return a===jt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===yB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===wB||s===xB||s===bB||s===_B||s===SB||s===EB||s===TB||s===CB||s===AB||s===MB||s===PB||s===DB||s===IB||s===OB)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===wB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===xB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===bB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===_B)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===SB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===EB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===TB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===CB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===AB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===MB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===PB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===DB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===IB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===OB)return a===jt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===fA)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===fA)return a===jt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===Dne||s===RB||s===kB||s===LB)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===fA)return o.COMPRESSED_RED_RGTC1_EXT;if(s===RB)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===kB)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===LB)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===$d?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var Uce=class extends ls{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},ah=class extends Cr{constructor(){super(),this.isGroup=!0,this.type="Group"}},jce={type:"move"},UA=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ah,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ah,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new R,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new R),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ah,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new R,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new R),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let f of e.hand.values()){let m=t.getJointPose(f,r),g=this._getHandJoint(l,f);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],h=c.position.distanceTo(u.position),d=.02,p=.005;l.inputState.pinching&&h>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(jce)))}return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new ah;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},og=class extends pi{constructor(e,t,r,i,n,s,a,o,l,c){if(c=c!==void 0?c:Qd,c!==Qd&&c!==gp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Qd&&(r=Bc),r===void 0&&c===gp&&(r=$d),super(null,i,n,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:_r,this.minFilter=o!==void 0?o:_r,this.flipY=!1,this.generateMipmaps=!1}},Vce=class extends Kn{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],w=new Set,b=new Map,E=new ls;E.layers.enable(1),E.viewport=new It;let _=new ls;_.layers.enable(2),_.viewport=new It;let C=[E,_],x=new Uce;x.layers.enable(1),x.layers.enable(2);let A=null,T=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let Q=v[X];return Q===void 0&&(Q=new UA,v[X]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(X){let Q=v[X];return Q===void 0&&(Q=new UA,v[X]=Q),Q.getGripSpace()},this.getHand=function(X){let Q=v[X];return Q===void 0&&(Q=new UA,v[X]=Q),Q.getHandSpace()};function M(X){let Q=y.indexOf(X.inputSource);if(Q===-1)return;let ie=v[Q];ie!==void 0&&ie.dispatchEvent({type:X.type,data:X.inputSource})}function D(){i.removeEventListener("select",M),i.removeEventListener("selectstart",M),i.removeEventListener("selectend",M),i.removeEventListener("squeeze",M),i.removeEventListener("squeezestart",M),i.removeEventListener("squeezeend",M),i.removeEventListener("end",D),i.removeEventListener("inputsourceschange",P);for(let X=0;X<v.length;X++){let Q=y[X];Q!==null&&(y[X]=null,v[X].disconnect(Q))}A=null,T=null,e.setRenderTarget(m),d=null,h=null,u=null,i=null,g=null,G.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){n=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(X){l=X},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(X){if(i=X,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",M),i.addEventListener("selectstart",M),i.addEventListener("selectend",M),i.addEventListener("squeeze",M),i.addEventListener("squeezestart",M),i.addEventListener("squeezeend",M),i.addEventListener("end",D),i.addEventListener("inputsourceschange",P),f.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let Q={antialias:i.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};d=new XRWebGLLayer(i,t,Q),i.updateRenderState({baseLayer:d}),g=new vr(d.framebufferWidth,d.framebufferHeight,{format:xn,type:vs,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let Q=null,ie=null,J=null;f.depth&&(J=f.stencil?35056:33190,Q=f.stencil?gp:Qd,ie=f.stencil?$d:Bc);let se={colorFormat:32856,depthFormat:J,scaleFactor:n};u=new XRWebGLBinding(i,t),h=u.createProjectionLayer(se),i.updateRenderState({layers:[h]}),g=new vr(h.textureWidth,h.textureHeight,{format:xn,type:vs,depthTexture:new og(h.textureWidth,h.textureHeight,ie,void 0,void 0,void 0,void 0,void 0,void 0,Q),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let ee=e.properties.get(g);ee.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),G.setContext(i),G.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function P(X){for(let Q=0;Q<X.removed.length;Q++){let ie=X.removed[Q],J=y.indexOf(ie);J>=0&&(y[J]=null,v[J].disconnect(ie))}for(let Q=0;Q<X.added.length;Q++){let ie=X.added[Q],J=y.indexOf(ie);if(J===-1){for(let ee=0;ee<v.length;ee++)if(ee>=y.length){y.push(ie),J=ee;break}else if(y[ee]===null){y[ee]=ie,J=ee;break}if(J===-1)break}let se=v[J];se&&se.connect(ie)}}let I=new R,B=new R;function V(X,Q,ie){I.setFromMatrixPosition(Q.matrixWorld),B.setFromMatrixPosition(ie.matrixWorld);let J=I.distanceTo(B),se=Q.projectionMatrix.elements,ee=ie.projectionMatrix.elements,ue=se[14]/(se[10]-1),oe=se[14]/(se[10]+1),le=(se[9]+1)/se[5],de=(se[9]-1)/se[5],xe=(se[8]-1)/se[0],_e=(ee[8]+1)/ee[0],Se=ue*xe,Le=ue*_e,Oe=J/(-xe+_e),Ye=Oe*-xe;Q.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(Ye),X.translateZ(Oe),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();let $e=ue+Oe,He=oe+Oe,je=Se-Ye,lt=Le+(J-Ye),pe=le*oe/He*$e,q=de*oe/He*$e;X.projectionMatrix.makePerspective(je,lt,pe,q,$e,He)}function N(X,Q){Q===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(Q.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(i===null)return;x.near=_.near=E.near=X.near,x.far=_.far=E.far=X.far,(A!==x.near||T!==x.far)&&(i.updateRenderState({depthNear:x.near,depthFar:x.far}),A=x.near,T=x.far);let Q=X.parent,ie=x.cameras;N(x,Q);for(let se=0;se<ie.length;se++)N(ie[se],Q);x.matrixWorld.decompose(x.position,x.quaternion,x.scale),X.matrix.copy(x.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale);let J=X.children;for(let se=0,ee=J.length;se<ee;se++)J[se].updateMatrixWorld(!0);ie.length===2?V(x,E,_):x.projectionMatrix.copy(E.projectionMatrix)},this.getCamera=function(){return x},this.getFoveation=function(){if(!(h===null&&d===null))return o},this.setFoveation=function(X){o=X,h!==null&&(h.fixedFoveation=X),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=X)},this.getPlanes=function(){return w};let L=null;function W(X,Q){if(c=Q.getViewerPose(l||s),p=Q,c!==null){let ie=c.views;d!==null&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let J=!1;ie.length!==x.cameras.length&&(x.cameras.length=0,J=!0);for(let se=0;se<ie.length;se++){let ee=ie[se],ue=null;if(d!==null)ue=d.getViewport(ee);else{let le=u.getViewSubImage(h,ee);ue=le.viewport,se===0&&(e.setRenderTargetTextures(g,le.colorTexture,h.ignoreDepthValues?void 0:le.depthStencilTexture),e.setRenderTarget(g))}let oe=C[se];oe===void 0&&(oe=new ls,oe.layers.enable(se),oe.viewport=new It,C[se]=oe),oe.matrix.fromArray(ee.transform.matrix),oe.projectionMatrix.fromArray(ee.projectionMatrix),oe.viewport.set(ue.x,ue.y,ue.width,ue.height),se===0&&x.matrix.copy(oe.matrix),J===!0&&x.cameras.push(oe)}}for(let ie=0;ie<v.length;ie++){let J=y[ie],se=v[ie];J!==null&&se!==void 0&&se.update(J,Q,l||s)}if(L&&L(X,Q),Q.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:Q.detectedPlanes});let ie=null;for(let J of w)Q.detectedPlanes.has(J)||(ie===null&&(ie=[]),ie.push(J));if(ie!==null)for(let J of ie)w.delete(J),b.delete(J),r.dispatchEvent({type:"planeremoved",data:J});for(let J of Q.detectedPlanes)if(!w.has(J))w.add(J),b.set(J,Q.lastChangedTime),r.dispatchEvent({type:"planeadded",data:J});else{let se=b.get(J);J.lastChangedTime>se&&(b.set(J,J.lastChangedTime),r.dispatchEvent({type:"planechanged",data:J}))}}p=null}let G=new $9;G.setAnimationLoop(W),this.setAnimationLoop=function(X){L=X},this.dispose=function(){}}};function Hce(e,t){function r(m,g){g.color.getRGB(m.fogColor.value,X9(e)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function i(m,g,v,y,w){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),u(m,g)):g.isMeshPhongMaterial?(n(m,g),c(m,g)):g.isMeshStandardMaterial?(n(m,g),h(m,g),g.isMeshPhysicalMaterial&&d(m,g,w)):g.isMeshMatcapMaterial?(n(m,g),p(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),f(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?o(m,g,v,y):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===_n&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===_n&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=t.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let b=e.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix));let w;g.aoMap?w=g.aoMap:g.lightMap&&(w=g.lightMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),m.uv2Transform.value.copy(w.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=y*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let w;g.map?w=g.map:g.alphaMap&&(w=g.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),m.uvTransform.value.copy(w.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===_n&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function f(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Wce(e,t,r,i){let n={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(y,w){let b=w.program;i.uniformBlockBinding(y,b)}function c(y,w){let b=n[y.id];b===void 0&&(f(y),b=u(y),n[y.id]=b,y.addEventListener("dispose",g));let E=w.program;i.updateUBOMapping(y,E);let _=t.render.frame;s[y.id]!==_&&(d(y),s[y.id]=_)}function u(y){let w=h();y.__bindingPointIndex=w;let b=e.createBuffer(),E=y.__size,_=y.usage;return e.bindBuffer(35345,b),e.bufferData(35345,E,_),e.bindBuffer(35345,null),e.bindBufferBase(35345,w,b),b}function h(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let w=n[y.id],b=y.uniforms,E=y.__cache;e.bindBuffer(35345,w);for(let _=0,C=b.length;_<C;_++){let x=b[_];if(p(x,_,E)===!0){let A=x.__offset,T=Array.isArray(x.value)?x.value:[x.value],M=0;for(let D=0;D<T.length;D++){let P=T[D],I=m(P);typeof P=="number"?(x.__data[0]=P,e.bufferSubData(35345,A+M,x.__data)):P.isMatrix3?(x.__data[0]=P.elements[0],x.__data[1]=P.elements[1],x.__data[2]=P.elements[2],x.__data[3]=P.elements[0],x.__data[4]=P.elements[3],x.__data[5]=P.elements[4],x.__data[6]=P.elements[5],x.__data[7]=P.elements[0],x.__data[8]=P.elements[6],x.__data[9]=P.elements[7],x.__data[10]=P.elements[8],x.__data[11]=P.elements[0]):(P.toArray(x.__data,M),M+=I.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,A,x.__data)}}e.bindBuffer(35345,null)}function p(y,w,b){let E=y.value;if(b[w]===void 0){if(typeof E=="number")b[w]=E;else{let _=Array.isArray(E)?E:[E],C=[];for(let x=0;x<_.length;x++)C.push(_[x].clone());b[w]=C}return!0}else if(typeof E=="number"){if(b[w]!==E)return b[w]=E,!0}else{let _=Array.isArray(b[w])?b[w]:[b[w]],C=Array.isArray(E)?E:[E];for(let x=0;x<_.length;x++){let A=_[x];if(A.equals(C[x])===!1)return A.copy(C[x]),!0}}return!1}function f(y){let w=y.uniforms,b=0,E=16,_=0;for(let C=0,x=w.length;C<x;C++){let A=w[C],T={boundary:0,storage:0},M=Array.isArray(A.value)?A.value:[A.value];for(let D=0,P=M.length;D<P;D++){let I=M[D],B=m(I);T.boundary+=B.boundary,T.storage+=B.storage}if(A.__data=new Float32Array(T.storage/Float32Array.BYTES_PER_ELEMENT),A.__offset=b,C>0){_=b%E;let D=E-_;_!==0&&D-T.boundary<0&&(b+=E-_,A.__offset=b)}b+=T.storage}return _=b%E,_>0&&(b+=E-_),y.__size=b,y.__cache={},this}function m(y){let w={boundary:0,storage:0};return typeof y=="number"?(w.boundary=4,w.storage=4):y.isVector2?(w.boundary=8,w.storage=8):y.isVector3||y.isColor?(w.boundary=16,w.storage=12):y.isVector4?(w.boundary=16,w.storage=16):y.isMatrix3?(w.boundary=48,w.storage=48):y.isMatrix4?(w.boundary=64,w.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),w}function g(y){let w=y.target;w.removeEventListener("dispose",g);let b=a.indexOf(w.__bindingPointIndex);a.splice(b,1),e.deleteBuffer(n[w.id]),delete n[w.id],delete s[w.id]}function v(){for(let y in n)e.deleteBuffer(n[y]);a=[],n={},s={}}return{bind:l,update:c,dispose:v}}function Gce(){let e=N0("canvas");return e.style.display="block",e}function t8(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:Gce(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let h=null,d=null,p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ho,this.physicallyCorrectLights=!1,this.toneMapping=kl,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,w=null,b=-1,E=null,_=new It,C=new It,x=null,A=t.width,T=t.height,M=1,D=null,P=null,I=new It(0,0,A,T),B=new It(0,0,A,T),V=!1,N=new d3,L=!1,W=!1,G=null,X=new Be,Q=new re,ie=new R,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function se(){return w===null?M:1}let ee=r;function ue(K,be){for(let Me=0;Me<K.length;Me++){let we=K[Me],Ie=t.getContext(we,be);if(Ie!==null)return Ie}return null}try{let K={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Wg}`),t.addEventListener("webglcontextlost",gt,!1),t.addEventListener("webglcontextrestored",ft,!1),t.addEventListener("webglcontextcreationerror",mt,!1),ee===null){let be=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&be.shift(),ee=ue(be,K),ee===null)throw ue(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ee.getShaderPrecisionFormat===void 0&&(ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(K){throw console.error("THREE.WebGLRenderer: "+K.message),K}let oe,le,de,xe,_e,Se,Le,Oe,Ye,$e,He,je,lt,pe,q,j,ve,ze,U,Fe,he,Ee,me,Je;function et(){oe=new nle(ee),le=new Zoe(ee,oe,e),oe.init(le),Ee=new Fce(ee,oe,le),de=new zce(ee,oe,le),xe=new ole,_e=new Ece,Se=new Bce(ee,oe,de,_e,le,Ee,xe),Le=new ele(m),Oe=new ile(m),Ye=new gse(ee,le),me=new Qoe(ee,oe,Ye,le),$e=new sle(ee,Ye,xe,me),He=new hle(ee,$e,Ye,xe),U=new ule(ee,le,Se),j=new Joe(_e),je=new Sce(m,Le,Oe,oe,le,me,j),lt=new Hce(m,_e),pe=new Cce,q=new Oce(oe,le),ze=new $oe(m,Le,Oe,de,He,u,a),ve=new Nce(m,He,le),Je=new Wce(ee,xe,le,de),Fe=new Koe(ee,oe,xe,le),he=new ale(ee,oe,xe,le),xe.programs=je.programs,m.capabilities=le,m.extensions=oe,m.properties=_e,m.renderLists=pe,m.shadowMap=ve,m.state=de,m.info=xe}et();let at=new Vce(m,ee);this.xr=at,this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.forceContextLoss=function(){let K=oe.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){let K=oe.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(K){K!==void 0&&(M=K,this.setSize(A,T,!1))},this.getSize=function(K){return K.set(A,T)},this.setSize=function(K,be,Me){if(at.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}A=K,T=be,t.width=Math.floor(K*M),t.height=Math.floor(be*M),Me!==!1&&(t.style.width=K+"px",t.style.height=be+"px"),this.setViewport(0,0,K,be)},this.getDrawingBufferSize=function(K){return K.set(A*M,T*M).floor()},this.setDrawingBufferSize=function(K,be,Me){A=K,T=be,M=Me,t.width=Math.floor(K*Me),t.height=Math.floor(be*Me),this.setViewport(0,0,K,be)},this.getCurrentViewport=function(K){return K.copy(_)},this.getViewport=function(K){return K.copy(I)},this.setViewport=function(K,be,Me,we){K.isVector4?I.set(K.x,K.y,K.z,K.w):I.set(K,be,Me,we),de.viewport(_.copy(I).multiplyScalar(M).floor())},this.getScissor=function(K){return K.copy(B)},this.setScissor=function(K,be,Me,we){K.isVector4?B.set(K.x,K.y,K.z,K.w):B.set(K,be,Me,we),de.scissor(C.copy(B).multiplyScalar(M).floor())},this.getScissorTest=function(){return V},this.setScissorTest=function(K){de.setScissorTest(V=K)},this.setOpaqueSort=function(K){D=K},this.setTransparentSort=function(K){P=K},this.getClearColor=function(K){return K.copy(ze.getClearColor())},this.setClearColor=function(){ze.setClearColor.apply(ze,arguments)},this.getClearAlpha=function(){return ze.getClearAlpha()},this.setClearAlpha=function(){ze.setClearAlpha.apply(ze,arguments)},this.clear=function(K=!0,be=!0,Me=!0){let we=0;K&&(we|=16384),be&&(we|=256),Me&&(we|=1024),ee.clear(we)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",gt,!1),t.removeEventListener("webglcontextrestored",ft,!1),t.removeEventListener("webglcontextcreationerror",mt,!1),pe.dispose(),q.dispose(),_e.dispose(),Le.dispose(),Oe.dispose(),He.dispose(),me.dispose(),Je.dispose(),je.dispose(),at.dispose(),at.removeEventListener("sessionstart",Ke),at.removeEventListener("sessionend",yt),G&&(G.dispose(),G=null),Kt.stop()};function gt(K){K.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ft(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let K=xe.autoReset,be=ve.enabled,Me=ve.autoUpdate,we=ve.needsUpdate,Ie=ve.type;et(),xe.autoReset=K,ve.enabled=be,ve.autoUpdate=Me,ve.needsUpdate=we,ve.type=Ie}function mt(K){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Er(K){let be=K.target;be.removeEventListener("dispose",Er),Xr(be)}function Xr(K){ae(K),_e.remove(K)}function ae(K){let be=_e.get(K).programs;be!==void 0&&(be.forEach(function(Me){je.releaseProgram(Me)}),K.isShaderMaterial&&je.releaseShaderCache(K))}this.renderBufferDirect=function(K,be,Me,we,Ie,ut){be===null&&(be=J);let Ot=Ie.isMesh&&Ie.matrixWorld.determinant()<0,Lt=tf(K,be,Me,we,Ie);de.setMaterial(we,Ot);let vt=Me.index,er=1;we.wireframe===!0&&(vt=$e.getWireframeAttribute(Me),er=2);let $t=Me.drawRange,Zt=Me.attributes.position,Nt=$t.start*er,Bi=($t.start+$t.count)*er;ut!==null&&(Nt=Math.max(Nt,ut.start*er),Bi=Math.min(Bi,(ut.start+ut.count)*er)),vt!==null?(Nt=Math.max(Nt,0),Bi=Math.min(Bi,vt.count)):Zt!=null&&(Nt=Math.max(Nt,0),Bi=Math.min(Bi,Zt.count));let xs=Bi-Nt;if(xs<0||xs===1/0)return;me.setup(Ie,we,Lt,Me,vt);let Oa,$r=Fe;if(vt!==null&&(Oa=Ye.get(vt),$r=he,$r.setIndex(Oa)),Ie.isMesh)we.wireframe===!0?(de.setLineWidth(we.wireframeLinewidth*se()),$r.setMode(1)):$r.setMode(4);else if(Ie.isLine){let Yt=we.linewidth;Yt===void 0&&(Yt=1),de.setLineWidth(Yt*se()),Ie.isLineSegments?$r.setMode(1):Ie.isLineLoop?$r.setMode(2):$r.setMode(3)}else Ie.isPoints?$r.setMode(0):Ie.isSprite&&$r.setMode(4);if(Ie.isInstancedMesh)$r.renderInstances(Nt,xs,Ie.count);else if(Me.isInstancedBufferGeometry){let Yt=Me._maxInstanceCount!==void 0?Me._maxInstanceCount:1/0,qs=Math.min(Me.instanceCount,Yt);$r.renderInstances(Nt,xs,qs)}else $r.render(Nt,xs)},this.compile=function(K,be){function Me(we,Ie,ut){we.transparent===!0&&we.side===ia&&we.forceSinglePass===!1?(we.side=_n,we.needsUpdate=!0,On(we,Ie,ut),we.side=Vo,we.needsUpdate=!0,On(we,Ie,ut),we.side=ia):On(we,Ie,ut)}d=q.get(K),d.init(),f.push(d),K.traverseVisible(function(we){we.isLight&&we.layers.test(be.layers)&&(d.pushLight(we),we.castShadow&&d.pushShadow(we))}),d.setupLights(m.physicallyCorrectLights),K.traverse(function(we){let Ie=we.material;if(Ie)if(Array.isArray(Ie))for(let ut=0;ut<Ie.length;ut++){let Ot=Ie[ut];Me(Ot,K,we)}else Me(Ie,K,we)}),f.pop(),d=null};let Pe=null;function Ne(K){Pe&&Pe(K)}function Ke(){Kt.stop()}function yt(){Kt.start()}let Kt=new $9;Kt.setAnimationLoop(Ne),typeof self<"u"&&Kt.setContext(self),this.setAnimationLoop=function(K){Pe=K,at.setAnimationLoop(K),K===null?Kt.stop():Kt.start()},at.addEventListener("sessionstart",Ke),at.addEventListener("sessionend",yt),this.render=function(K,be){if(be!==void 0&&be.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),be.parent===null&&be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),at.enabled===!0&&at.isPresenting===!0&&(at.cameraAutoUpdate===!0&&at.updateCamera(be),be=at.getCamera()),K.isScene===!0&&K.onBeforeRender(m,K,be,w),d=q.get(K,f.length),d.init(),f.push(d),X.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),N.setFromProjectionMatrix(X),W=this.localClippingEnabled,L=j.init(this.clippingPlanes,W),h=pe.get(K,p.length),h.init(),p.push(h),Ar(K,be,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(D,P),L===!0&&j.beginShadows();let Me=d.state.shadowsArray;if(ve.render(Me,K,be),L===!0&&j.endShadows(),this.info.autoReset===!0&&this.info.reset(),ze.render(h,K),d.setupLights(m.physicallyCorrectLights),be.isArrayCamera){let we=be.cameras;for(let Ie=0,ut=we.length;Ie<ut;Ie++){let Ot=we[Ie];Ci(h,K,Ot,Ot.viewport)}}else Ci(h,K,be);w!==null&&(Se.updateMultisampleRenderTarget(w),Se.updateRenderTargetMipmap(w)),K.isScene===!0&&K.onAfterRender(m,K,be),me.resetDefaultState(),b=-1,E=null,f.pop(),f.length>0?d=f[f.length-1]:d=null,p.pop(),p.length>0?h=p[p.length-1]:h=null};function Ar(K,be,Me,we){if(K.visible===!1)return;if(K.layers.test(be.layers)){if(K.isGroup)Me=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(be);else if(K.isLight)d.pushLight(K),K.castShadow&&d.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||N.intersectsSprite(K)){we&&ie.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let ut=He.update(K),Ot=K.material;Ot.visible&&h.push(K,ut,Ot,Me,ie.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(K.isSkinnedMesh&&K.skeleton.frame!==xe.render.frame&&(K.skeleton.update(),K.skeleton.frame=xe.render.frame),!K.frustumCulled||N.intersectsObject(K))){we&&ie.setFromMatrixPosition(K.matrixWorld).applyMatrix4(X);let ut=He.update(K),Ot=K.material;if(Array.isArray(Ot)){let Lt=ut.groups;for(let vt=0,er=Lt.length;vt<er;vt++){let $t=Lt[vt],Zt=Ot[$t.materialIndex];Zt&&Zt.visible&&h.push(K,ut,Zt,Me,ie.z,$t)}}else Ot.visible&&h.push(K,ut,Ot,Me,ie.z,null)}}let Ie=K.children;for(let ut=0,Ot=Ie.length;ut<Ot;ut++)Ar(Ie[ut],be,Me,we)}function Ci(K,be,Me,we){let Ie=K.opaque,ut=K.transmissive,Ot=K.transparent;d.setupLightsView(Me),L===!0&&j.setGlobalState(m.clippingPlanes,Me),ut.length>0&&ws(Ie,be,Me),we&&de.viewport(_.copy(we)),Ie.length>0&&Mr(Ie,be,Me),ut.length>0&&Mr(ut,be,Me),Ot.length>0&&Mr(Ot,be,Me),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function ws(K,be,Me){let we=le.isWebGL2;G===null&&(G=new vr(1,1,{generateMipmaps:!0,type:oe.has("EXT_color_buffer_half_float")?ou:vs,minFilter:sg,samples:we&&s===!0?4:0})),m.getDrawingBufferSize(Q),we?G.setSize(Q.x,Q.y):G.setSize(J_(Q.x),J_(Q.y));let Ie=m.getRenderTarget();m.setRenderTarget(G),m.clear();let ut=m.toneMapping;m.toneMapping=kl,Mr(K,be,Me),m.toneMapping=ut,Se.updateMultisampleRenderTarget(G),Se.updateRenderTargetMipmap(G),m.setRenderTarget(Ie)}function Mr(K,be,Me){let we=be.isScene===!0?be.overrideMaterial:null;for(let Ie=0,ut=K.length;Ie<ut;Ie++){let Ot=K[Ie],Lt=Ot.object,vt=Ot.geometry,er=we===null?Ot.material:we,$t=Ot.group;Lt.layers.test(Me.layers)&&In(Lt,be,Me,vt,er,$t)}}function In(K,be,Me,we,Ie,ut){K.onBeforeRender(m,be,Me,we,Ie,ut),K.modelViewMatrix.multiplyMatrices(Me.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),Ie.onBeforeRender(m,be,Me,we,K,ut),Ie.transparent===!0&&Ie.side===ia&&Ie.forceSinglePass===!1?(Ie.side=_n,Ie.needsUpdate=!0,m.renderBufferDirect(Me,be,we,Ie,K,ut),Ie.side=Vo,Ie.needsUpdate=!0,m.renderBufferDirect(Me,be,we,Ie,K,ut),Ie.side=ia):m.renderBufferDirect(Me,be,we,Ie,K,ut),K.onAfterRender(m,be,Me,we,Ie,ut)}function On(K,be,Me){be.isScene!==!0&&(be=J);let we=_e.get(K),Ie=d.state.lights,ut=d.state.shadowsArray,Ot=Ie.state.version,Lt=je.getParameters(K,Ie.state,ut,be,Me),vt=je.getProgramCacheKey(Lt),er=we.programs;we.environment=K.isMeshStandardMaterial?be.environment:null,we.fog=be.fog,we.envMap=(K.isMeshStandardMaterial?Oe:Le).get(K.envMap||we.environment),er===void 0&&(K.addEventListener("dispose",Er),er=new Map,we.programs=er);let $t=er.get(vt);if($t!==void 0){if(we.currentProgram===$t&&we.lightsStateVersion===Ot)return vi(K,Lt),$t}else Lt.uniforms=je.getUniforms(K),K.onBuild(Me,Lt,m),K.onBeforeCompile(Lt,m),$t=je.acquireProgram(Lt,vt),er.set(vt,$t),we.uniforms=Lt.uniforms;let Zt=we.uniforms;(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(Zt.clippingPlanes=j.uniform),vi(K,Lt),we.needsLights=co(K),we.lightsStateVersion=Ot,we.needsLights&&(Zt.ambientLightColor.value=Ie.state.ambient,Zt.lightProbe.value=Ie.state.probe,Zt.directionalLights.value=Ie.state.directional,Zt.directionalLightShadows.value=Ie.state.directionalShadow,Zt.spotLights.value=Ie.state.spot,Zt.spotLightShadows.value=Ie.state.spotShadow,Zt.rectAreaLights.value=Ie.state.rectArea,Zt.ltc_1.value=Ie.state.rectAreaLTC1,Zt.ltc_2.value=Ie.state.rectAreaLTC2,Zt.pointLights.value=Ie.state.point,Zt.pointLightShadows.value=Ie.state.pointShadow,Zt.hemisphereLights.value=Ie.state.hemi,Zt.directionalShadowMap.value=Ie.state.directionalShadowMap,Zt.directionalShadowMatrix.value=Ie.state.directionalShadowMatrix,Zt.spotShadowMap.value=Ie.state.spotShadowMap,Zt.spotLightMatrix.value=Ie.state.spotLightMatrix,Zt.spotLightMap.value=Ie.state.spotLightMap,Zt.pointShadowMap.value=Ie.state.pointShadowMap,Zt.pointShadowMatrix.value=Ie.state.pointShadowMatrix);let Nt=$t.getUniforms(),Bi=Vb.seqWithValue(Nt.seq,Zt);return we.currentProgram=$t,we.uniformsList=Bi,$t}function vi(K,be){let Me=_e.get(K);Me.outputEncoding=be.outputEncoding,Me.instancing=be.instancing,Me.skinning=be.skinning,Me.morphTargets=be.morphTargets,Me.morphNormals=be.morphNormals,Me.morphColors=be.morphColors,Me.morphTargetsCount=be.morphTargetsCount,Me.numClippingPlanes=be.numClippingPlanes,Me.numIntersection=be.numClipIntersection,Me.vertexAlphas=be.vertexAlphas,Me.vertexTangents=be.vertexTangents,Me.toneMapping=be.toneMapping}function tf(K,be,Me,we,Ie){be.isScene!==!0&&(be=J),Se.resetTextureUnits();let ut=be.fog,Ot=we.isMeshStandardMaterial?be.environment:null,Lt=w===null?m.outputEncoding:w.isXRRenderTarget===!0?w.texture.encoding:Ho,vt=(we.isMeshStandardMaterial?Oe:Le).get(we.envMap||Ot),er=we.vertexColors===!0&&!!Me.attributes.color&&Me.attributes.color.itemSize===4,$t=!!we.normalMap&&!!Me.attributes.tangent,Zt=!!Me.morphAttributes.position,Nt=!!Me.morphAttributes.normal,Bi=!!Me.morphAttributes.color,xs=we.toneMapped?m.toneMapping:kl,Oa=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,$r=Oa!==void 0?Oa.length:0,Yt=_e.get(we),qs=d.state.lights;if(L===!0&&(W===!0||K!==E)){let $=K===E&&we.id===b;j.setState(we,K,$)}let Vt=!1;we.version===Yt.__version?(Yt.needsLights&&Yt.lightsStateVersion!==qs.state.version||Yt.outputEncoding!==Lt||Ie.isInstancedMesh&&Yt.instancing===!1||!Ie.isInstancedMesh&&Yt.instancing===!0||Ie.isSkinnedMesh&&Yt.skinning===!1||!Ie.isSkinnedMesh&&Yt.skinning===!0||Yt.envMap!==vt||we.fog===!0&&Yt.fog!==ut||Yt.numClippingPlanes!==void 0&&(Yt.numClippingPlanes!==j.numPlanes||Yt.numIntersection!==j.numIntersection)||Yt.vertexAlphas!==er||Yt.vertexTangents!==$t||Yt.morphTargets!==Zt||Yt.morphNormals!==Nt||Yt.morphColors!==Bi||Yt.toneMapping!==xs||le.isWebGL2===!0&&Yt.morphTargetsCount!==$r)&&(Vt=!0):(Vt=!0,Yt.__version=we.version);let bs=Yt.currentProgram;Vt===!0&&(bs=On(we,be,Ie));let _s=!1,Ra=!1,ka=!1,F=bs.getUniforms(),H=Yt.uniforms;if(de.useProgram(bs.program)&&(_s=!0,Ra=!0,ka=!0),we.id!==b&&(b=we.id,Ra=!0),_s||E!==K){if(F.setValue(ee,"projectionMatrix",K.projectionMatrix),le.logarithmicDepthBuffer&&F.setValue(ee,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),E!==K&&(E=K,Ra=!0,ka=!0),we.isShaderMaterial||we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshStandardMaterial||we.envMap){let $=F.map.cameraPosition;$!==void 0&&$.setValue(ee,ie.setFromMatrixPosition(K.matrixWorld))}(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial)&&F.setValue(ee,"isOrthographic",K.isOrthographicCamera===!0),(we.isMeshPhongMaterial||we.isMeshToonMaterial||we.isMeshLambertMaterial||we.isMeshBasicMaterial||we.isMeshStandardMaterial||we.isShaderMaterial||we.isShadowMaterial||Ie.isSkinnedMesh)&&F.setValue(ee,"viewMatrix",K.matrixWorldInverse)}if(Ie.isSkinnedMesh){F.setOptional(ee,Ie,"bindMatrix"),F.setOptional(ee,Ie,"bindMatrixInverse");let $=Ie.skeleton;$&&(le.floatVertexTextures?($.boneTexture===null&&$.computeBoneTexture(),F.setValue(ee,"boneTexture",$.boneTexture,Se),F.setValue(ee,"boneTextureSize",$.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let ne=Me.morphAttributes;if((ne.position!==void 0||ne.normal!==void 0||ne.color!==void 0&&le.isWebGL2===!0)&&U.update(Ie,Me,we,bs),(Ra||Yt.receiveShadow!==Ie.receiveShadow)&&(Yt.receiveShadow=Ie.receiveShadow,F.setValue(ee,"receiveShadow",Ie.receiveShadow)),we.isMeshGouraudMaterial&&we.envMap!==null&&(H.envMap.value=vt,H.flipEnvMap.value=vt.isCubeTexture&&vt.isRenderTargetTexture===!1?-1:1),Ra&&(F.setValue(ee,"toneMappingExposure",m.toneMappingExposure),Yt.needsLights&&nc(H,ka),ut&&we.fog===!0&&lt.refreshFogUniforms(H,ut),lt.refreshMaterialUniforms(H,we,M,T,G),Vb.upload(ee,Yt.uniformsList,H,Se)),we.isShaderMaterial&&we.uniformsNeedUpdate===!0&&(Vb.upload(ee,Yt.uniformsList,H,Se),we.uniformsNeedUpdate=!1),we.isSpriteMaterial&&F.setValue(ee,"center",Ie.center),F.setValue(ee,"modelViewMatrix",Ie.modelViewMatrix),F.setValue(ee,"normalMatrix",Ie.normalMatrix),F.setValue(ee,"modelMatrix",Ie.matrixWorld),Ie.previousModelViewMatrix&&F.setValue(ee,"previousModelViewMatrix",Ie.previousModelViewMatrix),K.previousProjectionMatrix&&F.setValue(ee,"previousProjectionMatrix",K.previousProjectionMatrix),we.isShaderMaterial||we.isRawShaderMaterial){let $=we.uniformsGroups;for(let ce=0,Ve=$.length;ce<Ve;ce++)if(le.isWebGL2){let La=$[ce];Je.update(La,bs),Je.bind(La,bs)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return bs}function nc(K,be){K.ambientLightColor.needsUpdate=be,K.lightProbe.needsUpdate=be,K.directionalLights.needsUpdate=be,K.directionalLightShadows.needsUpdate=be,K.pointLights.needsUpdate=be,K.pointLightShadows.needsUpdate=be,K.spotLights.needsUpdate=be,K.spotLightShadows.needsUpdate=be,K.rectAreaLights.needsUpdate=be,K.hemisphereLights.needsUpdate=be}function co(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(K,be,Me){_e.get(K.texture).__webglTexture=be,_e.get(K.depthTexture).__webglTexture=Me;let we=_e.get(K);we.__hasExternalTextures=!0,we.__hasExternalTextures&&(we.__autoAllocateDepthBuffer=Me===void 0,we.__autoAllocateDepthBuffer||oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),we.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(K,be){let Me=_e.get(K);Me.__webglFramebuffer=be,Me.__useDefaultFramebuffer=be===void 0},this.setRenderTarget=function(K,be=0,Me=0){w=K,v=be,y=Me;let we=!0,Ie=null,ut=!1,Ot=!1;if(K){let Lt=_e.get(K);Lt.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),we=!1):Lt.__webglFramebuffer===void 0?Se.setupRenderTarget(K):Lt.__hasExternalTextures&&Se.rebindTextures(K,_e.get(K.texture).__webglTexture,_e.get(K.depthTexture).__webglTexture);let vt=K.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(Ot=!0);let er=_e.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Ie=er[be],ut=!0):le.isWebGL2&&K.samples>0&&Se.useMultisampledRTT(K)===!1?Ie=_e.get(K).__webglMultisampledFramebuffer:Ie=er,_.copy(K.viewport),C.copy(K.scissor),x=K.scissorTest}else _.copy(I).multiplyScalar(M).floor(),C.copy(B).multiplyScalar(M).floor(),x=V;if(de.bindFramebuffer(36160,Ie)&&le.drawBuffers&&we&&de.drawBuffers(K,Ie),de.viewport(_),de.scissor(C),de.setScissorTest(x),ut){let Lt=_e.get(K.texture);ee.framebufferTexture2D(36160,36064,34069+be,Lt.__webglTexture,Me)}else if(Ot){let Lt=_e.get(K.texture),vt=be||0;ee.framebufferTextureLayer(36160,36064,Lt.__webglTexture,Me||0,vt)}b=-1},this.readRenderTargetPixels=function(K,be,Me,we,Ie,ut,Ot){if(!(K&&K.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Lt=_e.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&Ot!==void 0&&(Lt=Lt[Ot]),Lt){de.bindFramebuffer(36160,Lt);try{let vt=K.texture,er=vt.format,$t=vt.type;if(er!==xn&&Ee.convert(er)!==ee.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Zt=$t===ou&&(oe.has("EXT_color_buffer_half_float")||le.isWebGL2&&oe.has("EXT_color_buffer_float"));if($t!==vs&&Ee.convert($t)!==ee.getParameter(35738)&&!($t===Yi&&(le.isWebGL2||oe.has("OES_texture_float")||oe.has("WEBGL_color_buffer_float")))&&!Zt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}be>=0&&be<=K.width-we&&Me>=0&&Me<=K.height-Ie&&ee.readPixels(be,Me,we,Ie,Ee.convert(er),Ee.convert($t),ut)}finally{let vt=w!==null?_e.get(w).__webglFramebuffer:null;de.bindFramebuffer(36160,vt)}}},this.copyFramebufferToTexture=function(K,be,Me=0){let we=Math.pow(2,-Me),Ie=Math.floor(be.image.width*we),ut=Math.floor(be.image.height*we);Se.setTexture2D(be,0),ee.copyTexSubImage2D(3553,Me,0,0,K.x,K.y,Ie,ut),de.unbindTexture()},this.copyTextureToTexture=function(K,be,Me,we=0){let Ie=be.image.width,ut=be.image.height,Ot=Ee.convert(Me.format),Lt=Ee.convert(Me.type);Se.setTexture2D(Me,0),ee.pixelStorei(37440,Me.flipY),ee.pixelStorei(37441,Me.premultiplyAlpha),ee.pixelStorei(3317,Me.unpackAlignment),be.isDataTexture?ee.texSubImage2D(3553,we,K.x,K.y,Ie,ut,Ot,Lt,be.image.data):be.isCompressedTexture?ee.compressedTexSubImage2D(3553,we,K.x,K.y,be.mipmaps[0].width,be.mipmaps[0].height,Ot,be.mipmaps[0].data):ee.texSubImage2D(3553,we,K.x,K.y,Ot,Lt,be.image),we===0&&Me.generateMipmaps&&ee.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(K,be,Me,we,Ie=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let ut=K.max.x-K.min.x+1,Ot=K.max.y-K.min.y+1,Lt=K.max.z-K.min.z+1,vt=Ee.convert(we.format),er=Ee.convert(we.type),$t;if(we.isData3DTexture)Se.setTexture3D(we,0),$t=32879;else if(we.isDataArrayTexture)Se.setTexture2DArray(we,0),$t=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ee.pixelStorei(37440,we.flipY),ee.pixelStorei(37441,we.premultiplyAlpha),ee.pixelStorei(3317,we.unpackAlignment);let Zt=ee.getParameter(3314),Nt=ee.getParameter(32878),Bi=ee.getParameter(3316),xs=ee.getParameter(3315),Oa=ee.getParameter(32877),$r=Me.isCompressedTexture?Me.mipmaps[0]:Me.image;ee.pixelStorei(3314,$r.width),ee.pixelStorei(32878,$r.height),ee.pixelStorei(3316,K.min.x),ee.pixelStorei(3315,K.min.y),ee.pixelStorei(32877,K.min.z),Me.isDataTexture||Me.isData3DTexture?ee.texSubImage3D($t,Ie,be.x,be.y,be.z,ut,Ot,Lt,vt,er,$r.data):Me.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ee.compressedTexSubImage3D($t,Ie,be.x,be.y,be.z,ut,Ot,Lt,vt,$r.data)):ee.texSubImage3D($t,Ie,be.x,be.y,be.z,ut,Ot,Lt,vt,er,$r),ee.pixelStorei(3314,Zt),ee.pixelStorei(32878,Nt),ee.pixelStorei(3316,Bi),ee.pixelStorei(3315,xs),ee.pixelStorei(32877,Oa),Ie===0&&we.generateMipmaps&&ee.generateMipmap($t),de.unbindTexture()},this.initTexture=function(K){K.isCubeTexture?Se.setTextureCube(K,0):K.isData3DTexture?Se.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?Se.setTexture2DArray(K,0):Se.setTexture2D(K,0),de.unbindTexture()},this.resetState=function(){v=0,y=0,w=null,de.reset(),me.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var qce=class extends t8{};qce.prototype.isWebGL1Renderer=!0;var r8=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new bt(e),this.near=t,this.far=r}clone(){return new r8(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Yc=class extends Cr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},Yce=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=n2,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=eo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=eo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=eo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Es=new R,l2=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Es.fromBufferAttribute(this,t),Es.applyMatrix4(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Es.fromBufferAttribute(this,t),Es.applyNormalMatrix(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Es.fromBufferAttribute(this,t),Es.transformDirection(e),this.setXYZ(t,Es.x,Es.y,Es.z);return this}setX(e,t){return this.normalized&&(t=Vr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Vr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Vr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Vr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Fc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Fc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Fc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Fc(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array),i=Vr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Vr(t,this.array),r=Vr(r,this.array),i=Vr(i,this.array),n=Vr(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new Mt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new l2(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},i8=class extends Cr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Za=class extends pi{constructor(e=null,t=1,r=1,i,n,s,a,o,l=_r,c=_r,u,h){super(null,s,a,o,l,c,i,n,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},gF=new Be,Xce=new Be,f3=class{constructor(e=[],t=[]){this.uuid=eo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Be)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Be;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:Xce;gF.multiplyMatrices(a,t[n]),gF.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new f3(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=j9(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Za(t,e,e,xn,Yi);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new i8),this.bones.push(s),this.boneInverses.push(new Be().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let s=t[i];e.bones.push(s.uuid);let a=r[i];e.boneInverses.push(a.toArray())}return e}},z0=class extends Mt{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},vF=new Be,yF=new Be,o1=[],$ce=new Be,Hv=new Ii,Qce=class extends Ii{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new z0(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,$ce)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,i=this.count;if(Hv.geometry=this.geometry,Hv.material=this.material,Hv.material!==void 0)for(let n=0;n<i;n++){this.getMatrixAt(n,vF),yF.multiplyMatrices(r,vF),Hv.matrixWorld=yF,Hv.raycast(e,o1);for(let s=0,a=o1.length;s<a;s++){let o=o1[s];o.instanceId=n,o.object=this,t.push(o)}o1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new z0(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},nd=class extends Ow{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new bt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},wF=new R,xF=new R,bF=new Be,jA=new Gg,l1=new ca,eS=class extends Cr{constructor(e=new pt,t=new nd){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)wF.fromBufferAttribute(t,i-1),xF.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=wF.distanceTo(xF);e.setAttribute("lineDistance",new Ze(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),l1.copy(r.boundingSphere),l1.applyMatrix4(i),l1.radius+=n,e.ray.intersectsSphere(l1)===!1)return;bF.copy(i).invert(),jA.copy(e.ray).applyMatrix4(bF);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new R,c=new R,u=new R,h=new R,d=this.isLineSegments?2:1,p=r.index,f=r.attributes.position;if(p!==null){let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){let w=p.getX(v),b=p.getX(v+1);if(l.fromBufferAttribute(f,w),c.fromBufferAttribute(f,b),jA.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let E=e.ray.origin.distanceTo(h);E<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,y=g-1;v<y;v+=d){if(l.fromBufferAttribute(f,v),c.fromBufferAttribute(f,v+1),jA.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},_F=new R,SF=new R,Rw=class extends eS{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)_F.fromBufferAttribute(t,i),SF.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+_F.distanceTo(SF);e.setAttribute("lineDistance",new Ze(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},Kce=class extends pi{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:qt,this.magFilter=n!==void 0?n:qt,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},Zce=class extends pi{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},Jl=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let c=r[i],u=r[i+1]-c,h=(s-c)/u;return(i+h)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new re:new R);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new R,i=[],n=[],s=[],a=new R,o=new Be;for(let d=0;d<=e;d++){let p=d/e;i[d]=this.getTangentAt(p,new R)}n[0]=new R,s[0]=new R;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(Hi(i[d-1].dot(i[d]),-1,1));n[d].applyMatrix4(o.makeRotationAxis(a,p))}s[d].crossVectors(i[d],n[d])}if(t===!0){let d=Math.acos(Hi(n[0].dot(n[e]),-1,1));d/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let p=1;p<=e;p++)n[p].applyMatrix4(o.makeRotationAxis(i[p],d*p)),s[p].crossVectors(i[p],n[p])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},pT=class extends Jl{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new re,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=o-this.aX,d=l-this.aY;o=h*c-d*u+this.aX,l=h*u+d*c+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},Jce=class extends pT{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function m3(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){n(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,h){let d=(a-s)/c-(o-s)/(c+u)+(o-a)/u,p=(o-a)/u-(l-a)/(u+h)+(l-o)/h;d*=u,p*=u,n(a,o,d,p)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var c1=new R,VA=new m3,HA=new m3,WA=new m3,eue=class extends Jl{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new R){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,c;this.closed||a>0?l=i[(a-1)%n]:(c1.subVectors(i[0],i[1]).add(i[0]),l=c1);let u=i[a%n],h=i[(a+1)%n];if(this.closed||a+2<n?c=i[(a+2)%n]:(c1.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=c1),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(u),d),f=Math.pow(u.distanceToSquared(h),d),m=Math.pow(h.distanceToSquared(c),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),VA.initNonuniformCatmullRom(l.x,u.x,h.x,c.x,p,f,m),HA.initNonuniformCatmullRom(l.y,u.y,h.y,c.y,p,f,m),WA.initNonuniformCatmullRom(l.z,u.z,h.z,c.z,p,f,m)}else this.curveType==="catmullrom"&&(VA.initCatmullRom(l.x,u.x,h.x,c.x,this.tension),HA.initCatmullRom(l.y,u.y,h.y,c.y,this.tension),WA.initCatmullRom(l.z,u.z,h.z,c.z,this.tension));return r.set(VA.calc(o),HA.calc(o),WA.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new R().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function EF(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function tue(e,t){let r=1-e;return r*r*t}function rue(e,t){return 2*(1-e)*e*t}function iue(e,t){return e*e*t}function Qy(e,t,r,i){return tue(e,t)+rue(e,r)+iue(e,i)}function nue(e,t){let r=1-e;return r*r*r*t}function sue(e,t){let r=1-e;return 3*r*r*e*t}function aue(e,t){return 3*(1-e)*e*e*t}function oue(e,t){return e*e*e*t}function Ky(e,t,r,i,n){return nue(e,t)+sue(e,r)+aue(e,i)+oue(e,n)}var Do=class extends Jl{constructor(e=new re,t=new re,r=new re,i=new re){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new re){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Ky(e,i.x,n.x,s.x,a.x),Ky(e,i.y,n.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Hb=class extends Jl{constructor(e=new R,t=new R,r=new R,i=new R){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new R){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Ky(e,i.x,n.x,s.x,a.x),Ky(e,i.y,n.y,s.y,a.y),Ky(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},No=class extends Jl{constructor(e=new re,t=new re){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new re){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new re;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},n8=class extends Jl{constructor(e=new R,t=new R){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new R){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},jh=class extends Jl{constructor(e=new re,t=new re,r=new re){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new re){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Qy(e,i.x,n.x,s.x),Qy(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},lue=class extends Jl{constructor(e=new R,t=new R,r=new R){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new R){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Qy(e,i.x,n.x,s.x),Qy(e,i.y,n.y,s.y),Qy(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},g3=class extends Jl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new re){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(EF(a,o.x,l.x,c.x,u.x),EF(a,o.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new re().fromArray(i))}return this}},cue=Object.freeze({__proto__:null,ArcCurve:Jce,CatmullRomCurve3:eue,CubicBezierCurve:Do,CubicBezierCurve3:Hb,EllipseCurve:pT,LineCurve:No,LineCurve3:n8,QuadraticBezierCurve:jh,QuadraticBezierCurve3:lue,SplineCurve:g3}),s8=class extends Jl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new No(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new cue[i.type]().fromJSON(i))}return this}},tS=class extends s8{constructor(e){super(),this.type="Path",this.currentPoint=new re,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new No(this.currentPoint.clone(),new re(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new jh(this.currentPoint.clone(),new re(e,t),new re(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new Do(this.currentPoint.clone(),new re(e,t),new re(r,i),new re(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new g3(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new pT(e,t,r,i,n,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},a8=class extends pt{constructor(e=[new re(0,-.5),new re(.5,0),new re(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Hi(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],c=1/t,u=new R,h=new re,d=new R,p=new R,f=new R,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){let y=r+v*c*i,w=Math.sin(y),b=Math.cos(y);for(let E=0;E<=e.length-1;E++){u.x=e[E].x*w,u.y=e[E].y,u.z=e[E].x*b,s.push(u.x,u.y,u.z),h.x=v/t,h.y=E/(e.length-1),a.push(h.x,h.y);let _=o[3*E+0]*w,C=o[3*E+1],x=o[3*E+0]*b;l.push(_,C,x)}}for(let v=0;v<t;v++)for(let y=0;y<e.length-1;y++){let w=y+v*e.length,b=w,E=w+e.length,_=w+e.length+1,C=w+1;n.push(b,E,C),n.push(_,C,E)}this.setIndex(n),this.setAttribute("position",new Ze(s,3)),this.setAttribute("uv",new Ze(a,2)),this.setAttribute("normal",new Ze(l,3))}static fromJSON(e){return new a8(e.points,e.segments,e.phiStart,e.phiLength)}},v3=class extends pt{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],u=[],h=[],d=[],p=0,f=[],m=r/2,g=0;v(),s===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Ze(u,3)),this.setAttribute("normal",new Ze(h,3)),this.setAttribute("uv",new Ze(d,2));function v(){let w=new R,b=new R,E=0,_=(t-e)/r;for(let C=0;C<=n;C++){let x=[],A=C/n,T=A*(t-e)+e;for(let M=0;M<=i;M++){let D=M/i,P=D*o+a,I=Math.sin(P),B=Math.cos(P);b.x=T*I,b.y=-A*r+m,b.z=T*B,u.push(b.x,b.y,b.z),w.set(I,_,B).normalize(),h.push(w.x,w.y,w.z),d.push(D,1-A),x.push(p++)}f.push(x)}for(let C=0;C<i;C++)for(let x=0;x<n;x++){let A=f[x][C],T=f[x+1][C],M=f[x+1][C+1],D=f[x][C+1];c.push(A,T,D),c.push(T,M,D),E+=6}l.addGroup(g,E,0),g+=E}function y(w){let b=p,E=new re,_=new R,C=0,x=w===!0?e:t,A=w===!0?1:-1;for(let M=1;M<=i;M++)u.push(0,m*A,0),h.push(0,A,0),d.push(.5,.5),p++;let T=p;for(let M=0;M<=i;M++){let D=M/i*o+a,P=Math.cos(D),I=Math.sin(D);_.x=x*I,_.y=m*A,_.z=x*P,u.push(_.x,_.y,_.z),h.push(0,A,0),E.x=P*.5+.5,E.y=I*.5*A+.5,d.push(E.x,E.y),p++}for(let M=0;M<i;M++){let D=b+M,P=T+M;w===!0?c.push(P,P+1,D):c.push(P+1,P,D),C+=3}l.addGroup(g,C,w===!0?1:2),g+=C}}static fromJSON(e){return new v3(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},y3=class extends v3{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new y3(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},w3=class extends pt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),c(),this.setAttribute("position",new Ze(n,3)),this.setAttribute("normal",new Ze(n.slice(),3)),this.setAttribute("uv",new Ze(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){let y=new R,w=new R,b=new R;for(let E=0;E<t.length;E+=3)d(t[E+0],y),d(t[E+1],w),d(t[E+2],b),o(y,w,b,v)}function o(v,y,w,b){let E=b+1,_=[];for(let C=0;C<=E;C++){_[C]=[];let x=v.clone().lerp(w,C/E),A=y.clone().lerp(w,C/E),T=E-C;for(let M=0;M<=T;M++)M===0&&C===E?_[C][M]=x:_[C][M]=x.clone().lerp(A,M/T)}for(let C=0;C<E;C++)for(let x=0;x<2*(E-C)-1;x++){let A=Math.floor(x/2);x%2===0?(h(_[C][A+1]),h(_[C+1][A]),h(_[C][A])):(h(_[C][A+1]),h(_[C+1][A+1]),h(_[C+1][A]))}}function l(v){let y=new R;for(let w=0;w<n.length;w+=3)y.x=n[w+0],y.y=n[w+1],y.z=n[w+2],y.normalize().multiplyScalar(v),n[w+0]=y.x,n[w+1]=y.y,n[w+2]=y.z}function c(){let v=new R;for(let y=0;y<n.length;y+=3){v.x=n[y+0],v.y=n[y+1],v.z=n[y+2];let w=m(v)/2/Math.PI+.5,b=g(v)/Math.PI+.5;s.push(w,1-b)}p(),u()}function u(){for(let v=0;v<s.length;v+=6){let y=s[v+0],w=s[v+2],b=s[v+4],E=Math.max(y,w,b),_=Math.min(y,w,b);E>.9&&_<.1&&(y<.2&&(s[v+0]+=1),w<.2&&(s[v+2]+=1),b<.2&&(s[v+4]+=1))}}function h(v){n.push(v.x,v.y,v.z)}function d(v,y){let w=v*3;y.x=e[w+0],y.y=e[w+1],y.z=e[w+2]}function p(){let v=new R,y=new R,w=new R,b=new R,E=new re,_=new re,C=new re;for(let x=0,A=0;x<n.length;x+=9,A+=6){v.set(n[x+0],n[x+1],n[x+2]),y.set(n[x+3],n[x+4],n[x+5]),w.set(n[x+6],n[x+7],n[x+8]),E.set(s[A+0],s[A+1]),_.set(s[A+2],s[A+3]),C.set(s[A+4],s[A+5]),b.copy(v).add(y).add(w).divideScalar(3);let T=m(b);f(E,A+0,v,T),f(_,A+2,y,T),f(C,A+4,w,T)}}function f(v,y,w,b){b<0&&v.x===1&&(s[y]=v.x-1),w.x===0&&w.z===0&&(s[y]=b/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new w3(e.vertices,e.indices,e.radius,e.details)}},o8=class extends w3{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new o8(e.radius,e.detail)}},rS=class extends tS{constructor(e){super(e),this.uuid=eo(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new tS().fromJSON(i))}return this}},uue={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=l8(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,h,d,p;if(i&&(s=mue(e,t,s,r)),e.length>80*r){o=c=e[0],l=u=e[1];for(let f=r;f<n;f+=r)h=e[f],d=e[f+1],h<o&&(o=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-o,u-l),p=p!==0?32767/p:0}return B0(s,a,r,o,l,p,0),a}};function l8(e,t,r,i,n){let s,a;if(n===Cue(e,t,r,i)>0)for(s=t;s<r;s+=i)a=TF(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=TF(s,e[s],e[s+1],a);return a&&fT(a,a.next)&&(U0(a),a=a.next),a}function vp(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(fT(r,r.next)||ui(r.prev,r,r.next)===0)){if(U0(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function B0(e,t,r,i,n,s,a){if(!e)return;!a&&s&&xue(e,i,n,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?due(e,i,n,s):hue(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),U0(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=pue(vp(e),t,r),B0(e,t,r,i,n,s,2)):a===2&&fue(e,t,r,i,n,s):B0(vp(e),t,r,i,n,s,1);break}}}function hue(e){let t=e.prev,r=e,i=e.next;if(ui(t,r,i)>=0)return!1;let n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,c=i.y,u=n<s?n<a?n:a:s<a?s:a,h=o<l?o<c?o:c:l<c?l:c,d=n>s?n>a?n:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c,f=i.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&vm(n,o,s,l,a,c,f.x,f.y)&&ui(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function due(e,t,r,i){let n=e.prev,s=e,a=e.next;if(ui(n,s,a)>=0)return!1;let o=n.x,l=s.x,c=a.x,u=n.y,h=s.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=o>l?o>c?o:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,v=c2(p,f,t,r,i),y=c2(m,g,t,r,i),w=e.prevZ,b=e.nextZ;for(;w&&w.z>=v&&b&&b.z<=y;){if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==n&&w!==a&&vm(o,u,l,h,c,d,w.x,w.y)&&ui(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==a&&vm(o,u,l,h,c,d,b.x,b.y)&&ui(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=v;){if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==n&&w!==a&&vm(o,u,l,h,c,d,w.x,w.y)&&ui(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==a&&vm(o,u,l,h,c,d,b.x,b.y)&&ui(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function pue(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!fT(n,s)&&c8(n,i,i.next,s)&&F0(n,s)&&F0(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),U0(i),U0(i.next),i=e=s),i=i.next}while(i!==e);return vp(i)}function fue(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Sue(a,o)){let l=u8(a,o);a=vp(a,a.next),l=vp(l,l.next),B0(a,t,r,i,n,s,0),B0(l,t,r,i,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function mue(e,t,r,i){let n=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,c=l8(e,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(_ue(c));for(n.sort(gue),s=0;s<n.length;s++)r=vue(n[s],r);return r}function gue(e,t){return e.x-t.x}function vue(e,t){let r=yue(e,t);if(!r)return t;let i=u8(r,e);return vp(i,i.next),vp(r,r.next)}function yue(e,t){let r=t,i=-1/0,n,s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let d=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(d<=s&&d>i&&(i=d,n=r.x<r.next.x?r:r.next,d===s))return n}r=r.next}while(r!==t);if(!n)return null;let o=n,l=n.x,c=n.y,u=1/0,h;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&vm(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(h=Math.abs(a-r.y)/(s-r.x),F0(r,e)&&(h<u||h===u&&(r.x>n.x||r.x===n.x&&wue(n,r)))&&(n=r,u=h)),r=r.next;while(r!==o);return n}function wue(e,t){return ui(e.prev,e,t.prev)<0&&ui(t.next,e,e.next)<0}function xue(e,t,r,i){let n=e;do n.z===0&&(n.z=c2(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,bue(n)}function bue(e){let t,r,i,n,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<c&&(o++,i=i.nextZ,!!i);t++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(a>1);return e}function c2(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function _ue(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function vm(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function Sue(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Eue(e,t)&&(F0(e,t)&&F0(t,e)&&Tue(e,t)&&(ui(e.prev,e,t.prev)||ui(e,t.prev,t))||fT(e,t)&&ui(e.prev,e,e.next)>0&&ui(t.prev,t,t.next)>0)}function ui(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function fT(e,t){return e.x===t.x&&e.y===t.y}function c8(e,t,r,i){let n=h1(ui(e,t,r)),s=h1(ui(e,t,i)),a=h1(ui(r,i,e)),o=h1(ui(r,i,t));return!!(n!==s&&a!==o||n===0&&u1(e,r,t)||s===0&&u1(e,i,t)||a===0&&u1(r,e,i)||o===0&&u1(r,t,i))}function u1(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function h1(e){return e>0?1:e<0?-1:0}function Eue(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&c8(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function F0(e,t){return ui(e.prev,e,e.next)<0?ui(e,t,e.next)>=0&&ui(e,e.prev,t)>=0:ui(e,t,e.prev)<0||ui(e,e.next,t)<0}function Tue(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function u8(e,t){let r=new u2(e.i,e.x,e.y),i=new u2(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function TF(e,t,r,i){let n=new u2(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function U0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function u2(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cue(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var h8=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return h8.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];CF(e),AF(r,e);let s=e.length;t.forEach(CF);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,AF(r,t[o]);let a=uue.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function CF(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function AF(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var d8=class extends w3{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new d8(e.radius,e.detail)}},Pm=class extends pt{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new R,h=new R,d=[],p=[],f=[],m=[];for(let g=0;g<=r;g++){let v=[],y=g/r,w=0;g==0&&s==0?w=.5/t:g==r&&o==Math.PI&&(w=-.5/t);for(let b=0;b<=t;b++){let E=b/t;u.x=-e*Math.cos(i+E*n)*Math.sin(s+y*a),u.y=e*Math.cos(s+y*a),u.z=e*Math.sin(i+E*n)*Math.sin(s+y*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(E+w,1-y),v.push(l++)}c.push(v)}for(let g=0;g<r;g++)for(let v=0;v<t;v++){let y=c[g][v+1],w=c[g][v],b=c[g+1][v],E=c[g+1][v+1];(g!==0||s>0)&&d.push(y,w,E),(g!==r-1||o<Math.PI)&&d.push(w,b,E)}this.setIndex(d),this.setAttribute("position",new Ze(p,3)),this.setAttribute("normal",new Ze(f,3)),this.setAttribute("uv",new Ze(m,2))}static fromJSON(e){return new Pm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},p8=class extends pt{constructor(e=1,t=.4,r=12,i=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let s=[],a=[],o=[],l=[],c=new R,u=new R,h=new R;for(let d=0;d<=r;d++)for(let p=0;p<=i;p++){let f=p/i*n,m=d/r*Math.PI*2;u.x=(e+t*Math.cos(m))*Math.cos(f),u.y=(e+t*Math.cos(m))*Math.sin(f),u.z=t*Math.sin(m),a.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),h.subVectors(u,c).normalize(),o.push(h.x,h.y,h.z),l.push(p/i),l.push(d/r)}for(let d=1;d<=r;d++)for(let p=1;p<=i;p++){let f=(i+1)*d+p-1,m=(i+1)*(d-1)+p-1,g=(i+1)*(d-1)+p,v=(i+1)*d+p;s.push(f,m,v),s.push(m,g,v)}this.setIndex(s),this.setAttribute("position",new Ze(a,3)),this.setAttribute("normal",new Ze(o,3)),this.setAttribute("uv",new Ze(l,2))}static fromJSON(e){return new p8(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},f8=class extends pt{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],c=[],u=new R,h=new R,d=new R,p=new R,f=new R,m=new R,g=new R;for(let y=0;y<=r;++y){let w=y/r*n*Math.PI*2;v(w,n,s,e,d),v(w+.01,n,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let b=0;b<=i;++b){let E=b/i*Math.PI*2,_=-t*Math.cos(E),C=t*Math.sin(E);u.x=d.x+(_*g.x+C*f.x),u.y=d.y+(_*g.y+C*f.y),u.z=d.z+(_*g.z+C*f.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/r),c.push(b/i)}}for(let y=1;y<=r;y++)for(let w=1;w<=i;w++){let b=(i+1)*(y-1)+(w-1),E=(i+1)*y+(w-1),_=(i+1)*y+w,C=(i+1)*(y-1)+w;a.push(b,E,C),a.push(E,_,C)}this.setIndex(a),this.setAttribute("position",new Ze(o,3)),this.setAttribute("normal",new Ze(l,3)),this.setAttribute("uv",new Ze(c,2));function v(y,w,b,E,_){let C=Math.cos(y),x=Math.sin(y),A=b/w*y,T=Math.cos(A);_.x=E*(2+T)*.5*C,_.y=E*(2+T)*x*.5,_.z=E*Math.sin(A)*.5}}static fromJSON(e){return new f8(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function Mu(e,t,r){return m8(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function d1(e,t,r){return!e||!r&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function m8(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Aue(e){function t(n,s){return e[n]-e[s]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function MF(e,t,r){let i=e.length,n=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let o=r[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function g8(e,t,r,i){let n=1,s=e[0];for(;s!==void 0&&s[i]===void 0;)s=e[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(t.push(s.time),r.push.apply(r,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(t.push(s.time),a.toArray(r,r.length)),s=e[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(t.push(s.time),r.push(a)),s=e[n++];while(s!==void 0)}var mT=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let o=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0;break r}break e}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let s=0;s!==i;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Mue=class extends mT{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fm,endingEnd:fm}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,a=i[n],o=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case mm:n=e,a=2*t-r;break;case K_:n=i.length-2,a=t+i[n]-i[n+1];break;default:n=e,a=r}if(o===void 0)switch(this.getSettings_().endingEnd){case mm:s=e,o=2*r-t;break;case K_:s=1,o=r+i[1]-i[0];break;default:s=e-1,o=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,w=d*m-d*f;for(let b=0;b!==a;++b)n[b]=g*s[c+b]+v*s[l+b]+y*s[o+b]+w*s[u+b];return n}},v8=class extends mT{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(i-t),u=1-c;for(let h=0;h!==a;++h)n[h]=s[l+h]*u+s[o+h]*c;return n}},Pue=class extends mT{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},ec=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=d1(t,this.TimeBufferType),this.values=d1(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:d1(e.times,Array),values:d1(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Pue(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new v8(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Mue(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case $_:t=this.InterpolantFactoryMethodDiscrete;break;case Q_:t=this.InterpolantFactoryMethodLinear;break;case mA:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $_;case this.InterpolantFactoryMethodLinear:return Q_;case this.InterpolantFactoryMethodSmooth:return mA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=Mu(r,n,s),this.values=Mu(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=r[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(i!==void 0&&m8(i))for(let a=0,o=i.length;a!==o;++a){let l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=Mu(this.times),t=Mu(this.values),r=this.getValueSize(),i=this.getInterpolation()===mA,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(i)o=!0;else{let u=a*r,h=u-r,d=u+r;for(let p=0;p!==r;++p){let f=t[u+p];if(f!==t[h+p]||f!==t[d+p]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let u=a*r,h=s*r;for(let d=0;d!==r;++d)t[h+d]=t[u+d]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,o=s*r,l=0;l!==r;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=Mu(e,0,s),this.values=Mu(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=Mu(this.times,0),t=Mu(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};ec.prototype.TimeBufferType=Float32Array;ec.prototype.ValueBufferType=Float32Array;ec.prototype.DefaultInterpolation=Q_;var Xg=class extends ec{};Xg.prototype.ValueTypeName="bool";Xg.prototype.ValueBufferType=Array;Xg.prototype.DefaultInterpolation=$_;Xg.prototype.InterpolantFactoryMethodLinear=void 0;Xg.prototype.InterpolantFactoryMethodSmooth=void 0;var y8=class extends ec{};y8.prototype.ValueTypeName="color";var iS=class extends ec{};iS.prototype.ValueTypeName="number";var Due=class extends mT{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)Dt.slerpFlat(n,0,s,l-a,s,l,o);return n}},kw=class extends ec{InterpolantFactoryMethodLinear(e){return new Due(this.times,this.values,this.getValueSize(),e)}};kw.prototype.ValueTypeName="quaternion";kw.prototype.DefaultInterpolation=Q_;kw.prototype.InterpolantFactoryMethodSmooth=void 0;var $g=class extends ec{};$g.prototype.ValueTypeName="string";$g.prototype.ValueBufferType=Array;$g.prototype.DefaultInterpolation=$_;$g.prototype.InterpolantFactoryMethodLinear=void 0;$g.prototype.InterpolantFactoryMethodSmooth=void 0;var nS=class extends ec{};nS.prototype.ValueTypeName="vector";var h2=class{constructor(e,t=-1,r,i=l3){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=eo(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(Oue(r[s]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(ec.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let c=Aue(o);o=MF(o,1,c),l=MF(l,1,c),!i&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new iS(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(n);if(c&&c.length>1){let u=c[1],h=i[u];h||(i[u]=h=[]),h.push(l)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,u,h,d,p){if(h.length!==0){let f=[],m=[];g8(h,f,m,d),f.length!==0&&p.push(new c(u,f,m))}},i=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let h={},d;for(d=0;d<u.length;d++)if(u[d].morphTargets)for(let p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(let p in h){let f=[],m=[];for(let g=0;g!==u[d].morphTargets.length;++g){let v=u[d];f.push(v.time),m.push(v.morphTarget===p?1:0)}i.push(new iS(".morphTargetInfluence["+p+"]",f,m))}o=h.length*s}else{let h=".bones["+t[c].name+"]";r(nS,h+".position",u,"pos",i),r(kw,h+".quaternion",u,"rot",i),r(nS,h+".scale",u,"scl",i)}}return i.length===0?null:new this(n,o,i,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Iue(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return iS;case"vector":case"vector2":case"vector3":case"vector4":return nS;case"color":return y8;case"quaternion":return kw;case"bool":case"boolean":return Xg;case"string":return $g}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Oue(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=Iue(e.type);if(e.times===void 0){let r=[],i=[];g8(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var sS={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},w8=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,n===!1&&i.onStart!==void 0&&i.onStart(c,s,a),n=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,h=l.length;u<h;u+=2){let d=l[u],p=l[u+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}},Rue=new w8,Lw=class{constructor(e){this.manager=e!==void 0?e:Rue,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},dc={},kue=class extends Error{constructor(e,t){super(e),this.response=t}},d2=class extends Lw{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=sS.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(dc[e]!==void 0){dc[e].push({onLoad:t,onProgress:r,onError:i});return}dc[e]=[],dc[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=dc[e],u=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0,f=0,m=new ReadableStream({start(g){v();function v(){u.read().then(({done:y,value:w})=>{if(y)g.close();else{f+=w.byteLength;let b=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:d});for(let E=0,_=c.length;E<_;E++){let C=c[E];C.onProgress&&C.onProgress(b)}g.enqueue(w),v()}})}}});return new Response(m)}else throw new kue(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),u=c&&c[1]?c[1].toLowerCase():void 0,h=new TextDecoder(u);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{sS.add(e,l);let c=dc[e];delete dc[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=dc[e];if(c===void 0)throw this.manager.itemError(e),l;delete dc[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},Lue=class extends Lw{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=sS.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a=N0("img");function o(){c(),sS.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(u){c(),i&&i(u),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}},Nue=class extends Lw{constructor(e){super(e)}load(e,t,r,i){let n=new pi,s=new Lue(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){n.image=a,n.needsUpdate=!0,t!==void 0&&t(n)},r,i),n}},Nw=class extends Cr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new bt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},zue=class extends Nw{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Cr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new bt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},GA=new Be,PF=new R,DF=new R,x3=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new re(512,512),this.map=null,this.mapPass=null,this.matrix=new Be,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new d3,this._frameExtents=new re(1,1),this._viewportCount=1,this._viewports=[new It(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;PF.setFromMatrixPosition(e.matrixWorld),t.position.copy(PF),DF.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(DF),t.updateMatrixWorld(),GA.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(GA),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(GA)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Bue=class extends x3{constructor(){super(new ls(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=L0*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Fue=class extends Nw{constructor(e,t,r=0,i=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Cr.DEFAULT_UP),this.updateMatrix(),this.target=new Cr,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new Bue}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},IF=new Be,Wv=new R,qA=new R,Uue=class extends x3{constructor(){super(new ls(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new re(4,2),this._viewportCount=6,this._viewports=[new It(2,1,1,1),new It(0,1,1,1),new It(3,1,1,1),new It(1,1,1,1),new It(3,0,1,1),new It(1,0,1,1)],this._cubeDirections=[new R(1,0,0),new R(-1,0,0),new R(0,0,1),new R(0,0,-1),new R(0,1,0),new R(0,-1,0)],this._cubeUps=[new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,0,1),new R(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Wv.setFromMatrixPosition(e.matrixWorld),r.position.copy(Wv),qA.copy(r.position),qA.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(qA),r.updateMatrixWorld(),i.makeTranslation(-Wv.x,-Wv.y,-Wv.z),IF.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IF)}},jue=class extends Nw{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Uue}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Vue=class extends x3{constructor(){super(new hT(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Hue=class extends Nw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Cr.DEFAULT_UP),this.updateMatrix(),this.target=new Cr,this.shadow=new Vue}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},x8=class extends pt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},b8=class extends Lw{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new d2(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(h,d){if(t[d]!==void 0)return t[d];let p=h.interleavedBuffers[d],f=n(h,p.buffer),m=Vx(p.type,f),g=new Yce(m,p.stride);return g.uuid=p.uuid,t[d]=g,g}function n(h,d){if(r[d]!==void 0)return r[d];let p=h.arrayBuffers[d],f=new Uint32Array(p).buffer;return r[d]=f,f}let s=e.isInstancedBufferGeometry?new x8:new pt,a=e.data.index;if(a!==void 0){let h=Vx(a.type,a.array);s.setIndex(new Mt(h,1))}let o=e.data.attributes;for(let h in o){let d=o[h],p;if(d.isInterleavedBufferAttribute){let f=i(e.data,d.data);p=new l2(f,d.itemSize,d.offset,d.normalized)}else{let f=Vx(d.type,d.array),m=d.isInstancedBufferAttribute?z0:Mt;p=new m(f,d.itemSize,d.normalized)}d.name!==void 0&&(p.name=d.name),d.usage!==void 0&&p.setUsage(d.usage),d.updateRange!==void 0&&(p.updateRange.offset=d.updateRange.offset,p.updateRange.count=d.updateRange.count),s.setAttribute(h,p)}let l=e.data.morphAttributes;if(l)for(let h in l){let d=l[h],p=[];for(let f=0,m=d.length;f<m;f++){let g=d[f],v;if(g.isInterleavedBufferAttribute){let y=i(e.data,g.data);v=new l2(y,g.itemSize,g.offset,g.normalized)}else{let y=Vx(g.type,g.array);v=new Mt(y,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),p.push(v)}s.morphAttributes[h]=p}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let h=0,d=c.length;h!==d;++h){let p=c[h];s.addGroup(p.start,p.count,p.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let h=new R;u.center!==void 0&&h.fromArray(u.center),s.boundingSphere=new ca(h,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},Wue=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=OF(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=OF();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function OF(){return(typeof performance>"u"?Date:performance).now()}var Gue=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,s;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)r[n+a]=r[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(r,n,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,s=i;n!==s;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let s=0;s!==n;++s)e[t+s]=e[r+s]}_slerp(e,t,r,i){Dt.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let s=this._workIndex*n;Dt.multiplyQuaternionsFlat(e,s,e,t,e,r),Dt.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){let s=1-i;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[r+a]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[r+s]*i}}},b3="\\[\\]\\.:\\/",que=new RegExp("["+b3+"]","g"),_3="[^"+b3+"]",Yue="[^"+b3.replace("\\.","")+"]",Xue=/((?:WC+[\/:])*)/.source.replace("WC",_3),$ue=/(WCOD+)?/.source.replace("WCOD",Yue),Que=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_3),Kue=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_3),Zue=new RegExp("^"+Xue+$ue+Que+Kue+"$"),Jue=["material","materials","bones","map"],ehe=class{constructor(e,t,r){let i=r||Br.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Br=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Br.parseTrackName(t),this.node=Br.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Br.Composite(e,t,r):new Br(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(que,"")}static parseTrackName(e){let t=Zue.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);Jue.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=r(a.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=Br.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[i];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Br.Composite=ehe;Br.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Br.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Br.prototype.GetterByBindingType=[Br.prototype._getValue_direct,Br.prototype._getValue_array,Br.prototype._getValue_arrayElement,Br.prototype._getValue_toArray];Br.prototype.SetterByBindingTypeAndVersioning=[[Br.prototype._setValue_direct,Br.prototype._setValue_direct_setNeedsUpdate,Br.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Br.prototype._setValue_array,Br.prototype._setValue_array_setNeedsUpdate,Br.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Br.prototype._setValue_arrayElement,Br.prototype._setValue_arrayElement_setNeedsUpdate,Br.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Br.prototype._setValue_fromArray,Br.prototype._setValue_fromArray_setNeedsUpdate,Br.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var the=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:fm,endingEnd:fm};for(let l=0;l!==s;++l){let c=n[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=F9,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,s=n/i,a=i/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case Ine:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case l3:default:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,s=r===o3;if(e===0)return n===-1?i:s&&(n&1)===1?t-i:i;if(r===B9){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=mm,i.endingEnd=mm):(e?i.endingStart=this.zeroSlopeAtStart?mm:fm:i.endingStart=K_,t?i.endingEnd=this.zeroSlopeAtEnd?mm:fm:i.endingEnd=K_)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=r,this}},rhe=new Float32Array(1),ihe=class extends Kn{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let u=0;u!==n;++u){let h=i[u],d=h.name,p=c[d];if(p!==void 0)++p.referenceCount,s[u]=p;else{if(p=s[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,o,d));continue}let f=t&&t._propertyBindings[u].binding.parsedPath;p=new Gue(Br.create(r,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,o,d),s[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let u=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,s=i[t];s===void 0&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new v8(new Float32Array(2),new Float32Array(2),1,rhe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,s=typeof e=="string"?h2.findByName(i,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(r===void 0&&(s!==null?r=s.blendMode:r=l3),o!==void 0){let u=o.actionByRoot[n];if(u!==void 0&&u.blendMode===r)return u;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new the(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?h2.findByName(r,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let s in r){let a=r[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},ke=class{constructor(t){this.value=t}clone(){return new ke(this.value.clone===void 0?this.value:this.value.clone())}},_8=class{constructor(e,t,r=0,i=1/0){this.ray=new Gg(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new u3,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return p2(e,this,r,t),r.sort(RF),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)p2(e[i],this,r,t);return r.sort(RF),r}};function RF(e,t){return e.distance-t.distance}function p2(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)p2(n[s],t,r,!0)}}var kF=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Hi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},LF=new re,S8=class{constructor(e=new re(1/0,1/0),t=new re(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=LF.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return LF.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},NF=new R,p1=new R,to=class{constructor(e=new R,t=new R){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){NF.subVectors(e,this.start),p1.subVectors(this.end,this.start);let r=p1.dot(p1),i=p1.dot(NF)/r;return t&&(i=Hi(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},zF=new R,nhe=class extends Cr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new pt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new Ze(i,3));let n=new nd({fog:!1,toneMapped:!1});this.cone=new Rw(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),zF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(zF),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},she=class extends Ii{constructor(e,t,r){let i=new Pm(t,4,2),n=new Vp({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},BF=new R,f1=new R,FF=new R,ahe=class extends Cr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new pt;i.setAttribute("position",new Ze([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new nd({fog:!1,toneMapped:!1});this.lightPlane=new eS(i,n),this.add(this.lightPlane),i=new pt,i.setAttribute("position",new Ze([0,0,0,0,0,1],3)),this.targetLine=new eS(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),BF.setFromMatrixPosition(this.light.matrixWorld),f1.setFromMatrixPosition(this.light.target.matrixWorld),FF.subVectors(f1,BF),this.lightPlane.lookAt(f1),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(f1),this.targetLine.scale.z=FF.length()}},m1=new R,wi=new Hp,aS=class extends Rw{constructor(e){let t=new pt,r=new nd({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,f){o(p),o(f)}function o(p){i.push(0,0,0),n.push(0,0,0),s[p]===void 0&&(s[p]=[]),s[p].push(i.length/3-1)}t.setAttribute("position",new Ze(i,3)),t.setAttribute("color",new Ze(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new bt(16755200),c=new bt(16711680),u=new bt(43775),h=new bt(16777215),d=new bt(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,r,i,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;wi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ai("c",t,e,wi,0,0,-1),Ai("t",t,e,wi,0,0,1),Ai("n1",t,e,wi,-r,-i,-1),Ai("n2",t,e,wi,r,-i,-1),Ai("n3",t,e,wi,-r,i,-1),Ai("n4",t,e,wi,r,i,-1),Ai("f1",t,e,wi,-r,-i,1),Ai("f2",t,e,wi,r,-i,1),Ai("f3",t,e,wi,-r,i,1),Ai("f4",t,e,wi,r,i,1),Ai("u1",t,e,wi,r*.7,i*1.1,-1),Ai("u2",t,e,wi,-r*.7,i*1.1,-1),Ai("u3",t,e,wi,0,i*2,-1),Ai("cf1",t,e,wi,-r,0,1),Ai("cf2",t,e,wi,r,0,1),Ai("cf3",t,e,wi,0,-i,1),Ai("cf4",t,e,wi,0,i,1),Ai("cn1",t,e,wi,-r,0,-1),Ai("cn2",t,e,wi,r,0,-1),Ai("cn3",t,e,wi,0,-i,-1),Ai("cn4",t,e,wi,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ai(e,t,r,i,n,s,a){m1.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],m1.x,m1.y,m1.z)}}var oS=class extends Rw{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new pt;n.setIndex(new Mt(r,1)),n.setAttribute("position",new Ze(i,3)),super(n,new nd({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},ohe=class extends Rw{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new pt;i.setAttribute("position",new Ze(t,3)),i.setAttribute("color",new Ze(r,3));let n=new nd({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new bt,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Ic=lhe();function lhe(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),i=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,n[l]=24,n[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,n[l]=-c-1,n[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,n[l]=13,n[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,n[l]=24,n[l|256]=24):(i[l]=31744,i[l|256]=64512,n[l]=13,n[l|256]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:t,uint32View:r,baseTable:i,shiftTable:n,mantissaTable:s,exponentTable:a,offsetTable:o}}function che(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Hi(e,-65504,65504),Ic.floatView[0]=e;let t=Ic.uint32View[0],r=t>>23&511;return Ic.baseTable[r]+((t&8388607)>>Ic.shiftTable[r])}function uhe(e){let t=e>>10;return Ic.uint32View[0]=Ic.mantissaTable[Ic.offsetTable[t]+(e&1023)]+Ic.exponentTable[t],Ic.floatView[0]}var hhe=Object.freeze({__proto__:null,fromHalfFloat:uhe,toHalfFloat:che});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Wg}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Wg);var Gv=".",S3=Symbol("target"),E8=Symbol("unsubscribe");function f2(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function dhe(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Sl=Array.isArray;function E3(e){return typeof e=="symbol"}var phe={after:(e,t)=>Sl(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Sl(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Gv),E3(t)?e+t.toString():e+t):e,initial:e=>{if(Sl(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Gv);return t===-1?"":e.slice(0,t)},last:e=>{if(Sl(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Gv);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Sl(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(Gv);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(Gv,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Ha=phe;function fhe(e){return typeof e=="object"&&typeof e.next=="function"}function mhe(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[S3].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function UF(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&E3(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var ghe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Ha.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function m2(e){return toString.call(e)==="[object Object]"}function g1(){return!0}function Sf(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var T8=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),vhe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),C8={push:g1,pop:g1,shift:g1,unshift:g1,copyWithin:Sf,reverse:Sf,sort:Sf,splice:Sf,flat:Sf,fill:Sf},yhe=new Set([...T8,...vhe,...Object.keys(C8)]);function v1(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var A8=["keys","values","entries"],M8=new Set(["has","toString"]),P8={add:v1,clear:v1,delete:v1,forEach:v1},whe=new Set([...M8,...Object.keys(P8),...A8]);function y1(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var xhe=new Set([...M8,"get"]),D8={set:y1,clear:y1,delete:y1,forEach:y1},bhe=new Set([...xhe,...Object.keys(D8),...A8]),Vh=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return T8.has(e)}_shallowClone(e){let t=e;if(m2(e))t={...e};else if(Sl(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Sl(i)?this._onIsChanged=C8[t]:i instanceof Set?this._onIsChanged=P8[t]:i instanceof Map&&(this._onIsChanged=D8[t]),i):r}update(e,t,r){let i=Ha.after(e,this._path);if(t!=="length"){let n=this.clone;Ha.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Ha.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},jF=class extends Vh{static isHandledMethod(e){return yhe.has(e)}},_he=class extends Vh{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},VF=class extends Vh{static isHandledMethod(e){return whe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},HF=class extends Vh{static isHandledMethod(t){return bhe.has(t)}undo(t){for(let[r,i]of this.clone.entries())t.set(r,i);for(let r of t.keys())this.clone.has(r)||t.delete(r)}},She=class extends Vh{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},Ehe=class extends Vh{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},Gf=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return m2(e)||Sl(e)||f2(e)}static isHandledMethod(e,t){return m2(e)?Vh.isHandledMethod(t):Sl(e)?jF.isHandledMethod(t):e instanceof Set?VF.isHandledMethod(t):e instanceof Map?HF.isHandledMethod(t):f2(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Vh;Sl(e)?i=jF:e instanceof Date?i=_he:e instanceof Set?i=VF:e instanceof Map?i=HF:e instanceof WeakSet?i=She:e instanceof WeakMap&&(i=Ehe),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=Gf.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},The={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},T3=(e,t,r={})=>{r={...The,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new ghe(n),c=typeof r.onValidate=="function",u=new Gf(c),h=(y,w,b,E,_)=>!c||u.isCloning||r.onValidate(Ha.concat(l.getPath(y),w),b,E,_)===!0,d=(y,w,b,E)=>{!UF(l,r,w)&&!(a&&l.isDetached(y,e))&&p(l.getPath(y),w,b,E)},p=(y,w,b,E,_)=>{u.isCloning?u.update(y,w,E):t(Ha.concat(y,w),b,E,_)},f=y=>y&&(y[i]||y),m=(y,w,b,E)=>dhe(y)||b==="constructor"||s&&!Gf.isHandledMethod(w,b)||UF(l,r,b)||l.isGetInvariant(w,b)||a&&l.isDetached(w,e)?y:(E===void 0&&(E=l.getPath(w)),l.getProxy(y,Ha.concat(E,b),g,i)),g={get(y,w,b){if(E3(w)){if(w===i||w===S3)return y;if(w===E8&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let E=f2(y)?Reflect.get(y,w):Reflect.get(y,w,b);return m(E,y,w)},set(y,w,b,E){b=f(b);let _=y[i]||y,C=_[w];if(n(C,b)&&w in y)return!0;let x=h(y,w,b,C);return x&&l.setProperty(_,w,b,E,C)?(d(y,w,y[w],C),!0):!x},defineProperty(y,w,b){if(!l.isSameDescriptor(b,y,w)){let E=y[w];h(y,w,b.value,E)&&l.defineProperty(y,w,b,E)&&d(y,w,b.value,E)}return!0},deleteProperty(y,w){if(!Reflect.has(y,w))return!0;let b=Reflect.get(y,w),E=h(y,w,void 0,b);return E&&l.deleteProperty(y,w,b)?(d(y,w,void 0,b),!0):!E},apply(y,w,b){let E=w[i]||w;if(l.isUnsubscribed)return Reflect.apply(y,E,b);if((o===!1||o!==!0&&!o.includes(y.name))&&Gf.isHandledType(E)){let _=Ha.initial(l.getPath(y)),C=Gf.isHandledMethod(E,y.name);u.start(E,_,b);let x=Reflect.apply(y,u.preferredThisArg(y,w,E),C?b.map(M=>f(M)):b),A=u.isChanged(E,n),T=u.stop();if(Gf.isHandledType(x)&&C&&(w instanceof Map&&y.name==="get"&&(_=Ha.concat(_,b[0])),x=l.getProxy(x,_,g)),A){let M={name:y.name,args:b,result:x},D=u.isCloning?Ha.initial(_):_,P=u.isCloning?Ha.last(_):"";h(Ha.get(e,D),P,E,T,M)?p(D,P,E,T,M):u.undo(E)}return(w instanceof Map||w instanceof Set)&&fhe(x)?mhe(x,y,w,_,m):x}return Reflect.apply(y,w,b)}},v=l.getProxy(e,r.pathAsArray?[]:"",g);return t=t.bind(v),c&&(r.onValidate=r.onValidate.bind(v)),v};T3.target=e=>e&&e[S3]||e;T3.unsubscribe=e=>e[E8]||e;var WF=T3,Che=typeof global=="object"&&global&&global.Object===Object&&global,I8=Che,Ahe=typeof self=="object"&&self&&self.Object===Object&&self,Mhe=I8||Ahe||Function("return this")(),$o=Mhe,Phe=$o.Symbol,oo=Phe,O8=Object.prototype,Dhe=O8.hasOwnProperty,Ihe=O8.toString,qv=oo?oo.toStringTag:void 0;function Ohe(e){var t=Dhe.call(e,qv),r=e[qv];try{e[qv]=void 0;var i=!0}catch{}var n=Ihe.call(e);return i&&(t?e[qv]=r:delete e[qv]),n}var Rhe=Ohe,khe=Object.prototype,Lhe=khe.toString;function Nhe(e){return Lhe.call(e)}var zhe=Nhe,Bhe="[object Null]",Fhe="[object Undefined]",GF=oo?oo.toStringTag:void 0;function Uhe(e){return e==null?e===void 0?Fhe:Bhe:GF&&GF in Object(e)?Rhe(e):zhe(e)}var Gp=Uhe;function jhe(e){return e!=null&&typeof e=="object"}var lu=jhe,Vhe="[object Symbol]";function Hhe(e){return typeof e=="symbol"||lu(e)&&Gp(e)==Vhe}var gT=Hhe;function Whe(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var R8=Whe,Ghe=Array.isArray,Wl=Ghe,qhe=1/0,qF=oo?oo.prototype:void 0,YF=qF?qF.toString:void 0;function k8(e){if(typeof e=="string")return e;if(Wl(e))return R8(e,k8)+"";if(gT(e))return YF?YF.call(e):"";var t=e+"";return t=="0"&&1/e==-qhe?"-0":t}var Yhe=k8,Xhe=/\s/;function $he(e){for(var t=e.length;t--&&Xhe.test(e.charAt(t)););return t}var Qhe=$he,Khe=/^\s+/;function Zhe(e){return e&&e.slice(0,Qhe(e)+1).replace(Khe,"")}var Jhe=Zhe;function ede(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Go=ede,XF=NaN,tde=/^[-+]0x[0-9a-f]+$/i,rde=/^0b[01]+$/i,ide=/^0o[0-7]+$/i,nde=parseInt;function sde(e){if(typeof e=="number")return e;if(gT(e))return XF;if(Go(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Go(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Jhe(e);var r=rde.test(e);return r||ide.test(e)?nde(e.slice(2),r?2:8):tde.test(e)?XF:+e}var $F=sde;function ade(e){return e}var ode=ade,lde="[object AsyncFunction]",cde="[object Function]",ude="[object GeneratorFunction]",hde="[object Proxy]";function dde(e){if(!Go(e))return!1;var t=Gp(e);return t==cde||t==ude||t==lde||t==hde}var L8=dde,pde=$o["__core-js_shared__"],YA=pde,QF=function(){var e=/[^.]+$/.exec(YA&&YA.keys&&YA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fde(e){return!!QF&&QF in e}var mde=fde,gde=Function.prototype,vde=gde.toString;function yde(e){if(e!=null){try{return vde.call(e)}catch{}try{return e+""}catch{}}return""}var qp=yde,wde=/[\\^$.*+?()[\]{}|]/g,xde=/^\[object .+?Constructor\]$/,bde=Function.prototype,_de=Object.prototype,Sde=bde.toString,Ede=_de.hasOwnProperty,Tde=RegExp("^"+Sde.call(Ede).replace(wde,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Cde(e){if(!Go(e)||mde(e))return!1;var t=L8(e)?Tde:xde;return t.test(qp(e))}var Ade=Cde;function Mde(e,t){return e==null?void 0:e[t]}var Pde=Mde;function Dde(e,t){var r=Pde(e,t);return Ade(r)?r:void 0}var Yp=Dde,Ide=Yp($o,"WeakMap"),g2=Ide,KF=Object.create,Ode=function(){function e(){}return function(t){if(!Go(t))return{};if(KF)return KF(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Rde=Ode;function kde(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Lde=kde;function Nde(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var zde=Nde,Bde=800,Fde=16,Ude=Date.now;function jde(e){var t=0,r=0;return function(){var i=Ude(),n=Fde-(i-r);if(r=i,n>0){if(++t>=Bde)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Vde=jde;function Hde(e){return function(){return e}}var Wde=Hde,Gde=function(){try{var e=Yp(Object,"defineProperty");return e({},"",{}),e}catch{}}(),lS=Gde,qde=lS?function(e,t){return lS(e,"toString",{configurable:!0,enumerable:!1,value:Wde(t),writable:!0})}:ode,Yde=qde,Xde=Vde(Yde),$de=Xde;function Qde(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var Kde=Qde,Zde=9007199254740991,Jde=/^(?:0|[1-9]\d*)$/;function epe(e,t){var r=typeof e;return t=t??Zde,!!t&&(r=="number"||r!="symbol"&&Jde.test(e))&&e>-1&&e%1==0&&e<t}var C3=epe;function tpe(e,t,r){t=="__proto__"&&lS?lS(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var N8=tpe;function rpe(e,t){return e===t||e!==e&&t!==t}var A3=rpe,ipe=Object.prototype,npe=ipe.hasOwnProperty;function spe(e,t,r){var i=e[t];(!(npe.call(e,t)&&A3(i,r))||r===void 0&&!(t in e))&&N8(e,t,r)}var M3=spe;function ape(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?N8(r,o,l):M3(r,o,l)}return r}var zw=ape,ZF=Math.max;function ope(e,t,r){return t=ZF(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=ZF(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),Lde(e,this,o)}}var lpe=ope,cpe=9007199254740991;function upe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=cpe}var P3=upe;function hpe(e){return e!=null&&P3(e.length)&&!L8(e)}var z8=hpe,dpe=Object.prototype;function ppe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||dpe;return e===r}var D3=ppe;function fpe(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var mpe=fpe,gpe="[object Arguments]";function vpe(e){return lu(e)&&Gp(e)==gpe}var JF=vpe,B8=Object.prototype,ype=B8.hasOwnProperty,wpe=B8.propertyIsEnumerable,xpe=JF(function(){return arguments}())?JF:function(e){return lu(e)&&ype.call(e,"callee")&&!wpe.call(e,"callee")},I3=xpe;function bpe(){return!1}var _pe=bpe,F8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,e4=F8&&typeof module=="object"&&module&&!module.nodeType&&module,Spe=e4&&e4.exports===F8,t4=Spe?$o.Buffer:void 0,Epe=t4?t4.isBuffer:void 0,Tpe=Epe||_pe,cS=Tpe,Cpe="[object Arguments]",Ape="[object Array]",Mpe="[object Boolean]",Ppe="[object Date]",Dpe="[object Error]",Ipe="[object Function]",Ope="[object Map]",Rpe="[object Number]",kpe="[object Object]",Lpe="[object RegExp]",Npe="[object Set]",zpe="[object String]",Bpe="[object WeakMap]",Fpe="[object ArrayBuffer]",Upe="[object DataView]",jpe="[object Float32Array]",Vpe="[object Float64Array]",Hpe="[object Int8Array]",Wpe="[object Int16Array]",Gpe="[object Int32Array]",qpe="[object Uint8Array]",Ype="[object Uint8ClampedArray]",Xpe="[object Uint16Array]",$pe="[object Uint32Array]",Zr={};Zr[jpe]=Zr[Vpe]=Zr[Hpe]=Zr[Wpe]=Zr[Gpe]=Zr[qpe]=Zr[Ype]=Zr[Xpe]=Zr[$pe]=!0;Zr[Cpe]=Zr[Ape]=Zr[Fpe]=Zr[Mpe]=Zr[Upe]=Zr[Ppe]=Zr[Dpe]=Zr[Ipe]=Zr[Ope]=Zr[Rpe]=Zr[kpe]=Zr[Lpe]=Zr[Npe]=Zr[zpe]=Zr[Bpe]=!1;function Qpe(e){return lu(e)&&P3(e.length)&&!!Zr[Gp(e)]}var Kpe=Qpe;function Zpe(e){return function(t){return e(t)}}var O3=Zpe,U8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Zy=U8&&typeof module=="object"&&module&&!module.nodeType&&module,Jpe=Zy&&Zy.exports===U8,XA=Jpe&&I8.process,efe=function(){try{var e=Zy&&Zy.require&&Zy.require("util").types;return e||XA&&XA.binding&&XA.binding("util")}catch{}}(),lg=efe,r4=lg&&lg.isTypedArray,tfe=r4?O3(r4):Kpe,j8=tfe,rfe=Object.prototype,ife=rfe.hasOwnProperty;function nfe(e,t){var r=Wl(e),i=!r&&I3(e),n=!r&&!i&&cS(e),s=!r&&!i&&!n&&j8(e),a=r||i||n||s,o=a?mpe(e.length,String):[],l=o.length;for(var c in e)(t||ife.call(e,c))&&!(a&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||C3(c,l)))&&o.push(c);return o}var V8=nfe;function sfe(e,t){return function(r){return e(t(r))}}var H8=sfe,afe=H8(Object.keys,Object),ofe=afe,lfe=Object.prototype,cfe=lfe.hasOwnProperty;function ufe(e){if(!D3(e))return ofe(e);var t=[];for(var r in Object(e))cfe.call(e,r)&&r!="constructor"&&t.push(r);return t}var hfe=ufe;function dfe(e){return z8(e)?V8(e):hfe(e)}var R3=dfe;function pfe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var ffe=pfe,mfe=Object.prototype,gfe=mfe.hasOwnProperty;function vfe(e){if(!Go(e))return ffe(e);var t=D3(e),r=[];for(var i in e)i=="constructor"&&(t||!gfe.call(e,i))||r.push(i);return r}var yfe=vfe;function wfe(e){return z8(e)?V8(e,!0):yfe(e)}var Ld=wfe,xfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bfe=/^\w*$/;function _fe(e,t){if(Wl(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||gT(e)?!0:bfe.test(e)||!xfe.test(e)||t!=null&&e in Object(t)}var Sfe=_fe,Efe=Yp(Object,"create"),j0=Efe;function Tfe(){this.__data__=j0?j0(null):{},this.size=0}var Cfe=Tfe;function Afe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Mfe=Afe,Pfe="__lodash_hash_undefined__",Dfe=Object.prototype,Ife=Dfe.hasOwnProperty;function Ofe(e){var t=this.__data__;if(j0){var r=t[e];return r===Pfe?void 0:r}return Ife.call(t,e)?t[e]:void 0}var Rfe=Ofe,kfe=Object.prototype,Lfe=kfe.hasOwnProperty;function Nfe(e){var t=this.__data__;return j0?t[e]!==void 0:Lfe.call(t,e)}var zfe=Nfe,Bfe="__lodash_hash_undefined__";function Ffe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=j0&&t===void 0?Bfe:t,this}var Ufe=Ffe;function Qg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Qg.prototype.clear=Cfe;Qg.prototype.delete=Mfe;Qg.prototype.get=Rfe;Qg.prototype.has=zfe;Qg.prototype.set=Ufe;var i4=Qg;function jfe(){this.__data__=[],this.size=0}var Vfe=jfe;function Hfe(e,t){for(var r=e.length;r--;)if(A3(e[r][0],t))return r;return-1}var vT=Hfe,Wfe=Array.prototype,Gfe=Wfe.splice;function qfe(e){var t=this.__data__,r=vT(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():Gfe.call(t,r,1),--this.size,!0}var Yfe=qfe;function Xfe(e){var t=this.__data__,r=vT(t,e);return r<0?void 0:t[r][1]}var $fe=Xfe;function Qfe(e){return vT(this.__data__,e)>-1}var Kfe=Qfe;function Zfe(e,t){var r=this.__data__,i=vT(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var Jfe=Zfe;function Kg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Kg.prototype.clear=Vfe;Kg.prototype.delete=Yfe;Kg.prototype.get=$fe;Kg.prototype.has=Kfe;Kg.prototype.set=Jfe;var yT=Kg,eme=Yp($o,"Map"),V0=eme;function tme(){this.size=0,this.__data__={hash:new i4,map:new(V0||yT),string:new i4}}var rme=tme;function ime(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var nme=ime;function sme(e,t){var r=e.__data__;return nme(t)?r[typeof t=="string"?"string":"hash"]:r.map}var wT=sme;function ame(e){var t=wT(this,e).delete(e);return this.size-=t?1:0,t}var ome=ame;function lme(e){return wT(this,e).get(e)}var cme=lme;function ume(e){return wT(this,e).has(e)}var hme=ume;function dme(e,t){var r=wT(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var pme=dme;function Zg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Zg.prototype.clear=rme;Zg.prototype.delete=ome;Zg.prototype.get=cme;Zg.prototype.has=hme;Zg.prototype.set=pme;var xT=Zg,fme="Expected a function";function k3(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(fme);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(k3.Cache||xT),r}k3.Cache=xT;var mme=k3,gme=500;function vme(e){var t=mme(e,function(i){return r.size===gme&&r.clear(),i}),r=t.cache;return t}var yme=vme,wme=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xme=/\\(\\)?/g,bme=yme(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(wme,function(r,i,n,s){t.push(n?s.replace(xme,"$1"):i||r)}),t}),_me=bme;function Sme(e){return e==null?"":Yhe(e)}var Eme=Sme;function Tme(e,t){return Wl(e)?e:Sfe(e,t)?[e]:_me(Eme(e))}var Jg=Tme,Cme=1/0;function Ame(e){if(typeof e=="string"||gT(e))return e;var t=e+"";return t=="0"&&1/e==-Cme?"-0":t}var bT=Ame;function Mme(e,t){t=Jg(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[bT(t[r++])];return r&&r==i?e:void 0}var W8=Mme;function Pme(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var L3=Pme,n4=oo?oo.isConcatSpreadable:void 0;function Dme(e){return Wl(e)||I3(e)||!!(n4&&e&&e[n4])}var Ime=Dme;function G8(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=Ime),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?G8(o,t-1,r,i,n):L3(n,o):i||(n[n.length]=o)}return n}var Ome=G8;function Rme(e){var t=e==null?0:e.length;return t?Ome(e,1):[]}var kme=Rme;function Lme(e){return $de(lpe(e,void 0,kme),e+"")}var q8=Lme,Nme=H8(Object.getPrototypeOf,Object),N3=Nme,zme="[object Object]",Bme=Function.prototype,Fme=Object.prototype,Y8=Bme.toString,Ume=Fme.hasOwnProperty,jme=Y8.call(Object);function Vme(e){if(!lu(e)||Gp(e)!=zme)return!1;var t=N3(e);if(t===null)return!0;var r=Ume.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Y8.call(r)==jme}var Hme=Vme;function Wme(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var Gme=Wme;function qme(){this.__data__=new yT,this.size=0}var Yme=qme;function Xme(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var $me=Xme;function Qme(e){return this.__data__.get(e)}var Kme=Qme;function Zme(e){return this.__data__.has(e)}var Jme=Zme,ege=200;function tge(e,t){var r=this.__data__;if(r instanceof yT){var i=r.__data__;if(!V0||i.length<ege-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new xT(i)}return r.set(e,t),this.size=r.size,this}var rge=tge;function ev(e){var t=this.__data__=new yT(e);this.size=t.size}ev.prototype.clear=Yme;ev.prototype.delete=$me;ev.prototype.get=Kme;ev.prototype.has=Jme;ev.prototype.set=rge;var Wb=ev;function ige(e,t){return e&&zw(t,R3(t),e)}var nge=ige;function sge(e,t){return e&&zw(t,Ld(t),e)}var age=sge,X8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,s4=X8&&typeof module=="object"&&module&&!module.nodeType&&module,oge=s4&&s4.exports===X8,a4=oge?$o.Buffer:void 0,o4=a4?a4.allocUnsafe:void 0;function lge(e,t){if(t)return e.slice();var r=e.length,i=o4?o4(r):new e.constructor(r);return e.copy(i),i}var cge=lge;function uge(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var hge=uge;function dge(){return[]}var $8=dge,pge=Object.prototype,fge=pge.propertyIsEnumerable,l4=Object.getOwnPropertySymbols,mge=l4?function(e){return e==null?[]:(e=Object(e),hge(l4(e),function(t){return fge.call(e,t)}))}:$8,z3=mge;function gge(e,t){return zw(e,z3(e),t)}var vge=gge,yge=Object.getOwnPropertySymbols,wge=yge?function(e){for(var t=[];e;)L3(t,z3(e)),e=N3(e);return t}:$8,Q8=wge;function xge(e,t){return zw(e,Q8(e),t)}var bge=xge;function _ge(e,t,r){var i=t(e);return Wl(e)?i:L3(i,r(e))}var K8=_ge;function Sge(e){return K8(e,R3,z3)}var v2=Sge;function Ege(e){return K8(e,Ld,Q8)}var Z8=Ege,Tge=Yp($o,"DataView"),y2=Tge,Cge=Yp($o,"Promise"),w2=Cge,Age=Yp($o,"Set"),x2=Age,c4="[object Map]",Mge="[object Object]",u4="[object Promise]",h4="[object Set]",d4="[object WeakMap]",p4="[object DataView]",Pge=qp(y2),Dge=qp(V0),Ige=qp(w2),Oge=qp(x2),Rge=qp(g2),bd=Gp;(y2&&bd(new y2(new ArrayBuffer(1)))!=p4||V0&&bd(new V0)!=c4||w2&&bd(w2.resolve())!=u4||x2&&bd(new x2)!=h4||g2&&bd(new g2)!=d4)&&(bd=function(e){var t=Gp(e),r=t==Mge?e.constructor:void 0,i=r?qp(r):"";if(i)switch(i){case Pge:return p4;case Dge:return c4;case Ige:return u4;case Oge:return h4;case Rge:return d4}return t});var H0=bd,kge=Object.prototype,Lge=kge.hasOwnProperty;function Nge(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Lge.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var zge=Nge,Bge=$o.Uint8Array,uS=Bge;function Fge(e){var t=new e.constructor(e.byteLength);return new uS(t).set(new uS(e)),t}var B3=Fge;function Uge(e,t){var r=t?B3(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var jge=Uge,Vge=/\w*$/;function Hge(e){var t=new e.constructor(e.source,Vge.exec(e));return t.lastIndex=e.lastIndex,t}var Wge=Hge,f4=oo?oo.prototype:void 0,m4=f4?f4.valueOf:void 0;function Gge(e){return m4?Object(m4.call(e)):{}}var qge=Gge;function Yge(e,t){var r=t?B3(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Xge=Yge,$ge="[object Boolean]",Qge="[object Date]",Kge="[object Map]",Zge="[object Number]",Jge="[object RegExp]",eve="[object Set]",tve="[object String]",rve="[object Symbol]",ive="[object ArrayBuffer]",nve="[object DataView]",sve="[object Float32Array]",ave="[object Float64Array]",ove="[object Int8Array]",lve="[object Int16Array]",cve="[object Int32Array]",uve="[object Uint8Array]",hve="[object Uint8ClampedArray]",dve="[object Uint16Array]",pve="[object Uint32Array]";function fve(e,t,r){var i=e.constructor;switch(t){case ive:return B3(e);case $ge:case Qge:return new i(+e);case nve:return jge(e,r);case sve:case ave:case ove:case lve:case cve:case uve:case hve:case dve:case pve:return Xge(e,r);case Kge:return new i;case Zge:case tve:return new i(e);case Jge:return Wge(e);case eve:return new i;case rve:return qge(e)}}var mve=fve;function gve(e){return typeof e.constructor=="function"&&!D3(e)?Rde(N3(e)):{}}var vve=gve,yve="[object Map]";function wve(e){return lu(e)&&H0(e)==yve}var xve=wve,g4=lg&&lg.isMap,bve=g4?O3(g4):xve,_ve=bve,Sve="[object Set]";function Eve(e){return lu(e)&&H0(e)==Sve}var Tve=Eve,v4=lg&&lg.isSet,Cve=v4?O3(v4):Tve,Ave=Cve,Mve=1,Pve=2,Dve=4,J8="[object Arguments]",Ive="[object Array]",Ove="[object Boolean]",Rve="[object Date]",kve="[object Error]",e7="[object Function]",Lve="[object GeneratorFunction]",Nve="[object Map]",zve="[object Number]",t7="[object Object]",Bve="[object RegExp]",Fve="[object Set]",Uve="[object String]",jve="[object Symbol]",Vve="[object WeakMap]",Hve="[object ArrayBuffer]",Wve="[object DataView]",Gve="[object Float32Array]",qve="[object Float64Array]",Yve="[object Int8Array]",Xve="[object Int16Array]",$ve="[object Int32Array]",Qve="[object Uint8Array]",Kve="[object Uint8ClampedArray]",Zve="[object Uint16Array]",Jve="[object Uint32Array]",Hr={};Hr[J8]=Hr[Ive]=Hr[Hve]=Hr[Wve]=Hr[Ove]=Hr[Rve]=Hr[Gve]=Hr[qve]=Hr[Yve]=Hr[Xve]=Hr[$ve]=Hr[Nve]=Hr[zve]=Hr[t7]=Hr[Bve]=Hr[Fve]=Hr[Uve]=Hr[jve]=Hr[Qve]=Hr[Kve]=Hr[Zve]=Hr[Jve]=!0;Hr[kve]=Hr[e7]=Hr[Vve]=!1;function Gb(e,t,r,i,n,s){var a,o=t&Mve,l=t&Pve,c=t&Dve;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!Go(e))return e;var u=Wl(e);if(u){if(a=zge(e),!o)return zde(e,a)}else{var h=H0(e),d=h==e7||h==Lve;if(cS(e))return cge(e,o);if(h==t7||h==J8||d&&!n){if(a=l||d?{}:vve(e),!o)return l?bge(e,age(a,e)):vge(e,nge(a,e))}else{if(!Hr[h])return n?e:{};a=mve(e,h,o)}}s||(s=new Wb);var p=s.get(e);if(p)return p;s.set(e,a),Ave(e)?e.forEach(function(g){a.add(Gb(g,t,r,g,e,s))}):_ve(e)&&e.forEach(function(g,v){a.set(v,Gb(g,t,r,v,e,s))});var f=c?l?Z8:v2:l?Ld:R3,m=u?void 0:f(e);return Kde(m||e,function(g,v){m&&(v=g,g=e[v]),M3(a,v,Gb(g,t,r,v,e,s))}),a}var r7=Gb,eye=1,tye=4;function rye(e){return r7(e,eye|tye)}var _T=rye,iye="__lodash_hash_undefined__";function nye(e){return this.__data__.set(e,iye),this}var sye=nye;function aye(e){return this.__data__.has(e)}var oye=aye;function hS(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new xT;++t<r;)this.add(e[t])}hS.prototype.add=hS.prototype.push=sye;hS.prototype.has=oye;var lye=hS;function cye(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var uye=cye;function hye(e,t){return e.has(t)}var dye=hye,pye=1,fye=2;function mye(e,t,r,i,n,s){var a=r&pye,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,p=r&fye?new lye:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var f=e[h],m=t[h];if(i)var g=a?i(m,f,h,t,e,s):i(f,m,h,e,t,s);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!uye(t,function(v,y){if(!dye(p,y)&&(f===v||n(f,v,r,i,s)))return p.push(y)})){d=!1;break}}else if(!(f===m||n(f,m,r,i,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var i7=mye;function gye(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var vye=gye;function yye(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var wye=yye,xye=1,bye=2,_ye="[object Boolean]",Sye="[object Date]",Eye="[object Error]",Tye="[object Map]",Cye="[object Number]",Aye="[object RegExp]",Mye="[object Set]",Pye="[object String]",Dye="[object Symbol]",Iye="[object ArrayBuffer]",Oye="[object DataView]",y4=oo?oo.prototype:void 0,$A=y4?y4.valueOf:void 0;function Rye(e,t,r,i,n,s,a){switch(r){case Oye:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Iye:return!(e.byteLength!=t.byteLength||!s(new uS(e),new uS(t)));case _ye:case Sye:case Cye:return A3(+e,+t);case Eye:return e.name==t.name&&e.message==t.message;case Aye:case Pye:return e==t+"";case Tye:var o=vye;case Mye:var l=i&xye;if(o||(o=wye),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=bye,a.set(e,t);var u=i7(o(e),o(t),i,n,s,a);return a.delete(e),u;case Dye:if($A)return $A.call(e)==$A.call(t)}return!1}var kye=Rye,Lye=1,Nye=Object.prototype,zye=Nye.hasOwnProperty;function Bye(e,t,r,i,n,s){var a=r&Lye,o=v2(e),l=o.length,c=v2(t),u=c.length;if(l!=u&&!a)return!1;for(var h=l;h--;){var d=o[h];if(!(a?d in t:zye.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var m=!0;s.set(e,t),s.set(t,e);for(var g=a;++h<l;){d=o[h];var v=e[d],y=t[d];if(i)var w=a?i(y,v,d,t,e,s):i(v,y,d,e,t,s);if(!(w===void 0?v===y||n(v,y,r,i,s):w)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var b=e.constructor,E=t.constructor;b!=E&&"constructor"in e&&"constructor"in t&&!(typeof b=="function"&&b instanceof b&&typeof E=="function"&&E instanceof E)&&(m=!1)}return s.delete(e),s.delete(t),m}var Fye=Bye,Uye=1,w4="[object Arguments]",x4="[object Array]",w1="[object Object]",jye=Object.prototype,b4=jye.hasOwnProperty;function Vye(e,t,r,i,n,s){var a=Wl(e),o=Wl(t),l=a?x4:H0(e),c=o?x4:H0(t);l=l==w4?w1:l,c=c==w4?w1:c;var u=l==w1,h=c==w1,d=l==c;if(d&&cS(e)){if(!cS(t))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Wb),a||j8(e)?i7(e,t,r,i,n,s):kye(e,t,l,r,i,n,s);if(!(r&Uye)){var p=u&&b4.call(e,"__wrapped__"),f=h&&b4.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return s||(s=new Wb),n(m,g,r,i,s)}}return d?(s||(s=new Wb),Fye(e,t,r,i,n,s)):!1}var Hye=Vye;function n7(e,t,r,i,n){return e===t?!0:e==null||t==null||!lu(e)&&!lu(t)?e!==e&&t!==t:Hye(e,t,r,i,n7,n)}var Wye=n7;function Gye(e,t){return e!=null&&t in Object(e)}var qye=Gye;function Yye(e,t,r){t=Jg(t,e);for(var i=-1,n=t.length,s=!1;++i<n;){var a=bT(t[i]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++i!=n?s:(n=e==null?0:e.length,!!n&&P3(n)&&C3(a,n)&&(Wl(e)||I3(e)))}var Xye=Yye;function $ye(e,t){return e!=null&&Xye(e,t,qye)}var Qye=$ye,Kye=function(){return $o.Date.now()},QA=Kye,Zye="Expected a function",Jye=Math.max,e0e=Math.min;function t0e(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Zye);t=$F(t)||0,Go(r)&&(u=!!r.leading,h="maxWait"in r,s=h?Jye($F(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(_){var C=i,x=n;return i=n=void 0,c=_,a=e.apply(x,C),a}function f(_){return c=_,o=setTimeout(v,t),u?p(_):a}function m(_){var C=_-l,x=_-c,A=t-C;return h?e0e(A,s-x):A}function g(_){var C=_-l,x=_-c;return l===void 0||C>=t||C<0||h&&x>=s}function v(){var _=QA();if(g(_))return y(_);o=setTimeout(v,m(_))}function y(_){return o=void 0,d&&i?p(_):(i=n=void 0,a)}function w(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function b(){return o===void 0?a:y(QA())}function E(){var _=QA(),C=g(_);if(i=arguments,n=this,l=_,C){if(o===void 0)return f(l);if(h)return clearTimeout(o),o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return E.cancel=w,E.flush=b,E}var F3=t0e;function r0e(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var i0e=r0e;function n0e(e,t){return t.length<2?e:W8(e,Gme(t,0,-1))}var s0e=n0e;function a0e(e,t){return Wye(e,t)}var U3=a0e;function o0e(e,t){return t=Jg(t,e),e=s0e(e,t),e==null||delete e[bT(i0e(t))]}var l0e=o0e;function c0e(e){return Hme(e)?void 0:e}var u0e=c0e,h0e=1,d0e=2,p0e=4,f0e=q8(function(e,t){var r={};if(e==null)return r;var i=!1;t=R8(t,function(s){return s=Jg(s,e),i||(i=s.length>1),s}),zw(e,Z8(e),r),i&&(r=r7(r,h0e|d0e|p0e,u0e));for(var n=t.length;n--;)l0e(r,t[n]);return r}),b2=f0e;function m0e(e,t,r,i){if(!Go(e))return e;t=Jg(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=bT(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var u=o[l];c=i?i(u,l,o):void 0,c===void 0&&(c=Go(u)?u:C3(t[n+1])?[]:{})}M3(o,l,c),o=o[l]}return e}var g0e=m0e;function v0e(e,t,r){for(var i=-1,n=t.length,s={};++i<n;){var a=t[i],o=W8(e,a);r(o,a)&&g0e(s,Jg(a,e),o)}return s}var y0e=v0e;function w0e(e,t){return y0e(e,t,function(r,i){return Qye(e,i)})}var x0e=w0e,b0e=q8(function(e,t){return e==null?{}:x0e(e,t)}),Xc=b0e,_0e="Expected a function";function S0e(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(_0e);return Go(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),F3(e,t,{leading:i,maxWait:t,trailing:n})}var E0e=S0e;function s7(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function Gl(e,t){return Object.setPrototypeOf(e,t),e}var T0e=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),C0e=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),A0e=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||ST&&"ontouchend"in document,M0e=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,P0e=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,D0e=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},I0e=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},O0e=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},R0e=T0e();R0e&&O0e();var ST=C0e(),Bw=A0e(),k0e=M0e(),xa=P0e(),_4=D0e(),L0e=Number(I0e());function a7(e){return Array.isArray(e)?e:[e]}function o7(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function x1(e){return ST?e.metaKey:e.ctrlKey}function N0e(e){return e.wheelDeltaY===0||e.deltaY===0?ST&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var Tt=[],dS={},Cy={},qb={};function l7(e){Tt.includes(e)||Tt.push(e)}function Dm(e){delete dS[e.pointerId];for(let t=0;t<Tt.length;t++)if(Tt[t].pointerId===e.pointerId){Tt.splice(t,1);break}}function z0e(){Tt.splice(0,Tt.length)}function pS(e){if(e.pointerType!=="touch")return;let t=dS[e.pointerId];t===void 0&&(t={x:0,y:0},dS[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function KA(e){let t=e.pointerId===Tt[0].pointerId?Tt[1]:Tt[0];return dS[t.pointerId]}function c7(e){Cy[e.key]=!0,qb[e.key]=qb[e.key]===void 0?1:qb[e.key]+1}function u7(e){if(ST&&Cy.Meta)for(let t in Cy)Cy[t]=!1;else Cy[e.key]=!1;qb={}}function B0e(e){e.addEventListener("pointerdown",l7,!0),e.addEventListener("pointerdown",pS,!0),e.addEventListener("pointermove",pS,!0),e.addEventListener("pointerup",Dm,!0),e.addEventListener("pointercancel",Dm,!0),e.addEventListener("pointerleave",Dm,!0),window.addEventListener("keydown",c7,!0),window.addEventListener("keyup",u7,!0)}function F0e(e){e.removeEventListener("pointerdown",l7,!0),e.removeEventListener("pointerdown",pS,!0),e.removeEventListener("pointermove",pS,!0),e.removeEventListener("pointerup",Dm,!0),e.removeEventListener("pointercancel",Dm,!0),e.removeEventListener("pointerleave",Dm,!0),window.removeEventListener("keydown",c7,!0),window.removeEventListener("keyup",u7,!0)}var h7,U0e=new Promise(e=>{h7=e}),b1;function j0e(){if(b1)return b1;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@1.7.2/build",r=id(()=>import("./navmesh-D1xgHkvw.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});h7(a)}return b1=e(),b1}var d7,V0e=new Promise(e=>{d7=e}),_1;function H0e(){if(_1)return _1;async function e(){let t=await id(()=>import("./physics-CUo4NZCQ.js"),[]);await t.init(),d7(t)}return _1=e(),_1}var kt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,kt.prototype),i}}add(e,t){var r;return((r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,kt.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,kt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function j3(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&j3(i)}return Object.freeze(e)}function W0e(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var p7=class extends Error{};function ZA(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function oh(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function V3(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function G0e(){return typeof process<"u"}function f7(e,t){for(let r of e)t(r.id,r.data)!==!0&&f7(r.children,t)}function m7(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)m7(r,t)}var Hn=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Hn.prototype)}deepFreeze(){let e=0;for(;e<this.length;)j3(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&m7(r,t)}}traverse(e){f7(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=i[n];return i=[...i],i[n]={...s,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let s=i,a=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let o=i.findIndex(l=>l.id===a);if(o<0)throw new Error;i=[...i],i[o]={...i[o],children:s}}Object.setPrototypeOf(i,Hn.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:i,data:n,children:s};return o=[...o,l],o.sort((c,u)=>c.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(a=>a.id===t);e.localIndex=n,i=[...i];let s=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...s,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let h=t;for(;h!==null;){if(h===void 0)throw new Error;if(h===i)throw new p7("cyclic tree");h=this.parent(h)}}let n=this.parent(i);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(h=>h.id===i);a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(n,a);n=t,a=c.childrenArray(n);let u=l.fi;return l={...l,fi:r},a=[...a,l],a.sort((h,d)=>h.fi-d.fi),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(n,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>W0e(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return oh(0,r,r);{let n=i[0].fi;return oh(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=i.find(a=>a.fi>n.fi);if(s===void 0){let a=i[i.length-1].fi;return oh(a,a+r,r)}else return oh(n.fi,s.fi,r)}}},fS;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a={...r},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let c=n[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(fS||(fS={}));var xt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,xt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)j3(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,xt.prototype);let t=e;return G0e()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a={...i[n],fi:t};return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return oh(0,t,t);{let i=r[0].fi;return oh(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return oh(s,s+t,t)}else return oh(i.fi,n.fi,t)}}};function cg(e){return e&&typeof e=="object"&&e instanceof Qi}var Qi=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!cg(r))return null;i+=1}r=r?ZA(r):new Qi;for(let[o,l]of Object.entries(e.props)){let c=r[o];n[o]=c,l===void 0?delete r[o]:r[o]=l}for(;i>0;){if(Object.keys(r).length===0){let o=t[i-1];o&&(r=ZA(o),delete r[e.path[i-1]])}else{let o=t[i-1];if(o){let l=ZA(o);l[e.path[i-1]]=r,r=l}else{let l=new Qi;l[e.path[i-1]]=r,r=l}}i-=1}let s=Object.setPrototypeOf(r,Qi.prototype),a={...e,props:n};return{data:s,actual:e,reverse:a}}},Dh;(e=>{function t(n,s){return W0(n,s)??n}e.apply=t;function r(n,s){return W3(n,s)}e.merge=r;function i(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=jn.zoomOnce(l,o[a]),l===void 0)return s;if(!cg(l))return;a+=1}if(l===void 0)return s;if(cg(l))if(s.type===0){let c={...s.props};for(let u of Object.keys(l))delete c[u];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=H3([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=i})(Dh||(Dh={}));function H3(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=W0(n.data,t[s]);if(r=r||a!==void 0,a===void 0&&(a=n.data),n.children){let o=H3(n.children,t);return o!==void 0?r=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(r)return i}function q0e(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=W0(n.data,t[s]);return r=r||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function W0(e,t){if(!cg(t))return t;if(e instanceof Hn){let r=H3(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof xt)return q0e(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,s)=>{let a=W0(n,t[s]);return r=r||a!==void 0,a===void 0&&(a=n),a});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof Qi)return W3(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,s]of Object.entries(e)){let a=W0(s,t[n]);i=i||a!==void 0,a===void 0&&(a=s),r[n]=a}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function W3(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!cg(t))return t;if(!cg(e))return Dh.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new Qi;for(let n of r){let s=W3(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=s}return i}function Y0e(e,t){let r={cur:[],result:[],len:0};return e=G0(e,t,r)??e,[e,r.result]}function mS(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function gS(e){e&&(e.len-=1)}function X0e(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function g7(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=G0(s.data,t,mS(r,a));gS(r),i=i||l!==void 0,l===void 0&&(l=s.data);let c=g7(s.children,t,r);return c!==void 0?i=!0:c=s.children,{...s,id:a,data:l,children:c}});if(i)return n}function $0e(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=G0(s.data,t,mS(r,a));return gS(r),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function G0(e,t,r){if(e instanceof Hn){let i=g7(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof xt)return $0e(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((s,a)=>{let o=G0(s,t,mS(r,a));return gS(r),i=i||o!==void 0,o===void 0&&(o=s),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!V3(e)){let i={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"){let o=t[s];if(typeof o=="string"){if(r!==null)throw new Error("not supported");n=!0,s=o}let l=G0(a,t,mS(r,s));gS(r),n=n||l!==void 0,l===void 0&&(l=a),i[s]=l}else i[s]=a;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&X0e(r),i}else return}}var vS;(e=>{function t(r,i){let n=jn.zoom(i,r.path);if(typeof n=="object"){let s={};for(let a of Object.keys(r.props))s[a]=n[a];return{...r,props:s}}else return{...r,props:{}}}e.replaceProps=t})(vS||(vS={}));var bn;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){var u;return((u=i(l,c))==null?void 0:u.data)??l}e.applySimple=r;function i(l,c){var d,p;let u=c.path;for(var h=[];;){let f;if(l instanceof Qi&&c.type===0&&(f=l.runOp({...c,path:u.slice(h.length)}),f===null&&(f=void 0)),f===void 0&&h.length===u.length&&(l instanceof Hn||l instanceof xt||l instanceof kt?f=l.runOp(c):f=fS.runOp(l,c)),f!==void 0)if(f!==null){let v=f.data;for(let y=h.length-1;y>=0;y--){let w=u[y],b=h[y];if(b instanceof Hn){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof xt){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof kt){if(typeof w=="number")throw new Error("illegal arg");v=b.modifyById(w,v)}else if(b instanceof Qi){let E={...b,[w]:v};v=Object.setPrototypeOf(E,Qi.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof w=="string"&&(w=parseInt(w),isNaN(w)))throw new Error("Invalid path");let E=v;v=[...b],v[w]=E}else v={...b,[w]:v};else return null}return{data:v,actual:{...f.actual,path:u},reverse:{...f.reverse,path:u}}}else return null;let m=u[h.length],g;if(l instanceof Hn){if(typeof m=="number")throw new Error("");g=(d=l.get(m))==null?void 0:d.data}else if(l instanceof xt){if(typeof m=="number")throw new Error("");g=(p=l.get(m))==null?void 0:p.data}else l!==null&&(g=l[m]);if(g!==void 0)h.push(l),l=g;else return null}}e.apply=i;function n(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=n;function s(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=s;function a(l,c){return n(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=o})(bn||(bn={}));var _2;(e=>{function t(){return[]}e.empty=t;function r(c,u){let h=[];for(let d of c){let[p,...f]=d.path;p===u&&h.push({...d,path:f})}return h}e.removePrefix=r;function i(c,u){return c.map(h=>({...h,path:[u,...h.path]}))}e.addPrefix=i;function n(c,u){return[...c,...u]}e.concat=n;function s(c,u){return[...c.filter(h=>!u.some(d=>bn.subsumed(h,d))),...u]}e.compress=s;function a(c,u){return c.every(h=>u.every(d=>bn.commutative(h,d)))}e.commutative=a;function o(c,u){for(let h of u){let d=l(c,h);d!==null&&(c=d.data)}return c}e.applyAll=o;function l(c,u){var h=c;let d=[],p=[];for(let f of u)try{if(f.type===3||f.type===5&&f.path[f.path.length-1]==="variables"){let m,g,v;if(f.type===3?(m=jn.zoom(h,[...f.path,f.id]),v=bn.apply(h,{...f,type:2})):(m=jn.zoom(h,[...f.path,f.id,"value"]),v=bn.apply(h,f)),v!==null){h=v.data;let[y,w]=Y0e(h,{[f.id]:m});h=y;for(let b=0;b<w.length;b++){let E=w[b],_=E.pop();if(typeof _=="number"){let C=[_];for(let A=b+1;A<w.length;A++){let T=w[A],M=T[T.length-1];if(typeof M=="number"&&jn.equal(E,T.slice(0,T.length-1)))C.push(M),w.splice(A,1);else break}let x=jn.zoom(h,E);g=x.map((A,T)=>C.includes(T)?f.id:A),m=x,_=E.pop()}else{if(_==="alphaOverride"||_==="alpha"){m/=100;let C=m,x=jn.zoom(h,E.slice(0,E.length-2)),A=x.layers.map(T=>T.id===E[E.length-1]?{...T,data:{...T.data,[_]:C}}:T);Object.setPrototypeOf(A,Object.getPrototypeOf(x.layers)),x.layers=A}g=f.id}d.push({type:0,path:E,props:{[_]:m}}),p.push({type:0,path:E,props:{[_]:g}})}p.push(v.reverse),d.push(v.actual)}}else{let m=bn.apply(h,f);m!==null&&(d.push(m.actual),h=m.data,p.push(m.reverse))}}catch(m){if(m instanceof p7)return null;throw m}return{data:h,actual:d,reverse:p.reverse()}}e.apply=l})(_2||(_2={}));var v7=Symbol(),Q0e=Symbol(),ET=Symbol(),Fw=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof w7);){let s=i._path,a=i._current;if(s!==""&&n.splice(0,0,s),i=i._parent,i===null)return;i.update(s,a)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[ET];r&&r(),delete this._children[e]}}}},K0e=class extends Fw{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,fS.runOp(this._current,e),e.path)}},Z0e=class extends Fw{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,kt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},y7={get(e,t){if(t===ET)return()=>{e._parent=null};if(t===v7)return e._current;if(t===Q0e)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=TT(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},J0e={...y7,set(e,t,r){let i={type:0,props:{[t]:ki(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},ewe={...y7,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},G3=class extends Fw{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[ET]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=TT(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},q3=class extends Fw{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[ET]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=TT(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function JA(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&jn.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var w7=class extends Fw{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){JA(this.ts,t,e),JA(this.actual,r,e),JA(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function TT(e,t,r){return r instanceof Hn?new G3(e,t,r):r instanceof xt?new q3(e,t,r):r instanceof kt?new Proxy(new Z0e(e,t,r),ewe):r!==null&&typeof r=="object"?V3(r)?r:new Proxy(new K0e(e,t,r),J0e):r}function x7(e){let t=new w7(e);return[TT(t,"",e),t]}function q0(e,t){let[r,i]=x7(e);return t(r),i.result()}function ki(e){return e instanceof G3||e instanceof q3?e._current:e!==null&&typeof e=="object"?e[v7]:e}var jn;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function r(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return a}e.removeOverridden=r;function i(s,a){if((s instanceof Hn||s instanceof G3)&&typeof a=="string"||(s instanceof xt||s instanceof q3)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=i;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=i(s,a[o]),o+=1;return s}e.zoom=n})(jn||(jn={}));function twe(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function Ur(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var b7=class{},S4=class extends b7{constructor(e){super(),this.id=e}},E4=class extends b7{constructor(e){super(),this.data=e}},S2;try{S2=new TextDecoder}catch{}var nt,Ih,ye=0,Js={},gr,lh,Wa=0,El=0,ga,$c,Us=[],Tr,T4={useRecords:!1,mapsAsObjects:!0},_7=class{},S7=new _7;S7.name="MessagePack 0xC1";var ug=!1,yS=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(nt)return P7(()=>(T2(),this?this.unpack(e,t):yS.prototype.unpack.call(T4,e,t)));Ih=t>-1?t:e.length,ye=0,El=0,lh=null,ga=null,nt=e;try{Tr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw nt=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof yS){if(Js=this,this.structures)return gr=this.structures,S1();(!gr||gr.length>0)&&(gr=[])}else Js=T4,(!gr||gr.length>0)&&(gr=[]);return S1()}unpackMultiple(e,t){let r,i=0;try{ug=!0;let n=e.length,s=this?this.unpack(e,n):AT.unpack(e,n);if(t){for(t(s);ye<n;)if(i=ye,t(S1())===!1)return}else{for(r=[s];ye<n;)i=ye,r.push(S1());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{ug=!1,T2()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function S1(){try{if(!Js.trusted&&!ug){let t=gr.sharedLength||0;t<gr.length&&(gr.length=t)}let e=_i();if(ye==Ih)gr.restoreStructures&&C4(),gr=null,nt=null,$c&&($c=null);else if(ye>Ih){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!ug)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw gr.restoreStructures&&C4(),T2(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function C4(){for(let e in gr.restoreStructures)gr[e]=gr.restoreStructures[e];gr.restoreStructures=null}function _i(){let e=nt[ye++];if(e<160)if(e<128){if(e<64)return e;{let t=gr[e&63]||Js.getStructures&&E7()[e&63];return t?(t.read||(t.read=Y3(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Js.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[C7()]=_i();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(_i(),_i());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=_i();return t}else if(e<192){let t=e-160;if(El>=ye)return lh.slice(ye-Wa,(ye+=t)-Wa);if(El==0&&Ih<140){let r=t<16?X3(t):T7(t);if(r!=null)return r}return E2(t)}else{let t;switch(e){case 192:return null;case 193:return ga?(t=_i(),t>0?ga[1].slice(ga.position1,ga.position1+=t):ga[0].slice(ga.position0,ga.position0-=t)):S7;case 194:return!1;case 195:return!0;case 196:return eM(nt[ye++]);case 197:return t=Tr.getUint16(ye),ye+=2,eM(t);case 198:return t=Tr.getUint32(ye),ye+=4,eM(t);case 199:return fd(nt[ye++]);case 200:return t=Tr.getUint16(ye),ye+=2,fd(t);case 201:return t=Tr.getUint32(ye),ye+=4,fd(t);case 202:if(t=Tr.getFloat32(ye),Js.useFloat32>2){let r=$3[(nt[ye]&127)<<1|nt[ye+1]>>7];return ye+=4,(r*t+(t>0?.5:-.5)>>0)/r}return ye+=4,t;case 203:return t=Tr.getFloat64(ye),ye+=8,t;case 204:return nt[ye++];case 205:return t=Tr.getUint16(ye),ye+=2,t;case 206:return t=Tr.getUint32(ye),ye+=4,t;case 207:return Js.int64AsNumber?(t=Tr.getUint32(ye)*4294967296,t+=Tr.getUint32(ye+4)):t=Tr.getBigUint64(ye),ye+=8,t;case 208:return Tr.getInt8(ye++);case 209:return t=Tr.getInt16(ye),ye+=2,t;case 210:return t=Tr.getInt32(ye),ye+=4,t;case 211:return Js.int64AsNumber?(t=Tr.getInt32(ye)*4294967296,t+=Tr.getUint32(ye+4)):t=Tr.getBigInt64(ye),ye+=8,t;case 212:if(t=nt[ye++],t==114)return I4(nt[ye++]&63);{let r=Us[t];if(r)return r.read?(ye++,r.read(_i())):r.noBuffer?(ye++,r()):r(nt.subarray(ye,++ye));throw new Error("Unknown extension "+t)}case 213:return t=nt[ye],t==114?(ye++,I4(nt[ye++]&63,nt[ye++])):fd(2);case 214:return fd(4);case 215:return fd(8);case 216:return fd(16);case 217:return t=nt[ye++],El>=ye?lh.slice(ye-Wa,(ye+=t)-Wa):iwe(t);case 218:return t=Tr.getUint16(ye),ye+=2,El>=ye?lh.slice(ye-Wa,(ye+=t)-Wa):nwe(t);case 219:return t=Tr.getUint32(ye),ye+=4,El>=ye?lh.slice(ye-Wa,(ye+=t)-Wa):swe(t);case 220:return t=Tr.getUint16(ye),ye+=2,M4(t);case 221:return t=Tr.getUint32(ye),ye+=4,M4(t);case 222:return t=Tr.getUint16(ye),ye+=2,P4(t);case 223:return t=Tr.getUint32(ye),ye+=4,P4(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var rwe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Y3(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>rwe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(_i);return e.highByte===0&&(e.read=A4(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=_i()}return i}return r.count=0,e.highByte===0?A4(t,r):r}var A4=(e,t)=>function(){let r=nt[ye++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=gr[i]||E7()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=Y3(n,e)),n.read()};function E7(){let e=P7(()=>(nt=null,Js.getStructures()));return gr=Js._mergeStructures(e,gr)}var E2=CT,iwe=CT,nwe=CT,swe=CT;function CT(e){let t;if(e<16&&(t=X3(e)))return t;if(e>64&&S2)return S2.decode(nt.subarray(ye,ye+=e));let r=ye+e,i=[];for(t="";ye<r;){let n=nt[ye++];if(!(n&128))i.push(n);else if((n&224)===192){let s=nt[ye++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=nt[ye++]&63,a=nt[ye++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=nt[ye++]&63,a=nt[ye++]&63,o=nt[ye++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=fn.apply(String,i),i.length=0)}return i.length>0&&(t+=fn.apply(String,i)),t}function M4(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=_i();return t}function P4(e){if(Js.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[C7()]=_i();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(_i(),_i());return t}}var fn=String.fromCharCode;function T7(e){let t=ye,r=new Array(e);for(let i=0;i<e;i++){let n=nt[ye++];if((n&128)>0){ye=t;return}r[i]=n}return fn.apply(String,r)}function X3(e){if(e<4)if(e<2){if(e===0)return"";{let t=nt[ye++];if((t&128)>1){ye-=1;return}return fn(t)}}else{let t=nt[ye++],r=nt[ye++];if((t&128)>0||(r&128)>0){ye-=2;return}if(e<3)return fn(t,r);let i=nt[ye++];if((i&128)>0){ye-=3;return}return fn(t,r,i)}else{let t=nt[ye++],r=nt[ye++],i=nt[ye++],n=nt[ye++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){ye-=4;return}if(e<6){if(e===4)return fn(t,r,i,n);{let s=nt[ye++];if((s&128)>0){ye-=5;return}return fn(t,r,i,n,s)}}else if(e<8){let s=nt[ye++],a=nt[ye++];if((s&128)>0||(a&128)>0){ye-=6;return}if(e<7)return fn(t,r,i,n,s,a);let o=nt[ye++];if((o&128)>0){ye-=7;return}return fn(t,r,i,n,s,a,o)}else{let s=nt[ye++],a=nt[ye++],o=nt[ye++],l=nt[ye++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){ye-=8;return}if(e<10){if(e===8)return fn(t,r,i,n,s,a,o,l);{let c=nt[ye++];if((c&128)>0){ye-=9;return}return fn(t,r,i,n,s,a,o,l,c)}}else if(e<12){let c=nt[ye++],u=nt[ye++];if((c&128)>0||(u&128)>0){ye-=10;return}if(e<11)return fn(t,r,i,n,s,a,o,l,c,u);let h=nt[ye++];if((h&128)>0){ye-=11;return}return fn(t,r,i,n,s,a,o,l,c,u,h)}else{let c=nt[ye++],u=nt[ye++],h=nt[ye++],d=nt[ye++];if((c&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){ye-=12;return}if(e<14){if(e===12)return fn(t,r,i,n,s,a,o,l,c,u,h,d);{let p=nt[ye++];if((p&128)>0){ye-=13;return}return fn(t,r,i,n,s,a,o,l,c,u,h,d,p)}}else{let p=nt[ye++],f=nt[ye++];if((p&128)>0||(f&128)>0){ye-=14;return}if(e<15)return fn(t,r,i,n,s,a,o,l,c,u,h,d,p,f);let m=nt[ye++];if((m&128)>0){ye-=15;return}return fn(t,r,i,n,s,a,o,l,c,u,h,d,p,f,m)}}}}}function eM(e){return Js.copyBuffers?Uint8Array.prototype.slice.call(nt,ye,ye+=e):nt.subarray(ye,ye+=e)}function fd(e){let t=nt[ye++];if(Us[t])return Us[t](nt.subarray(ye,ye+=e));throw new Error("Unknown extension type "+t)}var D4=new Array(4096);function C7(){let e=nt[ye++];if(e>=160&&e<192){if(e=e-160,El>=ye)return lh.slice(ye-Wa,(ye+=e)-Wa);if(!(El==0&&Ih<180))return E2(e)}else return ye--,_i();let t=(e<<5^(e>1?Tr.getUint16(ye):e>0?nt[ye]:0))&4095,r=D4[t],i=ye,n=ye+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=Tr.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=nt[i++],s!=r[a++]){i=1879048192;break}if(i===n)return ye=i,r.string;n-=3,i=ye}for(r=[],D4[t]=r,r.bytes=e;i<n;)s=Tr.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=nt[i++],r.push(s);let o=e<16?X3(e):T7(e);return o!=null?r.string=o:r.string=E2(e)}var I4=(e,t)=>{var r=_i();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=gr[e];return n&&n.isShared&&((gr.restoreStructures||(gr.restoreStructures=[]))[e]=n),gr[e]=r,r.read=Y3(r,i),r.read()},A7=typeof self=="object"?self:global;Us[0]=()=>{};Us[0].noBuffer=!0;Us[101]=()=>{let e=_i();return(A7[e[0]]||Error)(e[1])};Us[105]=e=>{let t=Tr.getUint32(ye-4);$c||($c=new Map);let r=nt[ye],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};$c.set(t,n);let s=_i();return n.used?Object.assign(i,s):(n.target=s,s)};Us[112]=e=>{let t=Tr.getUint32(ye-4),r=$c.get(t);return r.used=!0,r.target};Us[115]=()=>new Set(_i());var M7=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Us[116]=e=>{let t=e[0],r=M7[t];if(!r)throw new Error("Could not find typed array for code "+t);return new A7[r](Uint8Array.prototype.slice.call(e,1).buffer)};Us[120]=()=>{let e=_i();return new RegExp(e[0],e[1])};Us[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=ye;ye+=t-4,ga=[_i(),_i()],ga.position0=0,ga.position1=0;let i=ye;ye=r;try{return _i()}finally{ye=i}};Us[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function P7(e){let t=Ih,r=ye,i=Wa,n=El,s=lh,a=$c,o=ga,l=new Uint8Array(nt.slice(0,Ih)),c=gr,u=gr.slice(0,gr.length),h=Js,d=ug,p=e();return Ih=t,ye=r,Wa=i,El=n,lh=s,$c=a,ga=o,nt=l,ug=d,gr=c,gr.splice(0,gr.length,...u),Js=h,Tr=new DataView(nt.buffer,nt.byteOffset,nt.byteLength),p}function T2(){nt=null,$c=null,gr=null}function awe(e){e.unpack?Us[e.type]=e.unpack:Us[e.type]=e}var $3=new Array(147);for(let e=0;e<256;e++)$3[e]=+("1e"+Math.floor(45.15-e*.30103));var AT=new yS({useRecords:!1});AT.unpack;AT.unpackMultiple;AT.unpack;var owe=new Float32Array(1);new Uint8Array(owe.buffer,0,4);var Yb;try{Yb=new TextEncoder}catch{}var wS,Q3,MT=typeof Buffer<"u",tM=MT?Buffer.allocUnsafeSlow:Uint8Array,D7=MT?Buffer:Uint8Array,O4=MT?4294967296:2144337920,Re,Mi,Te=0,rl,il=null,lwe=/[\u0080-\uFFFF]/,Yv=Symbol("record-id"),I7=class extends yS{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=D7.prototype.utf8Write?function(_,C,x){return Re.utf8Write(_,C,x)}:Yb&&Yb.encodeInto?function(_,C){return Yb.encodeInto(_,Re.subarray(C)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=u?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(_,C){if(Re||(Re=new tM(8192),Mi=new DataView(Re.buffer,0,8192),Te=0),rl=Re.length-10,rl-Te<2048?(Re=new tM(Re.length),Mi=new DataView(Re.buffer,0,Re.length),rl=Re.length-10,Te=0):Te=Te+7&2147483640,t=Te,s=l.structuredClone?new Map:null,l.bundleStrings?(il=["",""],Re[Te++]=214,Re[Te++]=98,il.position=Te-t,Te+=4):il=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let x=r.sharedLength||0;if(x>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let A=0;A<x;A++){let T=r[A];if(!T)continue;let M,D=r.transitions;for(let P=0,I=T.length;P<I;P++){let B=T[P];M=D[B],M||(M=D[B]=Object.create(null)),D=M}D[Yv]=A+64}a=x}c||(r.nextId=x+64)}i&&(i=!1),n=r||[];try{if(w(_),il){Mi.setUint32(il.position+t,Te-il.position-t);let x=il;il=null,w(x[0]),w(x[1])}if(l.offset=Te,s&&s.idsToInsert){Te+=s.idsToInsert.length*6,Te>rl&&E(Te),l.offset=Te;let x=uwe(Re.subarray(t,Te),s.idsToInsert);return s=null,x}return C&hwe?(Re.start=t,Re.end=Te,Re):Re.subarray(t,Te)}finally{if(r){if(y<10&&y++,v>1e4)r.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let x=0,A=g.length;x<A;x++)g[x][Yv]=0;g=[]}if(i&&l.saveStructures){let x=r.sharedLength||h;r.length>x&&(r=r.slice(0,x));let A=Re.subarray(t,Te);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(_)):(a=x,A)}}C&dwe&&(Te=t)}};let w=_=>{Te>rl&&(Re=E(Te));var C=typeof _,x;if(C==="string"){let A=_.length;if(il&&A>=8&&A<4096){let D=lwe.test(_);il[D?0:1]+=_,Re[Te++]=193,w(D?-A:A);return}let T;A<32?T=1:A<256?T=2:A<65536?T=3:T=5;let M=A*3;if(Te+M>rl&&(Re=E(Te+M)),A<64||!o){let D,P,I,B=Te+T;for(D=0;D<A;D++)P=_.charCodeAt(D),P<128?Re[B++]=P:P<2048?(Re[B++]=P>>6|192,Re[B++]=P&63|128):(P&64512)===55296&&((I=_.charCodeAt(D+1))&64512)===56320?(P=65536+((P&1023)<<10)+(I&1023),D++,Re[B++]=P>>18|240,Re[B++]=P>>12&63|128,Re[B++]=P>>6&63|128,Re[B++]=P&63|128):(Re[B++]=P>>12|224,Re[B++]=P>>6&63|128,Re[B++]=P&63|128);x=B-Te-T}else x=o(_,Te+T,M);x<32?Re[Te++]=160|x:x<256?(T<2&&Re.copyWithin(Te+2,Te+1,Te+1+x),Re[Te++]=217,Re[Te++]=x):x<65536?(T<3&&Re.copyWithin(Te+3,Te+2,Te+2+x),Re[Te++]=218,Re[Te++]=x>>8,Re[Te++]=x&255):(T<5&&Re.copyWithin(Te+5,Te+3,Te+3+x),Re[Te++]=219,Mi.setUint32(Te,x),Te+=4),Te+=x}else if(C==="number")if(_>>>0===_)_<64?Re[Te++]=_:_<256?(Re[Te++]=204,Re[Te++]=_):_<65536?(Re[Te++]=205,Re[Te++]=_>>8,Re[Te++]=_&255):(Re[Te++]=206,Mi.setUint32(Te,_),Te+=4);else if(_>>0===_)_>=-32?Re[Te++]=256+_:_>=-128?(Re[Te++]=208,Re[Te++]=_+256):_>=-32768?(Re[Te++]=209,Mi.setInt16(Te,_),Te+=2):(Re[Te++]=210,Mi.setInt32(Te,_),Te+=4);else{let A;if((A=this.useFloat32)>0&&_<4294967296&&_>=-2147483648){Re[Te++]=202,Mi.setFloat32(Te,_);let T;if(A<4||(T=_*$3[(Re[Te]&127)<<1|Re[Te+1]>>7])>>0===T){Te+=4;return}else Te--}Re[Te++]=203,Mi.setFloat64(Te,_),Te+=8}else if(C==="object")if(!_)Re[Te++]=192;else{if(s){let T=s.get(_);if(T){if(!T.id){let M=s.idsToInsert||(s.idsToInsert=[]);T.id=M.push(T)}Re[Te++]=214,Re[Te++]=112,Mi.setUint32(Te,T.id),Te+=4;return}else s.set(_,{offset:Te-t})}let A=_.constructor;if(A===Object)b(_,!0);else if(A===Array){x=_.length,x<16?Re[Te++]=144|x:x<65536?(Re[Te++]=220,Re[Te++]=x>>8,Re[Te++]=x&255):(Re[Te++]=221,Mi.setUint32(Te,x),Te+=4);for(let T=0;T<x;T++)w(_[T])}else if(A===Map){x=_.size,x<16?Re[Te++]=128|x:x<65536?(Re[Te++]=222,Re[Te++]=x>>8,Re[Te++]=x&255):(Re[Te++]=223,Mi.setUint32(Te,x),Te+=4);for(let[T,M]of _)w(T),w(M)}else{for(let T=0,M=wS.length;T<M;T++){let D=Q3[T];if(_ instanceof D){let P=wS[T];if(P.write){P.type&&(Re[Te++]=212,Re[Te++]=P.type,Re[Te++]=0),w(P.write.call(this,_));return}let I=Re,B=Mi,V=Te;Re=null;let N;try{N=P.pack.call(this,_,L=>(Re=I,I=null,Te+=L,Te>rl&&E(Te),{target:Re,targetView:Mi,position:Te-L}),w)}finally{I&&(Re=I,Mi=B,Te=V,rl=Re.length-10)}N&&(N.length+Te>rl&&E(N.length+Te),Te=cwe(N,Re,Te,P.type));return}}b(_,!_.hasOwnProperty)}}else if(C==="boolean")Re[Te++]=_?195:194;else if(C==="bigint"){if(_<BigInt(1)<<BigInt(63)&&_>=-(BigInt(1)<<BigInt(63)))Re[Te++]=211,Mi.setBigInt64(Te,_);else if(_<BigInt(1)<<BigInt(64)&&_>0)Re[Te++]=207,Mi.setBigUint64(Te,_);else if(this.largeBigIntToFloat)Re[Te++]=203,Mi.setFloat64(Te,Number(_));else throw new RangeError(_+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Te+=8}else if(C==="undefined")this.encodeUndefinedAsNil?Re[Te++]=192:(Re[Te++]=212,Re[Te++]=0,Re[Te++]=0);else if(C==="function")w(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+C)},b=this.useRecords===!1?this.variableMapSize?_=>{let C=Object.keys(_),x=C.length;x<16?Re[Te++]=128|x:x<65536?(Re[Te++]=222,Re[Te++]=x>>8,Re[Te++]=x&255):(Re[Te++]=223,Mi.setUint32(Te,x),Te+=4);let A;for(let T=0;T<x;T++)w(A=C[T]),w(_[A])}:(_,C)=>{Re[Te++]=222;let x=Te-t;Te+=2;let A=0;for(let T in _)(C||_.hasOwnProperty(T))&&(w(T),w(_[T]),A++);Re[x+++t]=A>>8,Re[x+t]=A&255}:_=>{let C=Object.keys(_),x,A=n.transitions||(n.transitions=Object.create(null)),T=0;for(let D=0,P=C.length;D<P;D++){let I=C[D];x=A[I],x||(x=A[I]=Object.create(null),T++),A=x}let M=A[Yv];if(M)M>=96&&p?(Re[Te++]=((M-=96)&31)+96,Re[Te++]=M>>5):Re[Te++]=M;else{M=n.nextId,M||(M=64),M<f&&this.shouldShareStructure&&!this.shouldShareStructure(C)?(M=n.nextOwnId,M<m||(M=f),n.nextOwnId=M+1):(M>=m&&(M=f),n.nextId=M+1);let D=C.highByte=M>=96&&p?M-96>>5:-1;A[Yv]=M,n[M-64]=C,M<f?(C.isShared=!0,n.sharedLength=M-63,i=!0,D>=0?(Re[Te++]=(M&31)+96,Re[Te++]=D):Re[Te++]=M):(D>=0?(Re[Te++]=213,Re[Te++]=114,Re[Te++]=(M&31)+96,Re[Te++]=D):(Re[Te++]=212,Re[Te++]=114,Re[Te++]=M),T&&(v+=y*T),g.length>=d&&(g.shift()[Yv]=0),g.push(A),w(C))}for(let D=0,P=C.length;D<P;D++)w(_[C[D]])},E=_=>{let C;if(_>16777216){if(_-t>O4)throw new Error("Packed buffer would be larger than maximum buffer size");C=Math.min(O4,Math.round(Math.max((_-t)*(_>67108864?1.25:2),4194304)/4096)*4096)}else C=(Math.max(_-t<<2,Re.length-1)>>12)+1<<12;let x=new tM(C);return Mi=new DataView(x.buffer,0,C),Re.copy?Re.copy(x,0,t,_):x.set(Re.slice(t,_)),Te-=t,t=0,rl=x.length-10,Re=x}}useBuffer(e){Re=e,Mi=new DataView(Re.buffer,Re.byteOffset,Re.byteLength),Te=0}};Q3=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,_7];wS=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?R4(e,16,t):k4(MT?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==D7&&this.structuredClone?R4(e,M7.indexOf(r.name),t):k4(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function R4(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function k4(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function cwe(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function uwe(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function tv(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");Q3.unshift(e.Class),wS.unshift(e)}awe(e)}var O7=new I7({useRecords:!1});O7.pack;O7.pack;var hwe=512,dwe=1024,L4=new I7({structuredClone:!0});tv({Class:kt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,kt.prototype),e}});tv({Class:xt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,xt.prototype),e}});tv({Class:Hn.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Hn.prototype),e}});tv({Class:S4.prototype.constructor,type:4,write(e){return e.id},read(e){return new S4(e)}});tv({Class:E4.prototype.constructor,type:5,write(e){return e.data},read(e){return new E4(e)}});tv({Class:Qi.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Qi.prototype),e}});function pwe(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function C2(e){if(V3(e))return e;if(Array.isArray(e))return e.map(C2);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=C2(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var A2;(e=>{function t(n){return L4.pack(n)}e.serialize=t;function r(n){return L4.unpack(n)}e.deserialize=r;function i(n){return pwe(t(C2(n))).toString()}e.checksum=i})(A2||(A2={}));var N4;(e=>{function t(i){return i.type==="Conditional"?i.condition.type==="Distance"?"Distance":"StateChange":i.type}e.toEventUIType=t;function r(i){return i==="Distance"||i==="StateChange"?"Conditional":i}e.fromEventUIType=r})(N4||(N4={}));function z4(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var Ts={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage"]},B4;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,actions:new xt}:{type:i,disabled:!1,key:void 0,actions:new xt}}e.defaultData=r})(B4||(B4={}));var xS;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(xS||(xS={}));var M2;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:xS.propertyDefaultData(n),rOperand:{...xS.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=i})(M2||(M2={}));var F4;(e=>{function t(r){return r.find(i=>i==="ifActions"||i==="elseActions")!==void 0}e.isConditionalSubActions=t})(F4||(F4={}));var U4;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new xt,outActions:new xt,condition:M2.distanceDefaultData(i)}}e.defaultData=r})(U4||(U4={}));var j4;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new xt,drop:new xt}})(j4||(j4={}));var P2;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new xt})(P2||(P2={}));var D2;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(D2||(D2={}));var V4;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new xt}}e.defaultData=r})(V4||(V4={}));var H4;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new xt}}e.defaultData=r})(H4||(H4={}));var W4;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new xt}}e.defaultData=r})(W4||(W4={}));var G4;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,target:"character",actions:new xt}}e.defaultData=r})(G4||(G4={}));var q4;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new xt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(q4||(q4={}));var I2;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function r(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=r;function i(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=i;function n(){let a={size:"mobile",operator:"<",actions:new xt},o={size:"tablet",operator:"<",actions:new xt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new xt},c=new xt;return c.push({id:rt.generateUUID(),fi:0,data:a},{id:rt.generateUUID(),fi:1,data:o},{id:rt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new xt}}e.defaultBreakpointData=s})(I2||(I2={}));var O2;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(i){return i.type==="VariableChange"}e.is=t;function r(){return{disabled:!1,type:"VariableChange",actions:new xt,variableId:"",objectId:null,property:"Position X"}}e.defaultData=r})(O2||(O2={}));var rv="personal camera",Jy="a218fcc3-276b-49b9-b485-49037fd14f5f",fwe=2960946,Ma=5526619,Uc;(e=>{function t(f,m){return f[0]===m[0]&&f[1]===m[1]}e.isEqual=t;function r(f,m,g){return[f[0]+(m[0]-f[0])*g,f[1]+(m[1]-f[1])*g]}e.lerp=r;function i(f,m){return[f[0]+m[0],f[1]+m[1]]}e.add=i;function n(f,m){return[f[0]-m[0],f[1]-m[1]]}e.sub=n;function s(f,m){return[f[0]*m[0],f[1]*m[1]]}e.multiply=s;function a(f,m){return[f[0]/m[0],f[1]/m[1]]}e.divide=a;function o(f,m){return Math.pow(m[0]-f[0],2)+Math.pow(m[1]-f[1],2)}e.distanceSquared=o;function l(f,m){return Math.sqrt(o(f,m))}e.distance=l;function c(f,m){return f[0]*m[0]+f[1]*m[1]}e.dot=c;function u(f,m){return[f[0]*m,f[1]*m]}e.scalarMultiply=u;function h(f,m,g){let v=e.sub(m,f),y=e.sub(g,f),w=e.dot(v,y)/e.dot(v,v),b=e.scalarMultiply(v,w);return e.add(f,b)}e.projectionOnto=h;function d(f,m,g){return l(f,h(f,m,g))}e.projectionOntoDistance=d;function p(f,m){return[(f[0]+m[0])*.5,(f[1]+m[1])*.5]}e.center=p})(Uc||(Uc={}));var Zd;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=o})(Zd||(Zd={}));var bS;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(bS||(bS={}));var Y4;(e=>{let t=180/Math.PI,r=Math.PI/180;function i(o){return typeof o=="number"?o*t:o}function n(o){return typeof o=="number"?o*r:o}function s(o){return[i(o[0]),i(o[1]),i(o[2])]}e.radToDeg=s;function a(o){return[n(o[0]),n(o[1]),n(o[2])]}e.degToRad=a})(Y4||(Y4={}));var hg;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/c,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/c,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/c}return a}e.applyMatrix4=i})(hg||(hg={}));var as;(e=>{function t(c){return typeof c=="object"&&typeof c.r=="number"&&typeof c.g=="number"&&typeof c.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(c){return{r:Math.round(c.r*255),g:Math.round(c.g*255),b:Math.round(c.b*255),a:1}}e.toRgb255a1=r;function i(c){return{r:c.r,g:c.g,b:c.b}}e.clone=i;function n(c){return c=Math.floor(c),{r:(c>>16&255)/255,g:(c>>8&255)/255,b:(c&255)/255}}e.fromHex=n;function s(c){return Math.round(c.r*255)*65536+Math.round(c.g*255)*256+Math.round(c.b*255)}e.toHex=s;function a(c,u){return c.r===u.r&&c.g===u.g&&c.b===u.b}e.equals=a;function o(c,u){return c.r.toFixed(2)===u.r.toFixed(2)&&c.g.toFixed(2)===u.g.toFixed(2)&&c.b.toFixed(2)===u.b.toFixed(2)}e.equalsFixed=o;function l(c,u,h){return{r:c.r+(u.r-c.r)*h,g:c.g+(u.g-c.g)*h,b:c.b+(u.b-c.b)*h}}e.lerp=l})(as||(as={}));var Lr;(e=>{e.white={...as.white,a:1},e.transparent={...as.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function r(l,c){return{...as.fromHex(l),a:c}}e.fromHexAndA=r;function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=i;function n(l,c){return as.equals(l,c)&&l.a===c.a}e.equals=n;function s(l,c){return as.equalsFixed(l,c)&&l.a.toFixed(2)===c.a.toFixed(2)}e.equalsFixed=s;function a(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u,a:l.a+(c.a-l.a)*u}}e.lerp=a;function o({r:l,g:c,b:u,a:h}=e.white){return`rgba(${l*255}, ${c*255}, ${u*255}, ${h})`}e.toStyle=o})(Lr||(Lr={}));var R2;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(R2||(R2={}));var X4;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(X4||(X4={}));var $4;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})($4||($4={}));var Hu;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(Hu||(Hu={}));function Q4(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var yp;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(yp||(yp={}));var dg;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){var i,n;return r.type==="PerspectiveCamera"?((i=r.perspective)==null?void 0:i.zoom)??1:((n=r.orthographic)==null?void 0:n.zoom)??1}e.getZoom=t})(dg||(dg={}));var ch;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let s={...i};if(R7.forEach(a=>{Object.assign(s,{[a]:n[a]??i[a]})}),s.radial={...i.radial},n.radial){let a=i.radial,o=n.radial;k7.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...i.linear},n.linear){let a=i.linear,o=n.linear;L7.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...i.grid},n.grid){let a=i.grid,o=n.grid;N7.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...i.toObject},n.toObject){let a=i.toObject,o=n.toObject;z7.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...i.randomnessObject},n.randomnessObject){let a=i.randomnessObject,o=n.randomnessObject;B7.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=r})(ch||(ch={}));var k2;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let s=[];i.count!==void 0&&s.push({type:0,path:n,props:{count:i.count}});for(let a of t){let o=i[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=r})(k2||(k2={}));var R7=["count"],k7=["radius","start","end","position","scale","rotation"],L7=["position","scale","rotation"],N7=["count","size"],z7=["count","position","scale","rotation"],B7=["strength","scale","rotation","position","movement","seed","freqScale"],L2;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(L2||(L2={}));var N2;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:Lr.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:Lr.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Lr.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(N2||(N2={}));var _S;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(_S||(_S={}));var pg;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(pg||(pg={}));var z2;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(z2||(z2={}));var B2;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(B2||(B2={}));var F2;(e=>e.defaultData={...B2.defaultData,...z2.defaultData})(F2||(F2={}));var K4;(e=>{function t(r,i){var s,a;let n=[];if("material"in r){let o=typeof r.material=="string"?i.materials[r.material]??((s=i.lib.materials[r.material])==null?void 0:s.asset):r.material;o&&n.push(o)}else if("materials"in r)for(let o of r.materials){let l=typeof o=="string"?i.materials[o]??((a=i.lib.materials[o])==null?void 0:a.asset):o;l&&n.push(l)}return n}e.getMaterialData=t})(K4||(K4={}));var SS;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(SS||(SS={}));var Z4;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="particle"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(Z4||(Z4={}));function mwe(e){return e.type!=="displace"}var J4;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(J4||(J4={}));var F7=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],gwe=["wrapping","image","video","name","minFilter","magFilter"],mn;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function r(s,a){return s==="light"&&a?i(a):n(s)}e.defaultData=r;function i(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:SS.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...a,type:"color",color:as.fromHex(Ma)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...as.fromHex(6710886),a:1},colorB:{...as.fromHex(6710886),a:1},colorC:{...as.fromHex(16777215),a:1},colorD:{...as.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:Lr.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Lr.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:Lr.fromHexAndA(0,1),contourColor:Lr.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...as.fromHex(0),a:1},colorB:{...as.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(mn||(mn={}));var fs;(e=>{function t(u){return!u.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}e.isMergable=t;function r(u){let h="";return u.layers.forEach(d=>{Object.entries(d.data).forEach(([p,f])=>{h+=`${p}${f}`,Array.isArray(f)?f.forEach(m=>h+=`${m}`):typeof f=="object"?Object.values(f).forEach(m=>{typeof m=="number"?h+=`${m.toFixed(4)}`:h+=`${m}`}):h+=`${f}`})}),h}e.getHash=r;function i(){return{layers:new xt}}e.defaultEmptyData=i;function n(u="layer1",h="layer2"){return a("phong",u,h)}e.defaultData=n;function s(u,h){return{...u,name:h}}e.withName=s;function a(u,h="layer1",d="layer2"){let p=new xt;return p.push({fi:0,data:mn.defaultData("light",u),id:h}),p.push({fi:1,data:mn.defaultData("color"),id:d}),{layers:p}}e.defaultTwoLayerData=a;function o(u){let h=mn.defaultData("texture");u&&Object.assign(h.texture,{image:u});let d=new xt;return d.push({fi:0,data:h,id:"layer1"}),d.push({fi:1,data:{...mn.defaultData("transmission"),alpha:1},id:"layer2"}),d.push({fi:2,data:{...mn.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:d}}e.defaultUIObjectMaterial=o;function l(u,h="phong",d="layer1",p="layer2"){let f=mn.defaultData("texture");Object.assign(f.texture,{image:u});let m=new xt;return m.push({fi:0,data:f,id:d}),m.push({fi:1,data:mn.defaultData("light",h),id:p}),{layers:m}}e.defaultTwoLayerTextureData=l;function c(u,h="phong",d="layer1",p="layer2"){let f=mn.defaultData("video");Object.assign(f.texture,{video:u});let m=new xt;return m.push({fi:0,data:f,id:d}),m.push({fi:1,data:mn.defaultData("light",h),id:p}),{layers:m}}e.defaultTwoLayerVideoTextureData=c})(fs||(fs={}));var ES;(e=>{function t(){return{points:new xt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(ES||(ES={}));var TS;(e=>{function t(){return{points:new xt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(TS||(TS={}));var U7={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},U2;(e=>{function t(r,i){let n={...r};return V7.forEach(s=>{Object.assign(n,{[s]:i[s]??r[s]})}),n}e.merge=t})(U2||(U2={}));var j7={shape:U7,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},V7=["depth","offset","angle","twist","startScale","endScale"],CS;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="UIGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}e.isParametricMesh=r})(CS||(CS={}));var j2;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,U2.merge(n.extrusion,i.extrusion))),n}e.merge=t})(j2||(j2={}));var Im;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="UIGeometry")return{type:r,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:TS.defaultData(),extrusion:j7};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:ES.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(Im||(Im={}));var eU=["width","height","depth"],V2;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:as.white,near:.1,far:2e3})(V2||(V2={}));var AS;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(AS||(AS={}));var H2;(e=>e.defaultData={softShadowQuality:"low"})(H2||(H2={}));var W2;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(W2||(W2={}));var G2;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(G2||(G2={}));var fg;(e=>e.defaultData={usePhysics:!1,gravity:-10})(fg||(fg={}));var q2;(e=>e.defaultData={playCamera:rv,gameControlObject:null})(q2||(q2={}));var Y2;(e=>e.defaultData={backgroundColor:Lr.fromHexAndA(fwe,1),postprocessing:AS.defaultData,fog:V2.defaultData,globalPhysics:fg.defaultData,ambient:W2.defaultData,ao:G2.defaultData,shadow:H2.defaultData,publish:q2.defaultData})(Y2||(Y2={}));var X2;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(X2||(X2={}));var tU;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(tU||(tU={}));var mg;(e=>{e.identity={...R2.identity,hiddenMatrix:hg.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,s){return s7({position:Zd.isEqual(n.position,s.position)?void 0:s.position,rotation:Zd.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:Zd.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:hg.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=i})(mg||(mg={}));var Gn;(e=>e.defaultData={states:new xt,events:new xt,visible:!0,raycastLock:!1,physics:pg.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...mg.identity,cloner:null})(Gn||(Gn={}));var $2;(e=>e.defaultData={type:"Empty",...Gn.defaultData})($2||($2={}));var rU;(e=>e.defaultData={type:"ParticleCollider",...X2.defaultData,...Gn.defaultData})(rU||(rU={}));var iU;(e=>e.defaultData={type:"Component",...Gn.defaultData})(iU||(iU={}));var nU;(e=>e.defaultData={type:"Particle",...Gn.defaultData,..._S.defaultData})(nU||(nU={}));var Om;(e=>e.defaultData={type:"Mesh",...Gn.defaultData,...F2.defaultData})(Om||(Om={}));var Y0;(e=>e.defaultData={...Gn.defaultData,...mg.identity,position:[0,0,dg.DefaultTargetOffset],...dg.defaultData})(Y0||(Y0={}));var Q2;(e=>{function t(r){return{...Gn.defaultData,...N2.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(Q2||(Q2={}));var MS;(e=>{function t(i,n,s=0){for(;s<n.length;){let a=i?i[n[s]]:void 0;if(n.length===s+1)return a;if(a)i=a.descendants,s+=1;else return}}e.resolveWithDes=t;function r(i,n,s=0){let a=t(i,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=r})(MS||(MS={}));var uh;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Gn.defaultData,...n,component:i,overrides:new Qi,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=mg.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(uh||(uh={}));var gg;(e=>{e.defaultData={type:"Page",...Gn.defaultData,physics:{...pg.defaultData,fusedBody:!1},...Y2.defaultData,camera:Y0.defaultData};function t(r){return r.uiScene!==void 0}e.isUIPage=t})(gg||(gg={}));var K2;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:hg.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:pg.defaultData,states:new xt,events:new xt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...dg.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Gn.defaultData,...Om.defaultData,geometry:Im.defaultData("RectangleGeometry"),material:fs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Gn.defaultData,...Om.defaultData,geometry:Im.defaultData("BooleanGeometry"),material:fs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Gn.defaultData,...Om.defaultData,geometry:Im.defaultData("TextGeometry"),material:fs.defaultTwoLayerData("phong","layer1","layer2")}))(K2||(K2={}));var Nd;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new Qi}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new Qi})))):yp.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function r(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=q0(o.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(a.material.layers)){let h=l.layers.data(c);h&&mn.patch(h,u)}}).data),o.materials&&a.materials&&(o.materials=q0(o.materials,l=>{var c,u;for(let h=0;h<o.materials.length;h++){let d=a.materials[h];if(typeof d!="string")for(let[p,f]of Object.entries(d.layers)){let m=(u=(c=l[h])==null?void 0:c.layers)==null?void 0:u.data(p);m&&mn.patch(m,f)}}}).data),o}function i(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function u(h,d){for(let[p,f]of Object.entries(d.layers)){let{texture:m,...g}=f;if(m!==void 0&&Object.keys(m).length>0){let v={path:[...h,"layers",p,"texture"],props:m,type:0};l.push(v)}if(Object.keys(g).length>0){let v={path:[...h,"layers",p],props:g,type:0};l.push(v)}}}for(let[h,d]of Object.entries(a))if(h!=="name")if(h==="cloner")l.push(...k2.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")u(["material"],d);else if(h==="materials")for(let[p,f]of Object.entries(d))u(["materials",p],f);else if(c[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let p={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(p),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let p={path:[h],props:d,type:0};l.push(p)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[h]=d;return l}e.toOps=i;function n(s,a){var l,c,u,h,d,p;if(a===void 0)return s;let o={...s};if(Object.assign(o,mg.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((c=o.pathSnapping)==null?void 0:c.slide)??0,offset:((u=a.pathSnapping)==null?void 0:u.offset)??((h=o.pathSnapping)==null?void 0:h.offset)??0})}),yp.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let f=a;((d=f.orthographic)==null?void 0:d.zoom)!==void 0&&(o.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(o.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(o.targetOffset=f.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:j2.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=r(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:ch.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:ch.merge(o.cloner,a.cloner)});else if(L2.is(s.type)){let f=a;f.intensity!==void 0&&(o.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?o.color=f.color:o.color=as.clone(f.color))}return o}e.patch=n})(Nd||(Nd={}));var PS;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(PS||(PS={}));var hh;(e=>e.defaultData={orbitControls:PS.defaultData,playPage:Jy,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(hh||(hh={}));var Z2;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(Z2||(Z2={}));var J2;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(J2||(J2={}));var zd;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...Z2.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:J2.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(zd||(zd={}));var X0;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,s){i.scene.objects.traverseFrom(n,(a,o)=>{var l;if(o.type==="Instance"){let c=(l=OS.getComponentData(i,o.component))==null?void 0:l.data;c&&s(a,o,c.events)}else s(a,o,o.events)})}e.traverseModuleInstances=r})(X0||(X0={}));var Bd;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:Q2.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(n=!0,s=[]){let a=[],o=K2.defaultMeshObject;n&&(a.push({...e.defaultLight}),a.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]})),a.push(...s);let l=new Hn;return l.push({fi:1,id:Jy,data:{...gg.defaultData,name:"Scene 1"},children:a}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:hh.defaultData,styles:zd.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new Hn,publish:hh.defaultData,styles:zd.defaultData()}},e.emptyDataWithPage=function(n=!0){return{objects:t(n),publish:hh.defaultData,styles:zd.defaultData()}},e.emptyData=function(){return{objects:new Hn,publish:{...hh.defaultData},styles:zd.defaultData()}};function r(n){return{...e.defaultData,objects:Gl(n,Hn.prototype)}}e.withObjs=r;function i(n,s){return r([{id:n,data:s,children:[],fi:0}])}e.withObj=i})(Bd||(Bd={}));var e0;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(e0||(e0={}));var ba;(e=>{function t(a){return a.textValue!==void 0}e.isTextValue=t;function r(a){return typeof a=="number"}e.isNumber=r;function i(a){return typeof a=="boolean"}e.isBoolean=i;function n(a){return t(a)?"string":i(a)?"boolean":"number"}e.typeOfVariable=n;function s(a){return e.isTextValue(a)?Array.isArray(a.textValue)?a.textValue.map(o=>o.toString().padStart(a.padding??2,"0")).join(a.deliminator??":")+(a.suffix!==void 0?" "+a.suffix:""):a.textValue.toString():e.isBoolean(a)?a?"True":"False":e.isNumber(a)?parseFloat(a.toFixed(3)).toString():a.toString()}e.getDisplayedValue=s})(ba||(ba={}));var eI;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(eI||(eI={}));var sU;(e=>e.all=[...eI.all,"components"])(sU||(sU={}));var aU;(e=>{function t(){return{images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,materials:new kt,components:new kt,variables:new kt}}e.defaultData=t})(aU||(aU={}));var wp;(e=>{function t(){return{images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,materials:new kt,components:new kt,variables:new kt}}e.defaultData=t})(wp||(wp={}));var qa;(e=>{function t(){let a={};return a["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Gl(a,kt.prototype)}e.defaultColors=t;function r(){return Gl({},kt.prototype)}e.defaultImages=r;function i(){return{catelogs:new kt,materials:new kt,images:new kt,videos:new kt,colors:new kt,audios:new kt,particles:new kt,fonts:new kt,variables:new xt,lib:wp.defaultData()}}e.emptyData=i;function n(a){switch(a){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let o=[0,0,0];return{name:"Time",value:{textValue:o,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:o,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",a)}}e.defaultVariables=n;function s(a,o){if(o.format==="HH:mm:ss"){let l=Math.floor(a/3600),c=Math.floor((a-l*3600)/60),u=Math.round(a-l*3600-c*60);return{textValue:[l,c,u]}}else if(o.format==="mm:ss"){let l=Math.floor(a/60),c=Math.round(a-l*60);return{textValue:[l,c]}}else return o.format==="number"?a=Math.round(a):a=Math.round(a*1e3)/1e3,a}e.getFormattedTimerTime=s})(qa||(qa={}));var DS;(e=>e.list=["idle","move","jump","run"])(DS||(DS={}));var IS;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new xt,move:new xt,jump:new xt,run:new xt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Lr.fromHexAndA(3728051,1)}}))(IS||(IS={}));function oU(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...Xc(ki(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...ki(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function $u(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Qu(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,s)=>{n===void 0&&(i.materials[s]=fs.defaultData(),n=i.materials[s]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=fs.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=fs.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==Qi.prototype&&t(n.material)})})}function vwe(e){Object.assign(e.scene.publish,{orbitControls:{...PS.defaultData,...ki(e.scene.publish.orbitControls)}})}function ywe(e){Object.assign(e.scene.publish.settings,{video:{...hh.defaultData.settings.video,...ki(e.scene.publish.settings.video)}})}function wwe(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,s]of Object.entries(i))if((F7.includes(n)||typeof s=="boolean")&&delete i[n],n==="texture")for(let[a,o]of Object.entries(s))(gwe.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function xwe(e){e.scene.publish.withBackground=!0}function bwe(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function _we(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function Swe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function Ewe(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=ki(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=ki(r).booleanExclude!==!0)}})}function Twe(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function Cwe(e){function t(i){Object.setPrototypeOf(i,Qi.prototype),i.texture&&Object.setPrototypeOf(i.texture,Qi.prototype)}function r(i){Object.setPrototypeOf(i,Qi.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=ki(a.material).layers;r(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=ki(l).layers;r(c),l.layers=c}})})}function lU(e){e.layers===void 0&&Object.assign(e,fs.defaultTwoLayerData("lambert"))}function rM(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...ki(t),colors:r,steps:i};Object.assign(t,n)}})}function Awe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function cU(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&rM(i)}):"material"in r&&typeof r.material!="string"&&rM(r.material)}),Object.values(e.shared.materials).forEach(t=>rM(t))}function Mwe(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function Pwe(e){e.shared.audios=Gl({},kt.prototype)}function Dwe(e){e.shared.videos=Gl({},kt.prototype)}function Iwe(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function Owe(e){Object.entries(ki(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(ki(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function Rwe(e){e.scene.publish.settings.web.preload=!1}function uU(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function hU(e){e.layers&&e.layers.forEach(t=>{mwe(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function kwe(e){e.shared.fonts=Gl({},kt.prototype)}function Lwe(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Nwe(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let s=fs.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=Lwe(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Gn.defaultData,...Om.defaultData,flatShading:!1,wireframe:!1,geometry:{...Im.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:ki(n.states),events:ki(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=ki(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function zwe(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new xt,move:new xt,jump:new xt}});else{let s=new xt;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:rt.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(u,Xc(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(u,{control1:{...a.control1},control2:{...a.control2}});let h={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},d={state:a.state,...h,...u},p={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new xt({fi:0,id:rt.generateUUID(),data:c},{fi:1,id:rt.generateUUID(),data:d})};s.push({fi:l,id:o,data:p})}),delete n.targets)}})})}function Bwe(e){e.scene.objects.traverse((t,r)=>{function i(n,s){var l;let a=new xt,o=[];if(r.events.forEach((c,u,h)=>{if(c.type==="Audio"&&c.trigger===s){let d;o.push(u),c.interaction==="play"?d={...Xc(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...Xc(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:h,id:u,data:d})}}),o.forEach(c=>r.events.delete(c)),a.length){let c=(l=r.events.find(u=>u.type===n))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,a):r.events.insertBefore(null,[{id:rt.generateUUID(),data:{type:n,actions:a}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function dU(e){var r;let t=(r=e.layers.find(i=>i.type==="light"))==null?void 0:r.data;if((t==null?void 0:t.category)==="basic"){let i=mn.defaultData("light","phong"),n=t;Object.assign(n,i),n.visible=!1}}function pU(e){$u(e,dU),Qu(e,dU)}function Fwe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function Uwe(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function jwe(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=fs.defaultTwoLayerData("phong"))})}function Vwe(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function Hwe(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function Wwe(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function Gwe(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function qwe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function Ywe(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function Xwe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=IS.defaultDataThirdPerson.navmesh)})})}function $we(e){e.scene.styles||(e.scene.styles=zd.defaultData())}function fU(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function Qwe(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Qu(e,fU),$u(e,fU)}function Kwe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new xt})})})}function Zwe(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function mU(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function Jwe(e,t){if(t<1&&(Qu(e,oU),$u(e,oU),e.schema=1),t<2&&(vwe(e),e.schema=2),t<3&&(wwe(e),e.schema=3),t<4&&(xwe(e),e.schema=4),t<5&&(bwe(e),e.schema=5),t<6&&(_we(e),e.schema=6),t<7&&(Swe(e),e.schema=7),t<8&&(e.schema=8),t<9&&(cU(e),e.schema=9),t<10&&(Awe(e),e.schema=10),t<11&&(Mwe(e),e.schema=11),t<12&&(cU(e),e.schema=12),t<13&&(Pwe(e),e.schema=13),t<14&&(Iwe(e),e.schema=14),t<15&&(Owe(e),e.schema=15),t<16&&(Rwe(e),e.schema=16),t<17&&(Qu(e,uU),$u(e,uU),e.schema=17),t<18&&(Qu(e,lU),$u(e,lU),e.schema=18),t<19&&(ywe(e),e.schema=19),t<20&&(kwe(e),Nwe(e),e.schema=20),t<21&&(zwe(e),Bwe(e),e.schema=21),t<22&&(pU(e),e.schema=22),t<23&&(Fwe(e),e.schema=23),t<24&&(Uwe(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(Dwe(e),t<25&&(e.schema=25)),t<26&&(Ewe(e),e.schema=26),t<27&&(Twe(e),e.schema=27),t<28&&(pU(e),e.schema=28),t<29&&(Cwe(e),e.schema=29),t<30&&(jwe(e),e.schema=30),t<31&&(Vwe(e),e.schema=31),t<33&&(Hwe(e),e.schema=33),t<34&&(Wwe(e),e.schema=34),t<35&&(Gwe(e),e.schema=35),t<36&&(qwe(e),e.schema=36),t<37&&(Ywe(e),e.schema=37),t<38&&(Qu(e,hU),$u(e,hU),e.schema=38),t<39&&(Xwe(e),e.schema=39),t<40&&($we(e),e.schema=40),t<41&&(Qwe(e),e.schema=41),t<42&&(Kwe(e),e.schema=42),t<43&&(Zwe(e),e.schema=43),t<99){Qu(e,mU),$u(e,mU),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=rv);let r=ki(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=Jy,i.insertBefore(null,null,[{id:Jy,data:{...gg.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Xc(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Xc(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...fg.defaultData,...Xc(e.scene.environment,"usePhysics","gravity")},camera:ki(e.scene.ownerCamera)??gg.defaultData.camera,name:"Scene"},children:[]}]);for(let a of r)a.id!==Bd.TRASH_CAN_ID&&i.move(Jy,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,pg.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function gU(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function exe(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}function txe(e){var t;Array.isArray(ki(e.events))&&((t=e.events)==null||t.forEach(r=>{"disabled"in r||(r.disabled=!1),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress")&&(r.mode=r.mode||"Object")}))}var qf=180/Math.PI;function vU(e){e.rotation=e.rotation.slice(0,3).map(t=>t*qf)}function H7(e){var r,i;vU(e),e.type==="Page"&&vU(e.camera),(r=e.states)==null||r.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(s=>s*qf))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*qf),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*qf),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=qf,t.extrusion.twist*=qf),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(ki(e.events))&&((i=e.events)==null||i.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function rxe(e){e.shared.variables=Gl({},kt.prototype)}function ixe(e){let t=ki(e.shared.variables);e.shared.variables=Gl(Object.entries(t??{}).map(([r,i],n)=>({fi:n,id:r,data:i})),xt.prototype)}var Ac=113;function W7(e,t){t(e.data);for(let r of e.children)W7(r,t)}function nxe(e){let t=e.schema??104;t!==Ac&&t<105&&(W7(e.asset,H7),e.schema=105)}function sxe(e){e.shared.particles=Gl({},kt.prototype),e.shared.lib&&(e.shared.lib.particles=wp.defaultData().particles)}function axe(e){e.scene.objects.traverse((t,r)=>{r.type==="Particle"&&typeof r.renderMaterial.size=="number"&&Object.assign(r.renderMaterial,{size:[r.renderMaterial.size,r.renderMaterial.size]})})}function oxe(e){e.scene.objects.traverse((t,r)=>{r.type==="Page"&&(r.postprocessing.depthOfField.focusDistance=100,r.postprocessing.depthOfField.focalLength=20,r.postprocessing.depthOfField.bokehScale=5)})}function lxe(e){e.scene.objects.traverse((t,r)=>{var i;Array.isArray(ki(r.events))!==!1&&((i=r.events)==null||i.forEach(n=>{var a,o,l,c,u,h,d,p,f,m,g;let s=n.runMode;n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="Collision"||n.type==="Trigger"?(a=n.actions)==null||a.forEach(v=>{v.type==="Transition"&&(v.runMode=s??"Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode=s==="Toggle"?"Toggle":"Normal")}):n.type==="MouseHover"||n.type==="MousePress"||n.type==="KeyPress"?(o=n.actions)==null||o.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")}):n.type==="GameControl"?(delete n.actions,Object.keys(n.gameActions).forEach(v=>{var y;(y=n.gameActions[v])==null||y.forEach(w=>{w.type==="Transition"&&(w.runMode="Repeat"),w.type==="Animation"&&(w.runMode="Normal")})})):n.type==="DragDrop"?(delete n.actions,(c=(l=n.dragDropActions)==null?void 0:l.drag)==null||c.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")}),(h=(u=n.dragDropActions)==null?void 0:u.drop)==null||h.forEach(v=>{(v.type==="Transition"||v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Toggle")})):n.type==="Resize"?(delete n.actions,(d=n.breakpoints)==null||d.forEach(v=>{var y;(y=v.actions)==null||y.forEach(w=>{(w.type==="Transition"||w.type==="Animation"||w.type==="SwitchCamera")&&(w.runMode="Toggle")})})):n.type==="Start"?(p=n.actions)==null||p.forEach(v=>{v.type==="Transition"&&(v.runMode="Once"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}):n.type==="VariableChange"||n.type==="Scroll"?(f=n.actions)==null||f.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}):n.type==="Conditional"&&(delete n.actions,(m=n.inActions)==null||m.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}),(g=n.outActions)==null||g.forEach(v=>{v.type==="Transition"&&(v.runMode="Repeat"),(v.type==="Animation"||v.type==="SwitchCamera")&&(v.runMode="Normal")}))}))})}function G7(e){let t=e.schema??0;if(t!==Ac){console.warn("updating from ",t,"to ",Ac),Jwe(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=hh.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Qu(e,gU),$u(e,gU),e.schema=101),t<102&&(exe(e),e.schema=102),t<104&&(e.shared.catelogs=new kt,e.shared.lib=wp.defaultData(),e.schema=104),t<105&&(rxe(e),e.scene.objects.traverse((r,i)=>{H7(i)}),e.schema=105);for(let r of Object.values(e.shared.lib.components))nxe(r);t<106&&(ixe(e),e.schema=106),t<107&&(e.shared.lib.variables=wp.defaultData().variables,e.schema=107),t<109&&(sxe(e),e.schema=109),t<110&&(axe(e),e.schema=110),t<111&&(e.scene.objects.traverse((r,i)=>{txe(i)}),e.schema=111),t<112&&(oxe(e),e.schema=112),t<113&&(lxe(e),e.schema=113)}}var OS;(e=>{e.defaultData={schema:Ac,scene:Bd.defaultData,frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",e0.defaultData),shared:{...qa.emptyData(),colors:qa.defaultColors()}},e.emptyDataForImports=function(){let n=Bd.emptyDataWithPage();return{schema:Ac,scene:n,frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",e0.defaultData),shared:{...qa.emptyData(),colors:qa.defaultColors(),images:qa.defaultImages()}}},e.emptyData=function(){return{schema:Ac,scene:Bd.emptyDataWithPage(),frames:new kt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",e0.defaultData),shared:qa.emptyData()}},e.clipboard2dData=function(){return{schema:Ac,scene:Bd.emptyData(),frames:new kt,shared:qa.emptyData()}},e.collabHelper={..._2,updateSchema(n){return(n.schema??0)<Ac?q0(n,G7):(n.schema??0)-Ac}};function t(n){let s=e.collabHelper.updateSchema(n);return typeof s=="number"?s===0?n:null:s.data}e.updateSchemaDirectly=t;function r(n){return{...n,shared:{...n.shared,lib:wp.defaultData()}}}e.withoutLib=r;function i(n,s){let a=n.scene.objects.get(s);if(a&&a.data.type==="Component")return a;{let o=n.shared.lib.components[s];if(o)return o.asset}}e.getComponentData=i})(OS||(OS={}));var tI;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(tI||(tI={}));var yU;(e=>{function t(r){return!0}e.is=t})(yU||(yU={}));var RS;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(i,n){return{position:(n==null?void 0:n.position)??i.position,rotation:(n==null?void 0:n.rotation)??i.rotation,scale:(n==null?void 0:n.scale)??i.scale,shear:(n==null?void 0:n.shear)??i.shear}}e.merge=t;function r(i,n){return s7({position:Uc.isEqual(i.position,n.position)?void 0:n.position,rotation:i.rotation===n.rotation?void 0:n.rotation,scale:Uc.isEqual(i.scale,n.scale)?void 0:n.scale,shear:i.shear&&n.shear&&Uc.isEqual(i.shear,n.shear)?void 0:n.shear})}e.diff=r})(RS||(RS={}));var rI;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(rI||(rI={}));var wU;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(wU||(wU={}));var kS;(e=>e.defaultData={opacity:1,fill:{color:Lr.fromHexAndA(Ma,1),enabled:!0},stroke:{color:Lr.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:Lr.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:Lr.from0to1([0,0,0,1]),enabled:!1,spread:0}})(kS||(kS={}));var Fd;(e=>{function t(a,o){return{name:o}}e.newEmpty=t;function r(a,o){if(o===void 0)return a;let l={...a},c=["width","height","cornerRadius"];for(let u of c)u in l&&u in o&&o[u]!==void 0&&Object.assign(l,{[u]:o[u]});return l}function i(a,o){if(o===void 0)return a;let l={...a};return"fill"in l&&"fill"in o&&o.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...o.fill}}),"stroke"in l&&"stroke"in o&&o.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...o.stroke}}),"layerBlur"in l&&"layerBlur"in o&&o.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...o.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in o&&o.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...o.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in o&&o.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...o.dropShadow}}),"innerShadow"in l&&"innerShadow"in o&&o.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...o.innerShadow}}),l}function n(a,o){if(o===void 0)return a;let l={...a};return Object.assign(l,RS.merge(l,o)),l=r(l,o),l=i(l,o),l}e.patch=n;function s(a,o){let l,c=[];for(let[u,h]of Object.entries(o))u!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},c.push(l)),l.props[u]=h);return c}e.toOps=s})(Fd||(Fd={}));var $0;(e=>e.defaultData={...RS.defaultData,...rI.defaultData,states:new xt,events:new xt,visible:!0,raycastLock:!1})($0||($0={}));var vg;(e=>e.defaultData={...$0.defaultData,...kS.defaultData})(vg||(vg={}));var LS;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(LS||(LS={}));var iI;(e=>e.defaultData={...vg.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(iI||(iI={}));var Q0;(e=>e.defaultData={...vg.defaultData,...LS.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(Q0||(Q0={}));var nI;(e=>e.defaultData={...vg.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(nI||(nI={}));var sI;(e=>e.defaultData={...vg.defaultData,type:"path2d",path:"",name:"Path"})(sI||(sI={}));var xU;(e=>{function t(r){return r.type==="ellipse2d"||r.type==="rectangle2d"||r.type==="text2d"||r.type==="vector2d"||r.type==="path2d"}e.is=t})(xU||(xU={}));var NS;(e=>e.defaultData={...$0.defaultData,name:"Group",type:"group2d"})(NS||(NS={}));var aI;(e=>e.defaultData=()=>({...$0.defaultData,...LS.defaultData,...kS.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:Lr.fromHexAndA(4737101,1),enabled:!0},stroke:{color:Lr.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(aI||(aI={}));var Jd;(e=>{function t(a){switch(a){case"rectangle2d":return{...Q0.defaultData};case"ellipse2d":return{...iI.defaultData};case"text2d":return{...nI.defaultData};case"vector2d":return{...Q0.defaultData};case"path2d":return{...sI.defaultData};case"frame2d":return{...aI.defaultData()};case"group2d":return{...NS.defaultData}}}e.defaultData=t;function r(a){return"width"in a&&"height"in a?[typeof a.width=="number"?a.width*.5:0,typeof a.height=="number"?a.height*.5:0]:[0,0]}e.getPivot=r;function i(a){return a.type==="rectangle2d"||a.type==="ellipse2d"||a.type==="text2d"||a.type==="frame2d"}e.isResizeable=i;function n(a){return a.type==="frame2d"&&a.autoLayout!==void 0}e.isAutoLayoutable=n;function s(a){return a.type==="rectangle2d"||a.type==="frame2d"}e.hasCorners=s})(Jd||(Jd={}));var oI;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new Hn},e.emptyData=function(){return{type:"scene2d",objects:new Hn}}))(oI||(oI={}));function Ud(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new pt,c=0;for(let u=0;u<e.length;++u){let h=e[u],d=0;if(r!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!i.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[p]===void 0&&(a[p]=[]),a[p].push(h.morphAttributes[p])}if(t){let p;if(r)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,u),c+=p}}if(r){let u=0,h=[];for(let d=0;d<e.length;++d){let p=e[d].index;for(let f=0;f<p.count;++f)h.push(p.getX(f)+u);u+=e[d].attributes.position.count}l.setIndex(h)}for(let u in s){let h=bU(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,h)}for(let u in a){let h=a[u][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let d=0;d<h;++d){let p=[];for(let m=0;m<a[u].length;++m)p.push(a[u][m][d]);let f=bU(p);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(f)}}return l}function bU(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new Mt(s,r,i)}var cxe=Math.pow(2,-24),E1=class{constructor(){}};function Tl(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function _U(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function SU(e,t){t.set(e)}function EU(e,t,r){let i,n;for(let s=0;s<3;s++){let a=s+3;i=e[s],n=t[s],r[s]=i<n?i:n,i=e[a],n=t[a],r[a]=i>n?i:n}}function T1(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],s=t[e+2*i+1],a=n-s,o=n+s;a<r[i]&&(r[i]=a),o>r[i+3]&&(r[i+3]=o)}}function Xv(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function uxe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new Mt(n,1));for(let s=0;s<r;s++)n[s]=s}}function hxe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,s)=>n-s);for(let n=0;n<i.length-1;n++){let s=i[n],a=i[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function iM(e,t,r,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=n!==null;for(let y=t*6,w=(t+r)*6;y<w;y+=6){let b=e[y+0],E=e[y+1],_=b-E,C=b+E;_<s&&(s=_),C>l&&(l=C),v&&b<h&&(h=b),v&&b>f&&(f=b);let x=e[y+2],A=e[y+3],T=x-A,M=x+A;T<a&&(a=T),M>c&&(c=M),v&&x<d&&(d=x),v&&x>m&&(m=x);let D=e[y+4],P=e[y+5],I=D-P,B=D+P;I<o&&(o=I),B>u&&(u=B),v&&D<p&&(p=D),v&&D>g&&(g=D)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=u,v&&(n[0]=h,n[1]=d,n[2]=p,n[3]=f,n[4]=m,n[5]=g)}function dxe(e,t,r,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=t*6,h=(t+r)*6;u<h;u+=6){let d=e[u+0];d<n&&(n=d),d>o&&(o=d);let p=e[u+2];p<s&&(s=p),p>l&&(l=p);let f=e[u+4];f<a&&(a=f),f>c&&(c=f)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function pxe(e,t,r,i,n){let s=r,a=r+i-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let u=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=u;let h=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=h;let d=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=d}s++,a--}else return s}}var wc=32,fxe=(e,t)=>e.candidate-t.candidate,Pu=new Array(wc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),C1=new Float32Array(6);function mxe(e,t,r,i,n,s){let a=-1,o=0;if(s===0)a=_U(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=_U(e),a!==-1&&(o=gxe(r,i,n,a));else if(s===2){let l=Xv(e),c=1.25*n,u=i*6,h=(i+n)*6;for(let d=0;d<3;d++){let p=t[d],f=(t[d+3]-p)/wc;if(n<wc/4){let m=[...Pu];m.length=n;let g=0;for(let y=u;y<h;y+=6,g++){let w=m[g];w.candidate=r[y+2*d],w.count=0;let{bounds:b,leftCacheBounds:E,rightCacheBounds:_}=w;for(let C=0;C<3;C++)_[C]=1/0,_[C+3]=-1/0,E[C]=1/0,E[C+3]=-1/0,b[C]=1/0,b[C+3]=-1/0;T1(y,r,b)}m.sort(fxe);let v=n;for(let y=0;y<v;y++){let w=m[y];for(;y+1<v&&m[y+1].candidate===w.candidate;)m.splice(y+1,1),v--}for(let y=u;y<h;y+=6){let w=r[y+2*d];for(let b=0;b<v;b++){let E=m[b];w>=E.candidate?T1(y,r,E.rightCacheBounds):(T1(y,r,E.leftCacheBounds),E.count++)}}for(let y=0;y<v;y++){let w=m[y],b=w.count,E=n-w.count,_=w.leftCacheBounds,C=w.rightCacheBounds,x=0;b!==0&&(x=Xv(_)/l);let A=0;E!==0&&(A=Xv(C)/l);let T=1+1.25*(x*b+A*E);T<c&&(a=d,c=T,o=w.candidate)}}else{for(let v=0;v<wc;v++){let y=Pu[v];y.count=0,y.candidate=p+f+v*f;let w=y.bounds;for(let b=0;b<3;b++)w[b]=1/0,w[b+3]=-1/0}for(let v=u;v<h;v+=6){let y=~~((r[v+2*d]-p)/f);y>=wc&&(y=wc-1);let w=Pu[y];w.count++,T1(v,r,w.bounds)}let m=Pu[wc-1];SU(m.bounds,m.rightCacheBounds);for(let v=wc-2;v>=0;v--){let y=Pu[v],w=Pu[v+1];EU(y.bounds,w.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let v=0;v<wc-1;v++){let y=Pu[v],w=y.count,b=y.bounds,E=Pu[v+1].rightCacheBounds;w!==0&&(g===0?SU(b,C1):EU(b,C1,C1)),g+=w;let _=0,C=0;g!==0&&(_=Xv(C1)/l);let x=n-g;x!==0&&(C=Xv(E)/l);let A=1+1.25*(_*g+C*x);A<c&&(a=d,c=A,o=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function gxe(e,t,r,i){let n=0;for(let s=t,a=t+r;s<a;s++)n+=e[s*6+i*2];return n/r}function vxe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,s=new Float32Array(n*6),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let h=0;h<n;h++){let d=h*3,p=h*6,f,m,g;a?(f=i[d+0],m=i[d+1],g=i[d+2]):(f=i[d+0]*c+l,m=i[d+1]*c+l,g=i[d+2]*c+l);for(let v=0;v<3;v++){let y,w,b;a?(y=r[u[v]](f),w=r[u[v]](m),b=r[u[v]](g)):(y=o[f+v],w=o[m+v],b=o[g+v]);let E=y;w<E&&(E=w),b<E&&(E=b);let _=y;w>_&&(_=w),b>_&&(_=b);let C=(_-E)/2,x=v*2;s[p+x+0]=E+C,s[p+x+1]=C+(Math.abs(E)+C)*cxe,E<t[v]&&(t[v]=E),_>t[v+3]&&(t[v+3]=_)}}return s}function yxe(e,t){function r(v){d&&d(v/p)}function i(v,y,w,b=null,E=0){if(!f&&E>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),w<=u||E>=l)return r(y+w),v.offset=y,v.count=w,v;let _=mxe(v.boundingData,b,a,y,w,h);if(_.axis===-1)return r(y+w),v.offset=y,v.count=w,v;let C=pxe(o,a,y,w,_);if(C===y||C===y+w)r(y+w),v.offset=y,v.count=w;else{v.splitAxis=_.axis;let x=new E1,A=y,T=C-y;v.left=x,x.boundingData=new Float32Array(6),iM(a,A,T,x.boundingData,s),i(x,A,T,s,E+1);let M=new E1,D=C,P=w-T;v.right=M,M.boundingData=new Float32Array(6),iM(a,D,P,M.boundingData,s),i(M,D,P,s,E+1)}return v}uxe(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=vxe(e,n),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,m=[],g=hxe(e);if(g.length===1){let v=g[0],y=new E1;y.boundingData=n,dxe(a,v.offset,v.count,s),i(y,v.offset,v.count,s),m.push(y)}else for(let v of g){let y=new E1;y.boundingData=new Float32Array(6),iM(a,v.offset,v.count,y.boundingData,s),i(y,v.offset,v.count,s),m.push(y)}return m}function wxe(e,t){let r=yxe(e,t),i,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<r.length;u++){let h=r[u],d=l(h),p=new o(32*d);i=new Float32Array(p),n=new Uint32Array(p),s=new Uint16Array(p),c(0,h),a.push(p)}return a;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,h){let d=u/4,p=u/2,f=!!h.count,m=h.boundingData;for(let g=0;g<6;g++)i[d+g]=m[g];if(f){let g=h.offset,v=h.count;return n[d+6]=g,s[p+14]=v,s[p+15]=65535,u+32}else{let g=h.left,v=h.right,y=h.splitAxis,w;if(w=c(u+32,g),w/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=w/4,w=c(w,v),n[d+7]=y,w}}}var cu=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,i=-1/0;for(let n=0,s=e.length;n<s;n++){let a=e[n][t];r=a<r?a:r,i=a>i?a:i}this.min=r,this.max=i}setFromPoints(e,t){let r=1/0,i=-1/0;for(let n=0,s=t.length;n<s;n++){let a=t[n],o=e.dot(a);r=o<r?o:r,i=o>i?o:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};cu.prototype.setFromBox=function(){let e=new R;return function(t,r){let i=r.min,n=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*o+n.x*(1-o),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();var xxe=function(){let e=new R,t=new R,r=new R;return function(i,n,s){let a=i.start,o=e,l=n.start,c=t;r.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let u=r.dot(c),h=c.dot(o),d=c.dot(c),p=r.dot(o),f=o.dot(o)*d-h*h,m,g;f!==0?m=(u*h-p*d)/f:m=0,g=(u+m*h)/d,s.x=m,s.y=g}}(),K3=function(){let e=new re,t=new R,r=new R;return function(i,n,s,a){xxe(i,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){i.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?i.at(0,s):i.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=i.start:c=i.end;let u;l<0?u=n.start:u=n.end;let h=t,d=r;if(i.closestPointToPoint(u,!0,t),n.closestPointToPoint(c,!0,r),h.distanceToSquared(u)<=d.distanceToSquared(c)){s.copy(h),a.copy(u);return}else{s.copy(c),a.copy(d);return}}}}(),bxe=function(){let e=new R,t=new R,r=new ya,i=new to;return function(n,s){let{radius:a,center:o}=n,{a:l,b:c,c:u}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(r);if(Math.abs(h.distanceToPoint(o))<=a){let d=h.projectPoint(o,t);if(s.containsPoint(d))return!0}return!1}}(),_xe=1e-15;function Ef(e){return Math.abs(e)<_xe}var uu=class extends Un{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new R),this.satBounds=new Array(4).fill().map(()=>new cu),this.points=[this.a,this.b,this.c],this.sphere=new ca,this.plane=new ya,this.needsUpdate=!0}intersectsSphere(e){return bxe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=n[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let u=n[2],h=s[2];u.subVectors(t,r),h.setFromPoints(u,i);let d=n[3],p=s[3];d.subVectors(r,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};uu.prototype.closestPointToSegment=function(){let e=new R,t=new R,r=new to;return function(i,n=null,s=null){let{start:a,end:o}=i,l=this.points,c,u=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;r.start.copy(l[h]),r.end.copy(l[d]),K3(r,i,e,t),c=e.distanceToSquared(t),c<u&&(u=c,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(u)}}();uu.prototype.intersectsTriangle=function(){let e=new uu,t=new Array(3),r=new Array(3),i=new cu,n=new cu,s=new R,a=new R,o=new R,l=new R,c=new to,u=new to,h=new to;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let v=this.satBounds,y=this.satAxes;r[0]=d.a,r[1]=d.b,r[2]=d.c;for(let E=0;E<4;E++){let _=v[E],C=y[E];if(i.setFromPoints(C,r),_.isSeparated(i))return!1}let w=d.satBounds,b=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let E=0;E<4;E++){let _=w[E],C=b[E];if(i.setFromPoints(C,t),_.isSeparated(i))return!1}for(let E=0;E<4;E++){let _=y[E];for(let C=0;C<4;C++){let x=b[C];if(s.crossVectors(_,x),i.setFromPoints(s,t),n.setFromPoints(s,r),i.isSeparated(n))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let v=this.points,y=!1,w=0;for(let P=0;P<3;P++){let I=v[P],B=v[(P+1)%3];c.start.copy(I),c.end.copy(B),c.delta(a);let V=y?u.start:u.end,N=Ef(g.distanceToPoint(I));if(Ef(g.normal.dot(a))&&N){u.copy(c),w=2;break}if((g.intersectLine(c,V)||N)&&!Ef(V.distanceTo(B))){if(w++,y)break;y=!0}}if(w===1&&d.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(w!==2)return!1;let b=d.points,E=!1,_=0;for(let P=0;P<3;P++){let I=b[P],B=b[(P+1)%3];c.start.copy(I),c.end.copy(B),c.delta(o);let V=E?h.start:h.end,N=Ef(m.distanceToPoint(I));if(Ef(m.normal.dot(o))&&N){h.copy(c),_=2;break}if((m.intersectLine(c,V)||N)&&!Ef(V.distanceTo(B))){if(_++,E)break;E=!0}}if(_===1&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(_!==2)return!1;if(u.delta(a),h.delta(o),a.dot(o)<0){let P=h.start;h.start=h.end,h.end=P}let C=u.start.dot(a),x=u.end.dot(a),A=h.start.dot(a),T=h.end.dot(a),M=x<A,D=C<T;return C!==T&&A!==x&&M===D?!1:(p&&(l.subVectors(u.start,h.start),l.dot(a)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(a)<0?p.end.copy(u.end):p.end.copy(h.end)),!0)}}}();uu.prototype.distanceToPoint=function(){let e=new R;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();uu.prototype.distanceToTriangle=function(){let e=new R,t=new R,r=["a","b","c"],i=new to,n=new to;return function(s,a=null,o=null){let l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let u=0;u<3;u++){let h,d=r[u],p=s[d];this.closestPointToPoint(p,e),h=p.distanceToSquared(e),h<c&&(c=h,a&&a.copy(e),o&&o.copy(p));let f=this[d];s.closestPointToPoint(f,e),h=f.distanceToSquared(e),h<c&&(c=h,a&&a.copy(f),o&&o.copy(e))}for(let u=0;u<3;u++){let h=r[u],d=r[(u+1)%3];i.set(this[h],this[d]);for(let p=0;p<3;p++){let f=r[p],m=r[(p+1)%3];n.set(s[f],s[m]),K3(i,n,e,t);let g=e.distanceToSquared(t);g<c&&(c=g,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var ql=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new R,this.max=new R,this.matrix=new Be,this.invMatrix=new Be,this.points=new Array(8).fill().map(()=>new R),this.satAxes=new Array(3).fill().map(()=>new R),this.satBounds=new Array(3).fill().map(()=>new cu),this.alignedSatBounds=new Array(3).fill().map(()=>new cu),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ql.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let h=1*l|2*c|4*u,d=i[h];d.x=l?r.x:t.x,d.y=c?r.y:t.y,d.z=u?r.z:t.z,d.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let c=s[l],u=n[l],h=1<<l,d=i[h];c.subVectors(a,d),u.setFromPoints(c,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ql.prototype.intersectsBox=function(){let e=new cu;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,a[0].isSeparated(e)||(e.min=r.y,e.max=i.y,a[1].isSeparated(e))||(e.min=r.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=n[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();ql.prototype.intersectsTriangle=function(){let e=new uu,t=new Array(3),r=new cu,i=new cu,n=new R;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let h=0;h<3;h++){let d=a[h],p=o[h];if(r.setFromPoints(p,t),d.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let h=0;h<3;h++){let d=l[h],p=c[h];if(r.setFromPoints(p,u),d.isSeparated(r))return!1}for(let h=0;h<3;h++){let d=o[h];for(let p=0;p<4;p++){let f=c[p];if(n.crossVectors(d,f),r.setFromPoints(n,t),i.setFromPoints(n,u),r.isSeparated(i))return!1}}return!0}}();ql.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ql.prototype.distanceToPoint=function(){let e=new R;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ql.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new to),r=new Array(12).fill().map(()=>new to),i=new R,n=new R;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,i),s.closestPointToPoint(i,n),o&&o.copy(i),l&&l.copy(n)),0;let c=a*a,u=s.min,h=s.max,d=this.points,p=1/0;for(let m=0;m<8;m++){let g=d[m];n.copy(g).clamp(u,h);let v=g.distanceToSquared(n);if(v<p&&(p=v,o&&o.copy(g),l&&l.copy(n),v<c))return Math.sqrt(v)}let f=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){let y=(m+1)%3,w=(m+2)%3,b=g<<y|v<<w,E=1<<m|g<<y|v<<w,_=d[b],C=d[E];t[f].set(_,C);let x=e[m],A=e[y],T=e[w],M=r[f],D=M.start,P=M.end;D[x]=u[x],D[A]=g?u[A]:h[A],D[T]=v?u[T]:h[A],P[x]=h[x],P[A]=g?u[A]:h[A],P[T]=v?u[T]:h[A],f++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let v=0;v<=1;v++){n.x=m?h.x:u.x,n.y=g?h.y:u.y,n.z=v?h.z:u.z,this.closestPointToPoint(n,i);let y=n.distanceToSquared(i);if(y<p&&(p=y,o&&o.copy(i),l&&l.copy(n),y<c))return Math.sqrt(y)}for(let m=0;m<12;m++){let g=t[m];for(let v=0;v<12;v++){let y=r[v];K3(g,y,i,n);let w=i.distanceToSquared(n);if(w<p&&(p=w,o&&o.copy(i),l&&l.copy(n),w<c))return Math.sqrt(w)}}return Math.sqrt(p)}}();var Tf=new R,Cf=new R,Af=new R,A1=new re,M1=new re,P1=new re,TU=new R,CU=new R,AU=new R,D1=new R;function Sxe(e,t,r,i,n,s){let a;return s===_n?a=e.intersectTriangle(i,r,t,!0,n):a=e.intersectTriangle(t,r,i,s!==ia,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function Exe(e,t,r,i,n,s,a,o,l){Tf.fromBufferAttribute(t,s),Cf.fromBufferAttribute(t,a),Af.fromBufferAttribute(t,o);let c=Sxe(e,Tf,Cf,Af,D1,l);if(c){i&&(A1.fromBufferAttribute(i,s),M1.fromBufferAttribute(i,a),P1.fromBufferAttribute(i,o),c.uv=Un.getInterpolation(D1,Tf,Cf,Af,A1,M1,P1,new re)),n&&(A1.fromBufferAttribute(n,s),M1.fromBufferAttribute(n,a),P1.fromBufferAttribute(n,o),c.uv1=Un.getInterpolation(D1,Tf,Cf,Af,A1,M1,P1,new re)),r&&(TU.fromBufferAttribute(r,s),CU.fromBufferAttribute(r,a),AU.fromBufferAttribute(r,o),c.normal=Un.getInterpolation(D1,Tf,Cf,Af,TU,CU,AU,new R),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a:s,b:a,c:o,normal:new R,materialIndex:0};Un.getNormal(Tf,Cf,Af,u.normal),c.face=u,c.faceIndex=s}return c}function q7(e,t,r,i,n){let s=i*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:h,uv1:d}=e.attributes,p=Exe(r,c,u,h,d,a,o,l,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function Txe(e,t,r,i,n,s){for(let a=i,o=i+n;a<o;a++)q7(e,t,r,a,s)}function Cxe(e,t,r,i,n){let s=1/0,a=null;for(let o=i,l=i+n;o<l;o++){let c=q7(e,t,r,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function xl(e,t,r,i){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function MU(e,t,r,i,n,s,a){let o=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if(xl(a,c*3,o,l),a.needsUpdate=!0,i(a,c,n,s))return!0;return!1}var Y7=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Ku(e,t){return t[e+15]===65535}function Rm(e,t){return t[e+6]}function K0(e,t){return t[e+14]}function Z0(e){return e+8}function J0(e,t){return t[e+6]}function Axe(e,t){return t[e+7]}var ym=new Ni,zS=new R,Mxe=["x","y","z"];function lI(e,t,r,i,n){let s=e*2,a=iv,o=Oh,l=Rh;if(Ku(s,o)){let c=Rm(e,l),u=K0(s,o);Txe(t,r,i,c,u,n)}else{let c=Z0(e);BS(c,a,i,zS)&&lI(c,t,r,i,n);let u=J0(e,l);BS(u,a,i,zS)&&lI(u,t,r,i,n)}}function cI(e,t,r,i){let n=e*2,s=iv,a=Oh,o=Rh;if(Ku(n,a)){let l=Rm(e,o),c=K0(n,a);return Cxe(t,r,i,l,c)}else{let l=Axe(e,o),c=Mxe[l],u=i.direction[c]>=0,h,d;u?(h=Z0(e),d=J0(e,o)):(h=J0(e,o),d=Z0(e));let p=BS(h,s,i,zS)?cI(h,t,r,i):null;if(p){let m=p.point[c];if(u?m<=s[d+l]:m>=s[d+l+3])return p}let f=BS(d,s,i,zS)?cI(d,t,r,i):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var Pxe=function(){let e,t,r=[],i=new Y7(()=>new Ni);return function(...s){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let a=n(...s);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let o=r.length;return o>0&&(t=r[o-1],e=r[o-2]),a};function n(s,a,o,l,c=null,u=0,h=0){function d(y){let w=y*2,b=Oh,E=Rh;for(;!Ku(w,b);)y=Z0(y),w=y*2;return Rm(y,E)}function p(y){let w=y*2,b=Oh,E=Rh;for(;!Ku(w,b);)y=J0(y,E),w=y*2;return Rm(y,E)+K0(w,b)}let f=s*2,m=iv,g=Oh,v=Rh;if(Ku(f,g)){let y=Rm(s,v),w=K0(f,g);return Tl(s,m,e),l(y,w,!1,h,u+s,e)}else{let y=Z0(s),w=J0(s,v),b=y,E=w,_,C,x,A;if(c&&(x=e,A=t,Tl(b,m,x),Tl(E,m,A),_=c(x),C=c(A),C<_)){b=w,E=y;let V=_;_=C,C=V,x=A}x||(x=e,Tl(b,m,x));let T=Ku(b*2,g),M=o(x,T,_,h+1,u+b),D;if(M===2){let V=d(b),N=p(b)-V;D=l(V,N,!0,h+1,u+b,x)}else D=M&&n(b,a,o,l,c,u,h+1);if(D)return!0;A=t,Tl(E,m,A);let P=Ku(E*2,g),I=o(A,P,C,h+1,u+E),B;if(I===2){let V=d(E),N=p(E)-V;B=l(V,N,!0,h+1,u+E,A)}else B=I&&n(E,a,o,l,c,u,h+1);return!!B}}}(),Dxe=function(){let e=new uu,t=new uu,r=new Be,i=new ql,n=new ql;return function s(a,o,l,c,u=null){let h=a*2,d=iv,p=Oh,f=Rh;if(u===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),u=i),Ku(h,p)){let m=o,g=m.index,v=m.attributes.position,y=l.index,w=l.attributes.position,b=Rm(a,f),E=K0(h,p);if(r.copy(c).invert(),l.boundsTree)return Tl(a,d,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:_=>n.intersectsBox(_),intersectsTriangle:_=>{_.a.applyMatrix4(c),_.b.applyMatrix4(c),_.c.applyMatrix4(c),_.needsUpdate=!0;for(let C=b*3,x=(E+b)*3;C<x;C+=3)if(xl(t,C,g,v),t.needsUpdate=!0,_.intersectsTriangle(t))return!0;return!1}});for(let _=b*3,C=E+b*3;_<C;_+=3){xl(e,_,g,v),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let x=0,A=y.count;x<A;x+=3)if(xl(t,x,y,w),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let m=a+8,g=f[a+6];return Tl(m,d,ym),!!(u.intersectsBox(ym)&&s(m,o,l,c,u)||(Tl(g,d,ym),u.intersectsBox(ym)&&s(g,o,l,c,u)))}}}();function BS(e,t,r,i){return Tl(e,t,ym),r.intersectBox(ym,i)}var uI=[],Xb,iv,Oh,Rh;function Ay(e){Xb&&uI.push(Xb),Xb=e,iv=new Float32Array(e),Oh=new Uint16Array(e),Rh=new Uint32Array(e)}function I1(){Xb=null,iv=null,Oh=null,Rh=null,uI.length&&Ay(uI.pop())}var nM=Symbol("skip tree generation"),sM=new Ni,aM=new Ni,Mf=new Be,md=new ql,$v=new ql,Qv=new R,O1=new R,Ixe=new R,Oxe=new R,Rxe=new R,PU=new Ni,nl=new Y7(()=>new uu),t0=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),t0.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),s;return t.cloneBuffers?s={roots:i.map(a=>a.slice()),index:n.array.slice()}:s={roots:i,index:n.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),t0.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,s=new t0(t,{...r,[nM]:!0});if(s._roots=n,r.setIndex){let a=t.getIndex();if(a===null){let o=new Mt(e.index,1,!1);t.setIndex(o)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[nM]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[nM]||(this._roots=wxe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Ni))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,s,a,o,l=0,c=this._roots;for(let h=0,d=c.length;h<d;h++)n=c[h],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),u(0,l),l+=n.byteLength;function u(h,d,p=!1){let f=h*2;if(a[f+15]===65535){let m=s[h+6],g=a[f+14],v=1/0,y=1/0,w=1/0,b=-1/0,E=-1/0,_=-1/0;for(let C=3*m,x=3*(m+g);C<x;C++){let A=r[C],T=i.getX(A),M=i.getY(A),D=i.getZ(A);T<v&&(v=T),T>b&&(b=T),M<y&&(y=M),M>E&&(E=M),D<w&&(w=D),D>_&&(_=D)}return o[h+0]!==v||o[h+1]!==y||o[h+2]!==w||o[h+3]!==b||o[h+4]!==E||o[h+5]!==_?(o[h+0]=v,o[h+1]=y,o[h+2]=w,o[h+3]=b,o[h+4]=E,o[h+5]=_,!0):!1}else{let m=h+8,g=s[h+6],v=m+d,y=g+d,w=p,b=!1,E=!1;e?w||(b=e.has(v),E=e.has(y),w=!b&&!E):(b=!0,E=!0);let _=w||b,C=w||E,x=!1;_&&(x=u(m,d,w));let A=!1;C&&(A=u(g,d,w));let T=x||A;if(T)for(let M=0;M<3;M++){let D=m+M,P=g+M,I=o[D],B=o[D+3],V=o[P],N=o[P+3];o[h+M]=I<V?I:V,o[h+M+3]=B>N?B:N}return T}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);s(0);function s(a,o=0){let l=a*2,c=n[l+15]===65535;if(c){let u=i[a+6],h=n[l+14];e(o,c,new Float32Array(r,a*4,6),u,h)}else{let u=a+8,h=i[a+6],d=i[a+7];e(o,c,new Float32Array(r,a*4,6),d)||(s(u,o+1),s(h,o+1))}}}raycast(e,t=Vo){let r=this._roots,i=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=a?t[o[c].materialIndex].side:l,d=n.length;if(Ay(r[c]),lI(0,i,h,e,n),I1(),a){let p=o[c].materialIndex;for(let f=d,m=n.length;f<m;f++)n[f].face.materialIndex=p}}return n}raycastFirst(e,t=Vo){let r=this._roots,i=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=n?t.side:t;for(let c=0,u=r.length;c<u;c++){let h=s?t[o[c].materialIndex].side:l;Ay(r[c]);let d=cI(0,i,h,e);I1(),d!=null&&(a==null||d.distance<a.distance)&&(a=d,s&&(d.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(Ay(n),i=Dxe(0,r,e,t),I1(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let h=t;t=(d,p,f,m)=>{let g=p*3;return h(d,g,g+1,g+2,f,m)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=nl.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let h=o;o=(d,p,f,m,g)=>h(d,p,f,m,g)?!0:MU(d,p,i,l,f,m,n)}else o||(l?o=(h,d,p,f)=>MU(h,d,i,l,p,f,n):o=(h,d,p)=>p);let c=!1,u=0;for(let h of this._roots){if(Ay(h),c=Pxe(0,i,a,o,s,u),I1(),c)break;u+=h.byteLength}return nl.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;Mf.copy(t).invert();let c=nl.getPrimitive(),u=nl.getPrimitive();if(n){let d=function(p,f,m,g,v,y,w,b){for(let E=m,_=m+g;E<_;E++){xl(u,E*3,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let C=p,x=p+f;C<x;C++)if(xl(c,C*3,s,a),c.needsUpdate=!0,n(c,u,C,E,v,y,w,b))return!0}return!1};if(i){let p=i;i=function(f,m,g,v,y,w,b,E){return p(f,m,g,v,y,w,b,E)?!0:d(f,m,g,v,y,w,b,E)}}else i=d}e.getBoundingBox(aM),aM.applyMatrix4(t);let h=this.shapecast({intersectsBounds:d=>aM.intersectsBox(d),intersectsRange:(d,p,f,m,g,v)=>(sM.copy(v),sM.applyMatrix4(Mf),e.shapecast({intersectsBounds:y=>sM.intersectsBox(y),intersectsRange:(y,w,b,E,_)=>i(d,p,y,w,m,g,E,_)}))});return nl.releasePrimitive(c),nl.releasePrimitive(u),h}intersectsBox(e,t){return md.set(e.min,e.max,t),md.needsUpdate=!0,this.shapecast({intersectsBounds:r=>md.intersectsBox(r),intersectsTriangle:r=>md.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),md.set(e.boundingBox.min,e.boundingBox.max,t),md.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,h=nl.getPrimitive(),d=nl.getPrimitive(),p=O1,f=Ixe,m=null,g=null;i&&(m=Oxe,g=Rxe);let v=1/0,y=null,w=null;return Mf.copy(t).invert(),$v.matrix.copy(Mf),this.shapecast({boundsTraverseOrder:b=>md.distanceToBox(b),intersectsBounds:(b,E,_)=>_<v&&_<s?(E&&($v.min.copy(b.min),$v.max.copy(b.max),$v.needsUpdate=!0),!0):!1,intersectsRange:(b,E)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:_=>$v.distanceToBox(_),intersectsBounds:(_,C,x)=>x<v&&x<s,intersectsRange:(_,C)=>{for(let x=_*3,A=(_+C)*3;x<A;x+=3){xl(d,x,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let T=b*3,M=(b+E)*3;T<M;T+=3){xl(h,T,l,o),h.needsUpdate=!0;let D=h.distanceToTriangle(d,p,m);if(D<v&&(f.copy(p),g&&g.copy(m),v=D,y=T/3,w=x/3),D<n)return!0}}}});{let _=u?u.count:c.count;for(let C=0,x=_;C<x;C+=3){xl(d,C,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let A=b*3,T=(b+E)*3;A<T;A+=3){xl(h,A,l,o),h.needsUpdate=!0;let M=h.distanceToTriangle(d,p,m);if(M<v&&(f.copy(p),g&&g.copy(m),v=M,y=A/3,w=C/3),M<n)return!0}}}}}),nl.releasePrimitive(h),nl.releasePrimitive(d),v===1/0?null:(r.point?r.point.copy(f):r.point=f.clone(),r.distance=v,r.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(Mf),f.applyMatrix4(Mf),i.distance=f.sub(i.point).length(),i.faceIndex=w),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(Qv.copy(e).clamp(c.min,c.max),Qv.distanceToSquared(e)),intersectsBounds:(c,u,h)=>h<a&&h<s,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,Qv);let h=e.distanceToSquared(Qv);return h<a&&(O1.copy(Qv),a=h,o=u),h<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(O1):t.point=O1.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Tl(0,new Float32Array(t),PU),e.union(PU)}),e}},Kv=vu(Lie()),kxe=.5*(Math.sqrt(3)-1),Zv=(3-Math.sqrt(3))/6,Lxe=1/3,sl=1/6,r0=e=>Math.floor(e)|0,DU=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),oM=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function lM(e=Math.random){let t=X7(e),r=new Float64Array(t).map(n=>DU[n%12*2]),i=new Float64Array(t).map(n=>DU[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,c=(n+s)*kxe,u=r0(n+c),h=r0(s+c),d=(u+h)*Zv,p=u-d,f=h-d,m=n-p,g=s-f,v,y;m>g?(v=1,y=0):(v=0,y=1);let w=m-v+Zv,b=g-y+Zv,E=m-1+2*Zv,_=g-1+2*Zv,C=u&255,x=h&255,A=.5-m*m-g*g;if(A>=0){let D=C+t[x],P=r[D],I=i[D];A*=A,a=A*A*(P*m+I*g)}let T=.5-w*w-b*b;if(T>=0){let D=C+v+t[x+y],P=r[D],I=i[D];T*=T,o=T*T*(P*w+I*b)}let M=.5-E*E-_*_;if(M>=0){let D=C+1+t[x+1],P=r[D],I=i[D];M*=M,l=M*M*(P*E+I*_)}return 70*(a+o+l)}}function Nxe(e=Math.random){let t=X7(e),r=new Float64Array(t).map(s=>oM[s%12*3]),i=new Float64Array(t).map(s=>oM[s%12*3+1]),n=new Float64Array(t).map(s=>oM[s%12*3+2]);return function(s,a,o){let l,c,u,h,d=(s+a+o)*Lxe,p=r0(s+d),f=r0(a+d),m=r0(o+d),g=(p+f+m)*sl,v=p-g,y=f-g,w=m-g,b=s-v,E=a-y,_=o-w,C,x,A,T,M,D;b>=E?E>=_?(C=1,x=0,A=0,T=1,M=1,D=0):b>=_?(C=1,x=0,A=0,T=1,M=0,D=1):(C=0,x=0,A=1,T=1,M=0,D=1):E<_?(C=0,x=0,A=1,T=0,M=1,D=1):b<_?(C=0,x=1,A=0,T=0,M=1,D=1):(C=0,x=1,A=0,T=1,M=1,D=0);let P=b-C+sl,I=E-x+sl,B=_-A+sl,V=b-T+2*sl,N=E-M+2*sl,L=_-D+2*sl,W=b-1+3*sl,G=E-1+3*sl,X=_-1+3*sl,Q=p&255,ie=f&255,J=m&255,se=.6-b*b-E*E-_*_;if(se<0)l=0;else{let le=Q+t[ie+t[J]];se*=se,l=se*se*(r[le]*b+i[le]*E+n[le]*_)}let ee=.6-P*P-I*I-B*B;if(ee<0)c=0;else{let le=Q+C+t[ie+x+t[J+A]];ee*=ee,c=ee*ee*(r[le]*P+i[le]*I+n[le]*B)}let ue=.6-V*V-N*N-L*L;if(ue<0)u=0;else{let le=Q+T+t[ie+M+t[J+D]];ue*=ue,u=ue*ue*(r[le]*V+i[le]*N+n[le]*L)}let oe=.6-W*W-G*G-X*X;if(oe<0)h=0;else{let le=Q+1+t[ie+1+t[J+1]];oe*=oe,h=oe*oe*(r[le]*W+i[le]*G+n[le]*X)}return 32*(l+c+u+h)}}function X7(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var go=new Un,zxe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;go.a.fromBufferAttribute(e,i),go.b.fromBufferAttribute(e,i+1),go.c.fromBufferAttribute(e,i+2),n*=go.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),go.a.fromBufferAttribute(this.positionAttribute,e*3),go.b.fromBufferAttribute(this.positionAttribute,e*3+1),go.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(go.a,i).addScaledVector(go.b,n).addScaledVector(go.c,1-(i+n)),go.getNormal(r),this}},Bxe=vu(D9()),Fxe=new Be,Uxe=new Be,jxe=new Be,ew;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(ew||(ew={}));var Z3=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new Be,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Be,this.matrixWorldRigid=new Be,this.shearScale=new Be,this.shearScaleInv=new Be}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Cr&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)ew.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)ew.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:s}=(0,Bxe.SVD)(r),a=Fxe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=Uxe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=jxe.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new Be().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof Be?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},Vxe=class extends Z3(Cr){},Hxe=e=>e.type==="Mesh",ds=class extends Vxe{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];(r==null?void 0:r.object)!==t&&(r&&this.remove(r),r=new ds(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return Hxe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Md=new R,Pd=new R,km=new Be,$7=[new R(-1,1,1),new R(-1,-1,1),new R(1,-1,1),new R(1,1,1),new R(-1,1,-1),new R(-1,-1,-1),new R(1,-1,-1),new R(1,1,-1)],Wxe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],Gxe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],IU=(e,t,r)=>{e.updateEntityBoxSize(Md,Pd),km.copy(t).multiply(e.matrixWorld),Pd.x===0&&Pd.y===0&&Pd.z===0?r.push(new R(Md.x,Md.y,Md.z).applyMatrix4(km)):$7.forEach(i=>{r.push(i.clone().multiply(Pd).add(Md).applyMatrix4(km))})},OU=class extends Ni{constructor(){super(...arguments),this.matrix=new Be,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new Be().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new R);return}IU(n,t,i)}}):IU(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(km.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(Pd).multiplyScalar(.5),this.getCenter(Md),km.copy(this.matrix).setPosition(Md),this.vertices=$7.map(e=>e.clone().multiply(Pd).applyMatrix4(km))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=Wxe.map(([e,t])=>new to(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new R))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=Gxe.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},dh={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},qxe=class extends s8{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(e*l/n),u=o.getPoints(c);for(let h=0;h<u.length;h++){let d=u[h];r&&r.equals(d)||(t.push(d),r=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},hI=.001;function dI(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=hI}function cM(e,t){let r=new R(...e.position),i=new R(...e.controlNext.position),n=new R(...t.controlPrevious.position),s=new R(...t.position);return dI(r,i,s)&&dI(r,n,s)}function Q7(e){let t=e.points.map(u=>new R(...u.data.position)),r=[e.points[0]],i=new R(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)dI(i,t[u],t[u+1])||(r.push(e.points[u]),i=t[u]);r.push(e.points[e.points.length-1]);let n=e.isClosed,s=r.length-(n?0:1),a=r.length,o=[];for(let u=0;u<a;u++){let h=r[u].data,d=new R(...h.position),p=new R(...h.controlPrevious.position),f=new R(...h.controlNext.position),m={position:d,baseRoundness:h.roundness,controlPrevious:p,controlNext:f};if(h.roundness===0||!e.isClosed&&(u===0||u===a-1)){o[u]={...m,removedLength:0};continue}let g=n&&u==0?a-1:u-1,v=n&&u==a-1?0:u+1,y=r[g].data,w=r[v].data,b=new R(...y.position),E=new R(...w.position),_=b.clone().sub(d).normalize(),C=E.clone().sub(d).normalize();Object.assign(m,{prevDir:_,nextDir:C});let x=cM(y,h),A=cM(h,w);if(!x||!A)o[u]={...m,removedLength:0};else{let T=_.clone().add(C).normalize(),M=T.clone().cross(_).length()/_.dot(T);o[u]={...m,tan:M,removedLength:h.roundness/M}}}for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d];if(p.removedLength!==0||f.removedLength!==0){let m=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,m/2),f.removedLength=Math.min(f.removedLength,m/2)}}let l=[];for(let u=0;u<s;u++){let h=u,d=n&&u===a-1?0:u+1,p=o[h],f=o[d],m=null;if(!cM(r[h].data,r[d].data))p.position.distanceTo(f.position)>hI&&(m=new Hb(p.position,p.controlNext,f.controlPrevious,f.position));else{let g=p.position.clone(),v=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&g.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&v.add(f.prevDir.clone().setLength(f.removedLength))),g.distanceTo(v)>hI&&(m=new Hb(g,g.clone().lerp(v,.3),v.clone().lerp(g,.3),v))}l[2*u+1]=m}for(let u=0;u<a;u++){let h=o[u];if(h.removedLength===0){l[2*u]=null;continue}let d=h.position,p=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),f=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),m=h.tan*h.removedLength,g=h.prevDir.clone().add(h.nextDir).normalize(),v=p.clone().lerp(f,.5),y=p.distanceTo(f)/2,w=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(y,2))).add(v),b=g.clone().multiplyScalar(-m).add(w),E=d.distanceTo(b)/d.distanceTo(v),_=h.prevDir.clone().multiplyScalar(E*d.distanceTo(p)).add(d),C=_.clone().lerp(b,2),x=p.clone().lerp(_,4/3),A=f.clone().lerp(C,4/3);l[2*u]=new Hb(p,x,A,f)}let c=new qxe;return l.forEach(u=>{u&&c.add(u)}),c}var sr;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(sr||(sr={}));var Mc=e=>sr.is(e),Yxe={type:"completeState",isfromEntity:!0},Xxe=["x","y","z"],uM=new R,$xe=new R().set(0,1,0),J3=e=>class extends Z3(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new OU,this._recursiveBBox=new OU,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(sr.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(sr.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(sr.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)Nd.toOps(this.data,n.data).forEach(s=>{let a=vS.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=Nd.patch(this.data,n),Nd.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched,r),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Mc(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(sr.is(r[i]))return r[i];if(sr.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&sr.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)Mc(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{sr.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Mc(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Mc(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)Mc(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Mc(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x*rt.RAD2DEG,this.rotation.y*rt.RAD2DEG,this.rotation.z*rt.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return b2(r,t)}getTransformValues(t,r,i){return r[t].map((n,s)=>(i==null?void 0:i.shared.getVariable(n,[this.uuid,t,Xxe[s]]))??n)}updateTransformState(t,r){let i=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,r)),i=!0),t.rotation&&(uM.fromArray(this.getTransformValues("rotation",t,r)).multiplyScalar(rt.DEG2RAD),this.rotation.setFromVector3(uM),i=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,r)),i=!0),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??hg.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)sr.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{sr.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return b2(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let s=this.data;this.data=r;let a=t,o=Ur(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let h=jn.zoom(u,t.path.slice(2));if(h)for(let d in t.props)t.props[d]===void 0&&d in h&&(c[d]=h[d])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...h}=l;l=h}if(t.props.material!==void 0&&"material"in l){let{material:u,...h}=l;l=h}let c=jn.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,Nd.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),Ur(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let h=i.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=t.props[u],h.updateState(Dh.apply(h.component.data,h.overrideData),i))}}else{let u=i.scene.findInstance([this.uuid,...l]);if(u){let h=jn.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let d=t.props;if(h)for(let[p,f]of Object.entries(t.props))f===void 0&&(d===t.props&&(d={...t.props}),d[p]=h[p]);t={...t,props:d}}u.overrideData=MS.resolve(r.overrides,l),u.updateByOp(t,bn.applySimple(u.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of uh.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of uh.rootOverrideProps)if(Ur(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=Dh.filterOp(c.overrideData,l);u&&c.updateByOp(u,bn.applySimple(c.data,u),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=Dh.filterOp(c.overrideData,t);if(u){let h;s===c.data&&t===u?h=r:h=bn.applySimple(c.data,u),c.updateByOp(u,h,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!yp.is(t.props.type)&&dh.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){dh.changeEntityProptotype(this,r,i);for(let n of this.children)sr.is(n)&&n.updateVisible(i.scene)}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0&&this.updateState(t.props,i),Ur(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),Ur(t.path,["cloner"])!==null){let n=bn.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var f,m,g,v,y;let r=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,i=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,n=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset??0,s=((v=this._updatedPathSnapping)==null?void 0:v.orientation)??this.dataPatched.pathSnapping.orientation;if(r===null)return;let a=t.find(r);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=Q7(o.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let u=l.curves.length?l.getPointAt(c):null;if(u===null)return;let h=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new Be;a.updateMatrixWorld();let d=new Be().multiplyMatrices(h.clone().invert(),a.matrixWorld);u.applyMatrix4(d);let p={position:u.toArray(),rotation:o.rotation};if(s==="tangential"){let w=new Be().extractRotation(a.matrixWorld),b=l.getTangentAt(c).applyMatrix4(w).add(u),E=new Be().lookAt(u,b,$xe),_=uM.setFromEuler(new an().setFromRotationMatrix(E)).multiplyScalar(rt.RAD2DEG);p={...p,rotation:_.toArray()}}this.updateTransformState(p),this.traverseEntity(w=>{w._cameraType&&w.dispatchEvent(Yxe)})}updateVisible(t){var i;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((i=this.dataPatched.cloner)==null?void 0:i.hideBase)!==!0),!t)return;let r=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return r=!0,!0}),r&&t.reloadSplats()}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(r==null?void 0:r.scene),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible(r.scene)),this.updateTransformState(t,r)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof dh.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new dh.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},K7=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);r.thetaLength=rt.clamp(r.thetaLength,0,360);let i=r.width/2,n=r.radiusTop??i,s=r.radiusBottom??i;return n===s?(n=i,s=i):n>s?(n=i,s=s*i/n):(n=n*i/s,s=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:n,radiusBottom:s})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:h,cornerSegments:d,hollow:p}=e.parameters,f;return l===0?(f=new pt,f.setAttribute("position",new Ze([],3))):h||p?f=new Z7(c,u,i,n,s,a,o,l*Math.PI/180,h,h,d,p):f=new v3(c,u,i,n,s,a,o,l*Math.PI/180),f.scale(1,1,r/t),Object.assign(f,{userData:{...e,type:"CylinderGeometry"}})}};function Du(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function RU(e){return new re(e.y,-e.x)}var Z7=class extends pt{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let p=[],f=[],m=[],g=[],v=0,y=r/2,w=new R,b=new R;d&&e==0&&(e=l),d&&t==0&&(t=c);let E=new re(e,y),_=new re(t,-y),C=null,x=null,A=null,T=null,M=E.clone().sub(_),D=0,P=0,I=0;h>0&&(D=Math.min(e,t)*(1-h),P=e-D,I=t-D);let B=E.clone();B.x-=D;let V=Math.PI-M.angle(),N=M.angle(),L=Math.tan(N/2),W=Math.tan(V/2),G=L+W,X=h?G:W,Q=h?G:L;if(l=Math.min(l,(e-P)/X,M.length()/G),c=Math.min(c,(t-I)/Q,M.length()/G),l>0){let oe=l/L;C=E.clone().sub(new re(oe,l)),h&&(A=C.clone(),A.x-=D-G*l),E.sub(M.clone().setLength(oe))}if(c>0){let oe=c/W;x=_.clone().sub(new re(oe,-c)),_.add(M.clone().setLength(oe)),h&&(T=x.clone(),T.x-=D-G*c,B.sub(M.clone().setLength(oe)))}M=E.clone().sub(_);let ie=M.length()<.5,J=[];for(let oe=0;oe<=i;oe++){let le=[],de=oe/i,xe=de*o+a,_e=new re(Math.sin(xe),Math.cos(xe));T&&x?(se(le,de,_e,V,c,T,-1,!0),se(le,de,_e,N,c,x,-1,!1)):x?(ee(le,_e,x.x,0,-1),se(le,de,_e,N,c,x,-1,!1)):s||ee(le,_e,t,I,-1);let Se=RU(M).normalize();if(Du(Se,_e,w),!ie)for(let Le=0;Le<=n;Le++){let Oe=Le/n,Ye=M.clone().multiplyScalar(Oe).add(_);Du(Ye,_e,b),f.push(b.x,b.y,b.z),m.push(w.x,w.y,w.z),g.push(de,.5+b.y/r),le.push(v++)}if(A&&C?(se(le,de,_e,V,l,C,1,!1),se(le,de,_e,N,l,A,1,!0)):C?(se(le,de,_e,V,l,C,1,!1),ee(le,_e,C.x,0,1)):s||ee(le,_e,e,P,1),h&&!ie){let Le=RU(M).multiplyScalar(-1).normalize();Du(Le,_e,w);for(let Oe=0;Oe<=n;Oe++){let Ye=Oe/n,$e=M.clone().multiplyScalar(-Ye).add(B);Du($e,_e,b),f.push(b.x,b.y,b.z),m.push(w.x,w.y,w.z),g.push(de,.5+b.y/r),le.push(v++)}}h&&!s&&le.push(le[0]),J.push(le)}for(let oe=0;oe<J.length-1;oe++)for(let le=0;le<J[0].length-1;le++){if(s&&h&&le==n)continue;let de=J[oe][le],xe=J[oe+1][le],_e=J[oe+1][le+1],Se=J[oe][le+1],Le=f[_e*3+0],Oe=f[_e*3+2];p.push(de,xe,Se),(Le!=0||Oe!=0)&&p.push(xe,_e,Se)}o<Math.PI*2&&(ue(-1,J[0],a),ue(1,J[J.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new Ze(f,3)),this.setAttribute("normal",new Ze(m,3)),this.setAttribute("uv",new Ze(g,2));function se(oe,le,de,xe,_e,Se,Le,Oe){for(let Ye=0;Ye<u+1;Ye++){let $e=Ye/u,He=Le<0?$e:1-$e;Oe&&(He-=1),He*=xe;let je=new re(Math.sin(He),Math.cos(He)*Le),lt=je.clone().multiplyScalar(_e).add(Se);Du(lt,de,b),f.push(b.x,b.y,b.z),Du(je,de,w),m.push(w.x,w.y,w.z),g.push(le,.5+b.y/r),oe.push(v++)}}function ee(oe,le,de,xe,_e){let Se=new R,Le=new re,Oe=[de,xe];_e<0&&Oe.reverse();for(let Ye of Oe)Le.set(Ye,y*_e),Du(Le,le,Se),f.push(Se.x,Se.y,Se.z),m.push(0,_e,0),g.push(.5,.5),oe.push(v++)}function ue(oe,le,de){let xe=new re(Math.sin(de),Math.cos(de)),_e=new re(-Math.cos(de),Math.sin(de)),Se=new R,Le=oe<0?($e,He,je)=>p.push($e,He,je):($e,He,je)=>p.push($e,je,He),Oe=new re((e+t+P+I)/4,0);Du(Oe,xe,Se),f.push(Se.x,Se.y,Se.z),m.push(_e.x,0,_e.y),g.push(.5,.5);let Ye=v++;for(let $e of le){let He=f.slice($e*3,$e*3+3);f.push(...He),m.push(_e.x,0,_e.y);let je=g.slice($e*2,$e*2+2);g.push(...je),v++}for(let $e=Ye+1;$e<v-1;$e++)Le(Ye,$e,$e+1);Le(Ye,v-1,Ye+1)}}},Qxe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return r.thetaLength=rt.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:h}=e.parameters,d;return l===0?(d=new pt,d.setAttribute("position",new Ze([],3))):c>0||u>0||l<360?d=new Z7(0,t/2,i,n,s,a,o,l*Math.PI/180,c,u,h,0,!0):d=new y3(t/2,i,n,s,a),d.scale(1,1,r/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},Kxe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o===0?c=new Wo(t,r,i,n,s,a):c=new Zxe(t,r,i,n,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},hM=Math.PI/2,Zxe=class extends pt{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry",i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let l=[],c=[],u=[],h=[],d=0;p("z","y","x",-1,-1,r,t,e,s,n),p("z","y","x",1,-1,r,t,-e,s,n),p("x","z","y",1,1,e,r,t,i,s),p("x","z","y",1,-1,e,r,-t,i,s),p("x","y","z",1,-1,e,t,r,i,n),p("x","y","z",-1,-1,e,t,-r,i,n),a>0&&(f("z","y","x",-1,-1,1,r,t,e,s),f("z","y","x",1,-1,-1,r,t,e,s),f("z","y","x",-1,1,-1,r,t,e,s),f("z","y","x",1,1,1,r,t,e,s),f("x","y","z",-1,-1,-1,e,t,r,i),f("x","y","z",1,-1,1,e,t,r,i),f("x","y","z",-1,1,1,e,t,r,i),f("x","y","z",1,1,-1,e,t,r,i),f("y","x","z",-1,-1,1,t,e,r,n),f("y","x","z",1,-1,-1,t,e,r,n),f("y","x","z",1,1,1,t,e,r,n),f("y","x","z",-1,1,-1,t,e,r,n),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new Ze(c,3)),this.setAttribute("normal",new Ze(u,3)),this.setAttribute("uv",new Ze(h,2));function p(g,v,y,w,b,E,_,C,x,A){let T=(E-2*a)/x,M=(_-2*a)/A,D=E/2-a,P=_/2-a,I=C/2,B=x+1,V=A+1,N=0,L=new R;for(let W=0;W<V;W++){let G=W*M-P;for(let X=0;X<B;X++){let Q=X*T-D;L[g]=Q*w,L[v]=G*b,L[y]=I,c.push(L.x,L.y,L.z),L[g]=0,L[v]=0,L[y]=C>0?1:-1,u.push(L.x,L.y,L.z),h.push(X/x),h.push(1-W/A),N+=1}}for(let W=0;W<A;W++)for(let G=0;G<x;G++){let X=d+G+B*W,Q=d+G+B*(W+1),ie=d+(G+1)+B*(W+1),J=d+(G+1)+B*W;l.push(X,Q,J),l.push(Q,ie,J)}d+=N}function f(g,v,y,w,b,E,_,C,x,A){let T=(_-2*a)/A,M=_/2-a,D=C/2-a,P=x/2,I=A+1,B=0,V=new R,N=new R;for(let L=0;L<o+1;L++){let W=L/o*hM,G=Math.sin(W)*a,X=(1-Math.cos(W))*a,Q=Math.sin(W),ie=Math.cos(W);V[v]=(D+G)*b,V[y]=(P-X)*E,N[g]=0,N[v]=Q*Math.sign(V[v]),N[y]=ie*Math.sign(V[y]);for(let J=0;J<I;J++){let se=J*T-M;V[g]=se*w,c.push(V.x,V.y,V.z),u.push(N.x,N.y,N.z),h.push(J/A),h.push(0),B+=1}}for(let L=0;L<o;L++)for(let W=0;W<A;W++){let G=d+W+I*L,X=d+W+I*(L+1),Q=d+(W+1)+I*(L+1),ie=d+(W+1)+I*L;l.push(G,X,ie),l.push(X,Q,ie)}d+=B}function m(g,v,y){let w=new R,b=new R(e/2,t/2,r/2);b.subScalar(a);let E=[],_=g*v*y>0?(x,A,T)=>l.push(x,A,T):(x,A,T)=>l.push(x,T,A);for(let x=0;x<=o;x++){let A=[],T=hM*(1-x/o),M=Math.cos(T),D=Math.sin(T),P=0;for(let I=0;I<=x;I++){let B=Math.cos(P),V=Math.sin(P);w.x=M*B,w.y=D,w.z=M*V;let N=b.clone().addScaledVector(w,a);c.push(g*N.x,v*N.y,y*N.z),u.push(g*w.x,v*w.y,y*w.z),h.push(0,0),A.push(d++),P+=hM/x}E.push(A)}let C=E.length-1;for(let x=0;x<C;x++){let A=E[x],T=E[x+1],M=A.length-1;_(A[0],T[1],T[0]);for(let D=1;D<=M;D++)_(A[D-1],A[D],T[D]),_(A[D],T[D+1],T[D])}}}},ek=class extends pt{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),u(),this.setAttribute("position",new Ze(a,3)),this.setAttribute("normal",new Ze(l,3)),this.setAttribute("uv",new Ze(o,2));return;function c(){var N;n=Math.min(1-1e-5,n),n==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],d=new R,p=d.clone(),f=new Un,m=n*i,g=i-m,v=s+1,y=new R,w=(L,W)=>y.subVectors(L,W).normalize(),b=(L,W)=>Array(L).fill(void 0).map(W),E=b(e.length/3,(L,W)=>new R().fromArray(e,W*3).setLength(i)),_=[],C=1e6;for(let L=0;L<E.length;L++){let W=E[L],G=[],X,Q,ie,J=1e10,se=-1;for(;(se=t.indexOf(L,se+1))!=-1;){let le=se-se%3;X=t[le+(se+1)%3],Q=t[le+(se+2)%3],ie=W.distanceToSquared(E[X]),J=Math.min(J,ie),G.push([X,Q,ie])}J+=1e-6;let ee=[],ue=0,oe=G.length;for(let le=0;le<oe;le++){[X,Q,ie]=G[ue];let de=((N=_[X])==null?void 0:N.includes(L))==!0;ie<=J&&ee.push(X+ +de*C),ue=G.findIndex(xe=>xe[0]==Q)}_.push(ee)}let x=[];{let L=0,W=0,G,X,Q=h==3;for(let ie=0;ie<=s;ie++){G=ie*(ie+1)/2,X=(ie+1)*(ie+2)/2;for(let J=0;J<s-ie;J++)[L,W]=[G+J+ie+2,X+J+ie+3],x.push(G,X,...Q?[W,G]:[L,X],W,L),[G,X]=[L,W];x.push(G,X,G+s+2)}}let A=d.clone(),T=d.clone(),M=d.clone(),D=d.clone(),P=d.clone(),I=[],B=b(E.length,()=>b(h,()=>d.clone()));for(let L=0;L<E.length;L++){d.copy(E[L]).normalize(),A.copy(d).multiplyScalar(g);let W=_[L];for(let ee=0;ee<W.length;ee++){let ue=W[ee],oe=W[(ee+1)%h];f.setFromPointsAndIndices(E,L,ue%C,oe%C),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(A,B[L][ee])}let G=[],X=[],Q=[],ie=new R;s==0&&[...B[L]].reduce((ee,ue)=>ee.add(ue),ie).multiplyScalar(1/h);for(let ee=0;ee<h;ee++){let ue=[],oe=(ee-1+h)%h,le=B[L][oe],de=B[L][ee];d.copy(le).sub(A),p.copy(de).sub(A);let xe=A.angleTo(d),_e=d.angleTo(p),Se=Math.cos(xe)*m;s==0?T.copy(ie):T.copy(A).setLength(g+Se),X.push(Se);let Le=[T,le,de];for(let Oe=0;Oe<2;Oe++){let Ye=Le[Oe],$e=Le[Oe+1];D.subVectors(Ye,A),P.subVectors($e,A),M.crossVectors(D,P).normalize();for(let He=0;He<v;He++){let je=[xe,_e][Oe]*He/v;d.copy(D).applyAxisAngle(M,je).add(A),G.push(d.clone()),Oe&&(w(d,A),ue.push([He==0?Ye:d.clone(),y.clone()]))}Oe&&(w($e,A),ue.push([$e,y.clone()]))}Q.push(ue)}I.push(Q);let J=2*v,se=2;for(let ee=0;ee<h;ee++){let ue=J*ee,oe=J*((ee+1)%h),le=[G[ue]];for(let xe=1;xe<v;xe++){D=G[ue+xe],P=G[oe+xe],le.push(D);for(let _e=1,Se=xe-se+1;_e<=Se;_e++)d.lerpVectors(D,P,_e/(Se+1)),d.sub(A).setLength(X[ee]).add(A),le.push(d.clone());le.push(P)}for(let xe=0;xe<v;xe++)le.push(G[xe+v+ue]);le.push(G[oe+v]);let de=x.map(xe=>le[xe]);a.push(...de.map(xe=>[xe.x,xe.y,xe.z]).flat()),l.push(...de.map(xe=>(w(xe,A),[y.x,y.y,y.z])).flat())}}let V=[];for(let L=0;L<_.length;L++)for(let W=0;W<h;W++){let G=_[L][W];if(G<C){let X=_[G].findIndex(J=>J%C==L),Q=I[L][W],ie=I[G][X];for(let J=0;J<v;J++){let se=Q[J],ee=ie[v-J],ue=Q[J+1],oe=ie[v-(J+1)];[se,ee,ue,ue,ee,oe].forEach(le=>{a.push(le[0].x,le[0].y,le[0].z),l.push(le[1].x,le[1].y,le[1].z)})}V.push(Q[0][0],ie[v][0],Q[v][0],ie[0][0])}}for(;V.length;){let L,W,G,X;[L,W]=V.splice(0,2);let Q=[L];for(;L!=W;)Q.push(W),G=V.indexOf(W),X=G%2,W=V.splice(G-X,2)[1-X];y.subVectors(Q[0],Q[1]).cross(d.subVectors(Q[0],Q[2])).normalize();let ie=y.dot(Q[0])<0;ie&&y.negate();for(let J=1;J<=Q.length-2;J++)[Q[J+ +ie],Q[J+1-+ie],Q[0]].forEach(se=>{a.push(se.x,se.y,se.z),l.push(y.x,y.y,y.z)})}}function u(){let h=new R;for(let _=0;_<a.length;_+=3){h.x=a[_+0],h.y=a[_+1],h.z=a[_+2];let C=b(h)/2/Math.PI+.5,x=E(h)/Math.PI+.5;o.push(C,1-x)}let d=new R,p=new R,f=new R,m=new R,g=new re,v=new re,y=new re,w=(_,C,x,A)=>{A<0&&_.x===1&&(o[C]=_.x-1),x.x===0&&x.z===0&&(o[C]=A/2/Math.PI+.5)};for(let _=0,C=0;_<a.length;_+=9,C+=6){d.set(a[_+0],a[_+1],a[_+2]),p.set(a[_+3],a[_+4],a[_+5]),f.set(a[_+6],a[_+7],a[_+8]),g.set(o[C+0],o[C+1]),v.set(o[C+2],o[C+3]),y.set(o[C+4],o[C+5]),m.copy(d).add(p).add(f).divideScalar(3);let x=b(m);w(g,C+0,d,x),w(v,C+2,p,x),w(y,C+4,f,x)}for(let _=0;_<o.length;_+=6){let C=o[_+0],x=o[_+2],A=o[_+4],T=Math.max(C,x,A),M=Math.min(C,x,A);T>.9&&M<.1&&(C<.2&&(o[_+0]+=1),x<.2&&(o[_+2]+=1),A<.2&&(o[_+4]+=1))}function b(_){return Math.atan2(_.z,-_.x)}function E(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}}static fromJSON(e){return new ek(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},Jxe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new J7(t*.5,s,a):new o8(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},J7=class extends ek{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new J7(e.radius,e.corner,e.cornerSides)}},Jv=1e-12,tk=class{constructor(e){this.position=new re,this.startPosition=new re,this.uuid=rt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new tk(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},pI=class extends tk{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new pI(this.parent).copy(this)}},Lm=class extends tk{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new pI(this),new pI(this))}static create(e,t){let r=new Lm(e,new re(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new Lm(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new re,t=new re){let[r,i]=this.computeTangents();return r&&i&&(kU(r,e),kU(i,t)),[e,t]}computeTangent(e=new re){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new re){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function kU(e,t=new re){let r=e.length();return t.set(-e.y/r,e.x/r)}var rk=e=>e,nv=new re,PT=new re,e1e=new re,t1e=new re,r1e=new re,i1e=new re,eq=new R,tq=new R;function n1e(e){let t=new re;t.addVectors(e.v0,nv.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new re;return r.addVectors(e.v2,PT.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new Do(e.v0,t,r,e.v2)}function My(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function s1e(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function a1e(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function rq(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function o1e(e,t,r){return NU(e,t)&&NU(t,r)&&fI(e.position,t.position,r.position)}function fI(e,t,r){return nv.copy(t).sub(e).cross(PT.copy(r).sub(e))===0}function l1e(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),n.set(o-l,a-c),[i,n]}function c1e(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function u1e(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,c=r.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),h;return rq(t,e,r)>Math.PI&&(u*=-1),My(c,o)?h=(o+c)*(i/u-.5)*8/3/(a-l):h=(a+l)*(i/u-.5)*8/3/(c-o),n.set(t.x-h*o,t.y+h*a),s.set(r.x+h*c,r.y-h*l),[n,s]}function LU(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function NU(e,t){return fI(e.position,e.controls[1].position,t.position)&&fI(e.position,t.controls[0].position,t.position)}function h1e(e,t,r,i,n=.5){let s=nv.subVectors(t,e).multiplyScalar(n).add(e),a=PT.subVectors(r,t).multiplyScalar(n).add(t),o=e1e.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=t1e.subVectors(a,s).multiplyScalar(n).add(s),u=r1e.subVectors(o,a).multiplyScalar(n).add(a),h=o,d=i1e.subVectors(u,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,u.x,u.y,h.x,h.y,i.x,i.y]}function d1e(e,t,r=12,i=!0){let n=tq.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=rk(t[o]),c=nv,u=ep(l,r);for(let h=0;h<=u;h++)if(l instanceof Do||l instanceof jh||l instanceof No){if(l.getPoint(h/u,c),n.set(c.x,c.y,0),s!==void 0&&a1e(s,n))continue;s===void 0&&(s=eq),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function p1e(e,t,r,i=12,n=!0){let s=tq.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,u=rk(t[l]),h=nv,d=ep(u,i);o.push(d);for(let p=0;p<=d;p++)if(u instanceof Do||u instanceof jh||u instanceof No){if(u.getPoint(p/d,h),s.set(h.x,h.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=eq:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function zU(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=ep(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=ep(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=ep(e[0].roundedCurveCorner,t)*.5),i}function ep(e,t=12){return e&&e instanceof pT?t*2:e&&(e instanceof No||e instanceof n8)?1:e&&e instanceof g3?t*e.points.length:t}function f1e(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=rk(t[a]),l=ep(o,r),c=nv;for(let u=0;u<=l;u++)if(o instanceof Do||o instanceof jh||o instanceof No){if(o.getPoint(u/l,c),n!==void 0&&s1e(n,c,Jv))continue;n===void 0&&(n=PT),n.copy(c),e.push(c.x,c.y),s++}}return My(e[0],e[e.length-2],Jv)&&My(e[1],e[e.length-1],Jv)&&(e.pop(),e.pop()),i&&s>1&&!(My(e[s-1],e[1],Jv)&&My(e[s-2],e[0],Jv))&&(e.push(e[0],e[1]),s++),e}var dM=new re,m1e=new re,g1e=new re,v1e=new re,y1e=new re,w1e=new re,Si=class extends rS{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new ya(new R(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=rt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new Si;return i.isClosed=e.isClosed,i.points=e.points.map(n=>Lm.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>Si.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length,l=a.getPointIndexById(e);if(l<0)i+=o;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=e-t;if(s<=n.points.length-1)return n.points[s];t+=n.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=dM.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i];s.position.multiply(r),s.controls[0].position.multiply(r),s.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e,t=0,r=rt.generateUUID()){let i;e instanceof re?i=e:i=new re(e,t);let n=new Lm(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return d1e(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=zU(this.points,e,!1),this.roundedCurveDivisions=zU(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return p1e(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),f1e(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=ep(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=i.reduce((a,o)=>a+o,0));for(let a=0,o=i.length;a<o;a++){let l=i[a];if(s<r+l)return[a,(s-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(LU(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(dM.set(r.x,r.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){LU(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(t===0)this.moveTo(i.position.x,i.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(i,n)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],r=this.points[this.points.length-1];this._applyCurveForPoint(t,r)}if(this.points.length>2){let t=0;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r],s=this.points[r-1]??this.points[this.points.length-1],a=this.points[r+1]??this.points[0],o=n.roundness,l=s&&a&&o1e(s,n,a);if(!n.controlsMoved()&&o>0&&!l){let c=n.curveBefore,u=n.curveAfter;if(c===void 0||u===void 0)continue;let h=n.roundedCurveBefore,d=n.roundedCurveAfter,p=c.getLength(),f=u.getLength(),m=Math.min(o,p*.499),g=Math.min(o,f*.499),v=Math.min(m,g),y=1-v/p,w=v/f,b=c.getPointAt(y,dM),E=u.getPointAt(w,m1e);this._subSplitCurve(c,h,y,b,void 0),this._subSplitCurve(u,d,w,void 0,E);let _;if(this.useCubicForRoundedCorners){let C=rq(b,n.position,E)/2,x=Math.tan(C)*b.distanceTo(n.position),[A,T]=l1e(b,E,x,g1e,v1e),M=c1e(A,T,n.position),[D,P]=u1e(M,b,E,x,y1e,w1e);_=new Do(b.clone(),D.clone(),P.clone(),E.clone())}else _=new jh(b.clone(),n.position.clone(),E.clone());n.roundedCurveCorner=_,this.roundedCurves.splice(r+t,0,_),t++}}}}_subSplitCurve(e,t,r,i,n){if(e instanceof No)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(r,0),l=h1e(s.v0,s.v1,s.v2,s.v3,o);return i!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new Si(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],c=e.points[n+4],u=e.points[n+5],h=e.points[n+6],d=new Lm(rt.generateUUID(),new re(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(c,u),d.roundness=h,this.points.push(d)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new Si;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e,t=!1){this.isText=t;let r=(n,s)=>{s instanceof Do&&s.v3.equals(n.position)&&n.controls[0].position.copy(s.v2)},i=n=>{let s=[],a,o;for(a=0,o=n.length;a<o;a++)n[a]instanceof jh&&(n[a]=n1e(n[a]));for(a=0,o=n.length;a<o;a++){let u=n[a],h=a>0?n[a-1]:null,d;u instanceof Do?(d=this.createPoint(u.v0),d.controls[1].position.copy(u.v1)):u instanceof No&&(d=this.createPoint(u.v1)),d!==void 0&&(h!==null&&r(d,h),s.push(d))}let l=n[n.length-1],c=!1;return l instanceof Do?l.v3.equals(s[0].position)&&(s[0].controls[0].position.copy(l.v2),c=!0):l instanceof No&&l.v2.equals(s[0].position)&&(c=!0),this.isClosed=c,s};return this.points=i(e.curves),e instanceof rS&&(this.shapeHoles=e.holes.map(n=>{let s=new Si;return s.fromShape(n),s})),this.update(),this}updatePoint(e,t){let r=this.getPointByUuid(e);r&&(t.position!==void 0&&r.position.fromArray(t.position),t.roundness!==void 0&&(r.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[0];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var i;let r=(i=this.getPointByUuid(e))==null?void 0:i.controls[1];r&&(t.position&&r.position.fromArray(t.position),this.needsUpdate=!0)}},mI=Math.PI*2;function pM({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function x1e(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function BU(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function b1e(e,t,r,i,n,s,a,o,l,c){let u=Math.pow(n,2),h=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=u*h-u*p-h*d;f<0&&(f=0),f/=u*p+h*d,f=Math.sqrt(f)*(l===c?-1:1);let m=f*n/s*o,g=f*-s/n*a,v=m+(e+r)/2,y=g+(t+i)/2,w=(a-m)/n,b=(o-g)/s,E=(-a-m)/n,_=(-o-g)/s,C=BU(1,0,w,b),x=BU(w,b,E,_);return!c&&x>0&&(x-=mI),c&&x<0&&(x+=mI),{centerx:v,centery:y,ang1:C,ang2:x}}function _1e({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let c=(e-r)/2,u=(t-i)/2;if(c===0&&u===0)return[];n=Math.abs(n),s=Math.abs(s);let h=Math.pow(c,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(s,2);h>1&&(n*=Math.sqrt(h),s*=Math.sqrt(h));let d=b1e(e,t,r,i,n,s,c,u,a,o),{ang1:p,ang2:f}=d,{centerx:m,centery:g}=d,v=Math.abs(f)/(mI/4);Math.abs(1-v)<1e-7&&(v=1);let y=Math.max(Math.ceil(v),1);f/=y;for(let w=0;w<y;w++)l.push(x1e(p,f)),p+=f;return l.map(w=>{let{x:b,y:E}=pM(w[0],n,s,m,g),{x:_,y:C}=pM(w[1],n,s,m,g),{x,y:A}=pM(w[2],n,s,m,g);return{x1:b,y1:E,x2:_,y2:C,x,y:A}})}var Rr;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Rr||(Rr={}));var Gi;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Gi||(Gi={}));function Ct(e,t){if(!e)throw t||"Assertion Failed!"}var wt=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){Ct(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){Ct(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){Ct(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){Ct(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),ey=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),R1=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),Yf=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),FU=function(){function e(){var t=new Yf,r=new ey,i=new R1(0),n=new R1(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new R1(0),i=new R1(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;Ct(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;Ct(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new Yf,r=new Yf,i=new ey,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new Yf;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new ey;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new ey;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new Yf;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new ey;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&wt.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&wt.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,c;for(s=t,s=t;(n=s.next)!==t;s=n){Ct(n.prev===s),l=n.anEdge;do Ct(l.Sym!==l),Ct(l.Sym.Sym===l),Ct(l.Lnext.Onext.Sym===l),Ct(l.Onext.Sym.Lnext===l),Ct(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(Ct(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){Ct(a.prev===o),l=a.anEdge;do Ct(l.Sym!==l),Ct(l.Sym.Sym===l),Ct(l.Lnext.Onext.Sym===l),Ct(l.Onext.Sym.Lnext===l),Ct(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(Ct(a.prev===o&&a.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)Ct(l.Sym.next===c.Sym),Ct(l.Sym!==l),Ct(l.Sym.Sym===l),Ct(l.Org!==null),Ct(l.Dst!==null),Ct(l.Lnext.Onext.Sym===l),Ct(l.Onext.Sym.Lnext===l);Ct(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),UU=function(){function e(){this.handle=null}return e}(),jU=function(){function e(){this.key=null,this.node=0}return e}(),S1e=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new UU,this.handles[i]=new jU;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,Ct(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new UU;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new jU}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;Ct(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),fM=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),VU=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),E1e=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new VU,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new VU;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),T1e=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?wt.vertLeq(s.Org,a.Org)?wt.edgeSign(a.Dst,s.Org,a.Org)<=0:wt.edgeSign(s.Dst,a.Org,s.Org)>=0:wt.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return wt.edgeSign(s.Dst,n,s.Org)>=0;var o=wt.edgeEval(s.Dst,n,s.Org),l=wt.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&Ct(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){Ct(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new fM;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case Rr.ODD:return(r&1)!==0;case Rr.NONZERO:return r!==0;case Rr.POSITIVE:return r>0;case Rr.NEGATIVE:return r<0;case Rr.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,c,u,h=!0;c=i;do Ct(wt.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),h=!1,l=o,u=c;l.dirty=!0,Ct(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=wt.vertL1dist(r,t),s=wt.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(wt.vertLeq(n.Org,s.Org)){if(wt.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;wt.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(wt.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if(Ct(!wt.vertEq(n.Dst,s.Dst)),wt.vertLeq(n.Dst,s.Dst)){if(wt.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if(wt.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,c=s.Dst,u,h,d=new Yf,p,f;if(Ct(!wt.vertEq(c,l)),Ct(wt.edgeSign(l,t.event,a)<=0),Ct(wt.edgeSign(c,t.event,o)>=0),Ct(a!==t.event&&o!==t.event),Ct(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),h=Math.max(o.t,c.t),u>h))return!1;if(wt.vertLeq(a,o)){if(wt.edgeSign(c,a,o)>0)return!1}else if(wt.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),wt.intersect(l,a,c,o,d),Ct(Math.min(a.t,l.t)<=d.t),Ct(d.t<=Math.max(o.t,c.t)),Ct(Math.min(c.s,l.s)<=d.s),Ct(d.s<=Math.max(o.s,a.s)),wt.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),p=wt.vertLeq(a,o)?a:o,wt.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),wt.vertEq(d,a)||wt.vertEq(d,o)?(e.checkForRightSplice(t,r),!1):!wt.vertEq(l,t.event)&&wt.edgeSign(l,t.event,d)>=0||!wt.vertEq(c,t.event)&&wt.edgeSign(c,t.event,d)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),f=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,f,!0),!0):(wt.edgeSign(l,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),wt.edgeSign(c,t.event,d)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),wt.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),wt.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,r,i.Onext,s,s,!0);return}wt.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,wt.vertEq(n.Org,i)){Ct(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!wt.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}Ct(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(Ct(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),wt.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,c=new fM;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,wt.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=wt.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,r.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);Ct(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new fM,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new E1e(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(Ct(r.fixUpperEdge),Ct(++i===1)),Ct(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,wt.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new S1e(s,wt.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,Ct(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!wt.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),C1e=function(){function e(){this.mesh=new FU,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Rr.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],c=[0,0,0],u=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],f=[null,null,null],m=this.mesh.vHead;r=m.next;for(var g=0;g<3;++g)s=r.coords[g],c[g]=s,f[g]=r,l[g]=s,p[g]=r;for(r=m.next;r!==m;r=r.next)for(var v=0;v<3;++v)s=r.coords[v],s<c[v]&&(c[v]=s,f[v]=r),s>l[v]&&(l[v]=s,p[v]=r);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=f[y],n=p[y],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=m.next;r!==m;r=r.next)h[0]=r.coords[0]-n.coords[0],h[1]=r.coords[1]-n.coords[1],h[2]=r.coords[2]-n.coords[2],d[0]=u[1]*h[2]-u[2]*h[1],d[1]=u[2]*h[0]-u[0]*h[2],d[2]=u[0]*h[1]-u[1]*h[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;wt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;wt.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if(wt.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(wt.edgeGoesLeft(n.Lnext)||wt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(wt.edgeGoesRight(i.Lprev)||wt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,r===Gi.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var h=c.n*n;this.vertices[h+0]=c.coords[0],this.vertices[h+1]=c.coords[1],n>2&&(this.vertices[h+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1;if(r===Gi.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new FU),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=Rr.ODD),r===void 0&&(r=Gi.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),T1e.computeInterior(this,a);var o=this.mesh;return r===Gi.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===Gi.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function ph(e){var t=e.windingRule,r=t===void 0?Rr.ODD:t,i=e.elementType,n=i===void 0?Gi.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,u=c===void 0?[0,0,1]:c,h=e.contours,d=h===void 0?[]:h,p=e.strict,f=p===void 0?!0:p,m=e.debug,g=m===void 0?!1:m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var v=new C1e;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(r,n,a,l,u,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}Rr.ODD;Rr.NONZERO;Rr.POSITIVE;Rr.NEGATIVE;Rr.ABS_GEQ_TWO;Gi.POLYGONS;Gi.CONNECTED_POLYGONS;Gi.BOUNDARY_CONTOURS;var gI=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*gI.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*gI.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},iq=gI;iq.eSize=8*Float32Array.BYTES_PER_ELEMENT;var A1e=vu(zie()),ik={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},nq={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},sq={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},mM=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),nk=class extends pt{constructor(e,t,r=0,i=12,n=3,s=Rr.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(A=>{let T=A.extractShapePointsToFlatArray([],i),M=[];for(let D=T.length-1;D>=1;D-=2){let P=T[D-1],I=T[D-0];M.push(P,I)}return M}),c=[],u=[];for(let A=0;A<o.length;A+=2)u.push([o[A],o[A+1]]);c.push(u);for(let A=0;A<l.length;A++){let T=l[A],M=[];for(let D=0;D<T.length;D+=2)M.push([T[D],T[D+1]]);c.push(M)}let h;e.isText?h=new S8().setFromPoints(e.points.map(A=>A.position)).getSize(new re).length()*.1:c[0].length===0?h=r:h=(0,A1e.default)(c).distance,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,h,t/2),this._bevelSegments=Math.floor(n));let d;try{d=ph({windingRule:s,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{d=ik}let p;try{p=ph({windingRule:Rr.ODD,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=nq}if(!d)throw new Error("error generating geometry");let f=d.elementCount;if(p){d.elementCount+=p.elementCount;for(let A=0;A<p.elements.length;A++){let T=p.elements[A],M=A%2===0?d.vertexCount:0;d.elements.push(T+M)}for(let A=0;A<p.vertexIndices.length;A++){let T=p.vertexIndices[A],M=d.vertexCount;d.vertexIndices.push(T+M)}for(let A=0;A<p.vertices.length;A++){let T=p.vertices[A];d.vertices.push(T)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let A=0,T=d.vertexCount;A<T;A++){let M=A*2,D=d.vertices[M+0],P=d.vertices[M+1];D<m&&(m=D),D>g&&(g=D),P<v&&(v=P),P>y&&(y=P)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new iq(this._computeBufferEstimatedSize(d));let w=[],b=[];for(let A=d.elementCount-1;A>=0;A--){let T=A>=f,M=A*2,D=d.elements[M+0],P=d.elements[M+1],I=D+P,B={start:D,count:P,normals:[],continuous:[],concave:[]},V=D,N=I-1,L=D+1,W=this._shape.roundedCurves.length;do{let J=V-D,se=d.vertices[N*2+0],ee=d.vertices[N*2+1],ue=d.vertices[V*2+0],oe=d.vertices[V*2+1],le=d.vertices[L*2+0],de=d.vertices[L*2+1],xe=ue-se,_e=oe-ee,Se=Math.sqrt(xe*xe+_e*_e);xe/=Se,_e/=Se;let Le=ue-le,Oe=oe-de,Ye=Math.sqrt(Le*Le+Oe*Oe);Le/=Ye,Oe/=Ye,B.normals[J*2+0]=-Oe,B.normals[J*2+1]=Le,B.concave[J]=xe*Oe-_e*Le>0;let $e=d.vertexIndices[V];if(Array.isArray($e))B.continuous[J]=!1;else{let[He,je]=this._shape.getCurveIndexFromVertexId($e-1,!0);if(je>0&&je<1)B.continuous[J]=!0;else{let lt=je===1?He+1:He-1;lt=(lt+W)%W;let pe=je===1?0:1,q=this._shape.roundedCurves[He].getTangent(je),j=this._shape.roundedCurves[lt].getTangent(pe);B.continuous[J]=q.dot(j)>.95}}T&&(B.normals[J*2+0]*=-1,B.normals[J*2+1]*=-1),[N,V,L]=[V,L,L+1],L>=I&&(L-=P)}while(L!==D+1);let G=[];G.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(D*2,I*2),vertexCount:P,vertexIndices:new Array(P).fill(!0).map((J,se)=>[se,se]),elements:[0,P],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(D*2,I*2)});let X=0;for(let J=1;J<=this._bevelSegments;J++){let se=J/this._bevelSegments*Math.PI/2,ee=(1-Math.cos(se))*this._bevel,ue=[],oe=[],le=0;for(let xe=0;xe<P;xe++){let _e=xe*2,Se=(xe-1+P)%P*2,Le=d.vertices[B.start*2+_e+0],Oe=d.vertices[B.start*2+_e+1],Ye=-B.normals[Se+0]*ee,$e=-B.normals[Se+1]*ee,He=-B.normals[_e+0]*ee,je=-B.normals[_e+1]*ee;if(B.concave[xe]||!B.concave[xe]&&T){let lt=Math.atan2($e,Ye),pe=Math.atan2(je,He);pe>lt&&(pe-=Math.PI*2);let q=pe-lt;if(B.continuous[xe]||T){let j=lt+q/2,ve=Math.cos(j)*ee,ze=Math.sin(j)*ee;ue[2*le+0]=Le+ve*(T?-1:1),ue[2*le+1]=Oe+ze*(T?-1:1),oe[le]=xe,le++}else{let j=Math.max(1,Math.floor(i/4*Math.abs(q)/Math.PI));for(let ve=0;ve<=j;ve++){let ze=lt+q*(ve/j),U=Math.cos(ze)*ee,Fe=Math.sin(ze)*ee;ue[2*le+0]=Le+U,ue[2*le+1]=Oe+Fe,oe[le]=xe,le++}}}else ue[2*le+0]=Le+Ye,ue[2*le+1]=Oe+$e,oe[le]=xe,le++,ue[2*le+0]=Le,ue[2*le+1]=Oe,oe[le]=xe,le++,ue[2*le+0]=Le+He,ue[2*le+1]=Oe+je,oe[le]=xe,le++}let de=ph({windingRule:Rr.POSITIVE,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ue],edgeCreateCallback:xe=>{let _e=xe.Org.idx,Se=oe[_e],Le=oe[(_e+1)%oe.length];xe.idx=[Se,Le],xe.Sym.idx=[Le,Se]},vertexIdCallback:xe=>{let _e=xe.Lprev.idx;return[_e?_e[1]:0,xe.idx?xe.idx[0]:0]}});if(!de)throw console.log("Error"),new Error(`error generating bevel geometry for ${J}'th loop`);if(!de.vertexCount){let xe=(J-1)/this._bevelSegments*Math.PI/2;X=(1-Math.sin(xe))*this._bevel;break}for(let xe=0;xe<de.vertexIndices.length;xe++){let[_e,Se]=de.vertexIndices[xe];if(_e===Se)continue;let Le=Se;Se<_e&&(Le+=P);for(let Oe=_e;Oe<Le;Oe++){let Ye=Oe%P,$e=(Oe+1)%P;if(!B.continuous[Ye]||!B.continuous[$e]){de.vertexIndices[xe]=[_e,Ye],de.vertexIndices.splice(xe+1,0,[$e,Se]),de.vertices.splice((xe+1)*2,0,de.vertices[xe*2],de.vertices[xe*2+1]);break}}}G.push({bevelI:J,angle:se,size:ee,boundary:de,reverseMap:oe,insetPoints:ue})}let Q=(J,se,ee)=>{let ue=0,oe=J.boundary.vertexIndices.length;for(;ue<oe&&ee(J.boundary.vertexIndices[se]);)se=(se+1)%oe,ue++;return ue},ie=w.length;for(let J=1;J<G.length;J++){let se=G[J-1],ee=G[J],ue=se.boundary.vertexIndices.length,oe=ee.boundary.vertexIndices.length;if(!ue||!oe)break;let le=B.concave.length,de=0,xe=mM(de,P);for(;!se.boundary.vertexIndices.filter(xe).length||!ee.boundary.vertexIndices.filter(xe).length;)de++,xe=mM(de,P);let _e=se.boundary.vertexIndices.findIndex(xe),Se=ee.boundary.vertexIndices.findIndex(xe);do _e=(_e+1)%ue;while(xe(se.boundary.vertexIndices[_e]));do Se=(Se+1)%oe;while(xe(ee.boundary.vertexIndices[Se]));de=(de+1)%P;let Le=de,Oe=0,Ye=this._buildBevelVert(B,se,(_e-1+ue)%ue,void 0,Oe),$e=this._buildBevelVert(B,ee,(Se-1+oe)%oe,void 0,Oe),He=Ye,je=$e,lt,pe,q=!1;do{Oe=(de||le)/le,xe=mM(de,P);let j=Q(se,_e,xe),ve=Q(ee,Se,xe),ze=q;if(q=!1,j&&!ve){for(let U=0;U<j;U++)lt=this._buildBevelVert(B,se,(_e+U)%ue,U/(j-1),Oe),w.push(He.topN,lt.topP,je.topN),a===!1&&w.push(lt.bottomP,He.bottomN,je.bottomN),He=lt;q=!0}else if(!j&&ve)for(let U=0;U<ve;U++)pe=this._buildBevelVert(B,ee,(Se+U)%oe,U/(ve-1),Oe),w.push(je.topN,He.topP,pe.topP),a===!1&&w.push(He.bottomP,je.bottomN,pe.bottomP),je=pe;else if(j&&ve)if(lt=this._buildBevelVert(B,se,_e,0,Oe),pe=this._buildBevelVert(B,ee,Se,0,Oe),ze?(w.push(He.topN,pe.topP,je.topN),w.push(He.topN,lt.topP,pe.topP),a===!1&&(w.push(pe.bottomP,He.bottomN,je.bottomN),w.push(pe.bottomP,lt.bottomP,He.bottomN))):(w.push(je.topN,He.topN,lt.topP),w.push(je.topN,lt.topP,pe.topP),a===!1&&(w.push(lt.bottomP,He.bottomN,je.bottomN),w.push(lt.bottomP,je.bottomN,pe.bottomP))),He=lt,je=pe,j===ve)for(let U=1;U<j;U++)lt=this._buildBevelVert(B,se,(_e+U)%ue,U/(j-1),Oe),pe=this._buildBevelVert(B,ee,(Se+U)%oe,U/(ve-1),Oe),w.push(He.topN,lt.topP,je.topN),w.push(je.topN,lt.topP,pe.topP),a===!1&&(w.push(lt.bottomP,He.bottomN,je.bottomN),w.push(lt.bottomP,je.bottomN,pe.bottomP)),He=lt,je=pe;else if(j>ve){let U=j/ve,Fe=0;for(let he=1;he<j;he++)lt=this._buildBevelVert(B,se,(_e+he)%ue,he/(j-1),Oe),w.push(He.topN,lt.topP,je.topN),a===!1&&w.push(lt.bottomP,He.bottomN,je.bottomN),He=lt,he>(Fe+1)*U&&(Fe++,pe=this._buildBevelVert(B,ee,(Se+Fe)%oe,Fe/(ve-1),Oe),w.push(je.topN,lt.topP,pe.topP),a===!1&&w.push(lt.bottomP,je.bottomN,pe.bottomP),je=pe)}else{let U=ve/j,Fe=0;for(let he=1;he<ve;he++)pe=this._buildBevelVert(B,ee,(Se+he)%oe,he/(ve-1),Oe),w.push(je.topN,lt.topP,pe.topP),a===!1&&w.push(lt.bottomP,je.bottomN,pe.bottomP),je=pe,he>(Fe+1)*U&&(Fe++,lt=this._buildBevelVert(B,se,(_e+Fe)%ue,Fe/(j-1),Oe),w.push(He.topN,lt.topP,je.topN),a===!1&&w.push(lt.bottomP,He.bottomN,je.bottomN),He=lt)}_e=(_e+j)%ue,Se=(Se+ve)%oe,de=(de+1)%le}while(de!==Le)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(G,B,w),T){let J=[];for(let se=w.length-1;se>=ie+2;se-=3){let ee=w[se-2],ue=w[se-1],oe=w[se-0];J.push(oe,ue,ee)}w.splice(ie,w.length-ie,...J)}if(T){let J=[];for(let se=G[G.length-1].boundary.vertices.length-1;se>=1;se-=2){let ee=G[G.length-1].boundary.vertices[se-1],ue=G[G.length-1].boundary.vertices[se-0];J.push(ee,ue)}b.push(J)}if(!T){let J=G[G.length-1],se;try{se=ph({windingRule:G.length>1?Rr.POSITIVE:Rr.ODD,elementType:Gi.POLYGONS,vertexSize:2,strict:!0,contours:[J.insetPoints,...b]})}catch{se=sq}if(!se)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ee=0;ee<se.elementCount*3;ee+=3){let ue=this._buildSurfaceVert(se,se.elements[ee+0],X),oe=this._buildSurfaceVert(se,se.elements[ee+1],X),le=this._buildSurfaceVert(se,se.elements[ee+2],X);w.push(ue.top,oe.top,le.top),a===!1&&w.push(le.bottom,oe.bottom,ue.bottom)}}this.vertexCache={}}this._buffer.shrink();let E=new Mt(Uint32Array.from(w),1),_=new Mt(this._buffer.positions,3),C=new Mt(this._buffer.normals,3),x=new Mt(this._buffer.uvs,2);_.needsUpdate=!0,C.needsUpdate=!0,x.needsUpdate=!0,E.needsUpdate=!0,this.setAttribute("position",_),this.setAttribute("normal",C),this.setAttribute("uv",x),this.setIndex(E)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[i]=h,h}_buildBevelVert(e,t,r,i=1,n){let s=`${t.bevelI}:${r}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[r],l,c,u,h;a!==o?(c=a,l=o,h=!1,u=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,h=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||h);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=r*2,m=l*2,g=c*2,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],w=(1-p)*this._bevel,b=(v-this._minX)/this._width,E=(y-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(b=n),E=1);let _=e.normals[m+0],C=e.normals[m+1],x=e.normals[g+0],A=e.normals[g+1];if(h){let I=x-_,B=A-C;_=_+I*(1-i),C=C+B*(1-i);let V=Math.sqrt(_*_+C*C);_/=V,C/=V}let T=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),M=T*3,D=T*2,P={i:r,fi:l,topP:T+0,topN:T+0,bottomP:T+1,bottomN:T+1,pathBevelUCoord:n};return this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-w,this._buffer.normals[M+0]=_*d,this._buffer.normals[M+1]=C*d,this._buffer.normals[M+2]=p,this._buffer.uvs[D+0]=b,this._buffer.uvs[D+1]=E,this.forPathBevel===!1&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=w,this._buffer.normals[M+3]=_*d,this._buffer.normals[M+4]=C*d,this._buffer.normals[M+5]=-p,this._buffer.uvs[D+2]=E,this._buffer.uvs[D+3]=b),u||(this.forPathBevel?(T+=1,M+=3,D+=2):(T+=2,M+=6,D+=4),P.topP=T+0,P.bottomP=T+1,this._buffer.positions[M+0]=v,this._buffer.positions[M+1]=y,this._buffer.positions[M+2]=(this.forPathBevel?this._bevel:this._depth)-w,this._buffer.normals[M+0]=x*d,this._buffer.normals[M+1]=A*d,this._buffer.normals[M+2]=p,this._buffer.uvs[D+0]=b,this._buffer.uvs[D+1]=E,this.forPathBevel===!1&&(this._buffer.positions[M+3]=v,this._buffer.positions[M+4]=y,this._buffer.positions[M+5]=w,this._buffer.normals[M+3]=x*d,this._buffer.normals[M+4]=A*d,this._buffer.normals[M+5]=-p,this._buffer.uvs[D+2]=E,this._buffer.uvs[D+3]=b)),this.vertexCache[s]=P,P}clone(){let e=new nk(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=_T(this.userData),e}},aq=class extends pt{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=Rr.ODD,this.elementType=Gi.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Rr.ODD,elementType:Gi.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let d=0,p=i.length/2;d<p;d++){let f=d*2,m=i[f+0],g=i[f+1];if(l!==void 0&&m!==l&&(a=!1),c!==void 0&&g!==c&&(o=!1),l=m,c=g,!a&&!o)break}if(!a&&!o)try{s=ph({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=ik}let u=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Mt(new Float32Array(u*3),3),this._normalAttribute=new Mt(new Float32Array(u*3),3),this._uvAttribute=new Mt(new Float32Array(u*2),2),this._indexAttribute=new Mt(new Uint32Array(h*3),1),s){let d=1/0,p=-1/0,f=1/0,m=-1/0;for(let y=0,w=u;y<w;y++){let b=y*2,E=s.vertices[b+0],_=s.vertices[b+1];E<d&&(d=E),E>p&&(p=E),_<f&&(f=_),_>m&&(m=_)}let g=p-d,v=m-f;for(let y=0,w=u;y<w;y++){let b=y*2,E=s.vertices[b+0],_=s.vertices[b+1],C=(E-d)/g,x=(_-f)/v;this._positionAttribute.setXYZ(y,E,_,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,C,x)}for(let y=0,w=h;y<w;y++){let b=y*3,E=s.elements[b+0],_=s.elements[b+1],C=s.elements[b+2];this._indexAttribute.setX(b+0,E),this._indexAttribute.setX(b+1,_),this._indexAttribute.setX(b+2,C)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new aq(this._shape,this._curveSegments);return e.userData=_T(this.userData),e}},oq=class extends nk{constructor(e,t,r=0,i=12,n=3,s=Rr.ODD){super(e,t,r,i,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new oq(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=_T(this.userData),e}},Xp=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,u;let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Rr.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??r.roundness;a!==void 0&&(a instanceof Si?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new Si(i,n).fromJSON(a),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((u=e.parameters)==null?void 0:u.roundness)>0&&a.update());let l=a??new Si(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new aq(e.shape,n,{windingRule:a}):o=new oq(e.shape,t,r,n,i,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},lq=Math.PI*2,sk=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return r.angle=rt.clamp(r.angle,0,360),{shape:e.shape&&e.shape instanceof Si?e.shape:new Si,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,h=r*.5,d=M1e(c,u,h,n*Math.PI/180,i,s);c.isClosed=!0,c.update();let p;return n===0?(p=new pt,p.setAttribute("position",new Ze([],3))):p=Xp.create({shape:c,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}}),Object.assign(p,{userData:{...e,type:"EllipseGeometry"}})}};function M1e(e,t,r,i,n,s){if(i>=lq)return n>30||n%4===0?(D1e(e,t,r,s),Math.round(n/4)):HU(e,i,n,t,r,s);i=Math.max(i,.001);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=_1e({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?P1e(e,a.x,a.y,c,n,t,r,s):HU(e,i,n,t,r,s)}function P1e(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(Nm(t,r));for(let c=0,u=i.length;c<u;c++){let h=i[c],d=e.points[c],p=Nm(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),p.controls[0].position.set(h.x2,h.y2),e.addPoint(p)}return o>0?cq(e,s,a,o):e.addPoint(Nm(0,0)),l}function HU(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,c=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(Nm(c,u))}return t<lq?s>0?cq(e,i,n,s):e.addPoint(Nm(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&uq(e,i,n,s)),1}function D1e(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(k1(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(k1(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(k1(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(k1(n,s-r,n+o,s-r,n-o,s-r)),i>0&&uq(e,t,r,i)}function Nm(e,t){return new Lm(rt.generateUUID(),new re(e,t))}function k1(e,t,r,i,n,s){let a=Nm(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function cq(e,t,r,i){hq(e,t,r,i).forEach(n=>e.addPoint(n))}function uq(e,t,r,i){let n=hq(e,t,r,i),s=new Si;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function hq(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new re(n/t,s/r),o=e.points.map(l=>{let c=l.clone();return c.uuid=rt.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),o}var I1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),s=Math.abs(r.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:h}=e.parameters,d=new dq(!1,t,r,i,n,s,a,o,l,c,u,h);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},gM=new Mm([0,0,0],1),dq=class extends pt{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,c=1,u=1,h=1){if(super(),s===0)return;let d=e&&s===1;d&&(h=0),u>100&&(u=100),u===0&&(h=0);let p=()=>new R,f=new R,m=p(),g=p(),v=p(),y,w,b,E,_,C,x,A,T=p(),M=p(),D=p(),P=p(),I=p(),B=p(),V=p(),N=p(),L=r-2*o+.001,W=L/s,G=Math.ceil(a*s),X=G+1,Q=L/G,ie=-L/2,J=c+1,se=2*Math.PI/c,ee=Math.PI/2/h,ue=.01,oe=Math.min((1-u/100)*o,o-ue),le=o-oe,de=0,xe=2,_e=h*xe+xe,Se=J*_e/xe,Le=Se+J*X,Oe=Math.max(0,J*(X+_e)),[Ye,$e,He]=[3,3,2].map(me=>Array(Oe*me).fill(0)),je=[],lt=n-o;function pe(me,Je){let et=Math.PI/2;C=Je*Q,A=2*Math.PI*(C%W)/W+et,C+=ie,x=Math.sin(A)*lt,_=Math.cos(A)*lt,e?me.set(_,x,C):me.set(_,C,x)}pe(f,-1e-10),pe(m,0),T.copy(f),pe(f,1);let q=f.distanceTo(m),j=d?0:le+oe,ve=q*G+2*j,ze=oe,U=ve-j;for(let me=0;me<=G;me++){pe(g,me),N.subVectors(g,T).normalize(),T.copy(g),B.copy(g).setComponent(+e+1,0).normalize(),V.crossVectors(N,B).normalize();let Je=me===0,et=me===G,at=Je?3*Math.PI/2:ee,gt=Je?ze:U,ft=Je?J:Le,mt=Je?0:Oe-J,Er=N.clone().multiplyScalar(Je?-le:le).add(g),Xr=N.clone().multiplyScalar(Je?-1:1).normalize();for(let ae=0;ae<J;ae++){let Pe=ae*se;if(M.addVectors(f.copy(B).multiplyScalar(o*Math.cos(Pe)),m.copy(V).multiplyScalar(o*Math.sin(Pe))),D.copy(M).normalize(),Je||et){d||(de=mt+ae,[0,1,2].forEach(Ne=>{Ye[de*3+Ne]=Er.getComponent(Ne),$e[de*3+Ne]=Xr.getComponent(Ne)}),He[de*2]=+et,He[de*2+1]=ae/c),m.copy(D).multiplyScalar(oe),v.addVectors(g,m);for(let Ne=0;Ne<h;Ne++){let Ke=Ne*ee+at;P.addVectors(f.copy(N).multiplyScalar(le*Math.sin(Ke)),m.copy(D).multiplyScalar(le*Math.cos(Ke))),I.copy(P).normalize(),m.addVectors(v,P),P.normalize(),de=ft+Ne*J+ae,[0,1,2].forEach(Kt=>{Ye[de*3+Kt]=m.getComponent(Kt),$e[de*3+Kt]=I.getComponent(Kt)});let yt=+Je+Math.sin(Ke);He[de*2]=(gt+le*yt)/ve,He[de*2+1]=ae/c}}m.addVectors(g,M),de=Se+me*J+ae,[0,1,2].forEach(Ne=>{Ye[de*3+Ne]=m.getComponent(Ne),$e[de*3+Ne]=D.getComponent(Ne)}),He[de*2]=(j+me*q)/ve,He[de*2+1]=ae/c}}let Fe=X+2*h+xe,[he,Ee]=[+d,Fe-1];for(let me=he;me<=Ee-1;me++){let Je=d&&me===Ee-1;for(let et=0;et<J-1;et++)y=me*J+et,w=y+1,b=(Je?et:y)+J,E=(Je?et+1:w)+J,me===0?je.push(w,E,b):me===Fe-2?je.push(y,w,b):je.push(y,w,b,w,E,b)}this.setIndex(je),this.setAttribute("position",new Ze(Ye,3)),this.setAttribute("normal",new Ze($e,3)),this.setAttribute("uv",new Ze(He,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let h=0;h<e.radialSegments;h++)n=c*r+h,s=n+1,a=(u?h:n)+r,o=(u?h+1:s)+r,i[l++]=n,i[l++]=s,i[l++]=a,i[l++]=s,i[l++]=o,i[l++]=a;return i.length=l,gM.array=i,gM.count=i.length,gM}},O1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new pq(t*.5,s,a):new d8(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},pq=class extends ek{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new pq(e.radius,e.corner,e.cornerSides)}},R1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i;(((i=e.parameters)==null?void 0:i.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new rS;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new a8(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},al=new Be,vM=new Cr,L1=new R,FS=class extends Kn{constructor(){super(),this.uuid=rt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new ln().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return al.makeRotationX(e),this.applyMatrix4(al),this}rotateY(e){return al.makeRotationY(e),this.applyMatrix4(al),this}rotateZ(e){return al.makeRotationZ(e),this.applyMatrix4(al),this}translate(e,t,r){return al.makeTranslation(e,t,r),this.applyMatrix4(al),this}scale(e,t,r){return al.makeScale(e,t,r),this.applyMatrix4(al),this}lookAt(e){return vM.lookAt(e),vM.updateMatrix(),this.applyMatrix4(vM.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<n.count;h++)t.vertices.push(new R().fromBufferAttribute(n,h)),a!==void 0&&t.colors.push(new bt().fromBufferAttribute(a,h));function c(h,d,p,f){let m=a===void 0?[]:[t.colors[h].clone(),t.colors[d].clone(),t.colors[p].clone()],g=s===void 0?[]:[new R().fromBufferAttribute(s,h),new R().fromBufferAttribute(s,d),new R().fromBufferAttribute(s,p)],v=new vI(h,d,p,g,m,f);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new re().fromBufferAttribute(o,h),new re().fromBufferAttribute(o,d),new re().fromBufferAttribute(o,p)]),l!==void 0&&t.faceVertexUvs[1].push([new re().fromBufferAttribute(l,h),new re().fromBufferAttribute(l,d),new re().fromBufferAttribute(l,p)])}let u=e.groups;if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h],p=d.start,f=d.count;for(let m=p,g=p+f;m<g;m+=3)r!==void 0?c(r.getX(m),r.getX(m+1),r.getX(m+2),d.materialIndex):c(m,m+1,m+2,d.materialIndex)}else if(r!==void 0)for(let h=0;h<r.count;h+=3)c(r.getX(h),r.getX(h+1),r.getX(h+2));else for(let h=0;h<n.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(L1).negate(),this.translate(L1.x,L1.y,L1.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new Be;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new R,t=new R;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new R;if(e){let r=new R,i=new R;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];r.subVectors(c,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new FS;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new R,c={a:new R,b:new R,c:new R};n.push(l),s.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ni),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ca),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(i=new ln().getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let p=a[h].clone();t!==void 0&&p.applyMatrix4(t),s.push(p)}for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone());for(let h=0,d=l.length;h<d;h++){let p=l[h],f,m,g=p.vertexNormals,v=p.vertexColors,y=new vI(p.a+n,p.b+n,p.c+n);y.normal.copy(p.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let w=0,b=g.length;w<b;w++)f=g[w].clone(),i!==void 0&&f.applyMatrix3(i).normalize(),y.vertexNormals.push(f);y.color.copy(p.color);for(let w=0,b=v.length;w<b;w++)m=v[w],y.vertexColors.push(m.clone());y.materialIndex=p.materialIndex+r,o.push(y)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,w=g.length;y<w;y++)v.push(g[y].clone());this.faceVertexUvs[h].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],u=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[u]===void 0?(t[u]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let u=[c.a,c.b,c.c];for(let h=0;h<3;h++)if(u[h]===u[(h+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new R(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(e[f]=p[f]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];t.push(f.x,f.y,f.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],m=!0,g=!1,v=this.faceVertexUvs[0][p]!==void 0,y=f.normal.length()>0,w=f.vertexNormals.length>0,b=f.color.r!==1||f.color.g!==1||f.color.b!==1,E=f.vertexColors.length>0,_=0;if(_=c(_,0,0),_=c(_,1,m),_=c(_,2,g),_=c(_,3,v),_=c(_,4,y),_=c(_,5,w),_=c(_,6,b),_=c(_,7,E),r.push(_),r.push(f.a,f.b,f.c),r.push(f.materialIndex),v){let C=this.faceVertexUvs[0][p];r.push(d(C[0]),d(C[1]),d(C[2]))}if(y&&r.push(u(f.normal)),w){let C=f.vertexNormals;r.push(u(C[0]),u(C[1]),u(C[2]))}if(b&&r.push(h(f.color)),E){let C=f.vertexColors;r.push(h(C[0]),h(C[1]),h(C[2]))}}function c(p,f,m){return m?p|1<<f:p&~(1<<f)}function u(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return n[f]!==void 0||(n[f]=i.length/3,i.push(p.x,p.y,p.z)),n[f]}function h(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return a[f]!==void 0||(a[f]=s.length,s.push(p.getHex())),a[f]}function d(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=o.length/2,o.push(p.x,p.y)),l[f]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new FS().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let r=e.colors;for(let h=0,d=r.length;h<d;h++)this.colors.push(r[h].clone());let i=e.faces;for(let h=0,d=i.length;h<d;h++)this.faces.push(i[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],v=[];for(let y=0,w=g.length;y<w;y++){let b=g[y];v.push(b.clone())}this.faceVertexUvs[h].push(v)}}let n=e.morphTargets;for(let h=0,d=n.length;h<d;h++){let p={};if(p.name=n[h].name,n[h].vertices!==void 0){p.vertices=[];for(let f=0,m=n[h].vertices.length;f<m;f++)p.vertices.push(n[h].vertices[f].clone())}if(n[h].normals!==void 0){p.normals=[];for(let f=0,m=n[h].normals.length;f<m;f++)p.normals.push(n[h].normals[f].clone())}this.morphTargets.push(p)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let p={};if(s[h].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,m=s[h].vertexNormals.length;f<m;f++){let g=s[h].vertexNormals[f],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),p.vertexNormals.push(v)}}if(s[h].faceNormals!==void 0){p.faceNormals=[];for(let f=0,m=s[h].faceNormals.length;f<m;f++)p.faceNormals.push(s[h].faceNormals[f].clone())}this.morphNormals.push(p)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new k1e().fromGeometry(this),t=new pt,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",N1.call(new Mt(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",N1.call(new Mt(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",WU.call(new Mt(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",GU.call(new Mt(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",GU.call(new Mt(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new Ze(l.data.length*3,3);c.name=l.name,n.push(N1.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new Ze(e.skinIndices.length*4,4);t.setAttribute("skinIndex",qU.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new Ze(e.skinWeights.length*4,4);t.setAttribute("skinWeight",qU.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new pt,r=e.geometry;if(e.isPoints||e.isLine){let i=new Ze(r.vertices.length*3,3),n=new Ze(r.colors.length*3,3);if(t.setAttribute("position",N1.call(i,r.vertices)),t.setAttribute("color",WU.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new Ze(r.lineDistances.length,1);t.setAttribute("lineDistance",L1e.call(s,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};FS.prototype.isGeometry=!0;var k1e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let g=0;g<o;g++)l[g]={name:a[g].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,h;if(u>0){h=[];for(let g=0;g<u;g++)h[g]={name:c[g].name,data:[]};this.morphTargets.normal=h}let d=e.skinIndices,p=e.skinWeights,f=d.length===r.length,m=p.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<t.length;g++){let v=t[g];this.vertices.push(r[v.a],r[v.b],r[v.c]);let y=v.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let b=v.normal;this.normals.push(b,b,b)}let w=v.vertexColors;if(w.length===3)this.colors.push(w[0],w[1],w[2]);else{let b=v.color;this.colors.push(b,b,b)}if(n===!0){let b=i[0][g];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new re,new re,new re))}if(s===!0){let b=i[1][g];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new re,new re,new re))}for(let b=0;b<o;b++){let E=a[b].vertices;l[b].data.push(E[v.a],E[v.b],E[v.c])}for(let b=0;b<u;b++){let E=c[b].vertexNormals[g];h[b].data.push(E.a,E.b,E.c)}f&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},vI=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new R,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new bt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function L1e(e){return this.array.set(e),this}function WU(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new bt),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}function GU(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new re),t[r++]=s.x,t[r++]=s.y}return this}function N1(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new R),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}function qU(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new It),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}var N1e=["a","b","c"];function z1e(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function yM(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function wM(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(i.has(l))c=i.get(l);else{let u=r[a],h=r[o];c={a:u,b:h,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),s[e].edges.push(c),s[t].edges.push(c)}function B1e(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],wM(a.a,a.b,e,i,a,r),wM(a.b,a.c,e,i,a,r),wM(a.c,a.a,e,i,a,r)}function z1(e,t,r,i,n){e.push(new vI(t,r,i,void 0,void 0,n))}function Pf(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function B1(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var F1e=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof pt?e=new FS().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new R,r,i,n,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,h=[],d=new Map;B1e(o,l,h,d);let p=[],f,m,g,v,y,w,b;for(let ue of Array.from(d.keys())){for(m=d.get(ue),g=new R,y=3/8,w=1/8,b=m.faces.length,b!=2&&(y=.5,w=0,b!=1),g.addVectors(m.a,m.b).multiplyScalar(y),t.set(0,0,0),s=0;s<b;s++){for(v=m.faces[s],a=0;a<3&&(f=o[z1e(v,N1e[a])],!(f!==m.a&&f!==m.b));a++);f&&t.add(f)}t.multiplyScalar(w),g.add(t),m.newEdge=p.length,p.push(g)}let E,_,C,x,A,T,M,D=[];for(i=0,n=o.length;i<n;i++){for(T=o[i],A=h[i].edges,r=A.length,r==3?E=3/16:r>3&&(E=3/(8*r)),_=1-r*Number(E),C=E,r<=2&&(r==2?(_=3/4,C=1/8):r==1||r==0),M=T.clone().multiplyScalar(_),t.set(0,0,0),s=0;s<r;s++)x=A[s],f=x.a!==T?x.a:x.b,t.add(f);t.multiplyScalar(Number(C)),M.add(t),D.push(M)}let P=D.concat(p),I=D.length,B,V,N,L=[],W=[],G,X,Q,ie,J=new re,se=new re,ee=new re;for(i=0,n=l.length;i<n;i++)v=l[i],B=Number(yM(v.a,v.b,d).newEdge)+I,V=Number(yM(v.b,v.c,d).newEdge)+I,N=Number(yM(v.c,v.a,d).newEdge)+I,z1(L,B,V,N,v.materialIndex),z1(L,v.a,B,N,v.materialIndex),z1(L,v.b,V,B,v.materialIndex),z1(L,v.c,N,V,v.materialIndex),u&&(G=c[i],X=G[0],Q=G[1],ie=G[2],J.set(Pf(X.x,Q.x),Pf(X.y,Q.y)),se.set(Pf(Q.x,ie.x),Pf(Q.y,ie.y)),ee.set(Pf(X.x,ie.x),Pf(X.y,ie.y)),B1(W,J,se,ee),B1(W,X,J,ee),B1(W,Q,se,J),B1(W,ie,ee,se));e.vertices=P,e.faces=L,u&&(e.faceVertexUvs[0]=W)}},en=new R,U1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??(t==null?void 0:t.geometry)??new pt().copy(new Wo(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(en),i={width:en.x,height:en.y,depth:en.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=e.geometry??new pt().copy(new Wo(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(en)):en.set(a.width,a.height,a.depth),(t!==en.x||r!==en.y||i!==en.z)&&s.scale(en.x===0?1:t/en.x,en.y===0?1:r/en.y,en.z===0?1:i/en.z);let o=s.originalGeometry;try{n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new F1e(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new b8(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(en);let s=100/en.x;Object.assign(n.parameters,{width:100,height:en.y*s,depth:en.z*s}),t(this.build(n))})}},fq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Si?e.shape:new Si,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5,h=0,d=0,p=2*Math.PI/i;for(let m=0;m<i;m++){let g=p*m,v=h+Math.sin(g)*c,y=d+Math.cos(g)*u;l.addPoint(l.createPoint(v,y))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let f=Xp.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(f,{userData:{...e,type:"PolygonGeometry"}})}},j1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new H1e(t*.5,r,n,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function ty(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function xM(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(c)),s.addScaledVector(o,i/Math.sin(c))}}function V1e(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var H1e=class extends pt{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],c=[],u=[],h=0,d=t/2,p=Math.PI/r,f=e*Math.cos(Math.PI/r),m=2*Math.PI/r,g=(r-2)*Math.PI/r,v=Math.PI-g,y=new R(0,-d,0),w=new R(0,d,0),b=new re(e,-d),E=new re(f,-d),_=new re(0,w.y).sub(E),C=new re(0,w.y).sub(b),x=new re(_.y,-_.x).normalize(),A=new re(C.y,-C.x).normalize(),T=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-_.angle())/2)-1e-8;s=Math.min(s,T);let M;{let N=new R(x.x,x.y,0),L=new R(Math.cos(m)*N.x,N.y,Math.sin(m)*N.x);M=N.angleTo(L)}let D=s/Math.tan((Math.PI-_.angle())/2),P=s/Math.tan((Math.PI-M)/2),I=new R;if(!n){l.push(y.x,y.y,y.z),c.push(0,-1,0),u.push(0,0);let N=h++,L=[],W=b.clone(),G=D/Math.cos(Math.PI/r);W.x-=G;for(let X=0;X<r;X++){let Q=X/r*Math.PI*2+p,ie=new re(Math.sin(Q),Math.cos(Q));ty(W,ie,I),l.push(I.x,I.y,I.z),c.push(0,-1,0),u.push(0,0),L.push(h++)}for(let X=0;X<L.length;X++)o.push(L[X],N,L[(X+1)%L.length])}{let N=new R,L=new R,W=new R,G=new R,X=new R,Q=new R;for(let ie=0;ie<r;ie++){let J=ie/r*Math.PI*2+p,se=(ie+.5)/r*Math.PI*2+p,ee=(ie+1)/r*Math.PI*2+p,ue=new re(Math.sin(J),Math.cos(J)),oe=new re(Math.sin(se),Math.cos(se)),le=new re(Math.sin(ee),Math.cos(ee));ty(b,ue,L),ty(b,le,W),ty(x,oe,N),xM(w,L,W,P,P,G),l.push(G.x,G.y,G.z),xM(L,w,W,P,D,X),l.push(X.x,X.y,X.z),xM(W,L,w,D,P,Q),l.push(Q.x,Q.y,Q.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),c.push(N.x,N.y,N.z),u.push(0,0),u.push(0,0),u.push(0,0);let de=h++,xe=h++,_e=h++;if(o.push(de,xe,_e),s>0){{let Oe=L.clone().add(W).multiplyScalar(.5),Ye=w.clone().sub(Oe).normalize(),$e=y.clone().sub(Oe).normalize().add(Ye).normalize().multiplyScalar(-1),He=Q.clone().sub(X);B(Oe,He,$e,_.angle())}let Se,Le;{let Oe=new R;ty(A,le,Oe);let Ye=Q.clone().add(G).multiplyScalar(.5);Ye=V1e(Ye,W,w);let $e=Q.clone().sub(G);[Se,Le]=B(Ye,$e,Oe,M,G.y)}{let Oe=Se,Ye=Oe.clone().setY(0).normalize(),$e=new R(0,-1,0),He=Ye.clone().cross($e);V(Oe,Ye,$e,He)}{let Oe=_.angle(),Ye=Math.PI-Oe,$e=w.clone();$e.y-=s/Math.sin(Oe-Math.PI/2);let He=new R,je=[];for(let pe=0;pe<a;pe++){let q=[],j=Math.PI/2-Ye*pe/a,ve=Math.cos(j),ze=Math.sin(j),U=se;for(let Fe=0;Fe<=pe;Fe++){let he=Math.cos(U),Ee=Math.sin(U);N.x=ve*Ee,N.y=ze,N.z=ve*he,He.copy($e).addScaledVector(N,s),l.push(He.x,He.y,He.z),c.push(N.x,N.y,N.z),u.push(0,0),q.push(h++),U+=Math.PI*2/pe/r}je.push(q)}Le.reverse(),je.push(Le);let lt=je.length-1;for(let pe=0;pe<lt;pe++){let q=je[pe],j=je[pe+1],ve=q.length-1;o.push(j[1],q[0],j[0]);for(let ze=1;ze<=ve;ze++)o.push(q[ze],q[ze-1],j[ze]),o.push(j[ze+1],q[ze],j[ze])}}}}}this.setIndex(o),this.setAttribute("position",new Ze(l,3)),this.setAttribute("normal",new Ze(c,3)),this.setAttribute("uv",new Ze(u,2));function B(N,L,W,G,X){let Q=-G/2,ie=(Math.PI-G)/2,J=L.clone().normalize().cross(W);N.addScaledVector(W,-s/Math.sin(ie));let se=new R,ee=new R,ue=1,oe=h,le=[];for(let de=0;de<=a;de++){let xe=Q+de/a*G;ee.set(0,0,0),ee.addScaledVector(J,Math.sin(xe)),ee.addScaledVector(W,Math.cos(xe));for(let _e=0;_e<=ue;_e++){let Se=_e/ue-.5;if(se.copy(N),se.addScaledVector(L,Se),se.addScaledVector(ee,s),X!=null){let Le=Math.max(0,se.y-X);se.addScaledVector(L,-Le/L.y)}l.push(se.x,se.y,se.z),c.push(ee.x,ee.y,ee.z),u.push(0,0),_e===0&&le.push(h),h++}}for(let de=0;de<a;de++)for(let xe=0;xe<ue;xe++){let _e=oe+xe+(ue+1)*de,Se=_e+(ue+1),Le=Se+1,Oe=_e+1;o.push(_e,Se,Oe),o.push(Se,Le,Oe)}return[N.clone().addScaledVector(L,.5),le]}function V(N,L,W,G){let X=Math.PI/2,Q=C.angle()-X,ie=[],J=new R,se=new R;for(let ue=0;ue<=a;ue++){let oe=[],le=ue/a;for(let de=0;de<=ue;de++){let xe=((ue?de/ue:0)-.5)*v,_e=Math.cos(xe),Se=Math.sin(xe),Le=Math.atan(Math.tan(Q)*_e),Oe=(X+Le)*le,Ye=Math.cos(Oe),$e=Math.sin(Oe);J.set(0,0,0),J.addScaledVector(L,$e*_e),J.addScaledVector(W,Ye),J.addScaledVector(G,$e*Se),se.copy(N).addScaledVector(J,s),l.push(se.x,se.y,se.z),c.push(J.x,J.y,J.z),u.push(0,0),oe.push(h++)}ie.push(oe)}let ee=ie.length-1;for(let ue=0;ue<ee;ue++){let oe=ie[ue],le=ie[ue+1],de=oe.length-1;o.push(oe[0],le[1],le[0]);for(let xe=1;xe<=de;xe++)o.push(oe[xe-1],oe[xe],le[xe]),o.push(oe[xe],le[xe+1],le[xe])}}}},ak=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Si?e.shape:new Si,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},u={x:-c.x,y:-c.y},h={x:c.x,y:c.y};function d(b,E,_){return E>r&&_>i?Math.min(b*r/E,b*i/_):E>r?b*r/E:_>i?b*i/_:b}let p=[];p[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),p[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),p[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),p[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let f=u.x,m=h.x,g=h.y,v=u.y;t.addPoint(t.createPoint(f,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(f,v)),t.isClosed=!0;let y=!0;for(let b=0,E=t.points.length;b<E;b++)t.points[b].roundness=p[b],b>0&&p[b]!==p[b-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=s!==1,t.update();let w=Xp.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(w,{userData:{...e,type:"RectangleGeometry"}})}},W1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return r.thetaLength=rt.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,u;return c===0?(u=new pt,u.setAttribute("position",new Ze([],3))):u=new Pm(.5*t,n,s,a,o,l,c*rt.DEG2RAD),u.scale(1,r/t,i/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},G1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new Wp(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},q1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new Y1e(t,r,i,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},Y1e=class extends pt{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let u=[],h=Math.PI/2,d=(ue=0,oe=0,le=0)=>new R(ue,oe,le),p=d(),f=d(),[m,g,v]=[t/2,e/2,r/2],y=-g,w=+g,[b,E,_]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],C=(ue,oe=!1)=>Math.sin(ue-Math.PI/(1+ +oe)),x=(ue,oe=!1)=>Math.cos(ue-Math.PI/(1+ +oe));_.y=Math.sin(i)*t-m;let A=Math.cos(i)*t-v,T=b.z-c;i<=h?(_.z=Math.min(A,T),_.z==T&&(_.y-=(A-T)/Math.tan(h-i))):E.z=Math.min(E.z-A-v,b.z-c),p.subVectors(b,E),f.subVectors(_,E);let M=Math.min(p.length(),f.length())*n/100,D=M*Math.tan(i/2),P=M/Math.cos(i/2),I=p.clone().normalize().add(f.normalize()).setLength(P).add(E);p.set(0,C(i,!0),x(i,!0)),u.push([_,p.clone()]);let B=(Math.PI-i)/s;for(let ue=0;ue<=s;ue++){let oe=h+i+ue*B;p.set(0,Math.sin(oe)*D,Math.cos(oe)*D),p.add(I),f.set(0,C(oe),x(oe)),u.push([p.clone(),f.clone()])}u.push([b,d(0,1,0)]);let V=Math.sin(B/2)*D*2,N=u.length-1,L=u[0][0].distanceTo(u[1][0]),W=u[N-1][0].distanceTo(u[N][0]),G=L+V*s+W;u[0].push(1);for(let ue=0;ue<=s;ue++)u[ue+1].push(1-(L+ue*V)/G);u[N].push(0);let[X,Q,ie]=u[0],J,se,ee;for(let ue=1;ue<u.length;ue++)[J,se,ee]=u[ue],a.push(y,X.y,X.z,y,J.y,J.z,w,X.y,X.z,w,X.y,X.z,y,J.y,J.z,w,J.y,J.z),o.push(0,Q.y,Q.z,0,se.y,se.z,0,Q.y,Q.z,0,Q.y,Q.z,0,se.y,se.z,0,se.y,se.z),l.push(0,ie,0,ee,1,ie,1,ie,0,ee,1,ee),[X,Q,ie]=[J,se,ee];this.setAttribute("position",new Ze(a,3)),this.setAttribute("normal",new Ze(o,3)),this.setAttribute("uv",new Ze(l,2))}},mq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Si?e.shape:new Si,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,h=t*.5,d=r*.5,p=0,f=0,m=a*Math.PI/360/n,g=Math.PI/2*3*-1,v=h*i/100,y=d*i/100;if(n===3&&i===50){m=2*Math.PI/n;for(let b=0;b<n;b++){let E=m*b,_=p+Math.sin(E)*h,C=f+Math.cos(E)*d;u.addPoint(u.createPoint(_,C))}}else for(let b=0;b<n;b++){let E=p+Math.cos(g)*h,_=f+Math.sin(g)*d;u.addPoint(u.createPoint(E,_)),g+=m,E=p+Math.cos(g)*v,_=f+Math.sin(g)*y,u.addPoint(u.createPoint(E,_)),g+=m}u.isClosed=!0;for(let b=0,E=u.points.length;b<E;b++)u.points[b].roundness=s;u.roundness=s,u.update();let w=Xp.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(w,{userData:{...e,type:"StarGeometry"}})}},X1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new Wp(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},$1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=Q1e(t,r,i,t*.5,a,s,0,0,n,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function Q1e(e,t,r,i,n,s,a,o,l,c,u){[t,r]=[r,t],a=t/2;let h=rt.clamp(n/360,0,1);if(h===0){let d=new pt;return d.setAttribute("position",new Ze([],3)),d}return h===1&&(c=0),new dq(!0,e,t,r,i,h,s,a,o,l,c,u)}var K1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new f8(o,r,i,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},Z1e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Si?e.shape:new Si,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5;o?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=i;l.roundness=i,l.update();let h=Xp.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:{...e,type:"TriangleGeometry"}})}};function J1e(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}var ebe=class{add(e,t,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}},tbe=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},Ae=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+Ae.version}static addUnaryOp(t){return Ae.max_unop_len=Math.max(t.length,Ae.max_unop_len),Ae.unary_ops[t]=1,Ae}static addBinaryOp(t,r,i){return Ae.max_binop_len=Math.max(t.length,Ae.max_binop_len),Ae.binary_ops[t]=r,i?Ae.right_associative.add(t):Ae.right_associative.delete(t),Ae}static addIdentifierChar(t){return Ae.additional_identifier_chars.add(t),Ae}static addLiteral(t,r){return Ae.literals[t]=r,Ae}static removeUnaryOp(t){return delete Ae.unary_ops[t],t.length===Ae.max_unop_len&&(Ae.max_unop_len=Ae.getMaxKeyLen(Ae.unary_ops)),Ae}static removeAllUnaryOps(){return Ae.unary_ops={},Ae.max_unop_len=0,Ae}static removeIdentifierChar(t){return Ae.additional_identifier_chars.delete(t),Ae}static removeBinaryOp(t){return delete Ae.binary_ops[t],t.length===Ae.max_binop_len&&(Ae.max_binop_len=Ae.getMaxKeyLen(Ae.binary_ops)),Ae.right_associative.delete(t),Ae}static removeAllBinaryOps(){return Ae.binary_ops={},Ae.max_binop_len=0,Ae}static removeLiteral(t){return delete Ae.literals[t],Ae}static removeAllLiterals(){return Ae.literals={},Ae}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new Ae(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(r=>r.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return Ae.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!Ae.binary_ops[String.fromCharCode(t)]||Ae.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return Ae.isIdentifierStart(t)||Ae.isDecimalDigit(t)}throwError(t){let r=new Error(t+" at character "+this.index);throw r.index=this.index,r.description=t,r}runHook(t,r){if(Ae.hooks[t]){let i={context:this,node:r};return Ae.hooks.run(t,i),i.node}return r}searchHook(t){if(Ae.hooks[t]){let r={context:this};return Ae.hooks[t].find(function(i){return i.call(r.context,r),r.node}),r.node}}gobbleSpaces(){let t=this.code;for(;t===Ae.SPACE_CODE||t===Ae.TAB_CODE||t===Ae.LF_CODE||t===Ae.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),r=t.length===1?t[0]:{type:Ae.COMPOUND,body:t};return this.runHook("after-all",r)}gobbleExpressions(t){let r=[],i,n;for(;this.index<this.expr.length;)if(i=this.code,i===Ae.SEMCOL_CODE||i===Ae.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())r.push(n);else if(this.index<this.expr.length){if(i===t)break;this.throwError('Unexpected "'+this.char+'"')}return r}gobbleExpression(){let t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,Ae.max_binop_len),r=t.length;for(;r>0;){if(Ae.binary_ops.hasOwnProperty(t)&&(!Ae.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!Ae.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=r,t;t=t.substr(0,--r)}return!1}gobbleBinaryExpression(){let t,r,i,n,s,a,o,l,c;if(a=this.gobbleToken(),!a||(r=this.gobbleBinaryOp(),!r))return a;for(s={value:r,prec:Ae.binaryPrecedence(r),right_a:Ae.right_associative.has(r)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+r),n=[a,s,o];r=this.gobbleBinaryOp();){if(i=Ae.binaryPrecedence(r),i===0){this.index-=r.length;break}s={value:r,prec:i,right_a:Ae.right_associative.has(r)},c=r;let u=h=>s.right_a&&h.right_a?i>h.prec:i<=h.prec;for(;n.length>2&&u(n[n.length-2]);)o=n.pop(),r=n.pop().value,a=n.pop(),t={type:Ae.BINARY_EXP,operator:r,left:a,right:o},n.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+c),n.push(s,t)}for(l=n.length-1,t=n[l];l>1;)t={type:Ae.BINARY_EXP,operator:n[l-1].value,left:n[l-2],right:t},l-=2;return t}gobbleToken(){let t,r,i,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(t=this.code,Ae.isDecimalDigit(t)||t===Ae.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===Ae.SQUOTE_CODE||t===Ae.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(t===Ae.OBRACK_CODE)n=this.gobbleArray();else{for(r=this.expr.substr(this.index,Ae.max_unop_len),i=r.length;i>0;){if(Ae.unary_ops.hasOwnProperty(r)&&(!Ae.isIdentifierStart(this.code)||this.index+r.length<this.expr.length&&!Ae.isIdentifierPart(this.expr.charCodeAt(this.index+r.length)))){this.index+=i;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:Ae.UNARY_EXP,operator:r,argument:s,prefix:!0})}r=r.substr(0,--i)}Ae.isIdentifierStart(t)?(n=this.gobbleIdentifier(),Ae.literals.hasOwnProperty(n.name)?n={type:Ae.LITERAL,value:Ae.literals[n.name],raw:n.name}:n.name===Ae.this_str&&(n={type:Ae.THIS_EXP})):t===Ae.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let r=this.code;for(;r===Ae.PERIOD_CODE||r===Ae.OBRACK_CODE||r===Ae.OPAREN_CODE||r===Ae.QUMARK_CODE;){let i;if(r===Ae.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==Ae.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),r=this.code}this.index++,r===Ae.OBRACK_CODE?(t={type:Ae.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},this.gobbleSpaces(),r=this.code,r!==Ae.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):r===Ae.OPAREN_CODE?t={type:Ae.CALL_EXP,arguments:this.gobbleArguments(Ae.CPAREN_CODE),callee:t}:(r===Ae.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),t={type:Ae.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),i&&(t.optional=!0),this.gobbleSpaces(),r=this.code}return t}gobbleNumericLiteral(){let t="",r,i;for(;Ae.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===Ae.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);Ae.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(r=this.char,r==="e"||r==="E"){for(t+=this.expr.charAt(this.index++),r=this.char,(r==="+"||r==="-")&&(t+=this.expr.charAt(this.index++));Ae.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);Ae.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return i=this.code,Ae.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(i===Ae.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===Ae.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:Ae.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="",r=this.index,i=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===i){n=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=s}else t+=s}return n||this.throwError('Unclosed quote after "'+t+'"'),{type:Ae.LITERAL,value:t,raw:this.expr.substring(r,this.index)}}gobbleIdentifier(){let t=this.code,r=this.index;for(Ae.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,Ae.isIdentifierPart(t));)this.index++;return{type:Ae.IDENTIFIER,name:this.expr.slice(r,this.index)}}gobbleArguments(t){let r=[],i=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===t){i=!0,this.index++,t===Ae.CPAREN_CODE&&n&&n>=r.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(s===Ae.COMMA_CODE){if(this.index++,n++,n!==r.length){if(t===Ae.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===Ae.CBRACK_CODE)for(let a=r.length;a<n;a++)r.push(null)}}else if(r.length!==n&&n!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===Ae.COMPOUND)&&this.throwError("Expected comma"),r.push(a)}}return i||this.throwError("Expected "+String.fromCharCode(t)),r}gobbleGroup(){this.index++;let t=this.gobbleExpressions(Ae.CPAREN_CODE);if(this.code===Ae.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:Ae.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:Ae.ARRAY_EXP,elements:this.gobbleArguments(Ae.CBRACK_CODE)}}},rbe=new ebe;Object.assign(Ae,{hooks:rbe,plugins:new tbe(Ae),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});Ae.max_unop_len=Ae.getMaxKeyLen(Ae.unary_ops);Ae.max_binop_len=Ae.getMaxKeyLen(Ae.binary_ops);var yg=e=>new Ae(e).parse(),ibe=Object.getOwnPropertyNames(Ae);ibe.forEach(e=>{yg[e]===void 0&&e!=="prototype"&&(yg[e]=Ae[e])});yg.Jsep=Ae;var nbe="ConditionalExpression",sbe={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:nbe,test:r,consequent:i,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let s=r;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;t.node.test=s.right,s.right=t.node,t.node=r}}else this.throwError("Expected :")}})}};yg.plugins.register(sbe);var abe=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],obe=["0","1","2","3","4","5","6","7","8","9","."],lbe=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function cbe(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}yg.addBinaryOp("^",11,!0);function gq(e,t,r="number"){let i="";for(let a=0;a<e.length;a++){let o=e[a];if("id"in o){let l=e[a-1];if(a>0&&"id"in l){console.error("Two variables in a row",e);return}let c=t.getVariable(o.id),u=ba.getDisplayedValue(c);r==="number"&&ba.isTextValue(c)&&Array.isArray(c.textValue)&&c.textValue.length===1?u=parseFloat(u).toString():r==="boolean"&&ba.isBoolean(c)?u=c?"true":"false":r==="boolean"&&ba.isTextValue(c)&&!Array.isArray(c.textValue)&&(u='"'+u+'"'),i+=u;continue}else if(r==="string"){o.name!=='"'&&o.name!=="+"&&(i+=o.name),o.name==="+"&&i[i.length-1]==="\\"&&(i=i.slice(0,-1)+o.name);continue}if(o.name==="and"){i+="&&";continue}if(o.name==="or"){i+="||";continue}if(o.name==="True"){i+="true";continue}if(o.name==="False"){i+="false";continue}if(r==="boolean"&&!cbe(o.name)&&!obe.includes(o.name)&&!abe.includes(o.name)&&!lbe.includes(o.name.replace(/\($/g,""))){i+='"'+o.name+'"';continue}i+=o.name}if(r==="string")return i;if(e.length===0){if(r==="number")return 0;if(r==="boolean")return!1}let n;try{n=yg(i)}catch(a){console.error(i,a);return}let s;try{s=dr(n)}catch(a){console.error(i,n,a)}return s}function dr(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(dr(e.left)===dr(e.right));case"!=":return+(dr(e.left)!==dr(e.right));case">":return+(dr(e.left)>dr(e.right));case">=":return+(dr(e.left)>=dr(e.right));case"<":return+(dr(e.left)<dr(e.right));case"<=":return+(dr(e.left)<=dr(e.right));case"+":return dr(e.left)+dr(e.right);case"-":return dr(e.left)-dr(e.right);case"*":return dr(e.left)*dr(e.right);case"/":return dr(e.left)/dr(e.right);case"%":return dr(e.left)%dr(e.right);case"&&":return dr(e.left)&&dr(e.right);case"||":return dr(e.left)||dr(e.right);case"^":return Math.pow(dr(e.left),dr(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-dr(e.argument);case"!":return+!dr(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,r=1;if(e.arguments.length>=1)try{t=dr(e.arguments[0])}catch(i){console.warn(i)}if(e.arguments.length>=2)try{r=dr(e.arguments[1])}catch(i){console.warn(i)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(dr))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var ube=new Be,hbe=new Be;function dbe(e,t,r){let i=[new R,new R,new R],n=[new R,new R,new R];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((s,a)=>{let o=n[a],l=rt.lerp(s.length(),o.length(),r);s.lerp(o,r).setLength(l)}),new Be().makeBasis(i[0],i[1],i[2])}var pbe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=(t==null?void 0:t.shapeData)??sk.create({parameters:U7}).userData.shape;return{path:e.path??TS.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:s,extrusion:{...j7,...r.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new fbe(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new pt,{userData:{...e,type:"PathGeometry"}})}},fbe=class extends pt{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!J1e(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),i=Math.max(0,Math.min(i,1));let n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*n),a=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],c=[];for(let N=0;N<o;N++){let L=this.inputs.path.isClosed?(N+s)%e.length:Math.min(N+s,e.length-1);l.push(e[L].clone()),c.push(t[L].clone())}let u=(N,L,W)=>{l[N]=l[N].clone().lerp(l[L],W),c[N]=dbe(c[N],c[L],W)},h=0,d=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(d||i===0)&&(h=d,u(0,1,h));let p=0,f=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&f&&(p=f,u(l.length-1,l.length-2,1-p)),r===0){let N=l.length-1;l[N].copy(l[0]),c[N].copy(c[0])}this._applyPathModifiers(c,h,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:w,infos:b,vertices:E}=this._computeShapePoints(y),_=0,C;v==="round"&&(C=new nk(this.inputs.shapeData,2*m,m,y,g,void 0,!0),_=C.getAttribute("position").count);let x=0,A=0;b.sort((N,L)=>N.start-L.start),b.forEach(N=>{N.verticesStart=x,N.verticesCount=N.continuous.reduce((L,W,G)=>L+(G===0||!W?2:1),0),A+=N.verticesCount,x=A});let T=A*o,M,D=0;if(this._isOpenEnded()&&v==="flat"){try{M=ph({windingRule:Rr.ODD,elementType:Gi.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:w})}catch{M=sq}D=M.vertexCount}let P=T+2*D+_*2,I=T+2*D,B={positions:new Float32Array(P*3),normals:new Float32Array(P*3),uvs:new Float32Array(P*2)},V=[];if(b.forEach(N=>{this._extrudeRegion(N,E,c,l,B,V,this._isGeometryClosed()&&!this._isOpenEnded())}),M&&(this._closeEnd(M,T,V,B,c[0],l[0],!1),this._closeEnd(M,T+D,V,B,c[c.length-1],l[l.length-1],!0)),C){B.positions.set(C.getAttribute("position").array,I*3),B.normals.set(C.getAttribute("normal").array,I*3),B.uvs.set(C.getAttribute("uv").array,I*2);for(let G=I;G<I+_;G++)B.uvs[G*2+1]=1e-4;let N=V.length;V.push(...C.getIndex().array.map(G=>G+I)),I+=_,B.positions.set(C.getAttribute("position").array,I*3),B.normals.set(C.getAttribute("normal").array,I*3),B.uvs.set(C.getAttribute("uv").array,I*2);let L=V.length;V.push(...C.getIndex().array.map(G=>G+I)),this.setAttribute("position",new Mt(B.positions,3)),this.setAttribute("normal",new Mt(B.normals,3)),this.setAttribute("uv",new Mt(B.uvs,2)),this.setIndex(V);let W=ube;W.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(W,I,P),W.copy(c[0]).setPosition(l[0]).multiply(hbe.makeScale(1,1,-1)),this.applyMatrix4OnRange(W,I-_,I),this.reverseIndicesOnRange(N,L)}else this.setAttribute("position",new Mt(B.positions,3)),this.setAttribute("normal",new Mt(B.normals,3)),this.setAttribute("uv",new Mt(B.uvs,2)),this.setIndex(V)}_extractPathPoints(){let e=Q7(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new R,s=new R,a=new R,o=new R,l=new R(0,1,0);for(let f=0;f<r;f++){let m=e[f],g;f===0?g=i?e[e.length-2]:m.clone().multiplyScalar(2).sub(e[1]):g=e[f-1];let v;f===r-1?v=i?e[1]:m.clone().multiplyScalar(2).sub(e[f-1]):v=e[f+1];let y=m.clone().sub(g).normalize(),w=v.clone().sub(m).normalize(),b=y.clone().add(w).normalize();a.copy(b),f===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let E=l.clone().cross(b).normalize(),_=b.clone().cross(E).normalize();l.copy(_),o.copy(E),f===0&&(n.copy(_),s.copy(b));let C=new Be().makeBasis(E,_,b);t.push(C)}let c=i?s:a,u=i?n:new R(0,1,0),h=c.clone().cross(o).normalize(),d=Math.acos(u.dot(h));if(isNaN(d))return t;let p=u.clone().cross(h);c.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let m=new Be().makeRotationZ(d*f/t.length);t[f].multiply(m)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new Be,c=new Be;return e.forEach((u,h)=>{let d=h===0?0:h===i-1?1:(h-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(rt.lerp(n,n+s,d)*rt.DEG2RAD);let p=rt.lerp(a,o,d);c.makeScale(p,p,p),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Rr.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),h=[];for(let d=u.length-1;d>=1;d-=2){let p=u[d-1],f=u[d-0];h.push(p,f)}return h}),s;try{s=ph({windingRule:t,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=ik}let a;try{a=ph({windingRule:Rr.ODD,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=nq}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let u=a.elements[c],h=c%2===0?s.vertexCount:0;s.elements.push(u+h)}for(let c=0;c<a.vertexIndices.length;c++){let u=a.vertexIndices[c],h=s.vertexCount;s.vertexIndices.push(u+h)}for(let c=0;c<a.vertices.length;c++){let u=a.vertices[c];s.vertices.push(u)}}for(let c=0,u=s.vertexCount;c<u;c++){let h=c*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let u=c>=o,h=c*2,d=s.elements[h+0],p=s.elements[h+1],f=d+p,m={start:d,count:p,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=d,v=f-1,y=d+1,w=r.roundedCurves.length;do{let b=g-d;s.vertices[v*2+0],s.vertices[v*2+1];let E=s.vertices[g*2+0],_=s.vertices[g*2+1],C=s.vertices[y*2+0],x=s.vertices[y*2+1],A=E-C,T=_-x,M=Math.sqrt(A*A+T*T);A/=M,T/=M,m.normals[b*2+0]=-T,m.normals[b*2+1]=A;let D=s.vertexIndices[g];if(Array.isArray(D))m.continuous[b]=!1;else{let[P,I]=r.getCurveIndexFromVertexId(D-1,!0);if(I>0&&I<1)m.continuous[b]=!0;else{let B=I===1?P+1:P-1;B=(B+w)%w;let V=I===1?0:1,N=r.roundedCurves[P].getTangent(I),L=r.roundedCurves[B].getTangent(V);m.continuous[b]=N.dot(L)>.95}}u&&(m.normals[b*2+0]*=-1,m.normals[b*2+1]*=-1),[v,g,y]=[g,y,y+1],y>=f&&(y-=p)}while(y!==d+1)}return{regions:[i,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,r,i,n){let s=t*2,a=t*3;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,r,i,n,s,a){let o=new R,l=new R,c=new R,u=new R,h=new re;r.forEach((p,f)=>{let m=i[f],g=e.verticesStart*r.length+e.verticesCount*f;for(let v=0;v<e.count;v++){let y=(e.start+v)*2;if(o.set(t[y+0],t[y+1],0),c.copy(o).applyMatrix4(p).add(m),e.continuous[v])u.set(e.normals[v*2+0],e.normals[v*2+1],0);else{let w=v===0?(e.start+e.count-1)*2:y-2;l.set(t[w+0],t[w+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(p).normalize(),h.set(v===0?1:v/e.count,f/(r.length-1)),this._insertVertex(n,g,c,u,h),g++,!e.continuous[v]||v===0){if(v===0)u.set(e.normals[v*2+0],e.normals[v*2+1],0),h.set(0,f/(r.length-1));else{let w=v===e.count-1?e.start*2:y+2;l.set(t[w+0],t[w+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(p).normalize(),this._insertVertex(n,g,c,u,h),g++}}});let d=r.length-1;for(let p=0;p<d;p++){let f=e.verticesStart*r.length+e.verticesCount*p,m=e.verticesStart*r.length+e.verticesCount*(p+1),g=0;for(let v=0;v<e.count;v++){(!e.continuous[v]||v===0)&&g++;let y=v===e.count-1?0:g+1,w=f+g,b=f+y,E=m+y,_=m+g;e.isHole?s.push(w,E,b,w,_,E):s.push(w,b,E,w,E,_),g++}}}_closeEnd(e,t,r,i,n,s,a){let o=e.vertexCount,l=new R(0,0,a?-1:1).applyMatrix4(n),c=new R,u=new re;for(let d=0;d<o;d++){let p=2*d;c.set(e.vertices[p+0],e.vertices[p+1],0).applyMatrix4(n).add(s),this._insertVertex(i,t+d,c,l,u)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let p=3*d,f=h[p+0]+t,m=h[p+(a?1:2)]+t,g=h[p+(a?2:1)]+t;r.push(f,m,g)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new ln().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let h=c.array,d=u.array,p=c.itemSize;for(let f=t*p,m=r*p;f<m;f+=p){if(f===t)debugger;s=h[f+0],a=h[f+1],o=h[f+2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]),h[f+0]=(i[0]*s+i[4]*a+i[8]*o+i[12])*l,h[f+1]=(i[1]*s+i[5]*a+i[9]*o+i[13])*l,h[f+2]=(i[2]*s+i[6]*a+i[10]*o+i[14])*l,s=d[f+0],a=d[f+1],o=d[f+2],d[f+0]=n[0]*s+n[3]*a+n[6]*o,d[f+1]=n[1]*s+n[4]*a+n[7]*o,d[f+2]=n[2]*s+n[5]*a+n[8]*o}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),s=r.getX(i+1),a=r.getX(i+2);r.setXYZ(i,a,s,n)}r.needsUpdate=!0}}};function vq(){let e=new pt;return e.setAttribute("position",new Mt(new Float32Array([]),3)),e.setIndex(new Mt(new Uint16Array([]),1)),e}var mbe=vq().attributes,gbe=12,vbe=1,yq=class extends pt{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,mbe),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r!=null&&r.isLoaded?(this.font=r,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:r,height:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=ba.getDisplayedValue(o),u=l===2?c.toUpperCase():l===3?c.toLowerCase():c,h=ybe(e,t,u),{shapes:d,charWidths:p,charCoords:f}=t.generateShapes(h,e),m=(typeof r=="number"?r:1)*.5,g=(typeof i=="number"?i:1)*.5,v=d.map(b=>new Si().fromShape(b,!0));this.vectorShapes=v;let y=v.map(b=>Xp.create({shape:b,parameters:{depth:n,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:n<=0?Rr.NONZERO:Rr.ODD,subdivisions:this.isLowResolution&&n>0?vbe:gbe}})),w=y.length?Ud(y):vq();w.translate(-m,g,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=p,this.deleteAttribute("extrudeNormal"),Object.entries(w.attributes).forEach(([b,E])=>{this.setAttribute(b,E)}),this.setIndex(w.index),this.computeBoundingSphere()}clone(){let e=Gl(new pt,yq.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function ybe(e,t,r){let i=[""],n="";for(let s of r)n+=s,s===" "||s===`
`?(i[i.length-1]+=n,n="",s===`
`&&i.push("")):t.getTextWidth(i[i.length-1]+n,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+n,e)>e.width&&(n.length===1?(i[i.length-1]+=n,n=""):(i[i.length-1]+=n.slice(0,-1),n=n[n.length-1],i.push(""))));return i[i.length-1]+=n,i}var wq,xq=new Promise(e=>{wq=e}),YU=!1,F1;function wbe(){if(YU)return;if(F1)return F1;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@1.7.2/build",r=id(()=>import("./process-efgVNNca.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});wq(a),YU=!0}return F1=e(),F1}var xbe=["font"];function tw(e,t,r,i){var c,u;let n,s,a;e.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s={...e},a=[[]]);for(let h of a){let d=s;for(let p of h)d=d[p];for(n in d){let p=d[n];Q4(p)&&!xbe.includes(n)&&(d[n]=t.getVariable(p,[i.uuid,"geometry",...h,n]),Q4(d[n])&&(d[n]=1))}}let o={parameters:s,type:s.type};if(s.type==="PathGeometry")o.path=s.path;else if(s.type==="VectorGeometry"){let h=Si.createFromState(s.shape,s.width,s.height);o.shape=h}else if(s.type==="NonParametricGeometry"){if(s.data.groups&&((c=s.data.groups)==null||c.forEach(h=>h.materialIndex=Math.max(h.materialIndex??0,0))),o.geometry=new b8().parse(s),o.geometry.groups.length===0){let h=o.geometry;h.addGroup(0,Math.max(((u=h.getIndex())==null?void 0:u.count)??0,h.getAttribute("position").count),0)}}else if(s.type==="SubdivGeometry"){let h=new Rs(s,r);return h.data=e,h}else{if(s.type==="TextGeometry")return new yq(s,t);if(s.type==="UIGeometry")return ak.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}let l;try{l=ZU(o)}catch(h){console.error(h)}if(!l){let h=Si.createFromState(ES.defaultData(),100,100);o.shape=h,l=ZU(o)}return l}var bbe=new Be;function yI(e,t,r,i){let n=e.position.array,s=e.normal.array,a=bbe.makeScale(t,r,i).invert().elements,o,l,c;for(var u=0,h=n.length;u<h;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,o=s[u],l=s[u+1],c=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*c,s[u+1]=a[1]*o+a[5]*l+a[9]*c,s[u+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var U1=new Ni,Df=new R,_t;xq.then(e=>{_t=e});var XU=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),$U=new Uint32Array([0,1,2,3]),QU=new Uint8Array([4]),Rs=class extends pt{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=Zd.div(t,r);this.subdividedGeometry&&yI(this.subdividedGeometry.attributes,...i),this.originalGeometry&&yI(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(Df.fromArray(i));let s=Df.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=Rs.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Wo(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Rs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ca,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;U1.setFromBufferAttribute(t),U1.getCenter(r),e.boundingSphere.radius=r.distanceTo(U1.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),U1.getSize(Df);let i={width:Df.x,height:Df.y,depth:Df.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,s,a,o=(e==null?void 0:e.phongAngle)??35;r===!1&&(o=-1),t&&(_t.free_bvh(t),_t.free_subdivision_surface(t));try{n=Rs.allocate(e,i)}catch(l){console.error(l,e),n=Rs.allocate({positionWASM:XU,indexWASM:$U,verticesPerFaceWASM:QU},i)}if(_t.set_destination_refinement_level(n,0),s=Rs.buildLevel(n,!0,o),e.subdivisions>0)try{_t.set_destination_refinement_level(n,e.subdivisions),a=Rs.buildLevel(n,!1,o)}catch{try{_t.set_destination_refinement_level(n,e.subdivisions-1),a=Rs.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:tw(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let s,a,o,l;({positions:s,triIndices:l}=DT(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,h=u+e.radialSegments*3;c=[u,h]}return{indices:a,verticesPerFace:o}=bq(s,l,i,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var w;let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=XU,i=$U,n=QU);let o=r.length,l=i.length,c=n.length,u=r.length+s.length+a.length,h=i.length+n.length,d=u*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,p=u*Float32Array.BYTES_PER_ELEMENT,f=_t._malloc(d),m=new Float32Array(_t.HEAPF32.buffer,f,u),g=new Uint32Array(_t.HEAPU32.buffer,f+p,h);m.set(r,0),m.set(s,r.length),m.set(a,r.length+s.length),g.set(i,0),g.set(n,i.length);let v;(w=e==null?void 0:e.scaleBaked)!=null&&w.some(b=>b!==1)&&(v=new Be().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let y=v?_t.alloc_subdivision_surface2(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c,v.elements):_t.alloc_subdivision_surface(f,o,f+p,l,f+p+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return _t._free(f),y}static buildLevel(e,t,r,i,n){let s=n?_t.get_mesh_data2(e,t?_t.Level.CONTROL:_t.Level.REFINED,r,n.elements):_t.get_mesh_data(e,t?_t.Level.CONTROL:_t.Level.REFINED,r),a=8,o=_t.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,8),c=0,u=_t.HEAPU32[o[c]>>2],h=_t.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=_t.HEAPU32[o[c]>>2],p=_t.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=_t.HEAPU32[o[c]>>2],m=_t.HEAPU32.subarray(f>>2,(f>>2)+l[c]);c++;let g=_t.HEAPU32[o[c]>>2],v=_t.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new pt;if(y.setIndex(new Mm(v,1)),y.setAttribute("position",new Ze(h,3)),y.setAttribute("normal",new Ze(p,3)),t){y.setAttribute("faceMap",new Mm(m,1));let w=new Float32Array(p.length/3*4).fill(0);y.setAttribute("color",new Mt(w,4))}return _t.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(h),i.getAttribute("normal").copyArray(p),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,_t.free_mesh_data(s)}static freeSubdivPointer(e){_t.free_bvh(e),_t.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=_t.get_wireframe_data_for_base_level(e),n=4,s=_t.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,4),o=0,l=_t.HEAPU32[s[o]>>2],c=_t.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=_t.HEAPU32[s[o]>>2],h=_t.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let d=new pt;d.setAttribute("position",new Ze(c,3));let p=new Float32Array(c.length);for(let f=0,m=c.length;f<m;)p[f++]=r.r,p[f++]=r.g,p[f++]=r.b;return d.setAttribute("color",new Mt(p,3)),d.setIndex(new Mm(h,1)),_t.free_wireframe_data_for_base_level(i),d}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,_t.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||_t.set_destination_refinement_level(e,t);let n=r?_t.get_topological_data2(e,i?_t.Level.CONTROL:_t.Level.REFINED,r.elements):_t.get_topological_data(e,i?_t.Level.CONTROL:_t.Level.REFINED),s=6,a=_t.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,6),l=0,c=_t.HEAPU32[a[l]>>2],u=new Float32Array(_t.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let h=_t.HEAPU32[a[l]>>2],d=new Uint32Array(_t.HEAPU32.subarray(h>>2,(h>>2)+o[l]));l++;let p=_t.HEAPU32[a[l]>>2],f=new Uint8Array(_t.HEAPU32.subarray(p>>2,(p>>2)+o[l]));return _t.free_topological_data(n),{positions:u,indices:d,verticesPerFace:f}}},KU=["getX","getY","getZ"];function DT(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let c=0;c<i;c++){let u=t?t.getX(c):c,h="";for(let d=0;d<3;d++)h+=`${~~(e[KU[d]](u)*o)},`;if(h in r)s.push(r[h]);else{for(let d=0;d<3;d++)a.push(e[KU[d]](u));r[h]=n,s.push(n),n++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var j1=new R,bM=new R,_M=new R,SM=new R;function bq(e,t,r,i){let n=[],s=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let d=l.length/2/c;l=l.filter((p,f)=>Math.floor(f/2)%d===0)}let u=0;for(let d=0;d<l.length;d+=2)u+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);e.length=0;let h=0;if(u<0)for(let d=0;d<l.length;d+=2)e.push(l[d],l[d+1],0),n.push(h++);else for(let d=l.length-2;d>=0;d-=2)e.push(l[d],l[d+1],0),n.push(h++);return s.push(h),{indices:n,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){j1.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),bM.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),_M.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),SM.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),bM.sub(j1).normalize(),_M.sub(j1).normalize(),SM.sub(j1).normalize();let l=bM.cross(_M).dot(SM);Math.abs(l)>.005||i&&i.some((c,u)=>u%2===1?!1:o>=i[u]&&o<i[u+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let h=0,d=0;h<e.length;h+=3,d++)e[h+2]===0&&(l.push(d),u++),e[h+2]===a&&c.push(d);if(r.userData.parameters.extrudeBevelSize===0){let h=c[0];c[0]=c[1],c[1]=h}l.reverse(),n.push(...l,...c),s.push(u,u)}return{indices:n,verticesPerFace:s}}var Ec={};Rie(Ec,{calcBoolean:()=>Cbe,calcBooleanTopological:()=>Tbe,freeMeshSet:()=>Dbe,getMeshSet:()=>Abe,hasOpenEdges:()=>Mbe,transformMeshSet:()=>Pbe});var _q,_be=new Promise(e=>{_q=e}),V1;function Sbe(){if(V1)return V1;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@1.7.2/build",r=id(()=>import("./boolean-Bni0TW63.js"),[]),[i,n]=await Promise.all([r,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=i.default,a=await s({wasmBinary:n});_q(a)}return V1=e(),V1}var Jt,zm;_be.then(e=>Jt=e);function Ebe(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=DT(e.getAttribute("position"),n),o;if(t&&r){let{indices:l,verticesPerFace:c}=bq(s,a,e);o=c.length,i=[];for(let u=0,h=0;u<o;u++){i.push(c[u]);for(let d=0;d<c[u];d++)i.push(l[h++])}}else{let l=a.length;i=Array(l+l/3),o=0;for(let c=0,u=0;u<i.length;)i[u++]=3,o++,i[u++]=a[c++],i[u++]=a[c++],i[u++]=a[c++]}return{positions:s,faceIndices:i,nFaces:o}}function Sq(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=Jt._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(Jt.HEAPU32.buffer,s,t):new Float32Array(Jt.HEAPF32.buffer,s,t)).set(e,0),s}function Eq(e){switch(e){case 0:return Jt.OP.UNION;case 1:return Jt.OP.INTERSECTION;case 2:return Jt.OP.A_MINUS_B;case 3:return Jt.OP.B_MINUS_A;case 4:return Jt.OP.SYMMETRIC_DIFFERENCE;case 5:return Jt.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function Tbe(e,t){zm===void 0&&(zm=Jt.init_csg());let r=Sq(e),i=Jt.csg_calc_topological(zm,r,e.length,Eq(t));Jt._free(r);let n=6,s=Jt.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,6),o=0,l=Jt.HEAPU32[s[o]>>2],c=new Float32Array(Jt.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=Jt.HEAPU32[s[o]>>2],h=new Uint32Array(Jt.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=Jt.HEAPU32[s[o]>>2],p=new Uint8Array(Jt.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return Jt.free_mesh_data(i),{positions:c,indices:h,verticesPerFace:p}}function Cbe(e,t,r,i){zm===void 0&&(zm=Jt.init_csg());let n=Sq(e),s=Jt.csg_calc(zm,n,e.length,i,Eq(t));Jt._free(n);let a=5,o=Jt.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,5),c=0,u=Jt.HEAPU32[o[c]>>2],h=Jt.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=Jt.HEAPU32[o[c]>>2],p=Jt.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=l[c];r.setAttribute("position",new Ze(h,3)),r.setAttribute("normal",new Ze(p,3));let m=Jt.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new ca),r.boundingSphere.center.set(m[0],m[1],m[2]),r.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,r.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},Jt.free_mesh_data(s),f}function Abe(e,t,r){if(Jt===void 0)return-1;let i,n,s;if(t&&e.userData.positions!==void 0){let g=e.userData;s=g.verticesPerFace.length,i=g.positions,n=Array(g.verticesPerFace.reduce((v,y)=>v+y,0)+s);for(let v=0,y=0,w=0;v<g.verticesPerFace.length;v++){n[w++]=g.verticesPerFace[v];for(let b=0;b<g.verticesPerFace[v];b++)n[w++]=g.indices[y++]}}else({positions:i,faceIndices:n,nFaces:s}=Ebe(e,t,r));let a=i.length,o=n.length,l=i.length,c=n.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=Jt._malloc(u),p=new Float32Array(Jt.HEAPF32.buffer,d,l),f=new Uint32Array(Jt.HEAPU32.buffer,d+h,c);p.set(i,0),f.set(n,0);let m=Jt.get_csg_mesh(d,a,d+h,o,s);return Jt._free(d),m}function Mbe(e){return Jt.has_open_edges(e)}function Pbe(e,t){Jt.transform_csg_mesh(e,t.elements)}function Dbe(e){Jt.free_csg_mesh(e)}var Ibe={ConeGeometry:Qxe,CubeGeometry:Kxe,CylinderGeometry:K7,DodecahedronGeometry:Jxe,EllipseGeometry:sk,HelixGeometry:I1e,IcosahedronGeometry:O1e,LatheGeometry:R1e,NonParametricGeometry:U1e,PolygonGeometry:fq,PyramidGeometry:j1e,RectangleGeometry:ak,SphereGeometry:W1e,PlaneGeometry:G1e,BackdropGeometry:q1e,StarGeometry:mq,TextFrameGeometry:X1e,TorusGeometry:$1e,TorusKnotGeometry:K1e,TriangleGeometry:Z1e,PathGeometry:pbe,VectorGeometry:Xp},ZU=e=>Ibe[e.type].create(e);function If(e){return e!==null&&"booleanOp"in e}var Tq=class extends J3(Ii){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Be}updateVisible(e){super.updateVisible(e),this.visible=!If(this.parent)&&this.visible,If(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ec.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),If(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof Tq&&(e.freeBooleanPointer(),If(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&If(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(e=!1){super.onVariableUpdate(e),If(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},H1=new Ni;function ok(e,t=0,r=e.count,i,n){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=t;h<r;h++){let d=e.getX(h),p=e.getY(h),f=e.getZ(h);d<s&&(s=d),p<a&&(a=p),f<o&&(o=f),d>l&&(l=d),p>c&&(c=p),f>u&&(u=f)}H1.min.set(s,a,o),H1.max.set(l,c,u),H1.getCenter(i),H1.getSize(n).multiplyScalar(.5)}var Obe=new pt,Rbe=new Vp,js=class extends Tq{constructor(e,t){super(Obe,Rbe),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ok(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},Wu=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},Wu.uuidContext===null)throw new Error("plz startContext");Wu.uuidContext===Wu.globalContext?this.uuid="_gid"+Wu.uuidContext.nodeContextUuid++:this.uuid="_uid"+Wu.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){this.uuidContext===null||this.uuidContext===Wu.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},sn=Wu;sn.globalContext={nodeContextUuid:0},sn.uuidContext=Wu.globalContext;var JU=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},kbe=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},ea=new kbe,zr=class extends sn{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=rt.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},ua=class extends zr{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}},zn=class extends ua{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof re?e:new re(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},Va=class extends ua{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof R?e:new R(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},qn=class extends bt{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],s=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Tc=class extends ua{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof qn?e:new qn(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},Lbe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,ej=/[a-z_0-9]+/gi,Xe=class extends zr{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=ej.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let u=l[c],h=u[0],d=this.isMethod?!this.getInputByName(h):!0,p=h;if(this.keywords[h]||this.useKeywords&&d&&ea.containsKeyword(h)){let f=this.keywords[h];if(!f){let m=ea.getKeywordData(h);m.cache&&(f=e.keywords[h]),f=f||ea.getKeyword(h,e),m.cache&&(e.keywords[h]=f)}p=f.build(e)}h!==p&&o[u.index+a-1]!=="."&&(o=o.substring(0,u.index+a)+p+o.substring(u.index+h.length+a),a+=p.length-h.length),this.getIncludeByName(p)===void 0&&ea.contains(p)&&e.include(ea.get(p))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t??[],this.extensions=r??{},this.keywords=i??{},this.isMethod){let n=Lbe.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(ej);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let c=s[a++];this.inputs.push({name:c,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Nbe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Cq=class extends zr{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||Cq.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=Nbe.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},Dr=Cq;Dr.PI="PI",Dr.PI2="PI2",Dr.RECIPROCAL_PI="RECIPROCAL_PI",Dr.RECIPROCAL_PI2="RECIPROCAL_PI2",Dr.LOG2="LOG2",Dr.EPSILON="EPSILON";var zbe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Bbe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Aq=class extends zr{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=zbe.exec(e);if(t){let r=t[2],i;for(;i=Bbe.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},lk=class extends zr{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};ea.addKeyword("uv",function(){return new lk});ea.addKeyword("uv2",function(){return new lk(1)});var Xf=class extends zr{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??Xf.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Ho:return["Linear"];case jt:return["sRGB"];default:return[]}}generate(e,t){var a;let r=this.input.build(e,"v4"),i=this.getType(e),n=Xf.Nodes[this.method],s=e.include(n);if(s===Xf.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+r+", "+o+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=Xf.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Xf.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},Ml=Xf;Ml.Nodes={LinearToLinear:new Xe(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Xe(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Xe(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Ml.LINEAR_TO_LINEAR="LinearToLinear",Ml.SRGB_TO_LINEAR="sRGBToLinear",Ml.LINEAR_TO_SRGB="LinearTosRGB";var Wr=class extends Xe{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Oc=class extends ua{constructor(e=new pi,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new lk,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new Ml(new Wr("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},it=class extends ua{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},tj=class extends zr{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],u=this.inputs[l]||this.inputs[c.name];o.push(u.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},Mq=class extends zr{constructor(e,t,r=Mq.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},$s=Mq;$s.ADD="+",$s.SUB="-",$s.MUL="*",$s.DIV="/";var Pr=class extends zr{constructor(e,t=Pr.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Pr.MIX:case Pr.CLAMP:case Pr.REFRACT:case Pr.SMOOTHSTEP:case Pr.FACEFORWARD:return 3;case Pr.MIN:case Pr.MAX:case Pr.MOD:case Pr.STEP:case Pr.REFLECT:case Pr.DISTANCE:case Pr.DOT:case Pr.CROSS:case Pr.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Pr.LENGTH:case Pr.DISTANCE:case Pr.DOT:return"f";case Pr.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Pr.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Pr.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Pr.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Pr.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case Pr.MIN:case Pr.MAX:case Pr.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case Pr.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Pr.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let h=this.getNumInputs(e);if(u.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},zt=Pr;zt.RAD="radians",zt.DEG="degrees",zt.EXP="exp",zt.EXP2="exp2",zt.LOG="log",zt.LOG2="log2",zt.SQRT="sqrt",zt.INV_SQRT="inversesqrt",zt.FLOOR="floor",zt.CEIL="ceil",zt.NORMALIZE="normalize",zt.FRACT="fract",zt.SATURATE="saturate",zt.SIN="sin",zt.COS="cos",zt.TAN="tan",zt.ASIN="asin",zt.ACOS="acos",zt.ARCTAN="atan",zt.ABS="abs",zt.SIGN="sign",zt.LENGTH="length",zt.NEGATE="negate",zt.INVERT="invert",zt.MIN="min",zt.MAX="max",zt.MOD="mod",zt.STEP="step",zt.REFLECT="reflect",zt.DISTANCE="distance",zt.DOT="dot",zt.CROSS="cross",zt.POW="pow",zt.MIX="mix",zt.CLAMP="clamp",zt.REFRACT="refract",zt.SMOOTHSTEP="smoothstep",zt.FACEFORWARD="faceforward";var Py=class extends zr{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new tj(Py.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new Ml(new Wr("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Ml(new Wr("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Ml(new Wr("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Ml(new Wr("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new Wr(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Wr(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Wr(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Wr(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new Wr("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new tj(Py.Nodes.roughnessToMip,[i]),s=new zt(n,Py.Nodes.m0,Py.Nodes.cubeUV_maxMipLevel,zt.CLAMP),a=new zt(s,zt.FLOOR),o=new zt(s,zt.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new $s(a,new it(1).setReadonly(!0),$s.ADD)),u=new zt(l,c,o,zt.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},wI=Py;wI.Nodes=function(){let e=new Aq(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Dr("float cubeUV_maxMipLevel 8.0",!0),r=new Dr("float cubeUV_minMipLevel 4.0",!0),i=new Dr("float cubeUV_maxTileSize 256.0",!0),n=new Dr("float cubeUV_minTileSize 16.0",!0),s=new Xe(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new Xe(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new Xe(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new Dr("float r0 1.0",!0),c=new Dr("float v0 0.339",!0),u=new Dr("float m0 -2.0",!0),h=new Dr("float r1 0.8",!0),d=new Dr("float v1 0.276",!0),p=new Dr("float m1 -1.0",!0),f=new Dr("float r4 0.4",!0),m=new Dr("float v4 0.046",!0),g=new Dr("float m4 2.0",!0),v=new Dr("float r5 0.305",!0),y=new Dr("float v5 0.016",!0),w=new Dr("float m5 3.0",!0),b=new Dr("float r6 0.21",!0),E=new Dr("float v6 0.0038",!0),_=new Dr("float m6 4.0",!0),C=[l,c,u,h,d,p,f,m,g,v,y,w,b,E,_],x=new Xe(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,C);return{bilinearCubeUV:o,roughnessToMip:x,m0:u,cubeUV_maxMipLevel:t}}();var $f=class extends zr{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??$f.VIEW}getShared(){return this.scope===$f.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case $f.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case $f.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case $f.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},na=$f;na.LOCAL="local",na.WORLD="world",na.VIEW="view",na.NORMAL="normal";ea.addKeyword("viewNormal",function(){return new na(na.VIEW)});ea.addKeyword("localNormal",function(){return new na(na.NORMAL)});ea.addKeyword("worldNormal",function(){return new na(na.WORLD)});var xc=class extends zr{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??xc.LOCAL}getType(){switch(this.scope){case xc.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case xc.LOCAL:case xc.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case xc.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case xc.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case xc.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case xc.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Io=xc;Io.LOCAL="local",Io.WORLD="world",Io.VIEW="view",Io.PROJECTION="projection";ea.addKeyword("position",function(){return new Io});ea.addKeyword("worldPosition",function(){return new Io(Io.WORLD)});ea.addKeyword("viewPosition",function(){return new Io(Io.VIEW)});var fl=class extends zr{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??fl.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case fl.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case fl.VECTOR:{let n=new na(na.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new Io(Io.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case fl.CUBE:{let n=new fl(fl.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case fl.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new fl(fl.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},Bm=fl;Bm.CUBE="cube",Bm.SPHERE="sphere",Bm.VECTOR="vector";var Fbe=class extends zr{constructor(e=new Oc,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new wI(this.value,t??new Bm(Bm.VECTOR),r),this.irradianceNode=new wI(this.value,new na(na.WORLD),new it(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Ube=class extends ua{constructor(e=new h3,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new Bm,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new Ml(new Wr("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},jbe=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Vbe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,Hbe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,Wbe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,Gbe=`
layout(location = 1) out vec4 gVelocity;
`,qbe=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,rj=["x","y","z","w"],Ybe=["float","vec2","vec3","vec4"],Xbe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},$be={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Pq=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(jbe),this.addFragmentParsCode(Vbe),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(Hbe),this.addFragmentFinalCode(Wbe)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:r+=t+" "+c+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof sn?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new JU({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new JU({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var s;let i;if(e=typeof e=="string"?ea.get(e):e,this.context.include===!1)return e.name;e instanceof Xe?i=this.includes.functions:e instanceof Dr?i=this.includes.consts:e instanceof Aq&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof Xe&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return r&&(a.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return Ybe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case fp:case mp:return new Ube(r);case Iw:return new Fbe(new Oc(r));default:return new Oc(r)}else{if(r.isVector2)return new zn(r);if(r.isVector3)return new Va(r);if(r.isVector4)return new Tc(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return Xbe[e]||e}getFormatByType(e){return $be[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return rj[e]}getIndexByElement(e){return rj.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Ho,t===Ho&&this.context.gamma&&(t=jt),t}},Ei=class extends ua{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof qn?e:new qn(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},Fr=class extends ua{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},ks=class extends ua{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},_d=class extends ua{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},ck=class extends ua{},Qbe=class extends ck{constructor(e){super("v3"),this.image=e,this._value=new R}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},xI=class extends ck{constructor(e,t,r=1008,i=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=r,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},Dq=class extends ua{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new ln}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},Yl=class extends ua{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new Be}generateReadonly(e,t,r,i,n,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function ij(e,t,r,i=0){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0).premultiply(new ln().makeRotation(i*rt.DEG2RAD))}var Kbe=class extends Dq{constructor(e,t,r=0){super(new ln),this.repeat=e,this.offset=t,this.rotation=r,ij(this.value,e,t,r)}updateMatrix(){ij(this.value,this.repeat,this.offset,this.rotation)}},Sd=class extends ua{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof It?new Array(e).fill(t):new Array(e).fill(new It(0))}},nj=class extends zr{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Iq=class extends zr{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(Iq.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},bI=Iq;bI.Nodes=function(){return{customColor:new Xe(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var Oq=class extends zr{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(Oq.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Rq=Oq;Rq.Nodes=function(){return{customNormal:new Xe(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Dy=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(Dy.Nodes.cylindrical);break;case 2:i=e.include(Dy.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new Xe(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(o);break;case 4:i=e.include(Dy.Nodes.triplanar);break;default:i=e.include(Dy.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${r}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(a),n.push(o),n.push(l),n.push(c)}else{let s=`${r}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},uk=Dy;uk.Nodes=function(){let e=new Xe(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new Xe(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new Xe(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new Xe(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var Iy=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=h,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new Xe(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Iy.Nodes.vectorLinearWorldSpaceDepth,Iy.Nodes.vectorLinearObjectSpaceDepth,Iy.Nodes.vectorSphericalObjectSpaceDepth,Iy.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},kq=Iy;kq.Nodes=function(){let e=new Xe(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new Xe(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new Xe(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new Xe(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var Zbe=class extends zr{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new Xe(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Lq=class extends zr{constructor(e,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(Lq.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Nq=Lq;Nq.Nodes=function(){return{gradient:new Xe(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var zq=class extends zr{constructor(e,t,r,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=n}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(zq.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Bq=zq;Bq.Nodes=function(){return{matcap:new Xe(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var hk=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(hk||{}),Zs=function(){let e=new Xe(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new Xe(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Dr("float F3 0.3333333"),t.keywords.G3=new Dr("float G3 0.1666667");let r=new Xe(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new Xe("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new Xe("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new Xe(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),a=new Xe("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new Xe("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new Xe(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),c=new Xe(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Dr("int NUM_OCTAVES 5");let u=new Xe("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new Xe(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,u]),d=new Xe(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new Xe(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new Xe(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new Xe(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new Xe(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),v=new Xe(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new Xe(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,p,f,m,g,v]);return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:c,perlin:h,voronoi:y}}(),Fq=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(hk)[this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new Xe(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Zs.simplex,Zs.simplexFractal,Zs.simplexAshima,Zs.fbm,Zs.perlin,Zs.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};Fq.numOctaves=5;var Uq=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(Uq.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},jq=Uq;jq.Nodes=function(){let e=new Xe(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Xe(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var bc=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new Xe(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new Xe(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let u=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let o=new Xe(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,bc.DrawFunctions.circle,bc.DrawFunctions.ring,bc.DrawFunctions.polygon,bc.DrawFunctions.cross,bc.DrawFunctions.diamond,bc.DrawFunctions.checkerboard,bc.DrawFunctions.line,bc.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},Vq=bc;Vq.DrawFunctions=function(){let e=new Xe(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new Xe(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new Xe(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new Xe(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new Xe(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new Xe(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new Xe(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new Xe(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new Xe(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new Xe(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var Hq=class extends zr{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(Hq.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Wq=Hq;Wq.Nodes=function(){let e=new Xe(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Zs.simplex]);return{rainbow:new Xe(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var Gq=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(Gq.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},qq=Gq;qq.Nodes=function(){let e=new Xe(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new Xe(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new Xe(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new Xe(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new Xe(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new Xe(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Zs.simplex,e,r,n])}}();var Jbe=function(){return{textureBicubic:new Xe(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function e_e(e,t){return e>=t?new re(t/e,1):new re(1,e/t)}var Yq=class extends zr{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,St.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(Yq.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Xq=Yq;Xq.Nodes=function(){let e=new Xe(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new Xe(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new Xe(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new Xe(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[Jbe.textureBicubic,r,e]),n=new Xe(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new Xe(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var _I=(e=>(e.NOISE="noise",e.MAP="map",e))(_I||{}),$q=class extends zr{constructor(e,t,r,i,n,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new Fr(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(_I)[this.displacementTypeIndex.value]==="map"&&(this.mat=new Dq(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=i,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(_I)[this.displacementTypeIndex.value]){case"map":{r=e.include($q.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(hk)[this.noiseFunctionIndex.value],s=new Xe(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new Xe(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[Zs.simplex,Zs.simplexFractal,Zs.simplexAshima,Zs.fbm,Zs.perlin,Zs.voronoi]),l=new Xe(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Qq=$q;Qq.Nodes=function(){let e=new Xe(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new Xe(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Xe(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var St={normalRenderTarget:new Oc,normalRenderTargetDepth:new Oc,transmissionRenderTarget:new Oc,aspectRatio:new zn,transmissionSize:new zn(2048,2048),transmissionRenderTargetDepth:new Oc,aoRenderTarget:new Oc,aoEnabled:new ks,pixelRatioNode:new it(1),resolution:new zn,penumbraSize:new _d(5,.5),frameIndex:new Fr(0),transmissionLod:new Fr(2)};for(let e of Object.values(St))e.isRenderGlobal=!0;var Kq={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.7.2/build/ui.wasm"},dk=class extends sn{constructor(){super("basic"),this.nodeType="Basic",this.color=new Ei(Ma),this.shadingAlpha=new it(1),this.shadingBlend=new Fr(0),this.previousModelViewMatrix=new Yl,this.previouseProjectionMatrix=new Yl}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({resolution:St.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qg.merge([qe.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Ei(Ma)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",r.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${r.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},t_e=class extends sn{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Ei(Ma),this.emissive=new Ei(0),this.emissiveIntensity=new it(1),this.previousModelViewMatrix=new Yl,this.previouseProjectionMatrix=new Yl,this.shadingAlpha=new it(1),this.shadingBlend=new Fr(0),this.occlusion=new ks(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({resolution:St.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qg.merge([qe.fog,qe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:St.penumbraSize}),e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({aoMap:St.aoRenderTarget}),e.mergeUniform({aoEnabled:St.aoEnabled}),this.color===void 0&&(this.color=new Ei(Ma)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&h.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},wg=function(){let e=new Xe(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new Xe(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),r_e=class extends sn{constructor(){super("phong"),this.nodeType="Phong",this.color=new Ei(Ma),this.specular=new Ei(1118481),this.shininess=new it(30),this.previousModelViewMatrix=new Yl,this.previouseProjectionMatrix=new Yl,this.shadingAlpha=new it(1),this.shadingBlend=new Fr(0),this.occlusion=new ks(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({resolution:St.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qg.merge([qe.fog,qe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:St.penumbraSize}),e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({aoMap:St.aoRenderTarget}),e.mergeUniform({aoEnabled:St.aoEnabled}),this.color===void 0&&(this.color=new Ei(Ma)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(wg.dHdxy),e.include(wg.perturbNormalArb);let p=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${g}
					`)}h.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},i_e=class extends sn{constructor(){super("standard"),this.nodeType="Standard",this.color=new Ei(Ma),this.roughness=new it(.3),this.metalness=new it(0),this.reflectivity=new it(.5),this.previousModelViewMatrix=new Yl,this.previouseProjectionMatrix=new Yl,this.shadingAlpha=new it(1),this.shadingBlend=new Fr(0),this.occlusion=new ks(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({resolution:St.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qg.merge([qe.fog,qe.lights])),qe.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:St.penumbraSize}),e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({aoMap:St.aoRenderTarget}),e.mergeUniform({aoEnabled:St.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new Ei(Ma)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(wg.dHdxy),e.include(wg.perturbNormalArb);let m=this.bumpMap.texture.flow(e,"t"),g=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${y}
					`)}if(p.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(e,"t"),g=this.roughnessMap.flow(e,"v3"),v="";this.roughnessMap.projection.value===4?v=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:v=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${v}
				`)}else p.push(s.code,"	float roughnessFactor = "+s.result+";");u&&p.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&p.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push(`gl_FragColor.a *= ${h.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join(`
`)}return t}},n_e=class extends sn{constructor(){super("toon"),this.nodeType="Toon",this.color=new Ei(Ma),this.specular=new Ei(1118481),this.shininess=new it(30),this.previousModelViewMatrix=new Yl,this.previouseProjectionMatrix=new Yl,this.shadingAlpha=new it(1),this.shadingBlend=new Fr(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({resolution:St.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qg.merge([qe.fog,qe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:St.penumbraSize}),e.mergeUniform({frameIndex:St.frameIndex}),e.mergeUniform({aoMap:St.aoRenderTarget}),e.mergeUniform({aoEnabled:St.aoEnabled}),this.color===void 0&&(this.color=new Ei(Ma)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(wg.dHdxy),e.include(wg.perturbNormalArb);let d=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}u.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${a.result} );
				}
				`),o&&u.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},s_e=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},a_e=class extends s_e{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},EM;function o_e(e){return typeof e=="string"?e:(EM||(EM=new a_e),EM.load(e))}var l_e=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},c_e=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},Zq=class extends l_e{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let i of Object.values(this._cache))for(let n of Object.values(i))for(let s of Object.values(n))s&&(s.image=this.img,s.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=s=>{var a;i=(a=s.target)==null?void 0:a.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=o_e(e),this.img.onload=t}getTexture(e,t=1008,r=1006){var n,s;let i=(s=(n=this._cache[e])==null?void 0:n[t])==null?void 0:s[r];if(i)return i;{let a;return this.isBuffer?a=this.img.texture:this.isVideo?a=new Kce(this.img,void 0,e,e):a=new pi(this.img,void 0,e,e,r,t),this.loaded&&(a.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][r]=a,a}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))for(let i of Object.values(r))i&&(i.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,i]of Object.entries(t))for(let[n,s]of Object.entries(i))s==null||s.dispose(),this._cache[e]!==void 0&&this._cache[e][r]!==void 0&&(this._cache[e][r][n]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},Zu=class extends Zq{};function u_e(e,t){var r=f_e(t);return r.formatToParts?d_e(r,e):p_e(r,e)}var h_e={year:0,month:1,day:2,hour:3,minute:4,second:5};function d_e(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var s=h_e[r[n].type];s>=0&&(i[s]=parseInt(r[n].value,10))}return i}catch(a){if(a instanceof RangeError)return[NaN];throw a}}function p_e(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var TM={};function f_e(e){if(!TM[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";TM[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return TM[e]}function Jq(e,t,r,i,n,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,r),o.setUTCHours(i,n,s,a),o}var sj=36e5,m_e=6e4,CM={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function eY(e,t,r){var i,n;if(!e||(i=CM.timezoneZ.exec(e),i))return 0;var s;if(i=CM.timezoneHH.exec(e),i)return s=parseInt(i[1],10),aj(s)?-(s*sj):NaN;if(i=CM.timezoneHHMM.exec(e),i){s=parseInt(i[1],10);var a=parseInt(i[2],10);return aj(s,a)?(n=Math.abs(s)*sj+a*m_e,s>0?-n:n):NaN}if(y_e(e)){t=new Date(t||Date.now());var o=r?t:g_e(t),l=SI(o,e),c=r?l:v_e(t,l,e);return-c}return NaN}function g_e(e){return Jq(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function SI(e,t){var r=u_e(e,t),i=Jq(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),s=n%1e3;return n-=s>=0?s:1e3+s,i-n}function v_e(e,t,r){var i=e.getTime(),n=i-t,s=SI(new Date(n),r);if(t===s)return t;n-=s-t;var a=SI(new Date(n),r);return s===a?s:Math.max(s,a)}function aj(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var oj={};function y_e(e){if(oj[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),oj[e]=!0,!0}catch{return!1}}var w_e=vu(Bie(),1),lj=vu(Fie(),1),x_e=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,b_e=x_e,AM=36e5,cj=6e4,__e=2,Ls={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:b_e};function S_e(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r=t||{},i=r.additionalDigits==null?__e:(0,w_e.default)(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=E_e(e),s=T_e(n.date,i),a=s.year,o=s.restDateString,l=C_e(o,a);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),u=0,h;if(n.time&&(u=A_e(n.time),isNaN(u)))return new Date(NaN);if(n.timeZone||r.timeZone){if(h=eY(n.timeZone||r.timeZone,new Date(c+u)),isNaN(h))return new Date(NaN)}else h=(0,lj.default)(new Date(c+u)),h=(0,lj.default)(new Date(c+u+h));return new Date(c+u+h)}else return new Date(NaN)}function E_e(e){var t={},r=Ls.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=Ls.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=Ls.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function T_e(e,t){var r=Ls.YYY[t],i=Ls.YYYYY[t],n;if(n=Ls.YYYY.exec(e)||i.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=Ls.YY.exec(e)||r.exec(e),n){var a=n[1];return{year:parseInt(a,10)*100,restDateString:e.slice(a.length)}}return{year:null}}function C_e(e,t){if(t===null)return null;var r,i,n,s;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=Ls.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,hj(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=Ls.DDD.exec(e),r){i=new Date(0);var a=parseInt(r[1],10);return D_e(t,a)?(i.setUTCFullYear(t,0,a),i):new Date(NaN)}if(r=Ls.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return hj(t,n,o)?(i.setUTCFullYear(t,n,o),i):new Date(NaN)}if(r=Ls.Www.exec(e),r)return s=parseInt(r[1],10)-1,dj(t,s)?uj(t,s):new Date(NaN);if(r=Ls.WwwD.exec(e),r){s=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return dj(t,s,l)?uj(t,s,l):new Date(NaN)}return null}function A_e(e){var t,r,i;if(t=Ls.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),MM(r)?r%24*AM:NaN;if(t=Ls.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),MM(r,i)?r%24*AM+i*cj:NaN;if(t=Ls.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return MM(r,i,n)?r%24*AM+i*cj+n*1e3:NaN}return null}function uj(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,s=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+s),i}var M_e=[31,28,31,30,31,30,31,31,30,31,30,31],P_e=[31,29,31,30,31,30,31,31,30,31,30,31];function tY(e){return e%400===0||e%4===0&&e%100!==0}function hj(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=tY(e);if(i&&r>P_e[t]||!i&&r>M_e[t])return!1}return!0}function D_e(e,t){if(t<1)return!1;var r=tY(e);return!(r&&t>366||!r&&t>365)}function dj(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function MM(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function I_e(e,t,r){var i=S_e(e,r),n=eY(t,i,!0),s=new Date(i.getTime()-n),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}function Ns(e,t){return t.color(e)}function pj(e=new Date,t){let r=t.format,i=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=I_e(new Date,t.timeZone));let s=n.getHours(),a=n.getMinutes(),o;t.format12h24h==="12ampm"&&(o=s>=12?"PM":"AM");let l=s;t.format12h24h!=="24"&&(l=s%12,l===0&&(l=12));let c,u;switch(r){case"HH:mm:ss":c=[l,a,i];break;case"HH:mm":c=[l,a];break;case"HH":c=[l],o=void 0;break;case"mm":c=[a],o=void 0;break;case"ss":c=[i],o=void 0;break;case"year":u=n.getFullYear();break;case"month":u=n.getMonth()+1;break;case"dayOfYear":u=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":u=n.getDate();break;case"secondOfDay":u=s*60*60+a*60+i;break;default:console.error("Unknown time format",r),u=0;break}return c!==void 0?{textValue:c,suffix:o}:u}function O_e(e,t){switch(e.type){case"fresnel":return L_e(e,t);case"gradient":return N_e(e,t);case"depth":return z_e(e,t);case"normal":return B_e(e,t);case"noise":return F_e(e,t);case"rainbow":return U_e(e,t);case"toon":return j_e(e,t);case"outline":return V_e(e,t);case"transmission":return H_e(e,t);case"color":return k_e(e,t);case"pattern":return W_e(e,t)}}function R_e(e){return{type:e.type}}function Qo(e,t){let{alpha:r,mode:i,isMask:n}=e,s=typeof r=="string"?(Number(t.getVariable(r))??100)/100:r;return{...R_e(e),alpha:s,mode:i,isMask:n}}function k_e(e,t){return{...Qo(e,t),color:Ns(e.color,t)}}function L_e(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a}=e;return{...Qo(e,t),color:Ns(a,t),bias:r,scale:i,intensity:n,factor:s}}function N_e(e,t){let{gradientType:r,smooth:i,colors:n,steps:s,angle:a,offset:o,morph:l}=e;return{...Qo(e,t),gradientType:r,smooth:i,colors:n.map(c=>new It(c[0],c[1],c[2],c[3])),num:n.length,steps:s,offset:new re(...o),morph:new re(...l),angle:a}}function z_e(e,t){let{gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:c,steps:u,smooth:h}=e;return{...Qo(e,t),gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:new R(...o),direction:l?new R(...l):new R(1,0,0),colors:c.map(d=>d!==void 0?new It(d[0],d[1],d[2],d[3]):new It(0,0,0,0)),steps:u.slice(0,c.length),smooth:h}}function B_e(e,t){let{cnormal:r}=e;return{...Qo(e,t),cnormal:new R(r[0],r[1],r[2])}}function F_e(e,t){return{...Qo(e,t),scale:e.scale,move:e.move,fA:new re(...e.fA),fB:new re(...e.fB),size:new R(...e.size),distortion:new re(...e.distortion),colorA:Ns(e.colorA,t),colorB:Ns(e.colorB,t),colorC:Ns(e.colorC,t),colorD:Ns(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function U_e(e,t){return{...Qo(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new R(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new R(...e.offset)}}function j_e(e,t){return{...Qo(e,t),positioning:e.positioning,colors:e.colors.map(r=>new It(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new R(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:Ns(e.shadowColor,t),offset:new R(...e.offset)}}function V_e(e,t){return{...Qo(e,t),outlineColor:Ns(e.outlineColor,t),contourColor:Ns(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new R(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function H_e(e,t){return{...Qo(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function W_e(e,t){return{...Qo(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new re(...e.offset),colorA:Ns(e.colorA,t),colorB:Ns(e.colorB,t),frequency:new re(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new re(...e.vertical),horizontal:new re(...e.horizontal),sides:e.sides}}var US=class extends qn{},G_e={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},q_e={depth:["colors"]};function Y_e(e,t,r){var s,a;if(t==="isMask")return!0;let i=G_e[e.type],n=q_e[e.type];if(n!==void 0){let o=e.color;if(n.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function rY(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=i;l.image instanceof Zu||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=i;l.image instanceof Zu||l.image.deref(),l.image=o}if("wrapping"in s){let a=i;a.wrap=s.wrapping}if("minFilter"in s){let a=i;a.minFilter=s.minFilter}if("magFilter"in s){let a=i;a.magFilter=s.magFilter}if("rotation"in s&&r.uniforms[`f${r.id}_rotation`])return r.uniforms[`f${r.id}_rotation`].value=(s.rotation??0)*rt.DEG2RAD,n;if("repeat"in s||"offset"in s||"rotation"in s){let a="mat",o=r.uniforms[`f${r.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),"rotation"in s&&(o.rotation=s.rotation??0),o.updateMatrix()}return n}function X_e(e,t,r,i){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(nY(s,r,i,t)){s==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let o=r.uniforms[`f${r.id}_${s}`];if(o&&!(o instanceof ck))switch(n=n||Y_e(r,s,a),o.constructor){case Ei:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof US?o.value=new qn(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case Tc:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof US?o.value=new qn(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case zn:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case Va:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case Oc:{rY(a,t,r);break}case Sd:{o.value=a.map(l=>new It(...l));break}default:{o.value=a;break}}}return n}var xp=(e,t,r)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,r)??100)/100))??1,Uw=class{constructor(e,t,r,i,n){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let s in i)this.uniforms[`f${this.id}_${s}`]=i[s];for(let s in r)nY(s,this,r,n)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return vl.createLigherLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.uiBuffer(r.texture.image)??i.image(r.texture.image):i.video(r.texture.video),s=new xI(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),a=new Qbe(n),o=new Kbe(r.texture.repeat,r.texture.offset,r.texture.rotation??0),l=new it(r.crop?1:0),c=new Fr(r.projection??0),u=new Fr(["x","y","z"].indexOf(r.axis)??0),h=new Fr(r.side??0),d=new zn(r.size?new re(r.size[0],r.size[1]):new re(100,100)),p=new it(r.blending??0),f=new it(xp(r.alpha,i)),m=new Fr(r.mode??0),g=new ks(r.isMask??!1),v=new uk(s,a,l,c,u,h,d,p,o,f,m,g),y=new Wr(v.calpha,"f");return new xi(e,t,r,{texture:s,textureSize:a,crop:l,projection:c,axis:u,side:h,size:d,blending:p,mat:o,alpha:f,mode:m,isMask:g},v,m,y,g,i)}else if(r.type==="matcap"){let n=i.image(r.texture.image),s=new xI(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),a=new it(xp(r.alpha,i)),o=new Fr(r.mode??0),l=new ks(r.isMask??!1),c=new it(r.texture.rotation??0),u=new Bq(s,a,o,l,c),h=new Wr(u.calpha,"f");return new xi(e,t,r,{texture:s,alpha:a,mode:o,isMask:l,rotation:c},u,o,h,l,i)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new Va(new R(...r.offset)),s=new it(r.scale??10),a=new it(r.intensity??8),o=new it(r.movement??1),l=new Fr(r.noiseType??0),c=new Fr(r.voronoiStyle??0),u=new it(r.smoothness??.5),h=new it(r.seed??0),d=new it(r.highCut??1),p=new it(r.lowCut??0),f=new Fr(r.quality??1),m=new Qq(a,o,n,c,u,h,d,p,f,s,l);return new iY(e,t,r,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:h,highCut:d,lowCut:p,quality:f},m,i)}else throw new Error;else return K_e(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):X_e(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?rY(i.props,r.shared,this):!0;return!1}dispose(){if($_e(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof Zu||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},xi=class extends Uw{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,l),this.params=i,this.color=n,this.mode=s,this.alpha=a,this.isMask=o}},iY=class extends Uw{constructor(e,t,r,i,n,s){super(e,t,r,i,s),this.position=n}},vl=class extends Uw{constructor(e,t,r,i,n,s){super(e,t,r,n,s),this.node=i}static createLigherLayer(e,t,r,i){let n,s=new it(xp(r.alpha,i)),a=new Fr(r.mode),o=new it(r.bumpMapIntensity),l=new it(xp(r.alphaOverride,i)),c;if(!r.visible)n=new dk,c={};else if(r.category==="lambert"){n=new t_e;let u=new Ei(i.color(r.emissive)??0),h=new ks(r.occlusion??!0);c={emissive:u,occlusion:h},n.emissive=u,n.occlusion=h}else if(r.category==="toon"){n=new n_e;let u=new it(r.shininess??30),h=new Ei(i.color(r.specular)??1118481);c={shininess:u,specular:h},n.shininess=u,n.specular=h}else if(r.category==="physical"){n=new i_e;let u=new it(r.roughness??.3),h=new it(r.metalness??0),d=new it(r.reflectivity??.5),p=new ks(r.occlusion??!0);c={roughness:u,metalness:h,reflectivity:d,occlusion:p},n.roughness=u,n.metalness=h,n.reflectivity=d,n.occlusion=p}else{n=new r_e;let u=new it(r.shininess??30),h=new Ei(r.specular!==void 0?i.color(r.specular)??1118481:1118481),d=new ks(r.occlusion??!0);c={shininess:u,specular:h,occlusion:d},n.shininess=u,n.specular=h,n.occlusion=d}return n.alpha=new it(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new vl(e,t,r,n,c,i)}get category(){return this.node.category}};function $_e(e){let t=e instanceof Uw?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function Ba(e){return{alpha:new it(e.alpha??1),mode:new Fr(e.mode??0),isMask:new ks(e.isMask??!1)}}function Q_e(e,t,r,i,n){switch(e.type){case"color":{let s=new Ei(i.color??Ma),a=Ba(i),o=new bI(s,a.alpha),l=new Wr(o.calpha,"f");return new xi(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}case"fresnel":{let s=new Ei(i.color??16777215),a=new it(i.bias??.1),o=new it(i.scale??1),l=new it(i.intensity??2),c=new it(i.factor??1),u=Ba(i),h=new Zbe(s,a,o,l,c,u.alpha,u.mode,u.isMask),d=new Wr(h.calpha,"f");return new xi(t,r,e,{color:s,bias:a,scale:o,intensity:l,factor:c,...u},h,u.mode,d,u.isMask,n)}case"rainbow":{let s=new it(i.filmThickness??30),a=new it(i.movement??0),o=new Va(i.wavelengths??new R(0,0,0)),l=new it(i.noiseStrength??0),c=new it(i.noiseScale??1),u=new Va(i.offset??new R(0,0,0)),h=Ba(i),d=new Wq(s,a,o,l,c,u,h.alpha,h.isMask),p=new Wr(d.calpha,"f");return new xi(t,r,e,{filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:c,offset:u,...h},d,h.mode,p,h.isMask,n)}case"transmission":{let s=new it(i.thickness??10),a=new it(i.ior??1.5),o=new it(i.roughness??.5),l=St.transmissionSize,c=St.transmissionRenderTarget,u=St.transmissionRenderTargetDepth,h=window.innerWidth,d=window.innerHeight,p=h>=d?new zn(d/h,1):new zn(1,h/d),f=Ba(i),m=new Xq(s,a,o,l,c,u,p,f.alpha),g=new Wr(m.calpha,"f");return new xi(t,r,e,{thickness:s,ior:a,roughness:o,aspectRatio:p,...f},m,f.mode,g,f.isMask,n)}case"toon":{let s=new Fr(i.positioning??0),a;i.colors?a=new Sd(i.colors.length,i.colors):(a=new Sd(10,new It(0,0,0,1)),a.value[1]=new It(1,1,1,1));let o;i.steps?o=new _d(i.steps.length,i.steps):(o=new _d(10,1),o.value[0]=0);let l=new Va(i.source??new R(0,0,0)),c=new ks(i.isWorldSpace??!0),u=new it(i.noiseStrength??0),h=new it(i.noiseScale??1),d=new Tc(i.shadowColor),p=new Va(i.offset??new R(0,0,0)),f=Ba(i),m=new qq(s,a,o,l,c,u,h,d,p,f.alpha),g=new Wr(m.calpha,"f");return new xi(t,r,e,{positioning:s,colors:a,steps:o,source:l,isWorldSpace:c,noiseStrength:u,noiseScale:h,shadowColor:d,offset:p,...f},m,f.mode,g,f.isMask,n)}case"outline":{let s=new Ei(i.outlineColor??16777215),a=new Ei(i.contourColor??16777215),o=new it(i.outlineWidth??.1),l=new it(i.contourWidth??.1),c=new it(i.outlineThreshold??.1),u=new it(i.contourThreshold??.1),h=new it(i.outlineSmoothing??.1),d=new it(i.contourFrequency??.1),p=new Va(i.contourDirection??new R(0,1,0)),f=new ks(i.positionalLines??!1),m=new ks(i.compensation??!0),g=St.normalRenderTarget,v=St.normalRenderTargetDepth,y=St.pixelRatioNode,w=St.resolution,b=Ba(i),E=new jq(s,a,o,l,c,u,h,d,p,f,m,w,g,v,y,b.alpha),_=new Wr(E.calpha,"f");return new xi(t,r,e,{outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:c,contourThreshold:u,outlineSmoothing:h,contourFrequency:d,contourDirection:p,positionalLines:f,compensation:m,...b},E,b.mode,_,b.isMask,n)}case"depth":{let s=new Fr(i.gradientType??0),a=new ks(i.smooth??!1),o=new it(i.near??50),l=new it(i.far??200),c=new it(i.isVector??1),u=new it(i.isWorldSpace??0),h=new Va(i.origin??new R),d=new Va(i.direction??new R),p;i.colors?p=new Sd(i.colors.length,i.colors):(p=new Sd(2,new It(0,0,0,1)),p.value[1]=new It(1,1,1,1));let f;i.steps?f=new _d(i.steps.length,i.steps):(f=new _d(2,1),f.value[0]=0);let m=Ba(i),g=new kq(s,a,o,l,c,u,h,d,p,f,m.alpha,m.isMask),v=new Wr(g.calpha,"f");return new xi(t,r,e,{gradientType:s,smooth:a,near:o,far:l,isVector:c,isWorldSpace:u,origin:h,direction:d,colors:p,steps:f,...m},g,m.mode,v,m.isMask,n)}case"noise":{let s=new it(i.scale??1),a=new Va(i.size??new R(100,100,100)),o=new it(i.move??1),l=new zn(i.fA??new re(1.7,9.2)),c=new zn(i.fB??new re(8.3,2.8)),u=new zn(i.distortion??new re(1,1)),h=new Tc(i.colorA),d=new Tc(i.colorB),p=new Tc(i.colorC),f=new Tc(i.colorD),m=new Fr(i.noiseType??0),g=new Fr(i.voronoiStyle??0),v=new it(i.highCut??1),y=new it(i.lowCut??0),w=new it(i.smoothness??.5),b=new it(i.seed??.5),E=new Fr(i.quality??1),_=Ba(i),C=new Fq(s,a,o,l,c,u,h,d,p,f,_.alpha,m,_.isMask,g,v,y,w,b,E),x=new Wr(C.calpha,"f");return new xi(t,r,e,{scale:s,size:a,move:o,fA:l,fB:c,distortion:u,colorA:h,colorB:d,colorC:p,colorD:f,noiseType:m,..._,voronoiStyle:g,highCut:v,lowCut:y,smoothness:w,seed:b,quality:E},C,_.mode,x,_.isMask,n)}case"normal":{let s=new Va(i.cnormal??new R(1,1,1)),a=Ba(i),o=new Rq(s,a.alpha),l=new Wr(o.calpha,"f");return new xi(t,r,e,{cnormal:s,...a},o,a.mode,l,a.isMask,n)}case"gradient":{let s=new Fr(i.gradientType??0),a=new ks(i.smooth??!1),o;i.colors?o=new Sd(i.colors.length,i.colors):(o=new Sd(10,new It(0,0,0,1)),o.value[1]=new It(1,1,1,1));let l;i.steps?l=new _d(i.steps.length,i.steps):(l=new _d(10,1),l.value[0]=0);let c=new zn(i.offset??new re(0,0)),u=new zn(i.morph??new re(0,0)),h=new it(i.angle??0),d=Ba(i),p=new Nq(s,a,o,l,c,u,h,d.alpha,d.isMask),f=new Wr(p.calpha,"f");return new xi(t,r,e,{gradientType:s,smooth:a,colors:o,steps:l,offset:c,morph:u,angle:h,...d},p,d.mode,f,d.isMask,n)}case"pattern":{let s=new Fr(i.style??0),a=new Fr(i.projection??0),o=new Fr(["x","y","z"].indexOf(i.axis)??0),l=new it(i.blending??0),c=new zn(i.offset??new re(0,0)),u=new Tc(i.colorA),h=new Tc(i.colorB),d=new zn(i.frequency??new re(10,10)),p=new it(i.size??.5),f=new it(i.variation??0),m=new it(i.smoothness??.5),g=new it(i.zigzag??0),v=new it(i.rotation??0),y=new zn(i.vertical??new re(0,1)),w=new zn(i.horizontal??new re(0,1)),b=new Fr(i.sides??6),E=Ba(i),_=new Vq(s,a,o,l,c,u,h,d,p,f,m,g,v,y,w,b,E.alpha,E.isMask),C=new Wr(_.calpha,"f");return new xi(t,r,e,{style:s,projection:a,axis:o,blending:l,offset:c,colorA:u,colorB:h,frequency:d,size:p,variation:f,smoothness:m,zigzag:g,rotation:v,vertical:y,horizontal:w,sides:b,...E},_,E.mode,C,E.isMask,n)}default:{let s=new Ei(1,0,0,1),a=Ba(i),o=new bI(s,a.alpha),l=new Wr(o.calpha,"f");return new xi(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}}}function K_e(e,t,r,i){let n=O_e(r,i);return Q_e(r,e,t,n,i)}function nY(e,t,r,i){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=r.intensity*(r.visible?1:0),n):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=xp(r.alpha,i)*(r.visible?1:0),r.type==="outline"&&e==="visible"){let s=t.uniforms[`f${t.id}_compensation`];s&&(s.value=r.compensation&&r.visible)}return n}}function wm(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i){let n=i.data,s=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?s/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(t.getVariable(s)??100)/100))),s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,u=Math.min(a,Math.min(o,Math.min(l,c)));u<1&&(s=u)}r+=(1-r)*s}}return r<1}var Hh=class extends yr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},Z_e=class extends Hh{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r){return this.root.getFlavor(e,t,r)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},pk=class extends Hh{constructor(e,t,r=!0){super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,sn.startContext(this),this.reset0(e,t),sn.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,r){let i=r?6:(e?3:0)+t;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let n=this.flavors[i];return n===void 0&&(n=new Z_e(e,t,r,this),n.needsJitter=this.needsJitter,this.flavors[i]=n,n.flatShading=e,n.side=t,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t,r=!1){sn.startContext(this),(this.data!==e||r)&&this.reset0(e,t),sn.endContext(this)}reset0(e,t){this.data=e;let r=e.layers??fs.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>Uw.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=wm(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if(e[0]==="alphaOverride")this.transparent=wm(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let i=e[1],n=e[2];if(i&&n){let s=this.layers.find(a=>a.uuid===i);s!=null&&s.hasValue(n)&&(n==="alpha"?(this.transparent=wm(this.data,r.shared),s.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):s.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(r=>r.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(r=>{"alpha"in r.data&&typeof r.data.alpha=="string"&&e.shared.getVariable(r.data.alpha,["material",this.uuid,"layer",r.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof vl),this.lightLayer===void 0&&(this.lightLayer=new vl(0,"",{...mn.defaultData("light","phong"),visible:!1},new dk,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(n=>n instanceof vl);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof xi&&s.color instanceof uk&&(s.uuid===r&&(e.node.bumpMap=s.color),s.uuid===i&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,r){if(sn.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=wm(t,r.shared),e.path[0]==="layers"){let i=r.shared,n=e.path[1];if(n===void 0)r.scene.markNeedsUpdateRendererDirty(),this.reset0(t,r);else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n),o;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?o={...e.props,alpha:xp(e.props.alpha,i,["material",this.uuid,"layer",n,"alpha"])}:o={...e.props,alphaOverride:xp(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...e,...o?{props:o}:{},path:e.path.slice(2)},a,r)&&this.reset0(t,r)}}}else this.reset0(t,r);sn.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof xi?t.color.mask=void 0:t instanceof vl&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof xi&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof vl?i.node.mask=new $s(t.color,t.alpha,$s.MUL):i instanceof xi&&(i.isMask.value||(i.color.mask=new $s(t.color,t.alpha,$s.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof xi),t=this.layers.findIndex(r=>r instanceof vl);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof xi){if(n.isMask.value)continue;r=new nj(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new Wr("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof vl);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof xi){if(i.isMask.value)continue;e=new nj(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof iY);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new $s(t,e[r].position,$s.ADD),t=new $s(t,new it(.5).setReadonly(!0),$s.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new Pq;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof xi){let t=e.params.texture;if(t instanceof xI&&!t.image.loaded)return!1}return!0}};Object.defineProperties(Hh.prototype,{properties:{get:function(){return this.fragment.properties}}});var EI=class extends pk{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},fj=new Map;function J_e(e){if(typeof e=="string")return e;let t=fj.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},fj.set(e,t)),t.url}var sY,eSe=new Promise(e=>{sY=e}),mj=!1,W1;function tSe(){if(mj)return;if(W1)return W1;async function e(){await id(()=>import("./howler-exr9gBVb.js").then(t=>t.h),[]),sY(window!==void 0?window:global),mj=!0}return W1=e(),W1}var aY;eSe.then(e=>aY=e);function rSe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events===void 0||Array.isArray(i.events)===!1)return!0;let n=[];i.events.forEach(s=>{"dragDropActions"in s.data?(n.push(...s.data.dragDropActions.drag),n.push(...s.data.dragDropActions.drop)):"inActions"in s.data?(n.push(...s.data.inActions),n.push(...s.data.outActions)):"gameActions"in s.data?(n.push(...s.data.gameActions.idle),n.push(...s.data.gameActions.move),n.push(...s.data.gameActions.jump),n.push(...s.data.gameActions.run)):"breakpoints"in s.data?s.data.breakpoints.forEach(a=>{n.push(...a.data.actions)}):"actions"in s.data&&n.push(...s.data.actions),t=t||n.some(a=>a.data.type==="Audio")})}),t}var Oy=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:J_e(e),format:"wav"},this.sound=new aY.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},iSe=class{constructor(){this.type="ShapePath",this.color=new bt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new tS,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var r;return(r=this.currentPath)==null||r.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(p,f,m,g){let v=p.x,y=f.x,w=m.x,b=g.x,E=p.y,_=f.y,C=m.y,x=g.y,A=(b-w)*(E-C)-(x-C)*(v-w),T=(y-v)*(E-C)-(_-E)*(v-w),M=(x-C)*(y-v)-(b-w)*(_-E),D=A/M,P=T/M;if(M===0&&A!==0||D<=0||D>=1||P<0||P>1)return null;if(A===0&&M===0){for(let I=0;I<2;I++)if(i(I===0?m:g,p,f),t.loc===e.ORIGIN){let B=I===0?m:g;return{x:B.x,y:B.y,t:t.t}}else if(t.loc===e.BETWEEN){let B=+(v+t.t*(y-v)).toPrecision(10),V=+(E+t.t*(_-E)).toPrecision(10);return{x:B,y:V,t:t.t}}return null}else{for(let V=0;V<2;V++)if(i(V===0?m:g,p,f),t.loc===e.ORIGIN){let N=V===0?m:g;return{x:N.x,y:N.y,t:t.t}}let I=+(v+D*(y-v)).toPrecision(10),B=+(E+D*(_-E)).toPrecision(10);return{x:I,y:B,t:D}}}function i(p,f,m){let g=m.x-f.x,v=m.y-f.y,y=p.x-f.x,w=p.y-f.y,b=g*w-y*v;if(p.x===f.x&&p.y===f.y){t.loc=e.ORIGIN,t.t=0;return}if(p.x===m.x&&p.y===m.y){t.loc=e.DESTINATION,t.t=1;return}if(b<-Number.EPSILON){t.loc=e.LEFT;return}if(b>Number.EPSILON){t.loc=e.RIGHT;return}if(g*y<0||v*w<0){t.loc=e.BEHIND;return}if(Math.sqrt(g*g+v*v)<Math.sqrt(y*y+w*w)){t.loc=e.BEYOND;return}let E;g!==0?E=y/g:E=w/v,t.loc=e.BETWEEN,t.t=E}function n(p,f){let m=[],g=[];for(let v=1;v<p.length;v++){let y=p[v-1],w=p[v];for(let b=1;b<f.length;b++){let E=f[b-1],_=f[b],C=r(y,w,E,_);C!==null&&m.find(x=>x.t<=C.t+Number.EPSILON&&x.t>=C.t-Number.EPSILON)===void 0&&(m.push(C),g.push(new re(C.x,C.y)))}}return g}function s(p,f,m){let g=new re;f.getCenter(g);let v=[];return m.forEach(y=>{y.boundingBox.containsPoint(g)&&n(p,y.points).forEach(w=>{v.push({identifier:y.identifier,isCW:y.isCW,point:w})})}),v.sort((y,w)=>y.point.x-w.point.x),v}function a(p,f,m,g,v){(v==null||v==="")&&(v="nonzero");let y=new re;p.boundingBox.getCenter(y);let w=[new re(m,y.y),new re(g,y.y)],b=s(w,p.boundingBox,f);b.sort((T,M)=>T.point.x-M.point.x);let E=[],_=[];b.forEach(T=>{T.identifier===p.identifier?E.push(T):_.push(T)});let C=E[0].point.x,x=[],A=0;for(;A<_.length&&_[A].point.x<C;)x.length>0&&x[x.length-1]===_[A].identifier?x.pop():x.push(_[A].identifier),A++;if(x.push(p.identifier),v==="evenodd"){let T=x.length%2===0,M=x[x.length-2];return{identifier:p.identifier,isHole:T,for:M}}else if(v==="nonzero"){let T=!0,M=null,D=null;for(let P=0;P<x.length;P++){let I=x[P];f[I]&&(T?(D=f[I].isCW,T=!1,M=I):D!==f[I].isCW&&(D=f[I].isCW,T=!0))}return{identifier:p.identifier,isHole:T,for:M}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(p=>{let f=p.getPoints(),m=-999999999,g=999999999,v=-999999999,y=999999999;for(let w=0;w<f.length;w++){let b=f[w];b.y>m&&(m=b.y),b.y<g&&(g=b.y),b.x>v&&(v=b.x),b.x<y&&(y=b.x)}c<=v&&(c=v+1),l>=y&&(l=y-1),f.length&&u.push({curves:p.curves,points:f,isCW:h8.isClockWise(f),identifier:o++,boundingBox:new S8(new re(y,g),new re(v,m))})});let h=u.map(p=>{var f;return a(p,u,l,c,(f=this.userData)==null?void 0:f.style.fillRule)}),d=[];return u.forEach(p=>{let f=h[p.identifier];if(f&&!f.isHole){let m=new rS;m.curves=p.curves,h.filter(g=>(g==null?void 0:g.isHole)&&g.for===p.identifier).forEach(g=>{if(g){let v=u[g.identifier],y=new tS;y.curves=v.curves,m.holes.push(y)}}),d.push(m)}}),d}},oY=!1,lY,gj=new Promise(e=>{lY=e}),vj=!1,G1;function nSe(){if(oY=!0,vj)return;if(G1)return G1;async function e(){let t=await id(()=>import("./opentype-QeDitGAm.js"),[]);lY(t),vj=!0}return G1=e(),G1}var sSe=class{async load(e,t,r=()=>{}){let{load:i}=await gj;i(e,(n,s)=>{n||!s?r(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:r}=await gj;try{let i=t(e),n=new r,s=a=>i.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function aSe(e){return await(await fetch(e)).arrayBuffer()}var oSe=new sSe;async function yj(e){let t,r,i=!1;if(e.url?(t=await aSe(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(oY){let n=await oSe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}else return{font:void 0,url:r,intercepted:i,arr:t,bidi:null}}function lSe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var cSe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=yj(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=yj(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,s=[],a=0,o=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,u=String.fromCharCode(r[l].unicode),h=n[a];if(lSe(c,h)||o)s.push({char:u,index:c,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let d=h.char,p="",f=[h.state.glyphIndex],m=[],g=!1;for(;!g;)a++,p=t.charAt(a),d+=p,f.push(e.charToGlyphIndex(p)),m=e.stringToGlyphs(d),m.length===1&&m[0].index===c&&(g=!0),a>t.length&&(g=!0);s.push({char:u,index:c,replacements:f,replacementChars:Array.from(d)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let r=this.font,i=t.fontSize/this.unitsPerEm,n=t.fontSize*t.lineHeight,s=e.map(v=>this.getTextWidth(v,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,c=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),h=this.getLineInitialOffsetY(n,e.length,t.height,i,t.verticalAlign),d=[],p=e.map(v=>[]),f=e.map(v=>[]),m;for(let v=0;v<e.length;v++){let y=e[v],w={features:{liga:!0}},b=[];try{b=r.stringToGlyphs(y,w)}catch(_){console.warn(_)}u=this.getLineInitialOffsetX(s[v],a,t.horizontalAlign,y,o);let E=[];try{E=this.reverseLigaturesTable(r,y,b)}catch(_){console.warn(_)}c=this.computeSpaceWidthForLine(e,v,t);for(let _=0;_<b.length;_++){let C=b[_],x=C.index===0?`
`:C.unicode?String.fromCharCode(C.unicode):void 0,A=E[_],T=0,M=0;_===0&&t.horizontalAlign===2&&C.leftSideBearing!==void 0&&(M=-C.leftSideBearing*i),m&&(T=r.getKerningValue(C,m)*i),u+=M+T;let D=0;if(x===`
`)D=l;else if(x===" ")D=c;else{let P=this.createPath(C,i,u,h,t);P&&(D=P.offsetX-(T+M),d.push(P.path))}if(A.replacements.length===1)f[v].push([u,h]),p[v].push(D);else{let P=A.replacements.map(N=>(r.glyphs.get(N).advanceWidth??0)*i),I=P.reduce((N,L)=>N+=L,0),B=P.map(N=>N/I),V=u;for(let N=0;N<B.length;N++){let L=D*B[N];f[v].push([V,h]),p[v].push(L),V+=L}}u+=D,m=C}h-=n}let g=[];for(let v=0,y=d.length;v<y;v++)g.push(...d[v].toShapes());return{shapes:g,charWidths:p,lineWidths:s,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*i,o=e-a,l=-this.ascender*i-o/2;return n===3?-(r-s-l):n===2?-(r*.5-s*.5-l):l}createPath(e,t,r,i,n){var l;let s=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new iSe,o=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let u=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(u&&c.type!=="Z"&&u.x===c.x&&-u.y===c.y))switch(c.type){case"M":a.moveTo(c.x,-c.y);break;case"L":a.lineTo(c.x,-c.y);break;case"Q":a.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":a.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return a.subPaths.forEach(c=>{let u=uSe(c.curves);u!==void 0&&c.currentPoint.distanceTo(u)>0&&c.lineTo(u.x,u.y)}),{offsetX:o+n.fontSize*n.letterSpacing,path:a}}getCharWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var r;return((r=this.font)==null?void 0:r.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,r){let i=this.getCharWidth(" ",r),n=e[t];if(n){let s=this.countSpaces(n.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&s){let a=r.width,o=this.getTextWidth(n,r);return(a-(o-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};function uSe(e){if(e.length){let t=e[0];if(t instanceof No)return t.v1;if(t instanceof Do||t instanceof jh)return t.v0}}var hSe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t,r),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},wj=class extends hSe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let i=tw(e,t,this.flatShading,r);return i.computeBoundingSphere(),i}},dSe={markNeedsUpdateRendererDirty:()=>{}};function TI(e){return"variable_"+e}var pSe=class extends c_e{constructor(e){super(),this.shared=e}create(e){return new Zq(e,this.shared)}},fk=class{constructor(e,t={},r=!0,i=!1){if(this.data=e,this.needsJitter=r,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new wj(!0),this.geometryCache2=new wj(!1),this.imageHolderCache=new pSe(this),this.thisContext={scene:dSe,shared:this},this.deletedMaterial=new EI(fs.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new Zu(tI.emptyImage,this),this.deletedVideo=new Zu(SS.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[n,s]of Object.entries(t.images))this.addImage(n,s);if(t.videos)for(let[n,s]of Object.entries(t.videos))this.addVideo(n,s);if(t.audios)for(let[n,s]of Object.entries(t.audios))this.addAudio(n,s);if(t.particles)for(let[n,s]of Object.entries(t.particles))this.addParticle(n,s);this.reset(e)}setRequestRender(e){this._requestRender=e}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1){this.data=e,this.resetLib(e.lib);for(let{id:r,data:i}of e.variables)this.addVariableHolder(r,i),t&&this.updateVariableHolder(r,i);for(let[r,i]of Object.entries(e.images))this.addImage(r,i);for(let[r,i]of Object.entries(e.videos))this.addVideo(r,i);for(let[r,i]of Object.entries(e.colors))this.addColor(r,i);for(let[r,i]of Object.entries(e.materials))this.addMaterial(r,i);for(let[r,i]of Object.entries(e.audios))this.addAudio(r,i);for(let[r,i]of Object.entries(e.particles))this.addParticle(r,i);for(let[r,i]of Object.entries(e.fonts))this.addFont(r,i)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new EI(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new pk(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new Zu(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new Zu(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new Zu(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new US(t.r,t.g,t.b,t.a):this.colors[e]=new US(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new qn(0,0,0,0))}else return"a"in e?new qn(e.r,e.g,e.b,e.a):new qn(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Oy)return t;{let r=new Oy({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Oy&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new cSe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Oy&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let r=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(TI(e));r=i!==null?JSON.parse(i):t.value}return this.variables[e]={value:r,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(TI(e),JSON.stringify(t));let r=t;for(;typeof r=="string";)r=this.variables[r].value;let i=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let s=this.variables[e].locations[n];if(s[0]==="material"){let a=s[1],o=r,l={scene:i,shared:this},c=s.slice(2);i.traverseMaterial(h=>{let d=h.root??h;d.uuid===a&&d.onVariableUpdate(c,o,l)});let u=this.materials[a];u&&u.onVariableUpdate(c,o,l)}else{let a=i.find(s[0]);if(a===void 0){this.variables[e].locations.splice(n,1);continue}if(s[1]!=="geometry"&&s[1]!=="particles"){for(let o=1;o<s.length-1;o++)a=a[s[o]];s[1]==="rotation"?a[s[s.length-1]]=r*rt.DEG2RAD:a[s[s.length-1]]=r}if(a=i.find(s[0]),a.type==="ParticleEmitter"&&a.updateVariableState(r,s),sr.is(a)){if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")a.onVariableUpdate();else if(s[1]==="geometry"){let o=a;a.component&&(o=a.component);let l=o.dataPatched;o.chooseGeoemtryCache(this).forceDelete(l.geometry),o.createGeometryDelayed(this.entityOpContext),o.onVariableUpdate(!0),o.instances.forEach(c=>{let u=c.dataPatched;c.chooseGeoemtryCache(this).forceDelete(u.geometry),c.createGeometryDelayed(this.entityOpContext),c.onVariableUpdate(!0)})}}}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){var r,i,n;if(Array.isArray(e)){if(e[0]==="mouse")return((r=this.mouseProperty)==null?void 0:r[e[1]])??0;if(e[0]==="raycast")return((i=this.raycastProperty)==null?void 0:i[e[1]])??0;let s=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return s.geometry.userData.parameters[e[1]];for(let a=1;a<e.length;a++)s=s[e[a]];return e[1]==="rotation"&&(s*=rt.RAD2DEG),s}for(let s in this.variables){if(t===void 0)break;let a=this.variables[s],o=(n=a.locations)==null?void 0:n.findIndex(l=>jn.equal(l,t));o!==void 0&&o!==-1&&a.locations.splice(o,1)}if(typeof e=="string"){let s=e,a=e;do{if(a=s,this.variables[s]===void 0)break;let o=this.variables[s].value;t&&this.variables[a]!==void 0&&this.variables[a].locations.push(t),s=o}while(typeof s=="string");return s}else return e}getVariables(){return this.variables}getDynamicVariablePlayState(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){var t;return(t=this.variables[e])==null?void 0:t.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){this.data=t,e.path[0]==="images"?e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(bn.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r}):e.path[0]==="fonts"?e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id):e.path[0]==="lib"&&this.updateLibByOp(bn.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}};new fk(qa.emptyData());var sv=class extends js{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),twe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let s=r.shared.material(n);this.material[Number(i)]=s}else if(Ur(e.path,["material"])&&this.material instanceof Hh)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(bn.drop(e,1),t.material,r);else if(Ur(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(bn.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var i,n;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;if(((i=e.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe),t.scene.markNeedsUpdateRendererDirty()),(((n=e.geometry)==null?void 0:n.type)==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(s=>t.shared.material(s).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe)}disposeMaterial(){this.material&&a7(this.material).forEach(e=>{e instanceof Hh&&(e instanceof EI||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},xj=new R,bj=new It,_j=new It,fSe=new R,Sj=new Be,ps=class extends sv{constructor(e,t,r){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=new Be().fromArray(t.bindMatrix),this.bindMatrixInverse=new Be)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof pt&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof fk){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return CS.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return CS.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),Ur(e.path,["geometry"])&&this.updateByPatchedOpGeometry(bn.drop(e,1),t.geometry,r)}removeInteractionGeometry(e){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var i;this.invalidateDownstreamBooleanData();let r=this.data.geometry.type;if(r==="NonParametricGeometry"||r==="SubdivGeometry"){let n=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=tw(c,t,this.data.flatShading,this)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&yI(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...e};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=tw(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,r){var n;let i=!1;e.type===0&&e.path.length===0&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof Rs&&this.chooseGeoemtryCache(r.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)),i||((n=r.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(r)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;this.is2DType?e.set(0,0,r.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new It,r=this.geometry.attributes.skinWeight;for(let i=0,n=r.count;i<n;i++){t.fromBufferAttribute(r,i);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let r=this.skeleton;if(r===void 0)return;let i=this.geometry;bj.fromBufferAttribute(i.attributes.skinIndex,e),_j.fromBufferAttribute(i.attributes.skinWeight,e),xj.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=_j.getComponent(n);if(s!==0){let a=bj.getComponent(n);Sj.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(fSe.copy(xj).applyMatrix4(Sj),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function mSe(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=new R(n[l],n[l+1],n[l+2]);t.has(c)?(a=t.get(c))==null||a.normals.push(u):t.set(c,{normals:[u],result:new R})}t.forEach((l,c)=>{for(let u of l.normals)l.result.add(u);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,u=(o=t.get(c))==null?void 0:o.result;u&&(s[l]=u.x,s[l+1]=u.y,s[l+2]=u.z)}e.geometry.setAttribute("extrudeNormal",new Ze(s,3))}function gSe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new R;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new Ze(r,3))}function mk(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Hh)||e.material.getLayersOfType("outline").length===0)return;e instanceof ps&&e.is2DAndNoDepth?gSe(e):mSe(e)}function gk(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[rt.seededRandom(i),rt.seededRandom(i+1e4),rt.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)r[s]=n[s%3];e.geometry.setAttribute("randomColor",new Mt(r,3))}var ol=new Ni,ry=new R;function vSe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var rw=class extends ps{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new Be,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=Rs.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=r),i!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,mk(this),gk(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=Array.isArray(r)?r.map(i=>i.getFlavor(!1,i.side,i.wireframe)):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){Rs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Rs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Rs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Rs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,js.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ca,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;ol.setFromBufferAttribute(t),ol.getCenter(r),e.boundingSphere.radius=r.distanceTo(ol.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),ol.getSize(ry),this.hasNonUniformScale&&ry.divide(this.scale);let i={width:ry.x,height:ry.y,depth:ry.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;ol.min.set(e[0],e[2],e[4]),ol.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(ol.min.applyMatrix4(this.shearScaleInv),ol.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new ca);let r=t.boundingSphere.center;ol.getCenter(r),t.boundingSphere.radius=r.distanceTo(ol.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(Rs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},Ej=-1,ySe=1,wSe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},xSe={polygon_center:0,edge:1,vertex:2},q1=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,Ut=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-Ej)*(r-i)/(ySe-Ej)+i};function bSe(e){let t=[],r={};for(var i=0,n=e.length;i<n;i++){var s=JSON.stringify(e[i].pos.map(a=>Math.round(a*1e4)/1e4));r[s]||(t.push(e[i]),r[s]=!0)}return t}var _Se=new R,Y1=new R,SSe=new R,ESe=new R;function Fm(e,t){let r=SSe.fromArray(e),i=ESe.fromArray(t);Y1.copy(i).sub(r);let n=Y1.length();return Y1.normalize().multiplyScalar(n*.5),_Se.copy(r).add(Y1).toArray()}var Qa=new Un,X1=new R,jS=new R,Dd=new R;function TSe(e){let t=[];for(let r=0;r<=e.index.count;r++)if(X1.fromArray(e.index.array,r*3),Qa.setFromAttributeAndIndices(e.attributes.position,X1.x,X1.y,X1.z),Qa.getNormal(jS),Qa.getMidpoint(Dd),!(isNaN(Dd.x)||isNaN(Dd.y)||isNaN(Dd.z))){let{a:i,b:n,c:s}=Qa,a=i.toArray(),o=n.toArray(),l=s.toArray(),c=i.distanceTo(n),u=n.distanceTo(s),h=s.distanceTo(i),d=Fm(a,o),p=Fm(o,l),f=Fm(l,a),m=[c,u,h],g=Math.max(...m),v=m.filter(b=>Math.round(b)===Math.round(g)).length>1,y=[],w=Qa.getMidpoint(Dd).toArray();g===c&&!v&&(y=[p,f,f],w=d),g===u&&!v&&(y=[d,f,f],w=p),g===h&&!v&&(y=[d,p,p],w=f),v&&(y=[d,p,f]),t.push({vertices:[a,o,l],faceCenters:y,midpoint:w,norm:Qa.getNormal(jS).toArray()})}return t}function CSe(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Qa.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Qa.getNormal(jS),Qa.getMidpoint(Dd);let n=Qa.a.toArray(),s=Qa.b.toArray(),a=Qa.c.toArray();t.push({vertices:[n,s,a],faceCenters:[Fm(n,s),Fm(s,a),Fm(a,n)],midpoint:Dd.toArray(),norm:jS.toArray()})}return t}var ASe=4,MSe=.5,PM=e=>.5*(1-Math.cos(e*Math.PI)),PSe=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4096);for(let g=0;g<4096;g++)this.perlin[g]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),s=Math.floor(r),a=e-i,o=t-n,l=r-s,c,u,h=0,d=.5,p,f,m;for(let g=0;g<ASe;g++){let v=i+(n<<4)+(s<<8);c=PM(a),u=PM(o),p=this.perlin[v&4095],p+=c*(this.perlin[v+1&4095]-p),f=this.perlin[v+16&4095],f+=c*(this.perlin[v+16+1&4095]-f),p+=u*(f-p),v+=256,f=this.perlin[v&4095],f+=c*(this.perlin[v+1&4095]-f),m=this.perlin[v+16&4095],m+=c*(this.perlin[v+16+1&4095]-m),f+=u*(m-f),p+=PM(l)*(f-p),h+=p*d,d*=MSe,i<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(i++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return h}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let r=0;r<4096;r++)this.perlin[r]=t.rand()}},DSe=PSe,Tj=new R,Cj=new Be,Aj=new Gg;function Mj(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(t=!0)}),t}var cY=class extends ps{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(Cj.copy(r).invert(),Aj.copy(e.ray).applyMatrix4(Cj),Aj.intersectBox(this.singleBBox,Tj))){let i=Tj.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},Cs=1e-4,ll,uY,hY,dY,Pj=new R,Dj=new R;xq.then(e=>{ll=e,uY=[ll.get_face_center,ll.get_edge_midpoint,ll.get_vertex_position],hY=[ll.get_face_normal,ll.get_edge_normal,ll.get_vertex_normal],dY=[ll.face_count,ll.edge_count,ll.vertex_count]});var ISe=new Be,OSe=new Be,Iu=new R,$1=new R,iy=new R,DM=new R,RSe=new R,kSe=new R,pc=new DSe,Oo=class extends Z3(Cr){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof ds&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof ds&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,n=this.children.length;i<n;++i)this.remove(this.children[0]);let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let s=new ds(this.object);s.expand(),this.add(s)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new ds(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,r=t.start*rt.DEG2RAD,i=t.end*rt.DEG2RAD,n=r-i,s=new an(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new R(0,0,1);break;case"y":a=new R(0,1,0);break;default:case"x":a=new R(1,0,0);break}let o=e.randomnessObject??ch.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";pc.noiseSeed(o.seed);let c=lM((0,Kv.default)(o.seed)),u=q1(o.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(o.freqScale/10)+o.movement,f=l?pc.noise(p):c(p,p),m=h+1;d.scale.x=t.scale[0]+u(m,Ut(f,o.scale[0]))||Cs,d.scale.y=t.scale[1]+u(m,Ut(f,o.scale[1]))||Cs,d.scale.z=t.scale[2]+u(m,Ut(f,o.scale[2]))||Cs,d.position.setScalar(0);let g=n/e.count*h-r;switch(t.axis){case"x":d.rotation.set(0,g,0);break;case"y":d.rotation.set(0,0,g);break;case"z":d.rotation.set(g,0,0);break}d.translateOnAxis(a,t.radius),d.position.x+=t.position[0]+u(m,Ut(f,o.position[0])),d.position.y+=t.position[1]+u(m,Ut(f,o.position[1])),d.position.z+=t.position[2]+u(m,Ut(f,o.position[2]));let v=u(m,Ut(f,o.rotation[0])),y=u(m,Ut(f,o.rotation[1])),w=u(m,Ut(f,o.rotation[2]));t.alignment===!0?(d.rotation.x+=s.x+v,d.rotation.y+=s.y+y,d.rotation.z+=s.z+w):d.rotation.set(s.x+v,s.y+y,s.z+w)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new an(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??ch.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";pc.noiseSeed(i.seed);let s=lM((0,Kv.default)(i.seed)),a=q1(i.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let c=o*(i.freqScale/10)+i.movement,u=n?pc.noise(c):s(c,c),h=o+1,d=a(h,Ut(u,i.rotation[0])),p=a(h,Ut(u,i.rotation[1])),f=a(h,Ut(u,i.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+a(h,Ut(u,i.scale[0]))||Cs,l.scale.y=1+(t.scale[1]-1)*o+a(h,Ut(u,i.scale[1]))||Cs,l.scale.z=1+(t.scale[2]-1)*o+a(h,Ut(u,i.scale[2]))||Cs,l.rotation.x=r.x*o+d,l.rotation.y=r.y*o+p,l.rotation.z=r.z*o+f,l.position.x=t.position[0]*o+a(h,Ut(u,i.position[0])),l.position.y=t.position[1]*o+a(h,Ut(u,i.position[1])),l.position.z=t.position[2]*o+a(h,Ut(u,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??ch.defaultData([1,1,1]).randomnessObject,n=q1(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";pc.noiseSeed(i.seed);let a=Nxe((0,Kv.default)(i.seed));if(r.useCenter===!0){let o={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},l=new R(r.size[0]*(r.count[0]-o.x)*.5,r.size[1]*(r.count[1]-o.y)*.5,r.size[2]*(r.count[2]-o.z)*.5);for(let c=0;c<r.count[0];c++)for(let u=0;u<r.count[1];u++)for(let h=0;h<r.count[2];h++){let d=[(c+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement,(h+1)*(i.freqScale/10)+i.movement],p=s?pc.noise(...d):a(...d),f=this.children[t++];f.scale.x=1+n(t,Ut(p,i.scale[0]))||Cs,f.scale.y=1+n(t,Ut(p,i.scale[1]))||Cs,f.scale.z=1+n(t,Ut(p,i.scale[2]))||Cs;let m=n(t,Ut(p,i.rotation[0])),g=n(t,Ut(p,i.rotation[1])),v=n(t,Ut(p,i.rotation[2]));f.rotation.set(m,g,v),f.position.x=r.size[0]*c-l.x+n(t,Ut(p,i.position[0])),f.position.y=r.size[1]*u-l.y+n(t,Ut(p,i.position[1])),f.position.z=r.size[2]*h-l.z+n(t,Ut(p,i.position[2]))}}else for(let o=0;o<r.count[0];o++)for(let l=0;l<r.count[1];l++)for(let c=0;c<r.count[2];c++){let u=[(o+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],h=s?pc.noise(...u):a(...u),d=this.children[t++];d.scale.x=1+n(t,Ut(h,i.scale[0]))||Cs,d.scale.y=1+n(t,Ut(h,i.scale[1]))||Cs,d.scale.z=1+n(t,Ut(h,i.scale[2]))||Cs;let p=n(t,Ut(h,i.rotation[0])),f=n(t,Ut(h,i.rotation[1])),m=n(t,Ut(h,i.rotation[2]));d.rotation.set(p,f,m),d.position.x=r.size[0]*o+n(t,Ut(h,i.position[0])),d.position.y=-r.size[1]*l+n(t,Ut(h,i.position[1])),d.position.z=-r.size[2]*c+n(t,Ut(h,i.position[2]))}}_updateToObject(e){var m;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new an(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??ch.defaultData([1,1,1]).randomnessObject,n=i.noiseType==="perlin";pc.noiseSeed(i.seed);let s=lM((0,Kv.default)(i.seed)),a=q1(i.strength,this.parameters.randomness);if(!t.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof cY)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let o=this.getSubdivData(),l=[],c=g=>{let v=g.length,y=g.map(E=>E[0]).reduce((E,_)=>E+_,0),w=g.map(E=>E[1]).reduce((E,_)=>E+_,0),b=g.map(E=>E[2]).reduce((E,_)=>E+_,0);return[y/v,w/v,b/v]},u=g=>Math.round(g*1e6)/1e6;o.forEach(g=>{let v=o.filter(y=>u(g.pos[0])===u(y.pos[0])&&u(g.pos[1])===u(y.pos[1])&&u(g.pos[2])===u(y.pos[2]));v.length>1?l.push({pos:g.pos,norm:c(v.map(y=>y.norm))}):l.push(g)});let h=bSe(l);if(h.length>0){let g=Math.round(h.length*t.count/100);this._updateCount(g)}else{let g=this.objectForSample.geometry.getAttribute("position");if(!g||isNaN(g.count)||g.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let d=new zxe(this.objectForSample).build(),p=wSe[t.axis],f=this.children;d.setRandomGenerator((0,Kv.default)(this.object.uuid+t.seed));for(let[g,v]of f.entries()){let y=g*(i.freqScale/10)+i.movement,w=n?pc.noise(y):s(y,y),b=g+1,E=a(b,Ut(w,i.rotation[0])),_=a(b,Ut(w,i.rotation[1])),C=a(b,Ut(w,i.rotation[2]));t.spreadType==="random"?d.sample(iy,DM):(h.length&&(iy.fromArray(h[g].pos),DM.fromArray(h[g].norm)),this.objectForSample instanceof rw&&iy.applyMatrix4(ISe.copy(this.objectForSample.matrixWorld).invert())),iy.applyMatrix4(this.object.hiddenMatrix.clone().invert()),v.position.copy(iy),Iu.fromArray(p);let x=t.align==="normal"?DM:this.object.getWorldDirection(kSe),A=$1.fromArray(t.position);$1.x+=a(b,Ut(w,i.position[0])),$1.y+=a(b,Ut(w,i.position[1])),$1.z+=a(b,Ut(w,i.position[2]));let T=Math.acos(x.dot(Iu)),M=RSe.crossVectors(Iu,x).normalize(),D=OSe.makeRotationAxis(M,T),P=x.clone().cross(this.object.up).normalize(),I=P.clone().cross(x).normalize(),B=new Be().makeBasis(P,x,I),V=new R(Iu.y,Iu.z,Iu.x).normalize(),N=V.clone().cross(Iu).normalize(),L=new Be().makeBasis(V,Iu,N).invert(),W=new Be().multiplyMatrices(B,L);v.rotation.setFromRotationMatrix(W),A.applyMatrix4(D),v.position.add(A),v.rotation.x=v.rotation.x+r.x+E,v.rotation.y=v.rotation.y+r.y+_,v.rotation.z=v.rotation.z+r.z+C,v.scale.setScalar(1),v.scale.x=v.scale.x+t.scale[0]+a(b,Ut(w,i.scale[0]))||Cs,v.scale.y=v.scale.y+t.scale[1]+a(b,Ut(w,i.scale[1]))||Cs,v.scale.z=v.scale.z+t.scale[2]+a(b,Ut(w,i.scale[2]))||Cs,v.scale.multiply(this.object.scale),v.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof rw){let t=this.objectForSample,r=xSe[e],i=dY[r],n=uY[r],s=hY[r],a=[],o=i(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let c=n(t.subdivPointerNew,l),u=s(t.subdivPointerNew,l);Pj.fromArray(c).applyMatrix4(t.matrixWorld),Dj.fromArray(u),a.push({pos:Pj.toArray(),norm:Dj.toArray()})}return a}else return(this.objectForSample.geometry.index?TSe(this.objectForSample.geometry):CSe(this.objectForSample.geometry)).map((t,r)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var r;if(this.parameters=_T(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(r=this.object.parent)==null||r.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=t.find(this.parameters.toObject.object);i instanceof js?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new Be,this.hiddenMatrix=new Be,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},jw=e=>{var t;return t=class extends e{},t.geometryHelper=new Wo(30,30,30),t},Q1=new Gg,IM=new ca,Ij=new Be,Vw=(e,t,r,i,n=!1,s=e)=>{let a=t,o=s.matrixWorld;if(a.boundingSphere===null&&a.computeBoundingSphere(),IM.copy(a.boundingSphere),IM.applyMatrix4(o),r.ray.intersectsSphere(IM)===!1||(Ij.copy(o).invert(),Q1.copy(r.ray).applyMatrix4(Ij),a.boundingBox!==null&&Q1.intersectsBox(a.boundingBox)===!1))return;let l,c,u,h,d=a.index,p=a.attributes.position,f=a.drawRange,m,g;if(n===!1){let y=Math.max(0,f.start),w=Math.min(d.count,f.start+f.count);for(m=y,g=w;m<g;m+=3)if(c=d.getX(m),u=d.getX(m+1),h=d.getX(m+2),l=v(e,r,Q1,p,c,u,h),l){l.faceIndex=Math.floor(m/3),i.push(l);return}}else{let y=a.attributes.position,w=new R,b=new R,E=new R,_=new R,C=2,x=1/((s.scale.x+s.scale.y+s.scale.z)/3),A=x*x,T=Math.max(0,f.start),M=Math.min(y.count,f.start+f.count);for(let D=T,P=M-1;D<P;D+=C){if(w.fromBufferAttribute(y,D),b.fromBufferAttribute(y,D+1),Q1.distanceSqToSegment(w,b,_,E)>A)continue;_.applyMatrix4(s.matrixWorld);let I=r.ray.origin.distanceTo(_);I<r.near||I>r.far||i.push({distance:I,point:E.clone().applyMatrix4(s.matrixWorld),object:e})}}function v(y,w,b,E,_,C,x){let A=new R,T=new R,M=new R,D=new R,P=new R;if(A.fromBufferAttribute(E,_),T.fromBufferAttribute(E,C),M.fromBufferAttribute(E,x),b.intersectTriangle(A,T,M,!1,D)===null)return null;P.copy(D),P.applyMatrix4(y.matrixWorld);let I=w.ray.origin.distanceTo(P);return I<w.near||I>w.far?null:{faceIndex:1,distance:I,point:P.clone(),object:y}}},K1=new R,Fa=new Hp,LSe=class extends Rw{constructor(e){let t=new pt,r=new nd({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new bt(15711266),o=new bt(15711266),l=new bt(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(h,d,p){u(h,p),u(d,p)}function u(h,d){i.push(0,0,0),n.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(i.length/3-1)}t.setAttribute("position",new Ze(i,3)),t.setAttribute("color",new Ze(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;Fa.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;vo("n1",t,e,Fa,-r,-i,n),vo("n2",t,e,Fa,r,-i,n),vo("n3",t,e,Fa,-r,i,n),vo("n4",t,e,Fa,r,i,n);let s=n;vo("f1",t,e,Fa,-r,-i,s),vo("f2",t,e,Fa,r,-i,s),vo("f3",t,e,Fa,-r,i,s),vo("f4",t,e,Fa,r,i,s);let a=s,o=.5;vo("u1",t,e,Fa,r*.7*o,i*1.1,a),vo("u2",t,e,Fa,-r*.7*o,i*1.1,a),vo("u3",t,e,Fa,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function vo(e,t,r,i,n,s,a){K1.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],K1.x,K1.y,K1.z)}}var NSe=class extends jw(LSe){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){Vw(this.object,this.geometry,e,t,!0)}},CI;(e=>e.is=t=>"objectHelper"in t)(CI||(CI={}));var av=(e,t)=>class extends J3(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof oS&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof Wo?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof oS&&(i.visible=!1)}}},Z1=790,Of=new R,OM=new R,RM=new Dt,kM=new R,ny=new R,LM=new R,ms=class extends av(Hp,NSe){constructor(e="",t={...Y0.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=dg.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new Be,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new hT(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new ls(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new R(e,t,r)),super.lookAt(e),this.getWorldPosition(Of),this.targetOffset=Of.distanceTo(e)}getTarget(e=new R){return this.getWorldDirection(OM),this.getWorldPosition(Of),OM.multiplyScalar(this.targetOffset),e.copy(Of).add(OM),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Of),Of.distanceTo(e)}updateUp(){this.getWorldQuaternion(RM),kM.set(0,0,1).applyQuaternion(RM),ny.copy(Cr.DEFAULT_UP),this.isUpVectorFlipped&&ny.negate(),ny.applyQuaternion(RM),LM.copy(Cr.DEFAULT_UP).projectOnPlane(kM),this.angleOffsetFromUp=LM.angleTo(ny),this.angleOffsetFromUp*=LM.cross(ny).dot(kM)>=0?1:-1}updateTransformState(e,t){let r=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let t=e.getWorldPosition(new R),r=e.getWorldDirection(new R).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new R).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new R;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-Z1*.5*i,this.right=Z1*.5*i,this.top=Z1*.5*(1/n),this.bottom=-Z1*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return b2(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},Rf=new Be,zSe=new Be;function Oj(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var bp=class extends sv{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new pt,this.onAfterRender=(i,n,s,a,o,l)=>{super.onAfterRender(i,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var i;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof bp&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof js&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0&&s.booleanMeshSetAddress!==0){Rf.multiplyMatrices(s.hiddenMatrix,s.matrix);try{if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ec.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Ec.transformMeshSet(s.booleanMeshSetAddress,Rf),s.booleanMatrixInvOld.copy(Rf).invert(),s.booleanWasTransformed=!1}else s instanceof bp&&s.needsTransformForDownstream===!0?(Ec.transformMeshSet(s.booleanMeshSetAddress,Rf),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Ec.transformMeshSet(s.booleanMeshSetAddress,zSe.multiplyMatrices(Rf,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(Rf).invert(),s.booleanWasTransformed=!1)}catch(a){console.error(a),s.booleanMeshSetAddress=0,s.geometry.userData.booleanOperationDidFail=!0;continue}Ec.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.booleanOperationDidFail=!1):s.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Ze([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Ec.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new pt,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=Ec.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,mk(this),gk(this)}dispose(){super.dispose(),this.geometry.dispose()}},AI;(e=>{function t(r){return sr.is(r)&&r instanceof Nw}e.is=t})(AI||(AI={}));var vk=(e,t)=>class extends av(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},Mo=e=>e instanceof js,jc=e=>e!==null&&e instanceof bp,BSe=e=>e instanceof ms,FSe=e=>AI.is(e),MI=e=>CI.is(e),USe=new R(1,1,1),Rj=new R,jSe=new R,kj=new Dt,Hw=class extends jw(ohe){constructor(e,t=15){super(t),this.object=e,this.dummy=new ah,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){Vw(this.object,Hw.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(Rj,kj,jSe),this.matrix.compose(Rj,kj,USe),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},Um=class extends av(ah,Hw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},$b=class extends av(ah,Hw){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},pY={RED:0,GREEN:1,BLUE:2,ALPHA:3},Ww="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",VSe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,J1=class extends yr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new ke(null),kernel16:new ke(null),inputBuffer:new ke(null),cocBuffer:new ke(null),texelSize:new ke(new re),scale:new ke(1)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:VSe,vertexShader:Ww}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),u=c*Math.cos(l),h=c*Math.sin(l);o%5===0?(r[n++]=u,r[n++]=h):(t[i++]=u,t[i++]=h)}let s=[],a=[];for(let o=0;o<128;)s.push(new It(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new It(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function Lj(e,t,r){return e*(t-r)-t}function PI(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var HSe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,WSe=class extends yr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new ke(null),focusDistance:new ke(0),focusRange:new ke(0),cameraNear:new ke(.3),cameraFar:new ke(1e3)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:HSe,vertexShader:Ww}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yu){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-Lj(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=PI(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-Lj(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=PI(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof ls?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},GSe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,qSe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Nj=class extends yr{constructor(e=new re){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new ke(null),texelSize:new ke(new re),halfTexelSize:new ke(new re),kernel:new ke(0),scale:new ke(1)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:GSe,vertexShader:qSe}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},YSe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,XSe=class extends yr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new ke(null),opacity:new ke(1)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:YSe,vertexShader:Ww}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},$Se=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,QSe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,IT={DEPTH:0,LUMA:1,COLOR:2},KSe={DISABLED:0,DEPTH:1,CUSTOM:2},ZSe=class extends yr{constructor(e=new re,t=IT.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Wg.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new ke(null),depthBuffer:new ke(null),predicationBuffer:new ke(null),texelSize:new ke(e)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:$Se,vertexShader:QSe}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yu){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},JSe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,eEe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",yo={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},DI=class extends yr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Wg.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new ke(null),depthBuffer:new ke(null),resolution:new ke(new re),texelSize:new ke(new re),cameraNear:new ke(.3),cameraFar:new ke(1e3),aspect:new ke(1),time:new ke(0)},blending:$i,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=yu){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=JSe.replace(yo.FRAGMENT_HEAD,e.get(yo.FRAGMENT_HEAD)).replace(yo.FRAGMENT_MAIN_UV,e.get(yo.FRAGMENT_MAIN_UV)).replace(yo.FRAGMENT_MAIN_IMAGE,e.get(yo.FRAGMENT_MAIN_IMAGE)),this.vertexShader=eEe.replace(yo.VERTEX_HEAD,e.get(yo.VERTEX_HEAD)).replace(yo.VERTEX_MAIN_SUPPORT,e.get(yo.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof ls?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return yo}},tEe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,rEe=class extends yr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Wg.replace(/\D+/g,"")},uniforms:{inputBuffer:new ke(null),threshold:new ke(0),smoothing:new ke(1),range:new ke(null)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:tEe,vertexShader:Ww}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},iEe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,fY={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},nEe=class extends yr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new ke(e),inputBuffer:new ke(null),strength:new ke(1)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:iEe,vertexShader:Ww}),this.toneMapped=!1,this.setColorChannel(pY.RED),this.setMaskFunction(fY.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==vs&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},sEe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,aEe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",oEe=class extends yr{constructor(e=new re,t=new re){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new ke(null),searchTexture:new ke(null),areaTexture:new ke(null),resolution:new ke(t),texelSize:new ke(e)},blending:$i,depthWrite:!1,depthTest:!1,fragmentShader:sEe,vertexShader:aEe}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},lEe=new Hp,Ou=null;function cEe(){if(Ou===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Ou=new pt,Ou.setAttribute!==void 0?(Ou.setAttribute("position",new Mt(e,3)),Ou.setAttribute("uv",new Mt(t,2))):(Ou.addAttribute("position",new Mt(e,3)),Ou.addAttribute("uv",new Mt(t,2)))}return Ou}var Gs=class{constructor(e="Pass",t=new Yc,r=lEe){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ii(cEe(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Yc),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=yu){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Yc||t===this.renderer)continue;this[e].dispose()}}}},II=class extends Gs{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new XSe,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new vr(1,1,{minFilter:qt,magFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==vs?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===jt&&(this.renderTarget.texture.encoding=jt))}},uEe=class extends Gs{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},NM=new bt,yk=class extends Gs{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(NM.copy(e.getClearColor(NM)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(NM,o):c&&e.setClearAlpha(o)}},Ru=-1,sa=class extends Kn{constructor(e,t=Ru,r=Ru,i=1){super(),this.resizable=e,this.base=new re(1,1),this.preferred=new re(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==Ru?i=t.width:t.height!==Ru?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==Ru?i=t.height:t.width!==Ru?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Ru),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Ru}},zM=!1,zj=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case ia:r=this.materialsFlatShadedDoubleSide;break;case _n:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case ia:r=this.materialsDoubleSide;break;case _n:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Vo;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=_n,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=ia,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=_n,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=ia,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,zM){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return zM}static set workaroundEnabled(e){zM=e}},hEe=class extends Gs{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new yk,this.overrideMaterialManager=r===null?null:new zj(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new zj(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},Bj=class extends Gs{constructor(e,t,{resolutionScale:r=1,width:i=sa.AUTO_SIZE,height:n=sa.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new hEe(e,t,new e8({depthPacking:U9}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new bt(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new vr(1,1,{minFilter:_r,magFilter:_r,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new sa(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},cr={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},dEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",pEe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",fEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",mEe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",gEe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",vEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",yEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",wEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",xEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",bEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",_Ee="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",SEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",EEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",TEe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",CEe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",AEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",MEe="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",PEe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",DEe=new Map([[cr.SKIP,null],[cr.ADD,dEe],[cr.ALPHA,pEe],[cr.AVERAGE,fEe],[cr.COLOR_BURN,mEe],[cr.COLOR_DODGE,gEe],[cr.DARKEN,vEe],[cr.DIFFERENCE,yEe],[cr.EXCLUSION,wEe],[cr.LIGHTEN,xEe],[cr.MULTIPLY,bEe],[cr.DIVIDE,_Ee],[cr.NEGATION,SEe],[cr.NORMAL,EEe],[cr.OVERLAY,TEe],[cr.REFLECT,CEe],[cr.SCREEN,AEe],[cr.SOFT_LIGHT,MEe],[cr.SUBTRACT,PEe]]),IEe=class extends Kn{constructor(e,t=1){super(),this.f=e,this.opacity=new ke(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return DEe.get(this.blendFunction)}},Ll={NONE:0,DEPTH:1,CONVOLUTION:2},tc=class extends Kn{constructor(e,t,{attributes:r=Ll.NONE,blendFunction:i=cr.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new IEe(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=yu){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Yc||t===this.renderer)continue;this[e].dispose()}}}};function Fj(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function OEe(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],h=[],d=!1,p=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&a&Ll.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=DI.Section;if(c){let v=`	${e}MainUv(UV);
`;r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+v),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+v),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),h=h.concat(u).concat([...o.get("vertex").matchAll(f)].map(y=>y[1]))}h=h.concat([...o.get("fragment").matchAll(f)].map(v=>v[1])),h=h.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),t.defines.forEach((v,y)=>n.set(e+y.charAt(0).toUpperCase()+y.slice(1),v)),Fj(e,h,n),Fj(e,h,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;a&Ll.DEPTH&&v.test(o.get("fragment"))&&(y+="depth, ",p=!0),y+=`color1);
	`;let w=e+"BlendOpacity";s.set(w,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${w});

	`,r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${w};

`,r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+y)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:d,readDepth:p}}var VS=class extends Gs{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new DI(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=DI.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===cr.SKIP)l|=d.getAttributes()&Ll.DEPTH;else if(l&d.getAttributes()&Ll.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let p="e"+a++,f=OEe(p,d,t,r,i,n,l);if(o+=f.varyings.length,c=c||f.transformedUv,u=u||f.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let h=/\bblend\b/g;for(let d of r.values()){let p=d.getShaderCode().replace(h,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+p+`
`)}l&Ll.DEPTH?(u&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,c?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")):i.set("UV","vUv"),t.forEach((d,p,f)=>f.set(p,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=yu){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==vs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},REe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],wk=class extends Gs{constructor({resolutionScale:e=.5,width:t=sa.AUTO_SIZE,height:r=sa.AUTO_SIZE,kernelSize:i=OT.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new vr(1,1,{minFilter:qt,magFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new sa(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new Nj,this.ditheredBlurMaterial=new Nj,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=REe[this.kernelSize],u=this.blurMaterial,h=t,d,p;for(this.fullscreenMaterial=u,d=0,p=c.length-1;d<p;++d){let f=d&1?l:o;u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(f),e.render(s,a),h=f}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==vs?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===jt&&(this.renderTargetA.texture.encoding=jt,this.renderTargetB.texture.encoding=jt))}static get AUTO_SIZE(){return sa.AUTO_SIZE}},kEe=class extends Gs{constructor({width:e=sa.AUTO_SIZE,height:t=sa.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new rEe(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new vr(1,1,{minFilter:qt,magFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new sa(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==vs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},LEe=class extends Gs{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new yk(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Ao=class extends Gs{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==vs&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},BM=1/1e3,NEe=1e3,zEe=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*BM}getFixedDelta(){return this.fixedDelta*BM}setFixedDelta(e){return this.fixedDelta=e*NEe,this}getElapsed(){return this.elapsed*BM}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},OT={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},BEe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,FEe=class extends tc{constructor({blendFunction:e=cr.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=sa.AUTO_SIZE,height:a=sa.AUTO_SIZE,kernelSize:o=OT.LARGE}={}){super("BloomEffect",BEe,{blendFunction:e,uniforms:new Map([["map",new ke(null)],["intensity",new ke(n)]])}),this.renderTarget=new vr(1,1,{minFilter:qt,magFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new kEe({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new wk({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===jt&&(this.renderTarget.texture.encoding=jt))}},UEe="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",jEe=class extends tc{constructor({blendFunction:e=cr.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",UEe,{blendFunction:e,uniforms:new Map([["brightness",new ke(t)],["contrast",new ke(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},VEe="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",HEe=class extends tc{constructor(e=cr.NORMAL){super("ColorAverageEffect",VEe,{blendFunction:e})}},WEe="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",GEe="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",qEe=class extends tc{constructor({blendFunction:e=cr.NORMAL,offset:t=new re(.001,5e-4)}={}){super("ChromaticAberrationEffect",WEe,{vertexShader:GEe,blendFunction:e,attributes:Ll.CONVOLUTION,uniforms:new Map([["offset",new ke(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},YEe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,XEe=class extends tc{constructor(e,{blendFunction:t=cr.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=sa.AUTO_SIZE,height:c=sa.AUTO_SIZE}={}){super("DepthOfFieldEffect",YEe,{blendFunction:t,attributes:Ll.DEPTH,uniforms:new Map([["nearColorBuffer",new ke(null)],["farColorBuffer",new ke(null)],["nearCoCBuffer",new ke(null)],["scale",new ke(1)]])}),this.camera=e,this.renderTarget=new vr(1,1,{minFilter:qt,magFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Ao(new WSe(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=a,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new wk({kernelSize:OT.MEDIUM,width:l,height:c});let h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new Ao(new nEe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=fY.MULTIPLY,d.colorChannel=pY.GREEN,this.bokehNearBasePass=new Ao(new J1(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Ao(new J1(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Ao(new J1(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Ao(new J1(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return PI(-r,t.near,t.far)}setDepthTexture(e,t=yu){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,vs),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===jt&&(this.renderTarget.texture.encoding=jt,this.renderTargetNear.texture.encoding=jt,this.renderTargetFar.texture.encoding=jt,this.renderTargetMasked.texture.encoding=jt))}};new R;new Be;var $Ee="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",QEe=class extends tc{constructor({blendFunction:e=cr.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",$Ee,{blendFunction:e,uniforms:new Map([["hue",new ke(new R)],["saturation",new ke(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new bt;var KEe=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,ZEe=class extends tc{constructor({blendFunction:e=cr.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",KEe,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},JEe="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",eTe=class extends tc{constructor(e=30){super("PixelationEffect",JEe,{uniforms:new Map([["active",new ke(!1)],["d",new ke(new re)]])}),this.resolution=new re,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new R;new R;var Uj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",jj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",tTe="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",rTe="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Id={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},mY=class extends tc{constructor({preset:e=Id.MEDIUM,edgeDetectionMode:t=IT.COLOR,predicationMode:r=KSe.DISABLED}={}){super("SMAAEffect",tTe,{vertexShader:rTe,blendFunction:cr.NORMAL,attributes:Ll.CONVOLUTION|Ll.DEPTH,uniforms:new Map([["weightMap",new ke(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new vr(1,1,{minFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new yk(!0,!1,!1),this.clearPass.overrideClearColor=new bt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Ao(new ZSe),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new Ao(new oEe);let s=new w8;s.onLoad=()=>{let a=new pi(i);a.name="SMAA.Search",a.magFilter=_r,a.minFilter=_r,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new pi(n);o.name="SMAA.Area",o.magFilter=qt,o.minFilter=qt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=Uj,n.src=jj),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case Id.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Id.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Id.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case Id.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=yu){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return Uj}static get areaImageDataURL(){return jj}},iTe=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,eb={DEFAULT:0,ESKIL:1},nTe=class extends tc{constructor({blendFunction:e=cr.NORMAL,technique:t=eb.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",iTe,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new ke(i)],["darkness",new ke(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===eb.ESKIL}set eskil(e){this.technique=e?eb.ESKIL:eb.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},wu=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=cr.NORMAL}},sTe=class extends wu{constructor(){super(FEe),this.blendFunction=cr.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},aTe=class extends wu{constructor(){super(jEe)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},oTe=class extends wu{constructor(){super(qEe),this.effect.offset=new re(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},lTe=class extends wu{constructor(){super(HEe)}},cTe=class extends wu{constructor(){super(QEe),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},uTe=class extends wu{constructor(){super(ZEe),this.blendFunction=cr.OVERLAY}},hTe=class extends wu{constructor(){super(nTe)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},dTe=class extends wu{constructor(e){super(XEe)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},pTe=class extends wu{constructor(){super(eTe)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},fTe=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,mTe=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,gTe=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,vTe=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,OI=class extends yr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new ke(null)},blending:$i,depthWrite:!1,depthTest:!1,vertexShader:gTe,fragmentShader:vTe})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},yTe=class extends Gs{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new OI,this.resolutionVector=new re,this.resolveMaterial=new yr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new ke(null),historyBuffer:new ke(null),velocityBuffer:new ke(null),depthBuffer:new ke(null),resolution:new ke(new re)},blending:$i,depthWrite:!1,depthTest:!1,vertexShader:fTe,fragmentShader:mTe}),this.historyRenderTarget=new vr(1024,1024,{minFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new vr(1024,1024,{minFilter:qt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},wTe=class extends Gs{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new Bj(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new OI,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new OI,this.depthPass=new Bj(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},Vj=new Yc,xTe=new yr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),RI=class extends Gs{constructor(e,t,r){super("OpaquePass",t??Vj,r),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??Vj}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof js&&(this.originalMaterials.set(i.id,i.material),i.material=xTe)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((i,n)=>{let s=this.scene.getObjectById(n);s&&(s.material=i)})}},bTe=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new II,this.depthTexture=null,this.timer=new zEe,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let r=e.getSize(new re),i=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,n=this.inputBuffer.texture[0].type;n===vs&&e.outputEncoding===jt&&(this.inputBuffer.texture[0].encoding=jt,this.outputBuffer.texture[0].encoding=jt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(r.width,r.height,!1);for(let s of this.passes)s.initialize(e,i,n)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new og(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=gp,e.type=$d):e.type=Bc,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,s){let a=this.renderer,o=a===null?new re:a.getDrawingBufferSize(new re),l={minFilter:qt,magFilter:qt,wrapS:ti,wrapT:ti,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new vr(o.width,o.height,l),c.samples=i):(n?(c=new Zne(o.width,o.height,2,l),c.texture[1].type=ou):c=new vr(o.width,o.height,l),c.depthTexture=new og(2048,2048),c.depthTexture.type=Yi),r===vs&&a!==null&&a.outputEncoding===jt&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=jt):c.texture.encoding=jt),Array.isArray(c.texture)?c.texture.forEach((u,h)=>{u.name=`EffectComposer.Buffer ${n} ${h}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var o;let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new re),s=((o=i.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,u,h;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,i,n,e,o):d.render(t,s,a,e,o),d.needsSwap&&(o&&(r.renderToScreen=d.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,h=s,i=n,s=a,n=u,a=h),d instanceof LEe?o=!0:d instanceof uEe&&(o=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=i.getSize(new re);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new re);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},_Te=new yr({name:"CombineMaterial",uniforms:{inputBufferA:new ke(null),inputBufferB:new ke(null)},blending:$i,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),STe=class extends Gs{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=_Te,this.helperPass=new RI(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new RI(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new mY({preset:Id.LOW,edgeDetectionMode:IT.COLOR});this.effectPass=new VS(this.camera,t),this.rt=new vr(10,10,{minFilter:qt,magFilter:qt,wrapS:ti,wrapT:ti,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},ETe=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,TTe=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,CTe=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,ATe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,MTe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,PTe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,sy=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],DTe=new yr({vertexShader:ETe,fragmentShader:TTe}),kf=new yr({vertexShader:MTe,fragmentShader:PTe,uniforms:{texture_ao_lrez:new ke(null),texture_depth_lrez:new ke(null),texture_depth_hrez:new ke(null),near:new ke(null),far:new ke(null)}}),ITe=class extends Gs{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new vr(r,i,{type:Bw?ou:Yi,depthTexture:new og(r,i),minFilter:qt,magFilter:qt}),this.depthBufferHighRes=new vr(r,i,{depthTexture:new og(r,i)}),this.aoBuffer=new vr(r,i,{minFilter:qt,magFilter:qt}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array(sy.length*2);for(let a=0;a<sy.length;a++){let o=a*2;n[o+0]=sy[a][0],n[o+1]=sy[a][1]}this.blueNoiseInDiskTexture=new Za(n,sy.length,1,X_,Yi),this.blueNoiseInDiskTexture.wrapS=zc,this.blueNoiseInDiskTexture.wrapT=zc,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new yr({vertexShader:CTe,fragmentShader:ATe,uniforms:{near:new ke(null),far:new ke(null),fov:new ke(null),proj_info:new ke(new It),is_ortho:new ke(!1),resolution:new ke(new re),radius_of_influence:new ke(8),radius_in_screen_space:new ke(1),exponent:new ke(1),ao_color:new ke(new R),bias:new ke(.5),texture_depth:new ke(null),texture_normals:new ke(null),texture_blue_noise:new ke(null),texture_blue_noise_in_disk:new ke(this.blueNoiseInDiskTexture),frame_index:new ke(0),fog_enabled:new ke(!1),fog_near:new ke(1),fog_far:new ke(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new vr(r,i,{minFilter:qt,magFilter:qt,wrapS:ti,wrapT:ti,depthBuffer:!1,type:Yi});let s=new mY({preset:Id.ULTRA,edgeDetectionMode:IT.COLOR});this.effectPass=new VS(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,kf.uniforms.texture_depth_hrez.value=e,kf.needsUpdate=!0}render(e,t,r){this.splineScene.overrideMaterial=DTe;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=kf,kf.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,kf.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,kf.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},OTe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,RTe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,kTe=class extends Ao{constructor(){super(new yr({vertexShader:OTe,fragmentShader:RTe,uniforms:{tInput:new ke(null),tMap:new ke(null),uResolution:new ke(new re),uSize:new ke(new re),uCoords:new ke(new re),uScale:new ke(1),uSceneColor:new ke(new bt(16711680)),uDPR:new ke(1),uCurrent:new ke(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},LTe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,NTe=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,zTe=[],BTe=class extends Ao{constructor(){super(new yr({vertexShader:LTe,fragmentShader:NTe,uniforms:{toScene:new ke(null),fromScene:new ke(null),uResolution:new ke(new re),uDPR:new ke(1),mixRatio:new ke(0),threshold:new ke(.1),useTexture:new ke(0),tMixTexture:{value:zTe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},FTe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,UTe=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,jTe=class extends Ao{constructor(){super(new yr({vertexShader:FTe,fragmentShader:UTe,uniforms:{inputBuffer:new ke(null),blurredInputBuffer:new ke(null),overlay:new ke(null),uResolution:new ke(new re),uDPR:new ke(1),blurIntensity:new ke(0)}})),this._blurEnabled=!1,this.blurTarget=new vr(1,1,{minFilter:qt,magFilter:qt,wrapS:ti,wrapT:ti}),this.blurPass=new wk({width:window.innerWidth,height:window.innerHeight,kernelSize:OT.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,r=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let r=t.data.backgroundBlur,i=r.radius;this._blurEnabled=r.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,r,i,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,n)),super.render(e,t,r,i,n)}};function Hj(e,t){return t&&t.enabled&&e.push(t.effect),e}var VTe=e=>Object.values(cr).includes(e)?e:cr.NORMAL,HTe=class extends Kn{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=AS.defaultData,this._scene=new Yc,this._camera=new ms,this.effects=new Map,this.blueNoiseTexture=new Za,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new Wue,this.renderer=e,this.debug=!1,this.effects.set("bloom",new sTe),this.effects.set("chromaticAberration",new oTe),this.effects.set("vignette",new hTe),this.effects.set("noise",new uTe),this.effects.set("colorAverage",new lTe),this.effects.set("hueSaturation",new cTe),this.effects.set("brightnessContrast",new aTe),this.effects.set("depthOfField",new dTe),this.effects.set("pixelation",new pTe),this.effectComposer=new bTe(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new RI(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new wTe(this.scene,this.camera,this.renderer),this.aoPass=new ITe(this.scene,this.camera),this.taaPass=new yTe,this.taaPass.renderToScreen=!1,this.helperPass=new STe(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new kTe,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new jTe,this.uiOverlayPass.enabled=!1,this.sceneTransitionPass=new BTe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Za(e,128,128),this.blueNoiseTexture.wrapS=zc,this.blueNoiseTexture.wrapT=zc,this.blueNoiseTexture.minFilter=_r,this.blueNoiseTexture.magFilter=_r,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t,r;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(Hj,[]);i.length>0&&(this.uvEffectPass=new VS(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(Hj,[]);if(n.length>0&&(this.effectPass=new VS(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&((r=this.effects.get("depthOfField"))==null?void 0:r.enabled)&&window!==void 0)){let s=this.renderer.viewportWidth,a=this.renderer.viewportHeight;this.renderer.setSize(s-1,a-1),this.renderer.setSize(s,a)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new re;this.renderer.getDrawingBufferSize(e),this._rt=new vr(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:zc,wrapT:zc}),this._rt.samples=0,this._savePass=new II(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new II(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(i=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=VTe(l):a[o]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof It?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof It?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},WTe=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,GTe=Wt.lights_fragment_begin,qTe=Wt.shadowmask_pars_fragment,Wj=null,YTe=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},XTe=(e="medium")=>{if(Wj===e)return!1;Wj=e;let t=YTe(e);Wt.shadowmap_pars_fragment=WTe(t);let r=GTe.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Wt.lights_fragment_begin=r;let i=qTe.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Wt.shadowmask_pars_fragment=i,!0},$Te=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>

void main()
{
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,QTe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,FM=new yr({vertexShader:$Te,fragmentShader:QTe,uniforms:{depthContrast:{value:1}}}),Gj=new pi,KTe=new re,ZTe=class extends t8{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new re,this.dummyCamera=new ms,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.pipeline=new HTe(this,(e==null?void 0:e.needsDOFResize)??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=a3,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{var o,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,r(n,s,a),(o=this.normalRenderTarget)==null||o.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new vr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:qt,magFilter:qt,wrapS:ti,wrapT:ti,depthBuffer:!1}))}_resizeTransmission(e,t){var r,i;(r=this.transmissionRenderTarget)==null||r.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(i=this.aoRenderTarget)==null||i.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return St.transmissionLod.value===1}set hdTransmission(e){St.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new vr(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:sg,magFilter:qt,wrapS:ti,wrapT:ti,depthBuffer:!1}),this.transmissionDepthTarget=new vr(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:_r,magFilter:_r,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new vr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:_r,magFilter:_r,type:Yi,depthTexture:new og(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof ms?FM.uniforms.depthContrast.value=(r.far-r.near)/1e4:FM.uniforms.depthContrast.value=1,t.overrideMaterial=FM,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?UI:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<i?n=i*s:i=n/s,this.dummyCamera.setViewplaneSize(n,i);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:r=void 0,sceneHelpersOnTop:i=void 0,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){var d;let a=e instanceof Ck?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((p,f)=>{St.penumbraSize.value[f]=p}),St.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?St.resolution.value.set(this.resolution.x,this.resolution.y):St.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(St.normalRenderTarget.value=s,St.normalRenderTargetDepth.value=Gj):l.needsNormal()&&(this.createNormalRenderTarget(),St.normalRenderTarget.value=this.normalRenderTarget.texture,St.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,u=c.occlusion;if(u&&(this.createAORenderTarget(),St.aoRenderTarget.value=this.aoRenderTarget.texture),St.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes&&!Bw),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((d=a.uiCanvas)==null?void 0:d.enabled)&&a.uiCanvas.texture&&a.uiCanvas.texture.image.width>0){let p=this.getSize(KTe),f=this.getPixelRatio();(a.uiCanvas.width!==this.viewportWidth||a.uiCanvas.height!==this.viewportHeight||a.uiCanvas.dpr!==f)&&a.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},f),a.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=a.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(p.x,p.y,f),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();let h=!1;if(n!==void 0)St.transmissionRenderTarget.value=n,St.transmissionRenderTargetDepth.value=Gj,this.pipeline.setTransmissionPassEnabled(!1);else{let p=l.needsTransmission();p&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),St.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,St.aspectRatio.value=e_e(this.viewportWidth,this.viewportHeight),St.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(p)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),a.overrideMaterial=l.wireframeState?UI:null,this.pipeline.render(),St.frameIndex.value=(St.frameIndex.value+1)%16,t instanceof ms&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,r,i,n,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(r=this.transmissionDepthTarget)==null||r.dispose(),(i=this.normalRenderTarget)==null||i.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},gY=class extends jw(ahe){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){Vw(this.object,gY.geometryHelper,e,t)}},vY=class extends jw(she){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){Vw(this.object,vY.geometryHelper,e,t)}},kI=class extends jw(nhe){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){Vw(this.object,kI.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=kI._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},yY=kI;yY._vector=new R;function JTe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var wY=class extends vk(Hue,gY){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new aS(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof aS&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&JTe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},qj=new R,Yj=new R,Xj=new Dt,xY=class extends vk(Fue,yY){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=rt.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new aS(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof aS&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),Yj.setFromMatrixPosition(this.matrixWorld),Xj.setFromRotationMatrix(this.matrixWorld),qj.copy(this.up).applyQuaternion(Xj).negate().multiplyScalar(this.distance),this.target.position.copy(Yj).add(qj),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function eCe(e){let t=(e[0][0]+e[1][1])/2,r=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,n=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+n*n),a=Math.sqrt(r*r+i*i),o=s+a,l=s-a,c=Math.atan2(i,r),u=Math.atan2(n,t),h=(u-c)/2,d=(u+c)/2,p=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],f=[[o,0],[0,l]],m=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]];return p[0][0]*=-1,p[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[p,f,m]}function Qb(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function $j(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function tCe(e){let[t,r,i]=eCe(e),n=Qb(t,$j(i)),s=Qb(Qb(i,r),$j(i)),a=Math.atan2(n[1][0],n[0][0]),o=[s[0][0],s[1][1]],l=[s[0][1]/s[1][1],s[1][0]/s[0][0]];return{rotation:a,scale:o,shear:l}}function rCe({rotation:e,scale:t,shear:r}){let i=Math.cos(e),n=Math.sin(e),s=[[i,-n],[n,i]],a=[[t[0],r[0]*t[1]],[r[1]*t[0],t[1]]],o=Qb(s,a);return[o[0][0],o[1][0],o[0][1],o[1][1]]}var pr;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function r(_,C=e.identity()){for(let x=0,A=_.length;x<A;x++)C[x]=_[x];return C}e.copy=r;function i(_,C,x,A,T,M){return e.setAbcdef(e.identity(),_,C,x,A,T,M)}e.create=i;function n(_,C,x,A,T,M,D){return _[0]=C,_[1]=A,_[2]=M,_[3]=x,_[4]=T,_[5]=D,_}e.setAbcdef=n;function s(_,C){let[x,A,T,M,D,P]=o(_),[I,B,V,N,L,W]=o(C),G=I*x+B*T,X=I*A+B*M,Q=V*x+N*T,ie=V*A+N*M,J=L*x+W*T+D,se=L*A+W*M+P;return e.create(G,X,Q,ie,J,se)}e.append=s;function a(_,C){let[x,A,T,M,D,P]=o(_),[I,B,V,N,L,W]=o(C),G=x,X=A,Q=T,ie=M;(I!==1||B!==0||V!==0||N!==1)&&(G=x*I+A*V,X=x*B+A*N,Q=T*I+M*V,ie=T*B+M*N);let J=D*I+P*V+L,se=D*B+P*N+W;return e.create(G,X,Q,ie,J,se)}e.prepend=a;function o(_){return[_[0],_[3],_[1],_[4],_[2],_[5]]}e.getAbcdef=o;function l(_){let[C,x,A,T,M,D]=e.getAbcdef(_),P=C*T-x*A,I=T/P,B=-x/P,V=-A/P,N=C/P,L=(A*D-T*M)/P,W=-(C*D-x*M)/P;return e.create(I,B,V,N,L,W)}e.invert=l;function c([_,C],x){let[A,T,M,D,P,I]=e.getAbcdef(x);return[A*_+M*C+P,T*_+D*C+I]}e.apply=c;function u(_,C){let[x,A,T,M,D,P]=e.getAbcdef(C),I=1/(x*M+T*-A),[B,V]=_;return[M*I*B+-T*I*V+(P*T-D*M)*I,x*I*V+-A*I*B+(-P*x+D*A)*I]}e.applyInverse=u;function h(_,C,x=C){let[A,T,M,D,P,I]=e.getAbcdef(_);return e.setAbcdef(_,A*C,T*x,M*C,D*x,P*C,I*x),_}e.scale=h;function d(_,C){let x=Math.cos(C),A=Math.sin(C),[T,M,D,P,I,B]=e.getAbcdef(_);return e.setAbcdef(_,T*x-M*A,T*A+M*x,D*x-P*A,D*A+P*x,I*x-B*A,I*A+B*x),_}e.rotate=d;function p(_,C,x){let[A,T]=x,M=e.translate(_,-A,-T);return M=e.rotate(M,C),M=e.translate(M,A,T),M}e.rotateAround=p;function f(_,C,x){let[A,T,M,D,P,I]=e.getAbcdef(_);return e.setAbcdef(_,A,T,M,D,P+C,I+x),_}e.translate=f;function m(_,C,x){let[A,T,M,D]=e.getAbcdef(_);return e.setAbcdef(_,A,T,M,D,C,x),_}e.setTranslate=m;function g(_,C,x){let[A,T,M,D]=e.getAbcdef(_);return e.setAbcdef(_,A,T,M,D,C,x),_}e.setPosition=g;function v(_){let[C,x,A,T]=e.getAbcdef(_),M=Math.sqrt(C*C+x*x),D=Math.sqrt(A*A+T*T);return[M,D]}e.getScale=v;function y(_){let[,,,,C,x]=e.getAbcdef(_);return[C,x]}e.getPosition=y;function w(_,C){return e.decompose(_,C).rotation}e.getRotation=w;function b(_,C){let[x,A,T,M,D,P]=e.getAbcdef(_),{rotation:I,scale:B,shear:V}=tCe([[x,T],[A,M]]);return{position:[D+(C[0]*x+C[1]*T)-C[0],P+(C[0]*A+C[1]*M)-C[1]],scale:B,rotation:I,shear:V,pivot:C}}e.decompose=b;function E(_,C,x,A,T=[0,0]){let[M,D]=_,[P,I]=A,[B,V,N,L]=rCe({rotation:x,scale:C,shear:T}),W=M-(P*B+I*N)+P,G=D-(P*V+I*L)+I;return e.create(B,V,N,L,W,G)}e.compose=E})(pr||(pr={}));var iCe=Math.PI/180;function nCe(e,t,r,i,n,s){let a=e-r,o=t-i;return a*a/(n*n)+o*o/(s*s)<=1}function sCe(e){return e*iCe}function aCe(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(n){n(r)}),(i=e.get("*"))&&i.slice().map(function(n){n(t,r)})}}}var Tn=class{constructor(e,t,r){this.uuid=e,this.data=t,this.localMatrix=pr.identity(),this.worldMatrix=pr.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new LI,this._recursiveBBox=new LI,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=aCe(),this.dpr=r.dpr??1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=pr.append(t.worldMatrix,r)),pr.applyInverse(e,r)}intersects(e,t,r,i=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),i)}intersectsInLocalSpace(e,t,r=!1){let{min:i,max:n}=r?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=pr.compose(this.position,this.scale,sCe(this.rotation),Jd.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,r){let i=this.parent;t&&i!==null&&i!==void 0&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=pr.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=pr.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Jd.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,n=Ur(e.path,["states","*"]);if(n!==null){if(e.type===0){let[s]=n;if((this==null?void 0:this.stateSelection)===s){let a={...e.props};if(delete a.name,Object.values(e.props).some(o=>o===void 0)){let o=this.data;if(o!==void 0){let l=jn.zoom(o,e.path.slice(2));if(l)for(let c in e.props)e.props[c]===void 0&&c in l&&(a[c]=l[c])}}i={...e,props:a,path:e.path.slice(2)}}}}else if(e.type===0){let s=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(s!==void 0){if(e.props.name!==void 0&&s.name){let{name:o,...l}=s;s=l}let a=jn.removeOverridden(e.path,e.props,s);i={...e,props:a}}}this.updateByPatchedOpBase(i,Fd.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t,r=!1){if(!(this.data.states.length===0&&!r)){for(let i of this.data.states)Fd.toOps(this.data,i.data).forEach(n=>{let s=vS.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(s,this.data,t)});if(e!==null){let i=this.data.states.data(e);i&&(this.dataPatched=Fd.patch(this.data,i),Fd.toOps(this.data,i).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){e.path.length===0&&e.type===0&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Tn(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Tn&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},Po=class extends Tn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof Po&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let r of this.children)r instanceof Po?r.traverse(e):t=e(r)}intersectsChildrenHelper(e,t,r,i,n){for(let s of this.children)if(s.intersects(e,t,r,!1)&&(n.push(s),i)||s instanceof Po&&s.intersectsChildrenHelper(e,t,r,i,n))return!0;return!1}intersectsChildren(e,t,r,i=!1,n=[],s=!1){return this.intersectsChildrenHelper(e,t,r,i,n),n}intersectsChildrenHelperReverse(e,t,r,i,n){for(let s of this.children)if(s instanceof Po&&s.intersectsChildrenHelperReverse(e,t,r,i,n)||s.intersects(e,t,r,!1)&&(n.push(s),i))return!0;return!1}intersectsChildrenReverse(e,t,r,i=!1,n=[],s=!1){return this.intersectsChildrenHelperReverse(e,t,r,i,n),n}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(r=>{r.uuid===e&&(t=r)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new Po(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},Wh=class extends Po{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new Wh(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function oCe(e,t){let[[r,i],[n,s]]=e,[[a,o],[l,c]]=t,u=(r-n)*(o-c)-(i-s)*(a-l);if(u===0)return!1;let h=((r-a)*(o-c)-(i-o)*(a-l))/u,d=-((r-n)*(i-o)-(i-s)*(r-a))/u;return h>=0&&h<=1&&d>=0&&d<=1}var bY=[[-1,1],[-1,-1],[1,-1],[1,1]],Qj=(e,t,r)=>{let i=e.getCenter(),n=e.getHalfSize(),s=pr.append(t,e.worldMatrix);n[0]===0&&n[1]===0?r.push(pr.apply(i,s)):bY.forEach(a=>{let o=[a[0]*n[0]+i[0],a[1]*n[1]+i[1]];r.push(pr.apply(o,s))})},LI=class{constructor(){this.matrix=pr.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),pr.copy(e.worldMatrix,this.matrix);let r=pr.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];r===!0&&e instanceof Po?e.traverse(n=>{n.visible&&Qj(n,t,i)}):Qj(e,t,i),this.setFromPoints(i)}setFromSize(e,t,r){this.makeEmpty(),pr.copy(r,this.matrix),this.expandBySize(e,t,r)}expandBySize(e,t,r){[pr.apply([0,0],r),pr.apply([0,t],r),pr.apply([e,t],r),pr.apply([e,0],r)].forEach(i=>this.expandByPoint(i))}getCenter(){let[e,t]=this.min,[r,i]=this.getHalfSize();return pr.apply([e+r,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[i,n,s,a]=pr.getAbcdef(this.matrix),o=pr.create(i,n,s,a,r[0],r[1]);this.vertices=bY.map(([l,c])=>pr.apply([l*e,c*t],o))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=pr.append(t.worldMatrix,r)),pr.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:i}=this;return e>=r[0]&&e<=i[0]&&t>=r[1]&&t<=i[1]}containsPoint(e){let[t,r]=e,[i,n]=this.min,[s,a]=this.max;return t>=i&&t<=s&&r>=n&&r<=a}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let i=this.edges[t];for(let n=0,s=e.edges.length;n<s;n++){let a=e.edges[n];if(oCe(i,a))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],pr.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new LI;return e.copy(this),e}},_Y,lCe=new Promise(e=>{_Y=e}),Kj=!1,tb;function cCe(){if(Kj)return;if(tb)return tb;async function e(){let t=await id(()=>import("./ui-L7l3pL7d.js"),[]);_Y(t.default??t),Kj=!0}return tb=e(),tb}function Zj(e){let t=!1;return e.scene.objects.traverse((r,i)=>{(i.type==="Mesh"&&i.geometry.type==="UIGeometry"||i.type==="Page"&&i.uiFrame!==void 0)&&(t=!0)}),t}var Rt,UM;async function uCe(e){let t=await lCe;Rt||(UM||(UM=t({locateFile:()=>e})),Rt=await UM)}var Jj=pr.identity(),SY=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=Lr.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=Lr.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch{console.log(e.width,t)}this._currentM3Transform=Jj,this._currentTransform=new Float32Array(Jj)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){var e,t;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await uCe(this.wasmURL),this._surface=Rt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(e=this._surface)==null?void 0:e.getCanvas(),this._paint=new Rt.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(Rt.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(Rt.PaintStyle.Stroke),(t=this.ctx)==null||t.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=Rt.FontMgr.FromData(e);if(r)this._fonts.set(t,r);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(rb(e),Rt.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(rb(e),Rt.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){var e;(e=this.ctx)==null||e.clear(Rt.TRANSPARENT)}save(){var e;(e=this.ctx)==null||e.save()}restore(){var e;(e=this.ctx)==null||e.restore()}beginPath(){var e;(e=this._currentPath)==null||e.delete(),this._currentPath=new Rt.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,i,n=0,s=0,a=0,o=0){var c,u;let l=Rt.XYWHRect(e,t,r,i);if(n===0&&s===0&&o===0&&a===0)(c=this.ctx)==null||c.clipRect(l,Rt.ClipOp.Intersect,!0);else{let h=Rt.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=a,h[10]=h[11]=o,(u=this.ctx)==null||u.clipRRect(h,Rt.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=pr.invert(this.currentTransform);this.ctx.concat(e);let t=pr.translate(pr.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,r=!0){var i,n,s,a;if(this.ctx&&this._currentPath){let o,l=!1;if(r&&this._hasDropShadow()){let c=e.copy();c.setColor(rb(this._dropShadowColor));let u;this._dropShadowBlur>0&&(u=Rt.MaskFilter.MakeBlur(Rt.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((i=this.camera)==null?void 0:i.scale)??1),!1),c.setMaskFilter(u)),this.ctx.save(),this.ctx.clipPath(this._currentPath,Rt.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(c),this.ctx.restore(),c.delete(),u==null||u.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,Rt.ClipOp.Intersect,!0);let c=Rt.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,Rt.TileMode.Clamp,null),u=e.copy();u.setImageFilter(c),u.setAlphaf(1);let h=this._currentPath.computeTightBounds();this.ctx.saveLayer(u,h,null,Rt.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),u.delete(),c.delete(),l=!0}if(this._layerBlur>0){let c=e.copy();o=Rt.MaskFilter.MakeBlur(Rt.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),c.setMaskFilter(o),t(c),c.delete(),o.delete(),l=!0}if(l||t(e),r&&this._hasInnerShadow()){let c=new Rt.Paint;c.setAntiAlias(!0),c.setStyle(Rt.PaintStyle.Fill),c.setColor(rb(this._innerShadowColor));let u;this._innerShadowBlur>0&&(u=Rt.MaskFilter.MakeBlur(Rt.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((s=this.camera)==null?void 0:s.scale)??1),!1),c.setMaskFilter(u));let h=this._currentPath.computeTightBounds(),[d,p,f,m]=h,g=f-d,v=m-p;this.ctx.save(),this.ctx.clipPath(this._currentPath,Rt.ClipOp.Intersect,!0),this.ctx.saveLayer(c,h,null,Rt.SaveLayerInitWithPrevious),(a=this.ctx)==null||a.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(Rt.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+g+Math.abs(this._innerShadowOffsetX*2),2e3+v+Math.abs(this._innerShadowOffsetY*2)),c),c.setBlendMode(Rt.BlendMode.Clear),this.ctx.drawPath(this._currentPath,c),this.ctx.restore(),this.ctx.restore(),c.delete(),u==null||u.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let r=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,n=>{let s=!1;!t&&this._strokeMode!=="center"&&(r.save(),r.clipPath(i,this._strokeMode==="outside"?Rt.ClipOp.Difference:Rt.ClipOp.Intersect,!0),s=!0),r.drawPath(i,n),s&&r.restore()},t)}}_hasDropShadow(){var e;return((e=this._dropShadowColor)==null?void 0:e.a)>0}_hasInnerShadow(){var e;return((e=this._innerShadowColor)==null?void 0:e.a)>0}path(e){var t;(t=this._currentPath)==null||t.addPath(Rt.Path.MakeFromSVGString(e))}ellipse(e,t,r,i,n,s,a,o){var c;if(!eV([e,t,r,i])||!this._currentPath)return;if(r<0||i<0)throw Error("radii cannot be negative");let l=Rt.XYWHRect(e-r,t-i,r*2,i*2);(c=this._currentPath)==null||c.addOval(l)}rect(e,t,r,i,n=0,s=0,a=0,o=0){var c,u;let l=Rt.XYWHRect(e,t,r,i);if(eV(l))if(n===0&&s===0&&o===0&&a===0)(c=this._currentPath)==null||c.addRect(l);else{let h=Rt.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=a,h[10]=h[11]=o,(u=this._currentPath)==null||u.addRRect(h)}}getHorizontalAlign(e){switch(e){case 2:return Rt.TextAlign.Right;case 3:return Rt.TextAlign.Center;case 4:return Rt.TextAlign.Justify;case 1:default:return Rt.TextAlign.Left}}drawTextInner(e,t,r,[i,n,s,a],o,l,c=!0){let u=0,{ctx:h}=this;if(!h)return u;let d=l.copy(),p=l.copy();return p.setAlphaf(0),this._applyEffectsToPaint(d,f=>{t.pushPaintStyle(r,f,p),t.addText(e);let m=t.build();m.layout(s);let g=n;o===2?g+=(a-m.getHeight())/2:o===3&&(g+=a-m.getHeight()),h.drawParagraph(m,i,g),u=m.getHeight(),t.reset(),m.delete()},c),d.delete(),p.delete(),u}drawText(e,t){let r=0,i=this._fonts.get(t.font),{ctx:n,_paintFill:s,_paintStroke:a}=this;if(i&&n){let o=new Rt.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new Rt.ParagraphStyle({textStyle:o,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),c=Rt.XYWHRect(t.x,t.y,t.width,t.height),u=Rt.ParagraphBuilder.Make(l,i);s&&(r=this.drawTextInner(e,u,o,c,t.verticalAlign,s,!0)),a&&(r=this.drawTextInner(e,u,o,c,t.verticalAlign,a,!1)),u.delete()}return{height:r}}render(){var e;(e=this._surface)==null||e.flush()}moveTo(e,t){var r;(r=this._currentPath)==null||r.moveTo(e,t)}lineTo(e,t){var r;(r=this._currentPath)==null||r.lineTo(e,t)}bezierCurveTo(e,t,r,i,n,s){var a;(a=this._currentPath)==null||a.cubicTo(e,t,r,i,n,s)}quadraticCurveTo(e,t,r,i){var n;(n=this._currentPath)==null||n.quadTo(e,t,r,i)}setTransform(e,t=!1){var n,s,a,o,l;if(!this.ctx)return;let r=this.ctx.getTotalMatrix(),i=pr.invert(r);if(i&&this.ctx.concat(i),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((s=this.camera)==null?void 0:s.enabled)&&((a=this.ctx)==null||a.concat(this.camera.worldMatrix),t)){let c=pr.getScale(this.camera.worldMatrix);(o=this.ctx)==null||o.scale(1/c[0],1/c[1])}(l=this.ctx)==null||l.concat(e),this.currentTransform=e}transform(e){var t;(t=this.ctx)==null||t.concat(e)}setSize(e,t){var r;!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=Rt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(r=this._surface)==null?void 0:r.getCanvas()))}};function eV(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function rb({r:e,g:t,b:r,a:i}){return Rt.Color4f(e,t,r,i)}var tV=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Lr.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},rV=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},hCe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Lr.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},dCe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Lr.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},wn=class extends Tn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new hCe(e+"-fill",t.fill,r),this.stroke=new dCe(e+"-stroke",t.stroke,r),this.dropShadow=new tV(e+"-dropShadow",t.dropShadow,r),this.innerShadow=new tV(e+"-innerShadow",t.innerShadow,r),this.backgroundBlur=new rV(e+"-backgroundBlur",t.backgroundBlur,r),this.layerBlur=new rV(e+"-layerBlur",t.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Lr.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Lr.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=Lr.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=Lr.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(Ur(e.path,["fill"])?this.fill.update(e.props):Ur(e.path,["stroke"])?this.stroke.update(e.props):Ur(e.path,["dropShadow"])?this.dropShadow.update(e.props):Ur(e.path,["innerShadow"])?this.innerShadow.update(e.props):Ur(e.path,["layerBlur"])?this.layerBlur.update(e.props):Ur(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new wn(this.uuid,this.data,e);return t.parent=void 0,t}},xk=class extends wn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return nCe(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new xk(this.uuid,this.data,e);return t.parent=void 0,t}},Gw=class extends wn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new Gw(this.uuid,this.data,e);return t.parent=void 0,t}},bk=class extends wn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Lr.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Lr.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){var s;(s=this._fontHolder)!=null&&s.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,r=this.data.text.textValue.toString(),i=t===2?r.toUpperCase():t===3?r.toLowerCase():r,{height:n}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new bk(this.uuid,this.data,e);return t.parent=void 0,t}},EY=class extends wn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(i=>HS.extremas(i)),t=[1/0,1/0],r=[-1/0,-1/0];for(let i=0,n=e.length;i<n;i++){let s=e[i];s[0][0]<t[0]&&(t[0]=s[0][0]),s[0][1]<t[1]&&(t[1]=s[0][1]),s[1][0]>r[0]&&(r[0]=s[1][0]),s[1][1]>r[1]&&(r[1]=s[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,i=this.data.points.length;r<i;r++){let n=this.data.points[r].data,s=this.data.points[r-1].data,a={start:s.position,cp1:s.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(a)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,i]=this.getHalfSize();return[e+r,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let i=0,n=this.data.points.length;i<n;i++){let s=this.data.points[i].data;if(i===0){let[a,o]=s.position;e.moveTo(a,o)}else{let a=this.data.points[i-1].data,[o,l]=a.controlNext.position,[c,u]=s.controlPrevious.position,[h,d]=s.position,p={start:a.position,cp1:a.controlNext.position,cp2:s.controlPrevious.position,end:s.position};HS.derive(p),e.bezierCurveTo(o,l,c,u,h,d)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,n]=r.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(i,n,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new EY(this.uuid,this.data,e);return t.parent=void 0,t}},HS;(e=>{function t(a){let o=a.start,l=a.cp1,c=a.cp2,u=a.end,h=[3*(l[0]-o[0]),3*(l[1]-o[1])],d=[3*(c[0]-l[0]),3*(c[1]-l[1])],p=[3*(u[0]-c[0]),3*(u[1]-c[1])],f={start:h,cp:d,end:p};return a.derivative=f,f.derivative=NI.derive(f),f}e.derive=t;function r(a,o,l,c=!1){let u=a-2*o+l;if(u!==0){let h=-Math.sqrt(Math.abs(o*o-a*l)),d=-a+o,p=-(h+d)/u,f=-(-h+d)/u;return[p,f]}else if(o!==l&&u===0)return[(2*o-l)/(2*(o-l))];return[]}function i(a){let o=a.derivative??e.derive(a),l=o.start,c=o.cp,u=o.end;return[r(l[0],c[0],u[0]),r(l[1],c[1],u[1])]}e.droot=i;function n(a){let[o,l]=e.droot(a),c=[a.start[0],a.end[0]],u=[a.start[1],a.end[1]];for(let h of o)c.push(e.compute(a,Math.min(1,Math.max(0,h)))[0]);for(let h of l)u.push(e.compute(a,Math.min(1,Math.max(0,h)))[1]);return c.sort((h,d)=>h-d),u.sort((h,d)=>h-d),[[c[0],u[0]],[c[c.length-1],u[u.length-1]]]}e.extremas=n;function s(a,o){if(o===0)return[...a.start];if(o===1)return[...a.end];let l=1-o,c=l*l,u=o*o,h=c*l,d=c*o*3,p=l*u*3,f=o*u;return[h*a.start[0]+d*a.cp1[0]+p*a.cp2[0]+f*a.end[0],h*a.start[1]+d*a.cp1[1]+p*a.cp2[1]+f*a.end[1]]}e.compute=s})(HS||(HS={}));var NI;(e=>{function t(n){let s=n.start,a=n.cp,o=n.end,l=[2*(a[0]-s[0]),2*(a[1]-s[1])],c=[2*(o[0]-a[0]),2*(o[1]-a[1])],u={start:l,end:c};return u.derivative=zI.derive(u),n.derivative=u,u}e.derive=t;function r(n){let s=n.derivative??e.derive(n),a=s.start,o=s.end;return[a[0]!==o[0]?a[0]/(a[0]-o[0]):0,a[1]!==o[1]?a[1]/(a[1]-o[1]):0]}e.droot=r;function i(n,s){if(s===0)return[...n.start];if(s===1)return[...n.end];let a=1-s,o=a*a,l=s*s,c=o,u=a*s*2,h=l;return[c*n.start[0]+u*n.cp[0]+h*n.end[0],c*n.start[1]+u*n.cp[1]+h*n.end[1]]}e.compute=i})(NI||(NI={}));var zI;(e=>{function t(i){let n=i.start,s=i.end,a=[s[0]-n[0],s[1]-n[1]];return i.derivative=a,i.derivative}e.derive=t;function r(i,n){if(n===0)return[...i.start];if(n===1)return[...i.end];let s=i.start,a=i.end;return[s[0]+(a[0]-s[0])*n,s[1]+(a[1]-s[1])*n]}e.compute=r})(zI||(zI={}));var Nl=class extends Po{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new Gw(e+"-background",Q0.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){var e;super.updateLocalMatrix(),(e=this.background)==null||e.updateLocalMatrix()}updateWorldMatrix(e,t,r){var i;super.updateWorldMatrix(e,t,r),(i=this.background)==null||i.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(Ur(e.path,["fill"])?this.fill.update(e.props):Ur(e.path,["stroke"])?this.stroke.update(e.props):Ur(e.path,["dropShadow"])?this.dropShadow.update(e.props):Ur(e.path,["innerShadow"])?this.innerShadow.update(e.props):Ur(e.path,["layerBlur"])?this.layerBlur.update(e.props):Ur(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new Nl(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},pCe=vu(I9(),1),RT=class extends wn{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new RT(this.uuid,this.data,e);return t.parent=void 0,t}};function fCe(e,t=1,r=1){if(t<=0||r<=0)return e;let i=(0,pCe.parseSVG)(e).map(n=>{let s={...n};return"x"in s&&(s.x=s.x*t),"y"in s&&(s.y=s.y*r),"x1"in s&&(s.x1=s.x1*t),"x2"in s&&(s.x2=s.x2*t),"y1"in s&&(s.y1=s.y1*r),"y2"in s&&(s.y2=s.y2*r),"rx"in s&&(s.rx=s.rx*t),"ry"in s&&(s.ry=s.ry*r),s});return mCe(i)}function mCe(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],r;return e.map(i=>{let n=[];t.forEach(a=>{if(a in i){let o=i[a]*1;n.length&&o>=0&&n.push(","),n.push(o)}});let s=(r===i.code?n[0]<0?"":",":i.code)+n.join("");return r=i.code,s}).join("")}function gCe(e,t,r){switch(t.type){case"ellipse2d":return new xk(e,t,r);case"rectangle2d":return new Gw(e,t,r);case"text2d":return new bk(e,t,r);case"vector2d":return new EY(e,t,r);case"path2d":return new RT(e,t,r);case"frame2d":return new Nl(e,t,r);case"group2d":default:return new Wh(e,t,r)}}var TY=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new Wh(TY.GROUP_ID,{...NS.defaultData},r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,i,n,s){let a=gCe(e,t,s);a&&(i.add(a),i.children.splice(n,0,i.children.pop()),a.updateWorldMatrix(),r.length>0&&(a instanceof Wh||a instanceof Nl)&&this.createChildrenObjects(r,a,s))}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,i){let n=this.find(e);if(n)try{n.updateByOp(t,r,{shared:i})}catch(s){console.error(s)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this.group:this.find(e.parent);r!==void 0&&r instanceof Po&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r!==void 0&&r.parent!==void 0&&r.parent instanceof Po){let i=r.parent;r.resetBBoxNeedsUpdate(),i==null||i.remove(r),i==null||i.requestRender()}}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r!==void 0){let i=r.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof Po||n===this){n.add(r);let s=e.localIndex;n.children.splice(s,0,n.children.pop()),r.updateWorldMatrix(!0,!1,!0),i==null||i.requestRender(),r.requestRender()}r.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,r,i=!1,n=[]){return this.group.intersectsChildren(e,t,r,i,n,!0)}intersectsChildrenReverse(e,t,r,i=!1,n=[]){return this.group.intersectsChildrenReverse(e,t,r,i,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this.group;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>o7(r.sortKey,i.sortKey)),t.map(r=>r.entity)}},_k=TY;_k.GROUP_ID="scene2d";function CY({constraints:e,newParentWidth:t,newParentHeight:r,initialParentWidth:i,initialParentHeight:n,objectInitialWidth:s,objectInitialHeight:a,objectInitialPosition:o}){let{horizontalConstraint:l,verticalConstraint:c}=e,u=t-i,h=r-n,d=s,p=a,f=o[0],m=o[1];if(l!==0){if(l===1)f+=u;else if(l===3)f+=u/2;else if(l===2)d=Math.max(1,d+u);else if(l===4){let g=t/i;d*=g,f*=g}}if(c!==0){if(c===1)m+=h;else if(c===3)m+=h/2;else if(c===2)p=Math.max(1,p+h);else if(c===4){let g=r/n;p*=g,m*=g}}return{width:d,height:p,position:[f,m]}}vu(I9(),1);var vCe=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,yCe=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,wCe=new hT(-1,1,1,-1,0,1),xCe=class extends pt{constructor(){super(),this.setAttribute("position",new Ze([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Ze([0,2,0,0,2,0],2))}},bCe=new xCe,_Ce=class{constructor(e){this._mesh=new Ii(bCe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,wCe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},AY=new yr({defines:{},uniforms:{tDiffuse:new ke(null)},vertexShader:vCe,fragmentShader:yCe}),SCe=new _Ce(AY),jM=null,VM=null,ECe=()=>(jM===null&&(jM=document.createElement("canvas")),jM),TCe=e=>(VM===null&&(VM=new SY(e)),VM),CCe=pr.identity(),MY=class{constructor(e,t,r,i){this.uuid=e,this.width=t,this.height=r,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let n=this.width,s=this.height,a=this.dpr;this.renderer.dpr=this.isScreenSpace?a:Math.floor(2048/Math.max(n,s)),this.renderer.setSize(n,s)},this.onFrameOverrideObjectEvent=n=>{var s,a;if(((s=n.target)==null?void 0:s.uuid)!==void 0){let o=(a=this.frameRoot)==null?void 0:a.find(n.target.uuid);o&&o.dispatchEvent({...n,target:o})}},this.scene2d=new _k(rt.generateUUID(),oI.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=ECe(),this.renderer=TCe(this.canvas),this.promise=this.init(),this.renderTarget=new vr(1,1,{type:ou,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new Zce(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof SY&&(this.renderer.wasmURL=Kq.skiaWasmUrl),await this.renderer.init()}render(e){var t,r;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),AY.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let i=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),SCe.render(e),e.setRenderTarget(i),(r=this.textureHolder)==null||r.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,r,i){this.scene2d.updateEntityByOp(e,t,r,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=(e==null?void 0:e.width)??this.width,r=(e==null?void 0:e.height)??this.height;this.frameOverride.width=t,this.frameOverride.height=r,this.frameOverride.localMatrix=CCe,this.isScreenSpace&&(this.frameOverride.fill.color=Lr.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:r},PY({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){var n,s;let r=(e==null?void 0:e.width)??this.width,i=(e==null?void 0:e.height)??this.height;this.dpr=t,this.width=r,this.height=i,this._innerApplySize(),this.renderTarget.setSize(r*t,i*t),(n=this._canvasTexture)==null||n.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),(s=this.frameOverride)==null||s.requestRender()}applyFrame(e){var r,i;let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof Nl)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(r=this.frame)==null||r.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(n=>{n.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(n=>{n.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(i=this.frame)==null||i.requestRender(),t}get frame(){return this.frameOverride}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}find(e){return this.scene2d.find(e)}get texture(){var e;return(e=this.textureHolder)==null?void 0:e.getTexture(1001)}disposeFrameOverride(){var e,t,r;(e=this.frameOverride)==null||e.removeEventListener("render",this.onRenderRequestedDownstream),(t=this.frameOverride)==null||t.traverse(i=>{i.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(r=this.frameOverride)==null||r.traverse(i=>{i.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function PY({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){if(e instanceof Nl&&t instanceof Nl||e instanceof Wh&&t instanceof Wh)for(let a=0,o=e.children.length;a<o;a++){let l=e.children[a],c=t.children[a];l&&c&&l.uuid===c.uuid&&MCe({objectOverride:l,objectRoot:c,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s})}}function ACe(e){if(BI(e))return[e.width,e.height];if(e instanceof RT){let[t,r]=e.getHalfSize();return[t*2,r*2]}else if(e instanceof Wh){let[t,r]=e.recursiveBBox.getHalfSize();return[t*2,r*2]}return[0,0]}function MCe({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){let[a,o]=ACe(t),{width:l,height:c,position:u}=CY({constraints:e.data,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:t.position});if(e.position=u,e.data={...e.data,position:u},e.states)for(let h in e.states)PCe({stateId:h,objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s});if(BI(e)||e instanceof Wh)BI(e)&&(e.width=l,e.height=c,e.data={...e.data,width:l,height:c}),PY({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:c,initialParentWidth:a,initialParentHeight:o});else if(e instanceof RT){let h=t,d=a!==0?l/a:1,p=o!==0?c/o:1;e.path=fCe(h.path,d,p),e.data={...e.data,path:e.path}}}function PCe({stateId:e,objectOverride:t,objectRoot:r,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a}){var c,u;let o=(c=t.states)==null?void 0:c[e],l=(u=r.states)==null?void 0:u[e];if(o&&l){let{width:h,height:d,position:p}=CY({constraints:t.data,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:Jd.isResizeable(l)?l.width:0,objectInitialHeight:Jd.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:p}),Jd.isResizeable(o)&&Object.assign(t.states[e],{width:h,height:d})}}function BI(e){return e instanceof Gw||e instanceof Nl||e instanceof xk||e instanceof bk}var yn=class extends J3(Yc){constructor(e,t,r){super(),this.data=t,this.bgColor=new qn(1,1,1,1),this.fog=null,this.backupFog=new r8(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new bt,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new ms(rv,{...Y0.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new zue(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new _k((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return(e=this.uiCanvas)==null?void 0:e.frame}createUICanvas(e,t){this.uiCanvas=new MY(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var r,i;(r=this.uiCanvas)==null||r.applyFrame(e),(i=this.uiCanvas)==null||i.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=Ns(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(t=>{t instanceof bp&&t.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof sv)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&XTe(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Ns(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=Ns(e.aoColor,t))}updateByOp(e,t,r,i){let n=this.data.uiFrame;super.updateByOp(e,t,r,i);let s=t;Ur(e.path,["fog"])?this.updateFog(s.fog,r.shared):Ur(e.path,["ao"])?this.updateAo(s.ao,r.shared):Ur(e.path,["ambient"])?this.updateAmbientLight(s.ambient,r.shared):Ur(e.path,["shadow"])?this.updateShadow(s.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||n!==s.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(Ns(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof wY&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize,e+=1),r instanceof xY&&r.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;sr.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((Mo(n)||MI(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),FI(n,e,t,!0)),r(n))}};return r(this),t}updateEntity2DByOp(e,t,r,i){var n;(n=this.uiCanvas)==null||n.updateEntity2DByOp(e,t,r,i)}},DCe=class extends vk(jue,vY){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let n=new R(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new R(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new Ni(n,s),o=new oS(a,new bt(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof oS){let r=this.shadow.camera,i=new R(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new R(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},ICe=class extends ps{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ok(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},Sk=class extends ps{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var i;let e={...this.data.geometry.extrusion.shape};for(let n in e)typeof e[n]=="string"&&(e[n]=this._context.shared.getVariable(e[n],[this.uuid,"geometry","extrusion","shape",n]));let t;if(e.type==="Custom"){let n=e.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),t=(i=s.geometry.userData)==null?void 0:i.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(e.type){case"Rectangle":n=ak;break;case"Ellipse":n=sk;break;case"Polygon":n=fq;break;case"Star":n=mq;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=n.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?ok(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},jm=class extends av(ah,Hw){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=OS.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let s of uh.rootOverrideProps)e[s]===void 0?(i===void 0&&(i={...e}),i[s]=r.data[s]):(n===void 0&&(n={}),n[s]=e[s],i===void 0&&(i={...e}),i[s]=Dh.apply(r.data[s],e[s]));return this.overrideData=n,i}else return{...Gn.defaultData,...e,...Xc(Gn.defaultData,uh.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let s of uh.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&uh.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(sr.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),Ek(s),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};DY(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let s of this.children)if(sr.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{let l=o.dataPatched;if(o instanceof ps&&l.bones&&l.boneInverses){let c=o.dataPatched;if(c.bones&&c.boneInverses){let u=c.bones.map(p=>e.scene.find(n[p])),h=c.boneInverses.map(p=>new Be().fromArray(p)),d=new f3(u,h);o.bind(d,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function Ek(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)sr.is(r)&&Ek(r)}}function iV(e,t,r,i){return e.component===t&&U3(e.identity,i)?e.overrideData===r?2:1:0}function DY(e,t,r,i,n,s,a,o,l){if(a>50)return!1;if(i.component!==n){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}n.instances.find(u=>u===i)||n.instances.push(i),i.component=n}n instanceof jm&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let u of n.children)if(sr.is(u)){let h=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],d=MS.resolve(r,h,1);d!=null&&!(d instanceof Qi)&&(Object.setPrototypeOf(d,Qi.prototype),console.error("wrong prototype"));let p=null,f;if(!o){let m=i.children[c];if(p=sr.is(m)?m:null,p!==null){let g=iV(p,u,d,h);f=g>=1?p.stateSelection:void 0,g!==2&&(p=null)}if(p===null&&(p=e.scene.findInstance(h)??null,p!==null)){let g=iV(p,u,d,h);if(f=g>=1?p.stateSelection:void 0,g!==2)p=null;else{let v=p.parent.children.indexOf(p);p.parent.children.splice(v,1),i.children.splice(c,0,p),p.parent===i?v<=c&&console.error("not possible"):(p.parent=i,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(p===null){let m=d?Dh.apply(u.data,d):u.data;yp.is(m.type)&&(m={...m,type:"Empty"}),p=dh.createEntity(h,m,e),p.overrideData=d,i.add(p),i.children.splice(i.children.length-1,1),i.children.splice(c,0,p),p.updateState(p.data,e),f&&p.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let m=p.identity[p.identity.length-1];l[m]=p.uuid}c+=1,DY(e,t,r,p,u,s,a+1,o,l)}if(!o){let u=c;for(;;){let h=i.children[c];if(sr.is(h))e.pendingDeletes.add(h);else break;c+=1}i.children.splice(u,c-u)}return!0}var OCe=class extends av(i8,Hw){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},us=class extends ps{constructor(e,t,r){super(e,t,r),this.onBeforeRender=i=>{this.uiCanvas.render(i)},this.uiCanvas=new MY(e+"-canvas",t.geometry.width,t.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,r.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,r.shared))}applySize(e,t){let r=(e==null?void 0:e.width)??this.dataPatched.geometry.width,i=(e==null?void 0:e.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:i}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){var r;let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),(r=this.localGeometry)==null||r.dispose(),this.localGeometry=tw(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let r=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,r,i){this.uiCanvas.updateEntity2DByOp(e,t,r,i),e===this.frameId&&t.type===0&&(t.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(i):Ur(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},RCe=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let i=Yi,n=new Yc,s=new Hp;s.position.z=1;let a={passThruTexture:{value:null}},o=u(d(),a),l=new Ii(new Wp(2,2),o);n.add(l),this.setDataType=function(p){return i=p,this},this.addVariable=function(p,f,m){let g=this.createShaderMaterial(f),v={name:p,initialValueTexture:m,material:g,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:_r,magFilter:_r};return this.variables.push(v),v},this.setVariableDependencies=function(p,f){p.dependencies=f},this.init=function(){if(r.capabilities.isWebGL2===!1&&r.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(r.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let p=0;p<this.variables.length;p++){let f=this.variables[p];f.renderTargets[0]=this.createRenderTarget(e,t,f.wrapS,f.wrapT,f.minFilter,f.magFilter),f.renderTargets[1]=this.createRenderTarget(e,t,f.wrapS,f.wrapT,f.minFilter,f.magFilter),this.renderTexture(f.initialValueTexture,f.renderTargets[0]),this.renderTexture(f.initialValueTexture,f.renderTargets[1]);let m=f.material,g=m.uniforms;if(f.dependencies!==null)for(let v=0;v<f.dependencies.length;v++){let y=f.dependencies[v];if(y.name!==f.name){let w=!1;for(let b=0;b<this.variables.length;b++)if(y.name===this.variables[b].name){w=!0;break}if(!w)return"Variable dependency not found. Variable="+f.name+", dependency="+y.name}g[y.name]={value:null},m.fragmentShader=`
uniform sampler2D `+y.name+`;
`+m.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let p=this.currentTextureIndex,f=this.currentTextureIndex===0?1:0;for(let m=0,g=this.variables.length;m<g;m++){let v=this.variables[m];if(v.dependencies!==null){let y=v.material.uniforms;for(let w=0,b=v.dependencies.length;w<b;w++){let E=v.dependencies[w];y[E.name].value=E.renderTargets[p].texture}}this.doRenderTarget(v.material,v.renderTargets[f])}this.currentTextureIndex=f},this.getCurrentRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let p=this.variables;for(let f=0;f<p.length;f++){let m=p[f];m.initialValueTexture&&m.initialValueTexture.dispose();let g=m.renderTargets;for(let v=0;v<g.length;v++)g[v].dispose()}};function c(p){p.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=c;function u(p,f){f=f||{};let m=new yr({uniforms:f,vertexShader:h(),fragmentShader:p});return c(m),m}this.createShaderMaterial=u,this.createRenderTarget=function(p,f,m,g,v,y){return p=p||e,f=f||t,m=m||ti,g=g||ti,v=v||_r,y=y||_r,new vr(p,f,{wrapS:m,wrapT:g,minFilter:v,magFilter:y,format:xn,type:i,depthBuffer:!1})},this.createTexture=function(){let p=new Float32Array(e*t*4),f=new Za(p,e,t,xn,Yi);return f.needsUpdate=!0,f},this.renderTexture=function(p,f){a.passThruTexture.value=p,this.doRenderTarget(o,f),a.passThruTexture.value=null},this.doRenderTarget=function(p,f){let m=r.getRenderTarget(),g=r.xr.enabled,v=r.shadowMap.autoUpdate,y=r.outputEncoding,w=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=Ho,r.toneMapping=kl,l.material=p,r.setRenderTarget(f),r.render(n,s),l.material=o,r.xr.enabled=g,r.shadowMap.autoUpdate=v,r.outputEncoding=y,r.toneMapping=w,r.setRenderTarget(m)};function h(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function d(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},kn=new Un,ib=new R,kCe=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let s=1;t&&(s=t.getX(n)+t.getX(n+1)+t.getX(n+2)),kn.a.fromBufferAttribute(e,n),kn.b.fromBufferAttribute(e,n+1),kn.c.fromBufferAttribute(e,n+2),s*=kn.getArea(),r[n/3]=s}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<r.length;n++)i+=r[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t,r)}binarySearch(e){let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r,i){let n=this.randomFunction(),s=this.randomFunction();return n+s>1&&(n=1-n,s=1-s),kn.a.fromBufferAttribute(this.positionAttribute,e*3),kn.b.fromBufferAttribute(this.positionAttribute,e*3+1),kn.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(kn.a,n).addScaledVector(kn.b,s).addScaledVector(kn.c,1-(n+s)),r!==void 0&&kn.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(kn.a.fromBufferAttribute(this.colorAttribute,e*3),kn.b.fromBufferAttribute(this.colorAttribute,e*3+1),kn.c.fromBufferAttribute(this.colorAttribute,e*3+2),ib.set(0,0,0).addScaledVector(kn.a,n).addScaledVector(kn.b,s).addScaledVector(kn.c,1-(n+s)),i.r=ib.x,i.g=ib.y,i.b=ib.z),this}};function LCe(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let n=r*e+i;t[n*2+0]=r/(e-1),t[n*2+1]=i/(e-1)}return t}function NCe(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function zCe(e,t){let r=new Ii(e.geometry,e.material),i=[],n=[],s=new R,a=new R;r.geometry.index!==null&&(r.geometry=r.geometry.toNonIndexed());let o=new kCe(r).build();for(let u=0;u<t;u++)o.sample(s,a),i.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z);let l=new Float32Array(i),c=new Float32Array(n);return{positions:l,normals:c}}function nV(e,t){let r=e,i=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)i[4*s]=r[3*s],i[4*s+1]=r[3*s+1],i[4*s+2]=r[3*s+2],i[4*s+3]=0;let n=new Za(i,t,t,xn,Yi);return n.needsUpdate=!0,n}function BCe({size:e}){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=i,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Za(t,e,e,xn,Yi);return r.needsUpdate=!0,r}function FCe(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new Za(t,e,e,xn,Yi);return r.needsUpdate=!0,r}var UCe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,jCe=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,VCe=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,HCe=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,WCe=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,GCe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+jCe+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${VCe}
      // ATTRACTION
      ${HCe}  
      // VORTEX
      ${WCe}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,IY=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,qCe=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,YCe=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,XCe=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${qCe}
  ${IY}
`,$Ce=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,QCe=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+IY+`  
  ${YCe}

`,KCe=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,ZCe=class extends yr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],sn.startContext(sn.globalContext),this.lightLayer=new vl(0,"",{...mn.defaultData("light","phong"),visible:!1},new dk,{},t.shared),sn.endContext(sn.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new Pq;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(Gbe),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(qbe),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(XCe),e.addFragmentParsCode(QCe),e.addVertexFinalCode($Ce({easeSize:this.easeSize})),e.addFragmentFinalCode(KCe({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},HM=class{constructor(e,t,r,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=NCe(t);let n=1;this.targetMesh=(i==null?void 0:i.type)==="Mesh"&&i?i:this.getMesh(r,n);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(r,n));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:r,normals:i}=zCe(t,e*e),n=nV(r,e),s=nV(i,e);return{dataTexture:n,positions:r,dataTextureNormals:s}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":{r=new Pm(t*.5,32,32);break}case"TorusEmitterShape":{r=new p8(t*.5,.3,15,40);break}case"ConeEmitterShape":{r=new y3(t,t,15);break}case"BoxEmitterShape":{r=new Wo(t,t,t);break}case"PlaneEmitterShape":{r=new Wp(t,t),r.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{r=new Pm(t,32,32);break}default:{r=new Pm(t,32,32);break}}return new Ii(r,new Vp({color:16711680}))}applyToShader(e,t){this.size=new R().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function Qf(e){let t={...e},r=_S.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...r.shape,...t.shape},n={...r.renderMaterial,...t.renderMaterial};return{...r,...t,shape:i,renderMaterial:n}}var JCe=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,WM=10,eAe=class extends Cr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new Nue,this.currentWorldPosition=new R,this.systemQuaternion=new Dt,this.worldGravity=new R(0,0,0),this.directionAxis=new R(0,0,0),this.colliderV3=new R(0,0,0),this.colliderQuaternion=new Dt(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let r=t.data;this.material=new ZCe(r.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:r.renderMaterial.color},uColor2:{value:r.renderMaterial.color2},uPosition:{value:new R(0,0,0)},uEmissionData:{value:new R(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new R(0,0,0)},uWorldQuaternion:{value:new It(0,0,0,1)},uRandScaleFactor:{value:r.randomScale??0},uRandRotationFactor:{value:r.randomRotation??0},uRotation:{value:r.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:r.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,r.renderMaterial.texture),this.init(r)}setTexture(e,t){let r=t.data;if(typeof t=="string"){let i=this.shared.image(t),n=new pi(i.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof r!="string"){let i=new Image;i.onload=()=>{let a=new pi(i);a.needsUpdate=!0,e.uTexture.value=a};let n=new Blob([r],{type:"image/*"}),s=URL.createObjectURL(n);i.src=s}}updateGeometryAttributes(e,t){var i;let r=LCe(t);!((i=this.emitterShape)!=null&&i.positionsAttribute)||e.geometry.setAttribute("ref",new z0(r,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){var a;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let r=1e3/t,i=this.targetFPS/r,n=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let s=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=(a=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:a.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(Qf({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let r=e.data.size;this.colliderV3.fromArray(r),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(i,n)=>{let s=[...this.system.data.shape.size];s[i]=n,this.updateParticleState({shape:{...this.system.data.shape,size:s}})};t[2]==="shape_size_0"&&r(0,e),t[2]==="shape_size_1"&&r(1,e),t[2]==="shape_size_2"&&r(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/WM),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){var t,r,i;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(Qf(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/WM),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),((t=e.renderMaterial)==null?void 0:t.size)!==void 0){let n=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((r=e.renderMaterial)==null?void 0:r.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let n=e.shape.size??this.system.data.shape.size,s=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],a={...Qf(this.system.data).shape,size:s};(i=this.emitterShape)==null||i.applyToShader(this.positionSimRT.material.uniforms,a)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let n=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*rt.DEG2RAD,Number(e[1])*rt.DEG2RAD,Number(e[2])*rt.DEG2RAD],r=new an(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:i,shape:n,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:c}=e;return t!==void 0||r!==void 0||i||i===null||a!==void 0||n!==void 0||o!==void 0||s!==void 0||l!==void 0||c!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let r=new RCe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),n=r.addVariable("uCurrentPosition",i+UCe,this.emitterShape.positionsTexture),s=r.addVariable("uCurrentVelocity",i+GCe,this.emitterShape.directionsTexture),a=r.addVariable("uCurrentEmissionRate",JCe,FCe(this.emitterShape.textureSize));r.setVariableDependencies(n,[n,s,a]),r.setVariableDependencies(s,[n,s,a]),r.setVariableDependencies(a,[n,s,a]);let o=BCe({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new R(0,0,0)},uWorldQuaternion:{value:new It(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new R(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let u=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),h={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new It(0,0,0,1)},uColliderPos:{value:new R(0,0,0)},uColliderSize:{value:new R(0,0,0)},uForceIntensity:{value:u?u.forceIntensity:0},uForceDamping:{value:u?u.forceDambing:0},uColliderQuaternion:{value:new It(0,0,0,1)},uColliderQuaternionInvert:{value:new It(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/WM}};s.material.uniforms=h;let d={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=d;let p=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],f={...Qf(this.system.data).shape,size:p};this.emitterShape.applyToShader(n.material.uniforms,f),r.init(),this.gpuCompute=r,this.positionSimRT=n,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),r=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),i=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,r,i]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let r=this.system.getColliderData(e.colliderEntityId);switch(r==null?void 0:r.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let i=r==null?void 0:r.colliderType;i==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),i==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(r==null?void 0:r.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${r}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new R(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let i=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(i=n)}),i?new HM(r,t,e.type,i):new HM(r,t,"SphereEmitterShape")}else return new HM(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new Qce(new Wp(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:r=0}){return Math.ceil(e*(t+r))}dispose(){var e,t,r;!this.gpuCompute||((t=(e=this.rootObject)==null?void 0:e.parent)==null||t.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(r=this.emitterShape)==null||r.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,i=1/t;if(r>=i){let n=Math.max(1,Math.floor(r/i));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(Qf(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Kb=class extends js{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new pt,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=i=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(i))},this.context=r,this.data={...t,...Qf(t)},this.geometry.setAttribute("position",new Ze([],3)),this.material=new Vp({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new eAe(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let r=this.actualTime/1e3;this.emitter.update(r,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(r=>r.identity===e);return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),Ur(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...bn.drop(e,1).props}}),Ur(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...bn.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){var t;if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(t=this.emitter)==null||t.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var e;this.stopped=!0,this.currentLoopTime=0,(e=this.emitter)==null||e.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var e;this.started=!1,this.stopped=!1,(e=this.emitter)==null||e.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function tAe(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var GM=tAe();function rAe(e,t,r){var n;GM!==void 0&&(((n=t==null?void 0:t.geometry)==null?void 0:n.subdivisions)??0)>GM&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=GM);let i;return t.geometry.type==="TextGeometry"?new cY(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new rw(e,t,r):t.geometry.type==="PathGeometry"?i=new Sk(e,t,r):t.geometry.type==="VectorGeometry"?i=new ICe(e,t,r):t.geometry.type==="BooleanGeometry"?i=new bp(e,t,r):t.geometry.type==="UIGeometry"?i=new us(e,t,r):i=new ps(e,t,r),i)}function Tk(e,t,r){return console.assert(t.type!==void 0),t.type==="Mesh"?rAe(e,t,r):t.type==="Empty"?new Um(e,t):t.type==="Particle"?new Kb(e,t,r):t.type==="ParticleCollider"?new $b(e,t,r):t.type==="Splat"?new Um(e,t):t.type==="Bone"?new OCe(e,t):t.type==="Page"?new yn(e,t,r):t.type==="PointLight"?new DCe(e,t,r):t.type==="SpotLight"?new xY(e,t,r):t.type==="DirectionalLight"?new wY(e,t,r):t.type==="Component"||t.type==="Instance"?new jm(e,t,r):yp.is(t.type)?new ms(e,t):(console.error(t),new Um(e,t))}dh.createEntity=Tk;function iAe(e,t,r){let i=Tk(e.identity,t,r),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let d of Object.keys(i))e[d]=i[d];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),h&&e.changeSelectedState(h,r),e.resetBBoxNeedsUpdate()}dh.changeEntityProptotype=iAe;dh.Cloner=Oo;function nAe(e,t,r,i){e.updateByOp(t,r,i,!1)}function sV(e,t){let r=!1,i=t.getLayersOfType("transmission"),n=t.getLayersOfType("outline");return n.length>0&&(e.layers.set(8),i.length>0&&e.layers.enable(3),r=!0,gk(e),mk(e)),i.length===0&&n.length===0&&e.layers.set(0),e instanceof sv&&e.needsAO&&e.layers.enable(5),r}function aV(e,t){if(!t.layers)return!1;let r=!1,i=t.getLayersOfType("transmission").filter(s=>s.data.visible),n=t.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(e.layers.set(3),n.length>0&&e.layers.enable(8),r=!0),i.length===0&&n.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),r}function sAe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof sv)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)sV(r,r.material[i])&&(t=!0);else sV(r,r.material)&&(t=!0)}),t}function aAe(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof sv)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)aV(r,r.material[i])&&(t=!0);else aV(r,r.material)&&(t=!0)}),t}var oAe=new _8,lAe=new Be,cAe=new Gg;function FI(e,t,r,i=!1){let n=e.cloner;if(n)for(let s of n.children){let a=lAe.copy(s.matrixWorld).invert(),o=cAe.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=oAe;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&r.push({...u[0],object:i?s:e})}}var uAe=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],s=r;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||n.push(s);for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},hAe="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",fh=class{};Sy(fh,"DepthMapRange",65536),Sy(fh,"MemoryPageSize",65536),Sy(fh,"BytesPerFloat",4),Sy(fh,"BytesPerInt",4);function dAe(e){let t,r,i,n,s,a,o,l,c,u,h,d,p,f,m,g;function v(M){let D=new Float64Array(u,a,16);for(let I=0;I<16;I++)D[I]=M[I];let P;if(i>1){t.exports.sortIndexes(n,s,c,a,o,l,d.DepthMapRange,i);let I=new Uint32Array(i);P=I.buffer,I.set(new Uint32Array(u,l,i))}else if(i===1){let I=new Uint32Array(i);I[0]=new Uint32Array(u,n,r)[0],P=I.buffer}else P=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:P},[P])}function y(M,D,P){let I=new Float32Array(u,s,r*3);i=0;let B=new Uint32Array(u,n,r);for(let V=0;V<P.length-1;V++){let N=D[V],L=M[V].elements,W=N.filter(X=>X.enabled&&X.mode==="Include").map(X=>X.type==="Box"?_(X):A(X)),G=N.filter(X=>X.enabled&&X.mode==="Exclude").map(X=>X.type==="Box"?_(X):A(X));for(let X=P[V];X<P[V+1];X++){let Q=p[X*3],ie=p[X*3+1],J=p[X*3+2];if((W.length===0||b(Q,ie,J,W))&&(G.length===0||!b(Q,ie,J,G))){let se=1/(L[3]*Q+L[7]*ie+L[11]*J+L[15]);I[i*3]=(L[0]*Q+L[4]*ie+L[8]*J+L[12])*se,I[i*3+1]=(L[1]*Q+L[5]*ie+L[9]*J+L[13])*se,I[i*3+2]=(L[2]*Q+L[6]*ie+L[10]*J+L[14])*se,B[i]=X,i++}}}}function w(M,D){let P=[],I=D.filter(N=>N.enabled&&N.mode==="Include").map(N=>N.type==="Box"?_(N):A(N)),B=D.filter(N=>N.enabled&&N.mode==="Exclude").map(N=>N.type==="Box"?_(N):A(N)),V=M.length;for(let N=0;N<V;N+=3){let L=M[N],W=M[N+1],G=M[N+2];(I.length===0||b(L,W,G,I))&&(B.length===0||!b(L,W,G,B))||P.push(N/3)}return P}function b(M,D,P,I,B){return I[B==="Intersect"?"every":"some"](V=>{let N=E(M,D,P,V.invRotationMatrix,V.cropCenter);return Array.isArray(V)?x(N.x,N.y,N.z,V):T(N.x,N.y,N.z,V)})}function E(M,D,P,I,B){let V=M-B[0],N=D-B[1],L=P-B[2],W=1/(I[3]*V+I[7]*N+I[11]*L+I[15]);return{x:(I[0]*V+I[4]*N+I[8]*L+I[12])*W+B[0],y:(I[1]*V+I[5]*N+I[9]*L+I[13])*W+B[1],z:(I[2]*V+I[6]*N+I[10]*L+I[14])*W+B[2]}}function _(M){let D=M.cropSize[0]/2,P=M.cropSize[1]/2,I=M.cropSize[2]/2,B=[M.cropCenter[0]-D,M.cropCenter[1]-P,M.cropCenter[2]-I,M.cropCenter[0]+D,M.cropCenter[1]+P,M.cropCenter[2]+I],V=C(M.cropRotation);return Object.assign(B,{invRotationMatrix:V,cropCenter:M.cropCenter})}function C(M){let D=[],P=M[0]*Math.PI/180,I=M[1]*Math.PI/180,B=M[2]*Math.PI/180,V=Math.cos(P),N=Math.sin(P),L=Math.cos(I),W=Math.sin(I),G=Math.cos(B),X=Math.sin(B),Q=V*G,ie=V*X,J=N*G,se=N*X;return D[0]=L*G,D[1]=-L*X,D[2]=W,D[4]=ie+J*W,D[5]=Q-se*W,D[6]=-N*L,D[8]=se-Q*W,D[9]=J+ie*W,D[10]=V*L,D[12]=0,D[13]=0,D[14]=0,D[3]=0,D[7]=0,D[11]=0,D[15]=1,D}function x(M,D,P,I){return M>=I[0]&&M<=I[3]&&D>=I[1]&&D<=I[4]&&P>=I[2]&&P<=I[5]}function A(M){let D=2/M.cropSize[0],P=2/M.cropSize[1],I=2/M.cropSize[2],B=C(M.cropRotation);return{invRadiusX:D,invRadiusY:P,invRadiusZ:I,cropCenter:M.cropCenter,invRotationMatrix:B}}function T(M,D,P,I){let B=(M-I.cropCenter[0])*I.invRadiusX,V=(D-I.cropCenter[1])*I.invRadiusY,N=(P-I.cropCenter[2])*I.invRadiusZ;return B*B+V*V+N*N<=1}e.onmessage=M=>{if(M.data.getCroppedIndexes){let D=new Uint32Array(w(new Float32Array(M.data.positions),M.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:D},[D])}else if(M.data.positions)h=M.data.positions,p=new Float32Array(h),m=M.data.meshMatrixWorlds,g=M.data.cropsArray,f=M.data.meshIndexIntervals,y(m,g,f),e.postMessage({sortSetupComplete:!0});else if(M.data.sort||M.data.newMatrixWorlds||M.data.newCropsArray)(M.data.newMatrixWorlds||M.data.newCropsArray)&&(g=M.data.newCropsArray||g,m=M.data.newMatrixWorlds||m,y(m,g,f)),v(M.data.sort.view,M.data.sort.cameraPosition);else if(M.data.init){d=M.data.init.Constants,r=M.data.init.splatCount;let D=d.BytesPerInt,P=d.BytesPerFloat*3,I=new Uint8Array(M.data.init.sorterWasmBytes),B=D+P,V=r*B,N=r*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2,L=d.MemoryPageSize*32,W=V+N+L,G=Math.floor(W/d.MemoryPageSize)+1,X={module:{},env:{memory:new WebAssembly.Memory({initial:G*2,maximum:G*3,shared:!0})}};WebAssembly.compile(I).then(Q=>WebAssembly.instantiate(Q,X)).then(Q=>{t=Q,n=0,s=r*D,a=s+r*P,c=a+16*d.BytesPerFloat*2,o=c+r*d.BytesPerInt,l=o+d.DepthMapRange*d.BytesPerInt,u=X.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function pAe(e){let t=new Worker(URL.createObjectURL(new Blob(["(",dAe.toString(),")(self)"],{type:"application/javascript"}))),r=atob(hAe),i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:fh.BytesPerFloat,BytesPerInt:fh.BytesPerInt,DepthMapRange:fh.DepthMapRange,MemoryPageSize:fh.MemoryPageSize}}}),t}var qM=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),fAe=function(e,t,r,i){return e+(t<<8)+(r<<16)+(i<<24)},nb=new re;function oV(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.visible===!1)return!0;i.type==="Splat"&&(t=!0)}),t}var Zb=class extends Ii{constructor(e,t,r,i,n=!1,s=1,a,o){super(r,i),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=r,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,r=!1,i=1,n,s){let a=Zb.buildGeomtery(t),o=Zb.buildMaterial(n);return new Zb(e,t,a,o,r,i,n,s)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,r=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new re},viewport:{type:"v2",value:new re},basisViewport:{type:"v2",value:new re},debugColor:{type:"v3",value:new bt},covariancesTextureSize:{type:"v2",value:new re(1024,1024)},centersColorsTextureSize:{type:"v2",value:new re(1024,1024)},orthoZoom:{type:"f",value:-1}};return new yr({uniforms:i,vertexShader:t,fragmentShader:r,transparent:!0,alphaTest:1,blending:Xd,depthTest:!0,depthWrite:!1,side:ia})}static buildGeomtery(e){let t=new pt;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(4*3),i=new Mt(r,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let n=new x8().copy(t),s=new Uint32Array(e),a=new z0(s,1,!1);return a.setUsage(Lne),n.setAttribute("splatIndex",a),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,r=0;for(let i of this.splatBuffers){let n=i.nsplats;this.colors.subarray(e,e+n*4).set(i.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(i.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(r,r+n*6).set(new Float32Array(i.precomputedCovarianceBufferData)),r+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new re(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let r=new re(4096,1024);for(;r.x*r.y*4<e*4;)r.y*=2;let i,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let u=0;u<this.covariances.length;u++)n[u]=hhe.toHalfFloat(this.covariances[u]);i=new Za(n,t.x,t.y,X_,ou)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new Za(n,t.x,t.y,X_,Yi);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(r.x*r.y*4);for(let u=0;u<e;u++){let h=u*4,d=u*3,p=u*4;s[p]=fAe(this.colors[h],this.colors[h+1],this.colors[h+2],this.colors[h+3]),s[p+1]=qM(this.centers[d]),s[p+2]=qM(this.centers[d+1]),s[p+3]=qM(this.centers[d+2])}let a=new Za(s,r.x,r.y,z9,Bc);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(r);let o=256*4,l=new Float32Array(256*16);for(let u=0;u<this.meshMatrixWorlds.length;u++)l.set(this.meshMatrixWorlds[u].elements,u*16);let c=new Za(l,o,1,xn,Yi);c.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=c,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:s,texture:a,size:r},meshMatrixWorlds:{data:l,texture:c}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,i){this.splatCount>0&&(nb.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(nb),this.material.uniforms.basisViewport.value.set(2/nb.x,2/nb.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},OY,mAe=new Promise(e=>{OY=e}),lV=!1,sb;function gAe(){if(lV)return;if(sb)return sb;async function e(){let t=await id(()=>import("./gaussian-splat-compression-CuwKY2Va.js"),[]);OY(t),lV=!0}return sb=e(),sb}var RY;mAe.then(e=>RY=e);var vAe=class{constructor(e={}){Sy(this,"updateView",function(){let t=new Be,r=[],i=new R(0,0,-1),n=new R(0,0,-1),s=new R,a=new R;return function(o=!1,l){let c=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!o){n.set(0,0,-1).applyQuaternion(l.quaternion);let d=!1,p=!1;if(n.dot(i)<=.95&&(d=!0),a.copy(l.position).sub(s).length()>=1&&(p=!0),!d&&!p&&!c&&!u&&!this.needsInitialRender)return}this.needsInitialRender=!1,s.copy(l.position),i.copy(n),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),r[0]=l.position.x,r[1]=l.position.y,r[2]=l.position.z;let h={sort:{view:t.elements,cameraPosition:r,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...c?{newMatrixWorlds:this.meshMatrixWorlds}:{},...u?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=h:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(h))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new Be().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let r=new re;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(r),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*r.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*r.y*.45,this.splatMesh.updateUniforms(r,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new R().fromArray(e.position)),e.orientation&&(e.orientation=new Dt().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(s=>{s.data.type==="Splat"&&t.push(s)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=t.map(s=>s.matrixWorld.clone()),this.cropsArray=t.map(s=>s.data.crops.map(a=>a.data));let r=t.map(s=>new RY.GSplineBuffer(new Uint8Array(s.data.buffer).buffer)),i=0,n=[0];for(let s of r)i+=s.getSplatCount(),n.push(i);return this.setupSplatMesh(r,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,r)=>t.equals(this.meshMatrixWorldsOld[r]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,r)=>{var i;t.data.crops.forEach((n,s)=>{this.cropsArray[r][s]===void 0?(e=!0,this.cropsArray[r][s]=n.data):Object.entries(n.data).forEach(([a,o])=>{var l;Array.isArray(o)&&o.some((c,u)=>c!==this.cropsArray[r][s][a][u])?(e=!0,this.cropsArray[r][s][a]=o):o!==((l=this.cropsArray[r][s])==null?void 0:l[a])&&(e=!0,this.cropsArray[r][s][a]=o)})}),t.data.crops.length!==((i=this.cropsArray[r])==null?void 0:i.length)&&(this.cropsArray[r].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,r=new R,i=new Dt,n=!1,s=1,a,o){this.splatMesh=Zb.buildMesh(e,t,n,s,a,o),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,c,u)=>this.update(l,u)}setupSortWorker(e){this.sortWorker=pAe(e),this.sortWorker.onmessage=t=>{var r;t.data.sortDone?(this.sortRunning=!1,(r=this.splatMesh)==null||r.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},UI=new Vp;UI.wireframe=!0;var cV=new R,Ck=class extends Yc{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new uAe,this.invisibleObjects=new Um("jflkdsafjasdifjaslk",{...$2.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new yn("fdasfa",{...gg.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=aAe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=sAe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof yn&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>o7(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===rv)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof yn&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof yn&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(r=>{t===void 0&&r instanceof us&&(t=r.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof yn&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var r;if(e.path.length===0&&e.type===7){let i=e.parent===null?this:this.find(e.parent);if(i===void 0)throw new Error("unexpected");let n=this.createObject(e.id,e.data,e.children,i,e.localIndex,t);n.updateVisible(this),n.resetBBoxNeedsUpdate(),Mo(n)&&jc(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markPenumbraSizeDirty(),i.parent.remove(i),jc(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Mo(i)&&(i.freeBooleanPointer(),n instanceof bp&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof Sk&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid),i.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let i=this.find(e.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let n=i.parent;this.markNeedsRecomputeInstancesForAncessors(n),(r=i.cloner)==null||r.resetOnMove(),this.markToExpandCloner(i);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(this),i.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),Mo(i)&&(i.invalidateUpstreamBooleanData(),jc(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof bp&&n.invalidateDownstreamBooleanData().recomputeBoolean()),i.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){var t;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let r of this.children)r instanceof yn&&(r.visible=r.uuid===e,r.visible&&(this.activePage=r,this.activePage.onActive(this)));this.activePage!==((t=this.splatViewer)==null?void 0:t.activePage)&&this.reloadSplats()}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{nAe(n,t,r,{scene:this,shared:i}),n instanceof ps&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}updateEntity2DByOp(e,t,r,i,n,s=[]){e.updateEntityByOp(t,r,i,n),this.traverseEntity(a=>{(a instanceof us||a instanceof yn)&&(s.includes(a.frameId??"")||a.frameId===t)&&a.updateEntity2DByOp(t,r,i,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{i instanceof ms&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){sr.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{sr.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,s,a){if(e){let o=i.find(e);o&&o!==i&&n.forInstancesRec(l=>{l.data=q0(l.data,c=>{let u=c.events.data(a.id),h=l.goUp(s);if(h){let d=[...a7(h.identity),e].join("-"),p=this.entityIdentityToEntity[d];if(p){let f=p.uuid,m=jn.zoom(u,t);m[r]=f}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Animation"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Conditional"&&(this.rewriteActions(a.data.ifActions,[...t,a.id,"ifActions"],r,i,n,s),this.rewriteActions(a.data.elseActions,[...t,a.id,"elseActions"],r,i,n,s))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof jm&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=q0(s.data,a=>{s.isInstanceRoot||(a.events.delete(i.id),n=!0)}).data}),n===!1)for(let s of DS.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof jm&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(s=>{r.addClip(s)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),Ek(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof jm&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)sr.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;if(sr.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(Mo(s)||MI(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),FI(s,e,r)),i(s)}};return i(this.activePage),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;sr.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((Mo(n)||MI(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),FI(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)sr.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)sr.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)sr.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof ps&&r.data.type==="Mesh"&&r.data.geometry.type==="TextGeometry"&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n);let s=r.invalidateDownstreamBooleanData();jc(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)ew.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)sr.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,s){var l;let a={scene:this,shared:s},o=Tk(e,t,a);return o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(n,0,i.children.pop()),r.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,o,s)),o.updateState(t,a),o instanceof ps&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(c=>{let u=c.dataPatched;if(c instanceof ps&&u.bones&&u.boneInverses){let h=u.bones.map(f=>this.find(f)),d=u.boneInverses.map(f=>new Be().fromArray(f)),p=new f3(h,d);c.bind(p,c.bindMatrix)}else c.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new Ni;return r.setFromPoints(t),r.getCenter(cV),cV}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof js)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof Hh&&e(t.material[r]);else t.material instanceof Hh&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof ms&&i.setViewplaneSize(e,t,r)})}initializeSplatViewer(){this.splatViewer=new vAe({scene:this}),this.reloadSplats()}reloadSplats(){var e;(e=this.splatViewer)==null||e.loadSplat()}},Jb=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},yAe=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return xAe(Math.atan2(i,r))},wAe=(e,t,r)=>{let i={x:0,y:0};return r=jI(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},jI=e=>e*(Math.PI/180),xAe=e=>e*(180/Math.PI),bAe=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,YM=new Map,uV=e=>{YM.has(e)&&clearTimeout(YM.get(e)),YM.set(e,setTimeout(e,100))},WS=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},hV=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},kY=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),dV=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},VI=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},Ak=(e,t,r)=>{let i=LY(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+r+", ";i[n]=s.slice(0,-2)}return i},_Ae=(e,t)=>{let r=LY(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},LY=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},XM=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},SAe=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},HI=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},EAe=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(NY="ontouchstart"in window,zY=!!window.PointerEvent,BY=!!window.MSPointerEvent);var NY,zY,BY,ay={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},xm,iw={};zY?xm=ay.pointer:BY?xm=ay.MSPointer:NY?(xm=ay.touch,iw=ay.mouse):xm=ay.mouse;function $p(){}$p.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};$p.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};$p.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(a){a.call(r,{type:n,target:r},t)})};$p.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=SAe(t.options,e))};$p.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},WS(e,xm[t],r._domHandlers_[t]),iw[t]&&WS(e,iw[t],r._domHandlers_[t]),r};$p.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},hV(e,xm[t],r._domHandlers_[t]),iw[t]&&hV(e,iw[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var Mk=$p;function hn(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=hn.id,hn.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}hn.prototype=new Mk;hn.constructor=hn;hn.id=0;hn.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};hn.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=_Ae("borderRadius","50%"),r=Ak("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},XM(i.el,r),this.options.shape==="circle"&&XM(i.back,t),XM(i.front,t),this.applyStyles(i),this};hn.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};hn.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};hn.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};hn.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};hn.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};hn.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};hn.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=Ak("transition",["top","left"],i);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(s),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};hn.prototype.restCallback=function(){var e=this,t={};t.front=Ak("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};hn.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};hn.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,s,a;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var TAe=hn;function zi(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=zi.id,zi.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}zi.prototype=new Mk;zi.constructor=zi;zi.id=0;zi.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};zi.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};zi.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};zi.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},s=r.options,a={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new TAe(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(VI(c.ui.el,n),VI(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};zi.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};zi.prototype.bindNipple=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};zi.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),i.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(i),100)};zi.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=kY(e),t.updateBox();var n=function(s){t.actives.length<r.maxNumberOfNipples?t.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(s))};return HI(e,n),t.manager.bindDocument(),!1};zi.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),s>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(o))>=0&&t.idles.splice(i,1),t.actives.push(o),t.ids.push(o.identifier),r.mode!=="semi")l(o);else{var c=Jb(a,o.position);if(c<=r.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};zi.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};zi.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.scroll;if(!bAe(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=Jb(l,n.position),u=yAe(l,n.position),h=jI(u),d=c/o,p={distance:c,position:l},f,m;if(n.options.shape==="circle"?(f=Math.min(c,o),m=wAe(n.position,f,u)):(m=EAe(l,n.position,o),f=Jb(m,n.position)),r.follow){if(c>o){let w=l.x-m.x,b=l.y-m.y;n.position.x+=w,n.position.y+=b,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",c=Jb(l,n.position)}}else l=m,c=f;var g=l.x-n.position.x,v=l.y-n.position.y;n.frontPosition={x:g,y:v},r.dataOnly||VI(n.ui.front,n.frontPosition);var y={identifier:n.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:h,degree:u},vector:{x:g/o,y:-v/o},raw:p,instance:n,lockX:r.lockX,lockY:r.lockY};y=n.computeDirection(y),y.angle={radian:jI(180-u),degree:180-u},n.trigger("move",y),t.trigger("move "+n.id+":move",y)};zi.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))};zi.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};zi.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var CAe=zi;function Cn(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=dV(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;WS(window,"resize",function(){uV(r)});var i=function(){t.scroll=dV()};return WS(window,"scroll",function(){uV(i)}),t.collections}Cn.prototype=new Mk;Cn.constructor=Cn;Cn.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};Cn.prototype.create=function(e){return this.createCollection(e)};Cn.prototype.createCollection=function(e){var t=this,r=new CAe(t,e);return t.bindCollection(r),t.collections.push(r),r};Cn.prototype.bindCollection=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Cn.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Cn.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Cn.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Cn.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};Cn.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Cn.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Cn.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Cn.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=kY(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[n](o),o._found_=!0)},a=function(o){i=r.getIdentifier(o),HI(r.collections,s.bind(null,o,i)),o._found_||r.removeIdentifier(i)};return HI(t,a),!1};Cn.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Cn.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var AAe=Cn,pV=new AAe,MAe={create:function(e){return pV.create(e)},factory:pV},FY=new Map,i0=new Map,jd=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new Oy({src:l,volume:s,delay:a,loop:o}),i0.has(r.uuid)?i0.get(r.uuid).push(this):i0.set(r.uuid,[this]),FY.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},WI=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=FY.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=i0.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...i0.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},UY=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new jd(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new WI(t);else throw new Error("Missing property")}dispatchBasic(){if(ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof jd?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof jd?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof jd&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},jY=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(ni(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},PAe="text/plain",DAe="us-ascii",fV=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),IAe=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:s}=r.groups,a=i.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(u=>{let[h,d=""]=u.split("=").map(p=>p.trim());return h==="charset"&&(d=d.toLowerCase(),d===DAe)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==PAe)&&c.unshift(l),`data:${c.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function OAe(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return IAe(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(i.pathname);if(!c)break;let u=c[0],h=c.index,d=i.pathname.slice(a,h);o+=d.replace(/\/{2,}/g,"/"),o+=u,a=h+u.length}let l=i.pathname.slice(a,i.pathname.length);o+=l.replace(/\/{2,}/g,"/"),i.pathname=o}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];fV(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])fV(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var RAe=class{constructor({url:e,context:t},r,i,n){if(this.controlsManager=r,this.shared=i,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:OAe(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){var e;if(ni(this.shared,this.condition)===!1)return!1;Bw?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.controlsManager.orbitControls)==null||e.onPointerUp(Tt[0]),z0e())}},VY=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=s=>{var c,u;this.timeoutIdQueue.shift();let a=this.page.scene.find(s);if(a===void 0)return;let o=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=o?(c=a.dataPatched.physics)==null?void 0:c.fusedBody:!0;if(a.cloner){for(let h of a.cloner.children)l?(h.playModeVisible=!1,h.rigidBody&&((u=a.dataPatched.physics)==null?void 0:u.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),o.removeRigidBody(h.rigidBody),h.rigidBody=void 0),h.bvhGeometry&&(h.bvhGeometry=void 0)):this.clone===void 0||this.clone===h?(h.playModeVisible=!1,h.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),o.removeRigidBody(h.rigidBody),h.rigidBody=void 0)):h.playModeVisible===void 0&&(h.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(a.visible=!1,a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0))}else a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0),a.visible=!1;o===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.rigidBody!==void 0),a.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(ni(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(ni(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},HY=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.shared=r,this.eventManager=i,this.condition=n,this.shared=r}dispatch(){if(ni(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;this.shared.reset(this.shared.data,!0),Fk(this.page,this.shared,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},WY={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Pk={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},kAe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],GS={CSS:{},springs:{}};function Ro(e,t,r){return Math.min(Math.max(e,t),r)}function n0(e,t){return e.indexOf(t)>-1}function $M(e,t){return e.apply(null,t)}var At={arr:function(e){return Array.isArray(e)},obj:function(e){return n0(Object.prototype.toString.call(e),"Object")},pth:function(e){return At.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||At.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return At.hex(e)||At.rgb(e)||At.hsl(e)},key:function(e){return!WY.hasOwnProperty(e)&&!Pk.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function GY(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function qY(e,t){var r=GY(e),i=Ro(At.und(r[0])?1:r[0],.1,100),n=Ro(At.und(r[1])?100:r[1],.1,100),s=Ro(At.und(r[2])?10:r[2],.1,100),a=Ro(At.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?o*Math.sqrt(1-l*l):0,u=1,h=l<1?(l*o+-a)/c:-a+o;function d(f){var m=t?t*f/1e3:f;return l<1?m=Math.exp(-m*l*o)*(u*Math.cos(c*m)+h*Math.sin(c*m)):m=(u+h*m)*Math.exp(-m*o),f===0||f===1?f:1-m}function p(){var f=GS.springs[e];if(f)return f;for(var m=1/6,g=0,v=0;;)if(g+=m,d(g)===1){if(v++,v>=16)break}else v=0;var y=g*m*1e3;return GS.springs[e]=y,y}return t?d:p}function LAe(e){return e===void 0&&(e=10),function(t){return Math.ceil(Ro(t,1e-6,1)*e)*(1/e)}}var NAe=function(){var e=11,t=1/(e-1);function r(u,h){return 1-3*h+3*u}function i(u,h){return 3*h-6*u}function n(u){return 3*u}function s(u,h,d){return((r(h,d)*u+i(h,d))*u+n(h))*u}function a(u,h,d){return 3*r(h,d)*u*u+2*i(h,d)*u+n(h)}function o(u,h,d,p,f){var m,g,v=0;do g=h+(d-h)/2,m=s(g,p,f)-u,m>0?d=g:h=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(u,h,d,p){for(var f=0;f<4;++f){var m=a(h,d,p);if(m===0)return h;var g=s(h,d,p)-u;h-=g/m}return h}function c(u,h,d,p){if(!(0<=u&&u<=1&&0<=d&&d<=1))return;var f=new Float32Array(e);if(u!==h||d!==p)for(var m=0;m<e;++m)f[m]=s(m*t,u,d);function g(v){for(var y=0,w=1,b=e-1;w!==b&&f[w]<=v;++w)y+=t;--w;var E=(v-f[w])/(f[w+1]-f[w]),_=y+E*t,C=a(_,u,d);return C>=.001?l(v,_,u,d):C===0?_:o(v,y,y+t,u,d)}return function(v){return u===h&&d===p||v===0||v===1?v:s(g(v),h,p)}}return c}(),YY=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=Ro(i,1,10),a=Ro(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function Dk(e,t){if(At.fnc(e))return e;var r=e.split("(")[0],i=YY[r],n=GY(e);switch(r){case"spring":return qY(e,t);case"cubicBezier":return $M(NAe,n);case"steps":return $M(LAe,n);default:return $M(i,n)}}function XY(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function kT(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function LT(e){return e.reduce(function(t,r){return t.concat(At.arr(r)?LT(r):r)},[])}function mV(e){return At.arr(e)?e:(At.str(e)&&(e=XY(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Ik(e,t){return e.some(function(r){return r===t})}function Ok(e){var t={};for(var r in e)t[r]=e[r];return t}function GI(e,t){var r=Ok(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function NT(e,t){var r=Ok(e);for(var i in t)r[i]=At.und(e[i])?t[i]:e[i];return r}function zAe(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function BAe(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,c,u){return l+l+c+c+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function FAe(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(d,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(p-d)*6*f:f<1/2?p:f<2/3?d+(p-d)*(2/3-f)*6:d}var o,l,c;if(i==0)o=l=c=n;else{var u=n<.5?n*(1+i):n+i-n*i,h=2*n-u;o=a(h,u,r+1/3),l=a(h,u,r),c=a(h,u,r-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function UAe(e){if(At.rgb(e))return zAe(e);if(At.hex(e))return BAe(e);if(At.hsl(e))return FAe(e)}function Qc(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function jAe(e){if(n0(e,"translate")||e==="perspective")return"px";if(n0(e,"rotate")||n0(e,"skew"))return"deg"}function qI(e,t){return At.fnc(e)?e(t.target,t.id,t.total):e}function Pl(e,t){return e.getAttribute(t)}function Rk(e,t,r){var i=Qc(t);if(Ik([r,"deg","rad","turn"],i))return t;var n=GS.CSS[t+r];if(!At.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return GS.CSS[t+r]=c,c}function $Y(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?Rk(e,n,r):n}}function kk(e,t){if(At.dom(e)&&!At.inp(e)&&(Pl(e,t)||At.svg(e)&&e[t]))return"attribute";if(At.dom(e)&&Ik(kAe,t))return"transform";if(At.dom(e)&&t!=="transform"&&$Y(e,t))return"css";if(e[t]!=null)return"object"}function QY(e){if(At.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function VAe(e,t,r,i){var n=n0(t,"scale")?1:0+jAe(t),s=QY(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?Rk(e,s,i):s}function Lk(e,t,r,i){switch(kk(e,t)){case"transform":return VAe(e,t,i,r);case"css":return $Y(e,t,r);case"attribute":return Pl(e,t);default:return e[t]||0}}function Nk(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Qc(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function KY(e,t){if(At.col(e))return UAe(e);if(/\s/g.test(e))return e;var r=Qc(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function zk(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function HAe(e){return Math.PI*2*Pl(e,"r")}function WAe(e){return Pl(e,"width")*2+Pl(e,"height")*2}function GAe(e){return zk({x:Pl(e,"x1"),y:Pl(e,"y1")},{x:Pl(e,"x2"),y:Pl(e,"y2")})}function ZY(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=zk(i,s)),i=s}return r}function qAe(e){var t=e.points;return ZY(e)+zk(t.getItem(t.numberOfItems-1),t.getItem(0))}function JY(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return HAe(e);case"rect":return WAe(e);case"line":return GAe(e);case"polyline":return ZY(e);case"polygon":return qAe(e)}}function YAe(e){var t=JY(e);return e.setAttribute("stroke-dasharray",t),t}function XAe(e){for(var t=e.parentNode;At.svg(t)&&At.svg(t.parentNode);)t=t.parentNode;return t}function eX(e,t){var r=t||{},i=r.el||XAe(e),n=i.getBoundingClientRect(),s=Pl(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function $Ae(e,t){var r=At.str(e)?XY(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:eX(r),totalLength:JY(r)*(i/100)}}}function QAe(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=eX(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function gV(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=KY(At.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:At.str(e)||t?i.split(r):[]}}function tX(e){var t=e?LT(At.arr(e)?e.map(mV):mV(e)):[];return kT(t,function(r,i,n){return n.indexOf(r)===i})}function rX(e){var t=tX(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:QY(r)}}})}function KAe(e,t){var r=Ok(t);if(/^spring/.test(r.easing)&&(r.duration=qY(r.easing)),At.arr(e)){var i=e.length,n=i===2&&!At.obj(e[0]);n?e={value:e}:At.fnc(t.duration)||(r.duration=t.duration/i)}var s=At.arr(e)?e:[e];return s.map(function(a,o){var l=At.obj(a)&&!At.pth(a)?a:{value:a};return At.und(l.delay)&&(l.delay=o?0:t.delay),At.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return NT(a,r)})}function ZAe(e){for(var t=kT(LT(e.map(function(s){return Object.keys(s)})),function(s){return At.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var c in o)At.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},n=0;n<t.length;n++)i(n);return r}function JAe(e,t){var r=[],i=t.keyframes;i&&(t=NT(ZAe(i),t));for(var n in t)At.key(n)&&r.push({name:n,tweens:KAe(t[n],e)});return r}function eMe(e,t){var r={};for(var i in e){var n=qI(e[i],t);At.arr(n)&&(n=n.map(function(s){return qI(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function tMe(e,t){var r;return e.tweens.map(function(i){var n=eMe(i,t),s=n.value,a=At.arr(s)?s[1]:s,o=Qc(a),l=Lk(t.target,e.name,o,t),c=r?r.to.original:l,u=At.arr(s)?s[0]:c,h=Qc(u)||Qc(l),d=o||h;return At.und(a)&&(a=c),n.from=gV(u,d),n.to=gV(Nk(a,u),d),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=Dk(n.easing,n.duration),n.isPath=At.pth(s),n.isColor=At.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var iX={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function nX(e,t){var r=rX(e);r.forEach(function(i){for(var n in t){var s=qI(t[n],i),a=i.target,o=Qc(s),l=Lk(a,n,o,i),c=o||Qc(l),u=Nk(KY(s,c),l),h=kk(a,n);iX[h](a,n,u,i.transforms,!0)}})}function rMe(e,t){var r=kk(e.target,t.name);if(r){var i=tMe(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function iMe(e,t){return kT(LT(e.map(function(r){return t.map(function(i){return rMe(r,i)})})),function(r){return!At.und(r)})}function sX(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return i(s)+a+o+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var vV=0;function nMe(e){var t=GI(WY,e),r=GI(Pk,e),i=JAe(r,e),n=rX(e.targets),s=iMe(n,i),a=sX(s,r),o=vV;return vV++,NT(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var ro=[],yV=[],e_,sMe=function(){function e(){e_=requestAnimationFrame(t)}function t(r){var i=ro.length;if(i){for(var n=0;n<i;){var s=ro[n];s.paused?(ro.splice(n,1),i-=1):(s.tick(r),n++)}e()}else e_=cancelAnimationFrame(e_)}return e}();function aMe(e){document.hidden?(ro.forEach(function(t){return t.pause(e.timeStamp)}),yV=ro.slice(0),Li.running=ro=[]):yV.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",aMe);function Li(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s,a=0,o=null;function l(_){var C=window.Promise&&new Promise(function(x){return o=x});return _.finished=C,C}var c=nMe(e);l(c);function u(){var _=c.direction;_!=="alternate"&&(c.direction=_!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(C){(C.loop===1||C.loop%2===0)&&(C.reversed=c.reversed)})}function h(){c.direction="normal",c.reversed=!1,s.forEach(function(_){return _.reversed=!1})}function d(_){return c.reversed?c.duration-_:_}function p(){t=0,r=d(c.currentTime)*(1/Li.speed)}function f(_,C,x=!1){C&&(c.reversed?C.seek(C.duration*C.loop-(_-C.timelineOffset-C.pingPongDelayCorrection),x):C.seek(_-C.timelineOffset-C.startOnceDelay-C.pingPongDelayCorrection,x))}function m(_,C=!1){if(c.reversed)for(var x=a;x--;)f(_,s[x],C);else for(var A=0;A<a;A++)f(_,s[A],C)}function g(_){var ue,oe,le,de,xe,_e,Se,Le,Oe,Ye;var C=0,x=c.animations,A=x.length;for(c.direction!=="alternate"&&((ue=c.parent)==null?void 0:ue.direction)==="alternate"?((oe=c.parent)==null?void 0:oe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((le=c.parent)!=null&&le.reversed&&c.direction==="alternate"?_=c.duration-c.delay+c.endDelay-_:_=c.duration+c.delay-c.endDelay-_):b(!1,(de=c.parent)==null?void 0:de.rewind,c.rewind,(xe=c.parent)==null?void 0:xe.reversePlayback,c.reversePlayback)&&((_e=c.parent)!=null&&_e.reversed&&c.direction==="alternate"?_=c.duration-c.delay+c.endDelay-_:_=c.duration+c.delay-c.endDelay-_);C<A;){var T=x[C],M=T.animatable,D=T.tweens,P=D.length-1,I=D[P];P&&(I=kT(D,function(He){return _<He.end})[0]||I);let $e;(Se=c.parent)!=null&&Se.reversed&&c.direction==="alternate"?$e=Ro(_-I.start-I.endDelay,0,I.duration)/I.duration:$e=Ro(_-I.start-I.delay,0,I.duration)/I.duration;for(var B=isNaN($e)?1:I.easing($e),V=I.to.strings,N=I.round,L=[],W=I.to.numbers.length,G=void 0,X=0;X<W;X++){var Q=void 0;let He,je;c.direction!=="alternate"?((Le=c.parent)==null?void 0:Le.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(He=I.to.numbers[X],je=I.from.numbers[X]||0):(je=I.to.numbers[X],He=I.from.numbers[X]||0):b(!0,(Oe=c.parent)==null?void 0:Oe.rewind,c.rewind,(Ye=c.parent)==null?void 0:Ye.reversePlayback,c.reversePlayback)?(He=I.to.numbers[X],je=I.from.numbers[X]||0):(je=I.to.numbers[X],He=I.from.numbers[X]||0),I.isPath?Q=QAe(I.value,B*je):Q=He+B*(je-He),N&&(I.isColor&&X>2||(Q=Math.round(Q*N)/N)),L.push(Q)}var ie=V.length;if(!ie)G=L[0];else{G=V[0];for(var J=0;J<ie;J++){V[J];var se=V[J+1],ee=L[J];isNaN(ee)||(se?G+=ee+se:G+=ee+" ")}}iX[T.type](M.target,T.property,G,M.transforms),T.currentValue=G,C++}}function v(_){c[_]&&!c.passThrough&&c[_](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let w={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(_,C,x,A,T){return w[_<<4|C<<3|x<<2|A<<1|T]}function E(_,C=!1){var D;var x=c.duration;let A=c.delay,T=x-c.endDelay;(D=c.parent)!=null&&D.reversed&&c.direction==="alternate"&&(A=c.endDelay,T=x-c.delay);var M=d(_);if(c.progress=Ro(M/x*100,0,100),C||(c.reversePlayback=M<c.currentTime),a&&m(M,C),!c.began&&c.currentTime>=0&&(c.began=!0,v("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,v("loopBegin")),(c.reversed||M>=0)&&M<=A&&c.currentTime!==0&&(g(0),v("change")),(M>=T&&c.currentTime!==x+c.pingPongDelayCorrection||!x)&&(g(x),v("change")),M>A&&M<T?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,v("changeBegin")),g(M),v("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,v("change"),a&&v("timelineChangeComplete")):c.began&&M>T&&v("changeComplete"),c.currentTime=Ro(M,0,x+c.pingPongDelayCorrection),c.began&&v("update"),_>=x)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,v("loopComplete"),v("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/Li.speed:t+=c.duration;for(let P of s)P.setStartTime(0),P.remaining=P.loop;v("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():a&&h()}}return c.reset=function(){var _=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=_==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var C=a;C--;)c.children[C].reset();g(c.reversed?c.duration:0)},c.setStartTime=function(_){t=_},c.set=function(_,C){return nX(_,C),c},c.tick=function(_){i=_,t||(t=i),E((i+(r-t))*Li.speed)},c.seek=function(_,C=!1){E(_-t,C)},c.pause=function(_){c.paused=!0,a&&(n=_??performance.now())},c.play=function(_){!c.paused||(c.completed&&c.reset(),c.paused=!1,ro.push(c),a&&n!==void 0&&(t+=(_??performance.now())-n),e_||sMe())},c.reverse=function(){u(),c.completed=!c.reversed,p()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function wV(e,t){for(var r=t.length;r--;)Ik(e,t[r].animatable.target)&&t.splice(r,1)}function oMe(e){for(var t=tX(e),r=ro.length;r--;){var i=ro[r],n=i.animations,s=i.children;wV(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;wV(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function lMe(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?Dk(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",u=At.arr(e),h=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,p=Qc(u?e[1]:e)||0,f=t.start||0+(u?h:0),m=[],g=0;return function(v,y,w){if(o&&(a=0),l&&(a=(w-1)/2),c&&(a=w-1),!m.length){for(var b=0;b<w;b++){if(!n)m.push(Math.abs(a-b));else{var E=l?(n[0]-1)/2:a%n[0],_=l?(n[1]-1)/2:Math.floor(a/n[0]),C=b%n[0],x=Math.floor(b/n[0]),A=E-C,T=_-x,M=Math.sqrt(A*A+T*T);s==="x"&&(M=-A),s==="y"&&(M=-T),m.push(M)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(P){return i(P/g)*g})),r==="reverse"&&(m=m.map(function(P){return s?P<0?P*-1:-P:Math.abs(g-P)}))}var D=u?(d-h)/g:h;return f+D*(Math.round(m[y]*100)/100)+p}}function cMe(e){e===void 0&&(e={});var t=Li(e);return t.duration=0,t.add=function(r,i){var n=ro.indexOf(t),s=t.children;n>-1&&ro.splice(n,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=NT(r,GI(Pk,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=At.und(i)?c:Nk(i,c),a(t);var u=Li(l);a(u),s.push(u),u.parent=t;var h=sX(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Li.version="3.2.0";Li.speed=1;Li.running=ro;Li.remove=oMe;Li.get=Lk;Li.set=nX;Li.convertPx=Rk;Li.path=$Ae;Li.setDashoffset=YAe;Li.stagger=lMe;Li.timeline=cMe;Li.easing=Dk;Li.penner=YY;Li.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var aX=Li,xV=new R,bV=new R,_V=new Dt;function uMe(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function Bn(e,t,r,i,n,s){let a=r[e]!==void 0?r[e]:void 0,o=i[e];if(o==null)return;let l=a!=null?typeof a=="string"?Number(n.getVariable(a)??0):a:t[e],c=typeof o=="string"?Number(n.getVariable(o)??0):o;if(l!==c)return{update:u=>{let h=rt.lerp(l,c,u);s?t[e]=Math.trunc(h):t[e]=h},start:()=>{t[e]=l},end:()=>{t[e]=c}}}function Bk(e,t,r,i,n,s){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let l=t[e],c=[...a??l].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h),u=[...o].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h);if(!(c.length!==u.length||U3(c,u)))return{update:h=>{c.forEach((d,p)=>{let f=rt.lerp(d,u[p],h);t[e][p]=s?Math.trunc(f):f})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],u)}}}function qS(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function SV(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?qS(new R,s,n):o.clone(),c=qS(new R,a,n);if(!l.equals(c))return{update:u=>{o.lerpVectors(l,c,u)},start:()=>{o.copy(l)},end:()=>{o.copy(c)}}}function EV(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function YS(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=!(o instanceof re),c=o instanceof re?o:new re().fromArray(o),u=s?EV(new re,s,n):c.clone(),h=EV(new re,a,n);if(!u.equals(h))return{update:d=>{c.lerpVectors(u,h,d),l&&(t[e]=c.toArray())},start:()=>{c.copy(u),l&&(t[e]=c.toArray())},end:()=>{c.copy(h),l&&(t[e]=c.toArray())}}}function hMe(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new Be().fromArray(n):a.clone(),l=new R,c=new Dt,u=new R;o.decompose(l,c,u);let h=new Be().fromArray(s),d=new R,p=new Dt,f=new R;if(h.decompose(d,p,f),!o.equals(h))return{update:m=>{_V.slerpQuaternions(c,p,m),xV.lerpVectors(l,d,m),bV.lerpVectors(u,f,m),a.compose(xV,_V,bV)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(d,p,f)}}}function dMe(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new bt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new bt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return t[e]=u,{update:h=>{u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function ab(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=new qn(o.r,o.g,o.b,o.a),c=s?typeof s=="string"?n.getColor(s).clone():new qn(s.r,s.g,s.b,s.a):l.clone(),u=typeof a=="string"?n.getColor(a).clone():new qn(a.r,a.g,a.b,a.a);if(!c.equals(u))return{update:h=>{l.lerpColors(c,u,h);let d=rt.lerp(c.a,u.a,h);l.a=d,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(u)}}}function sd(e,t,r,i,n){if(typeof t[e]=="number")return Bn(e,t,r??{},i,n);if(Array.isArray(t[e]))return Bk(e,t,r??{},i,n)}function pMe(e,t,r,i){var o,l,c,u;let n=[],s=e.cameraType==="OrthographicCamera"?(o=t.orthographic)==null?void 0:o.zoom:(l=t.perspective)==null?void 0:l.zoom,a=e.cameraType==="OrthographicCamera"?(c=r.orthographic)==null?void 0:c.zoom:(u=r.perspective)==null?void 0:u.zoom;if(a!==void 0){let h=s??e.zoom,d=a;h!==d&&n.push({update:p=>{e.zoom=rt.lerp(h,d,p),e.updateProjectionMatrix()},start:()=>{e.zoom=h,e.updateProjectionMatrix()},end:()=>{e.zoom=d,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let h=Bn("targetOffset",e,t,r,i);h&&n.push(h)}return n}function fMe(e,t,r,i){if(r.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o),s=r.scaleBaked.map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o);if(Zd.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[rt.lerp(n[0],s[0],o),rt.lerp(n[1],s[1],o),rt.lerp(n[2],s[2],o)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),a}function mMe(e,t,r,i){if(!r.extrusion)return;let n=e.extrusion,s=t.extrusion??{},a=r.extrusion,o=[];return V7.forEach(l=>{let c=sd(l,n,s,a,i);c&&o.push(c)}),o}function gMe(e,t,r,i){let n=[];if(!("geometry"in r))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof rw){let l=fMe(e,a,o,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,Xc(s,eU)),eU.forEach(c=>{let u=sd(c,l,a,o,i);u&&n.push(u)}),e instanceof Sk){Object.assign(l,{extrusion:{...s.extrusion}});let c=mMe(l,a,o,i);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return n}function vMe(e,t,r,i){let n=[];if(r.intensity!==void 0){let s=Bn("intensity",e,t,r,i);s&&n.push(s)}if(r.color!==void 0){let s=dMe("color",e,t,r,i);s&&n.push(s)}return n}function yMe(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},u=a[l];typeof c=="string"||typeof u=="string"||n.push(...TV(o,c,u,i))})}else{if(!("material"in r&&r.material))return n;let s="material"in t&&t.material?t.material:{},a=r.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...TV(e.material,s,a,i))}return n}function TV(e,t,r,i){var a;let n=[],s=wm(r,i)||!!t.layers&&wm(t,i);n.push(AMe(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),c=r.layers.data(o.uuid);if(!c||o.type!=="light"&&(!(o.visible??!0)||!(c.visible??!0)))continue;let u=o.getNames().filter(h=>!F7.some(d=>h.includes(d)));for(let h of u)try{let d=o.getValue(h),p;if(h==="colors")p=TMe(o,l,c,h);else if(Array.isArray(d))h==="steps"&&(p=EMe(o,l,c,h));else if(typeof d=="number")p=wMe(o,l,c,h,i);else{if(typeof d=="boolean")continue;d instanceof re?p=xMe(o,l,c,h):d instanceof R?p=bMe(o,l,c,h,i):d instanceof qn?p=SMe(o,l,c,h,i):d instanceof bt?p=_Me(o,l,c,h,i):"isTexture"in d&&(p=CMe(o,l,c,h))}p&&(Array.isArray(p)?n.push(...p):n.push(p))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return n}function wMe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:e.getValue(i),a=r[i],o=typeof s=="string"?Number(n.getVariable(s)??0):s,l=typeof a=="string"?Number(n.getVariable(a)??0):a;if(o!==l)return{update:c=>{e.setValue(i,rt.lerp(o,l,c))},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,l)}}}function xMe(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new re().fromArray(t[i]):n.clone(),a=new re().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function bMe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=e.getValue(i),a=t?t[i]:void 0,o=r[i],l=a?qS(new R,a,n):s.clone(),c=qS(new R,o,n);if(!l.equals(c))return{update:u=>{s.lerpVectors(l,c,u)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function _Me(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new bt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new bt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function SMe(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new bt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new qn(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function EMe(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s,o=r[i];return U3(a,o)||n.push({update:l=>{let c=[...s];for(let u=0;u<s.length;++u){let h=a[u],d=o[u];c[u]=rt.lerp(h,d,l)}e.setValue(i,c)},start:()=>{e.setValue(i,a)},end:()=>{e.setValue(i,o)}}),n.length?n:void 0}function TMe(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s.map(l=>l.toArray()),o=r[i];for(let l=0;l<s.length;++l){let c=[...a[l]],u=[...o[l]];bS.isEqual(c,u)||n.push({update:h=>{s[l].fromArray(bS.lerp(c,u,h))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(u)}})}return n.length?n:void 0}function CMe(e,t,r,i="texture"){var g,v;if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("rotation"),s=((g=t==null?void 0:t[i])==null?void 0:g.rotation)??0,a=((v=r[i])==null?void 0:v.rotation)??0;if(n&&s!==a)return{update:y=>{n.value=rt.lerp(s,a,y)*rt.DEG2RAD},start:()=>{n.value=s*rt.DEG2RAD},end:()=>{n.value=a*rt.DEG2RAD}};let o=e.getNode("mat");if(!o)return;let l=t?t[i]:o,c=r[i],u=[...l.repeat],h=[...l.offset],d=[...c.repeat],p=[...c.offset],f=l.rotation??0,m=c.rotation??0;if(!Uc.isEqual(u,d)||!Uc.isEqual(h,p)||f!==m)return{update:y=>{o.repeat=Uc.lerp(u,d,y),o.offset=Uc.lerp(h,p,y),o.rotation=rt.lerp(f,m,y),o.updateMatrix()},start:()=>{o.repeat=[...u],o.offset=[...h],o.rotation=f,o.updateMatrix()},end:()=>{o.repeat=[...d],o.offset=[...p],o.rotation=m,o.updateMatrix()}}}function AMe(e,t){return{update:()=>{e.transparent=t}}}var QM=new R,CV=new an;function MMe(e,t,r,i,n){var f,m,g,v,y,w;let s=[],a,o,l,c,u,h,d,p;if(e instanceof Tn?(a=YS("position",e,t,r,n),a&&s.push(a),l=Bn("rotation",e,t,r,n),l&&s.push(l),c=YS("shear",e,t,r,n),c&&s.push(c)):(p={slide:((f=t.pathSnapping)==null?void 0:f.slide)??((m=e.updatedPathSnapping)==null?void 0:m.slide)??((g=e.dataPatched.pathSnapping)==null?void 0:g.slide)??0,offset:((v=t.pathSnapping)==null?void 0:v.offset)??((y=e.updatedPathSnapping)==null?void 0:y.offset)??((w=e.dataPatched.pathSnapping)==null?void 0:w.offset)??0},h=Bn("slide",p,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),h&&s.push(h),d=Bn("offset",p,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),d&&s.push(d),!h&&!d&&(a=SV("position",e,t,r,n),a&&s.push(a),o=SV("scale",e,t,r,n),o&&s.push(o),l=PMe(e,t,r,i,n),l&&s.push(l),u=hMe("hiddenMatrix",e,t,r),u&&s.push(u))),a||o||l||u||h||d){let b=e instanceof Tn?()=>{e.updateWorldMatrix(!0)}:()=>{var E;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(E=e.parent)!=null&&E.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),Mo(e)&&jc(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,p))};s.push({update:b,start:b,end:b})}return s}function PMe(e,t,r,i,n){var u;let s=t!=null&&t.rotation?t.rotation.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*rt.DEG2RAD):void 0,a=(u=r.rotation)==null?void 0:u.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*rt.DEG2RAD);if(!a)return;let o=s?new R().fromArray(s):new R().setFromEuler(e.rotation),l=new R().fromArray(a);if(o.equals(l))return;let c=QM.subVectors(l,o);if(i&&c.toArray().every(h=>Math.abs(h)<2*Math.PI)){let h=new Dt().setFromEuler(CV.setFromVector3(o)),d=new Dt().setFromEuler(CV.setFromVector3(l));return{update:p=>{uMe(h,d,e.quaternion,p)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:h=>{QM.lerpVectors(o,l,h),e.rotation.setFromVector3(QM)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}function DMe(e,t,r,i){let n=[];if(!("cloner"in r)||!e.cloner)return n;let s=e.cloner,a="cloner"in t?t.cloner:{},o=r.cloner;R7.forEach(p=>{let f;p==="count"?f=Bn("count",s.parameters,a,o,i,!0):f=sd(p,s.parameters,a??{},o,i),f&&n.push(f)});let l=IMe(s,a,o,i);l!=null&&l.length&&n.push(...l);let c=OMe(s,a,o,i);c!=null&&c.length&&n.push(...c);let u=RMe(s,a,o,i);u!=null&&u.length&&n.push(...u);let h=kMe(s,a,o,i);h!=null&&h.length&&n.push(...h);let d=LMe(s,a,o,i);return d!=null&&d.length&&n.push(...d),n.length&&n.push({update:()=>{s.update()}}),n}function IMe(e,t,r,i){if(e.parameters.type!=="radial")return;let n=t.radial,s=r.radial;if(!s)return;let a=e.parameters.radial,o=[];return k7.forEach(l=>{let c=sd(l,a,n??{},s,i);c&&o.push(c)}),o}function OMe(e,t,r,i){if(e.parameters.type!=="linear")return;let n=t.linear,s=r.linear;if(!s)return;let a=[],o=e.parameters.linear;return L7.forEach(l=>{let c=sd(l,o,n??{},s,i);c&&a.push(c)}),a}function RMe(e,t,r,i){if(e.parameters.type!=="grid")return;let n=t.grid,s=r.grid;if(!s)return;let a=[],o=e.parameters.grid;return N7.forEach(l=>{let c;l==="count"?c=Bk(l,o,n??{},s,i,!0):c=sd(l,o,n??{},s,i),c&&a.push(c)}),a}function kMe(e,t,r,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,s=r.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return z7.forEach(l=>{let c;l==="count"?c=Bn(l,o,n??{},s,i,!0):c=sd(l,o,n??{},s,i),c&&a.push(c)}),a}function LMe(e,t,r,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,s=r.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return B7.forEach(l=>{let c=sd(l,o,n??{},s,i);c&&a.push(c)}),a}function NMe(e,t){return{update:()=>{e instanceof wn&&(e.fill.enabled=t)}}}function zMe(e,t){return{update:()=>{e instanceof wn&&(e.stroke.enabled=t)}}}function BMe(e,t){return{update:()=>{e instanceof wn&&(e.dropShadow.enabled=t)}}}function FMe(e,t){return{update:()=>{e instanceof wn&&(e.innerShadow.enabled=t)}}}function UMe(e,t){return{update:()=>{e instanceof wn&&(e.backgroundBlur.enabled=t)}}}function jMe(e,t){return{update:()=>{e instanceof wn&&(e.layerBlur.enabled=t)}}}function VMe(e,t,r,i,n){let s=[],a,o,l,c,u,h,d,p,f,m,g,v,y,w,b;if("width"in e&&(a=Bn("width",e,t,r,n),a&&s.push(a)),"height"in e&&(o=Bn("height",e,t,r,n),o&&s.push(o)),e instanceof wn||e instanceof Nl){let E={...t.fill},_={...r.fill};E.enabled!==void 0&&E.enabled!==_.enabled&&(s.push(NMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}}),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}})),l=ab("color",e.fill,E,_,n),l&&s.push(l)}if(e instanceof wn){let E={...t.stroke},_={...r.stroke};(E.enabled||_.enabled)&&(s.push(zMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}}),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}})),c=ab("color",e.stroke,E,_,n),c&&s.push(c),u=Bn("thickness",e.stroke,E,_,n),u&&s.push(u)}if(e instanceof wn){let E={...t.dropShadow},_={...r.dropShadow};(E.enabled||_.enabled)&&(s.push(BMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}}),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}})),h=ab("color",e.dropShadow,E,_,n),h&&s.push(h),d=Bn("blurRadius",e.dropShadow,E,_,n),d&&s.push(d),f=Bn("spread",e.dropShadow,E,_,n),f&&s.push(f),p=YS("offset",e.dropShadow,E,_,n),p&&s.push(p)}if(e instanceof wn){let E={...t.innerShadow},_={...r.innerShadow};(E.enabled||_.enabled)&&(s.push(FMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,color:{...E.color,a:0}}),_.enabled||Object.assign(_,{enabled:!0,color:{..._.color,a:0}})),m=ab("color",e.innerShadow,E,_,n),m&&s.push(m),g=Bn("blurRadius",e.innerShadow,E,_,n),g&&s.push(g),y=Bn("spread",e.innerShadow,E,_,n),y&&s.push(y),v=YS("offset",e.innerShadow,E,_,n),v&&s.push(v)}if(e instanceof wn||e instanceof Nl){let E={...t.backgroundBlur},_={...r.backgroundBlur};(E.enabled||_.enabled)&&(s.push(UMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,radius:0}),_.enabled||Object.assign(_,{enabled:!0,radius:0})),w=Bn("radius",e.backgroundBlur,E,_,n),w&&s.push(w)}if(e instanceof wn){let E={...t.layerBlur},_={...r.layerBlur};(E.enabled||_.enabled)&&(s.push(jMe(e,!0)),E.enabled||Object.assign(E,{enabled:!0,radius:0}),_.enabled||Object.assign(_,{enabled:!0,radius:0})),b=Bn("radius",e.layerBlur,E,_,n),b&&s.push(b)}if(e instanceof Nl||e instanceof Gw){let E=Bk("cornerRadius",e,t,r,n);E&&s.push(E)}return s}function AV(e,t,r,i,n){let s=[];return e.data.visible&&s.push(...MMe(e,t,r,n,i)),e instanceof Tn?s.push(...VMe(e,t,r,n,i)):(e.data.visible&&s.push(...DMe(e,t,r,i)),Mo(e)?(e instanceof ps&&e.data.visible&&s.push(...gMe(e,t,r,i)),e.data.visible&&s.push(...yMe(e,t,r,i))):FSe(e)?e.data.visible&&s.push(...vMe(e,t,r,i)):BSe(e)&&s.push(...pMe(e,t,r,i))),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var MV=new R;function Fk(e,t,r=!1){var s;let i=[],n=a=>{let o=a.data;delete a.states,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let l of o.states){let c={...l.data};a.states||(a.states={}),a.states[l.id]=Fd.patch(o,c)}DV(e.scene,a,null,t,o.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),PV(e)};e.scene.traverse2D(n),e.traverseChildren(a=>{var u,h,d,p,f,m;if(r&&((u=a.rigidBody)==null||u.setTranslation(a.position0,!0),(h=a.rigidBody)==null||h.setRotation(a.rotation0,!0),(d=a.rigidBody)==null||d.setLinvel(MV,!0),(p=a.rigidBody)==null||p.setAngvel(MV,!0)),!sr.is(a))return;let o=a.uuid,l=a.data;if(delete a.states,a.uuid===rv)return;let c=!1;i.some(g=>{var v;return(v=e.scene.find(o))==null?void 0:v.isDescendantOf(g)})?c=!0:((f=l.physics)==null?void 0:f.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&i.push(o),a.data=l,a.currentState=null,a.reversibleToState=null,a.currentTransitionEvent=null;for(let g of l.states){let v={...g.data};e.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||c)&&(g.data.position!==void 0&&delete v.position,g.data.rotation!==void 0&&delete v.rotation,g.data.hiddenMatrix!==void 0&&delete v.hiddenMatrix),a.states||(a.states={}),a.states[g.id]=Nd.patch(l,v)}DV(e.scene,a,null,t,l.events.find(g=>g.data.type==="Follow"||g.data.type==="LookAt")!==void 0),PV(e),a instanceof us&&a.frame&&(a.frame.traverse(g=>n(g)),(m=a.uiCanvas)==null||m.applySize())}),e.frame&&(e.frame.traverse(a=>n(a)),(s=e.uiCanvas)==null||s.applySize())}function PV(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function DV(e,t,r,i,n=!1){if(t instanceof ps&&t.removeInteractionGeometry(i),t instanceof Tn?t.changeSelectedState(r,{shared:i},n):t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof ps&&t.updateGeometryGroupsIfNeeded(),t instanceof ms&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof Tn)){if(t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}}function oX(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:s}=e;t=`spring( ${r}, ${i}, ${n}, ${s} )`}else{let r;switch(e.easing){case 0:r=Hu.linear;break;case 1:r=Hu.ease;break;case 2:r=Hu.easeIn;break;case 3:r=Hu.easeOut;break;case 4:r=Hu.easeInOut;break;default:r=Hu.linear}let[i,n,s,a]=r;t=`cubicBezier( ${i}, ${n}, ${s}, ${a} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function YI(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var HMe={type:"beginState"},WMe={type:"completeState",isfromEntity:!1},IV=class{constructor(e,t,r,i,n,s){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object instanceof Tn||this.object.traverseEntity(o=>{o!==this.object&&o instanceof ms&&o.dispatchEvent(HMe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object instanceof Tn||this.object.traverseEntity(o=>{o!==this.object&&o instanceof ms&&o.dispatchEvent(WMe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=AV(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=t_(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=t_(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(r===void 0)throw new Error("Missing property");{let a=t_(this.object,r);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...YI(i),...oX(i),change:this.onChange},this.callback=AV(this.object,t===void 0?{}:this.from.data,r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},lX=class extends Kn{constructor(e,t,r,i,n){var a;if(super(),this.eventType=e,this.data=t,this.page=r,this.shared=i,this.condition=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var o;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((o=this.timeline)==null||o.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let s=this.page.scene.find(t.object)??((a=this.page.uiCanvas)==null?void 0:a.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!s)throw new Error("Missing property");if(!s.states)throw new Error("Missing property");if(this.object=s,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var e;return((e=this.timeline)==null?void 0:e.paused)===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=t_(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"||!z4(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:r=!1}={}){var i,n,s,a;try{let o=YI(this.data.tweens[0].data);r&&typeof o.loop=="number"&&o.loop--,(i=this.timeline)==null||i.pause(),this.timeline=aX.timeline({autoplay:!1,...o,...o.loop===!0||o.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let u=c;u<this.data.tweens.length-1;u++){let h=this.data.tweens[u],d=this.data.tweens[u+1],p;u===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.changeBegan)===!0)?(p=void 0,this.object instanceof ms&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new IV(this.object,p,d.data.state===void 0?this.currentState:d.data.state,d.data,this.shared,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?o.delay:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let u=c;u>0;u--){let h=this.data.tweens[u],d=this.data.tweens[u-1],p;u===c&&(this.object.wasMovedByUser===!0||((s=this.object.previousAction)==null?void 0:s.changeBegan)===!0)?(p=void 0,this.object instanceof ms&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new IV(this.object,p,d.data.state===void 0?this.currentState:d.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u-1]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?o.endDelay:0))}this.timeline.duration+=o.delay}}catch(o){o instanceof Error&&console.error(o.message)}((a=this.object.previousAction)==null?void 0:a.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(ni(this.shared,this.condition)===!1||z4(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=YI(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay+e)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Tn?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){var t;if(ni(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;if(ni(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var r;(r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function t_(e,t){var n;let r,i;if(typeof t=="string"?(r=t,i=(n=e.states)==null?void 0:n[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var GMe={type:"beginState"},OV={type:"completeState",isfromEntity:!1},RV={type:"requestRender"},cX=class extends Kn{constructor(e,t,r,i){super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.posStart=new R,this.posEnd=new R,this.qStart=new Dt,this.qEnd=new Dt,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=aX({targets:r,t:1,...oX(this.data),update:()=>{r.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(GMe));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(RV),r.t===1&&i.dispatchEvent(OV)}})}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(ni(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,r;if(ni(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward;try{this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(r=this.animation)==null||r.play()):this.timeoutId=window.setTimeout(()=>{var i,n;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(OV),this.page.activeCamera.dispatchEvent(RV))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},uX=class extends Kn{constructor(e,t,r,i,n){var c,u,h;super(),this.data=e,this.page=t,this.animationControls=r,this.shared=i,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,a=t.scene.find(e.object);a&&Array.isArray(a.identity)&&(s=a.identity[0]),this.data={...e,object:s};let o=this.animationControls.clipIdToAction[e.clipId+"/"+s];this.duration=((c=o==null?void 0:o.getClip())==null?void 0:c.duration)??1;let l=((h=(u=o==null?void 0:o.getClip())==null?void 0:u.tracks[0])==null?void 0:h.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/l*this.duration,this.rightFrameTime=this.data.crop[1]/l*this.duration,this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){if(ni(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let s=i.split("/")[1];this.threeAnimAction!==n&&s===t&&n.isRunning()&&(e?n.fadeOut(.2):n.stop())}),e&&((r=this.threeAnimAction)==null||r.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=rt.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(ni(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var r;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let i=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let a=n.split("/")[1];this.threeAnimAction!==s&&a===i&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((r=this.threeAnimAction)==null||r.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},hX=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(ni(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),Fk(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},dX=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=ni(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=gq(this.data.expression,this.shared,ba.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},pX=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.timeoutId=null}dispatchInner(){if(ni(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},qMe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){if(ni(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{var r;this.shared.getVariable(e);let t=(r=this.shared.data.variables.data(e))==null?void 0:r.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(TI(e))})}dispose(){}};function ni(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let r=gq(t.expression,e,"boolean");return t.negate?!r:!!r}function Vs(e,t,r,i,n,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[]},o=l=>({id:c,data:u})=>{try{u.type==="Audio"?Ts[e.type].includes("Audio")&&a.Audio.push(new UY(c,u,s,i,l)):u.type==="Video"&&!(s instanceof Tn)?Ts[e.type].includes("Video")&&a.Video.push(new mX(c,u,s,i,l)):u.type==="Particles"?Ts[e.type].includes("Particles")&&a.Particles.push(new jY(u,r,i,l)):u.type==="Link"?Ts[e.type].includes("Link")&&a.Link.push(new RAe(u,n.controlsManager,i,l)):u.type==="Create"?Ts[e.type].includes("Create")&&a.Create.push(new gX(u,r,n.controlsManager,i,l)):u.type==="Destroy"?Ts[e.type].includes("Destroy")&&a.Destroy.push(new VY(u,r,n.controlsManager,i,l)):u.type==="Reset"?Ts[e.type].includes("Reset")&&a.Reset.push(new HY(u,r,i,n,l)):u.type==="Transition"?Ts[e.type].includes("Transition")&&a.Transition.push(new lX(e.type,u,r,i,l)):u.type==="SwitchCamera"?Ts[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new cX(u,r,i,l)):u.type==="SceneTransition"?Ts[e.type].includes("SceneTransition")&&a.SceneTransition.push(new hX(u,r,n,i,l)):u.type==="Animation"?Ts[e.type].includes("Animation")&&a.Animation.push(new uX(u,r,n.animationControls,i,l)):u.type==="SetVariable"?Ts[e.type].includes("SetVariable")&&a.SetVariable.push(new dX(u,r,i,l)):u.type==="DynamicVariablePlay"?Ts[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new pX(u,r,i,l)):u.type==="Conditional"?Ts[e.type].includes("Conditional")&&(u.ifActions.forEach(o({expression:u.condition,negate:!1})),u.elseActions.forEach(o({expression:u.condition,negate:!0}))):u.type==="ClearLocalStorage"&&Ts[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new qMe(u,r,i,l))}catch{}};return t.forEach(o()),a}function Sn(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof UY||r instanceof mX||r instanceof jY||r instanceof uX||r instanceof lX||r instanceof gX||r instanceof VY||r instanceof cX||r instanceof hX||r instanceof HY||r instanceof dX||r instanceof pX)&&r.dispose()})})}function YMe(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var fX=new Map,s0=new Map,Vm=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:s,delay:a}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let o=YMe(r,i);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,Bw&&(this.videoElement.autoplay=!0),s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),s0.has(r.uuid)?s0.get(r.uuid).push(this):s0.set(r.uuid,[this]),fX.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},XI=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=fX.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=s0.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...s0.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},mX=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new Vm(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new XI(t);else throw new Error("Missing property")}dispatchBasic(){if(ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof Vm?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(ni(this.shared,this.condition)===!1)return!1;this.interaction instanceof Vm?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},kV=(()=>{let e,t,r,i;function n(o){!e&&!LV()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,i=o.requestRender)}function s(o){let l=r?o-r:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,h=c.length,d=0;for(;d<h;){let p=c[d];p.userData.createdTime===void 0&&(p.userData.createdTime=o),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&o-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&u[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),i()),d++):(u[p.userData.actionId]>p.userData.quantity&&u[p.userData.actionId]--,c.splice(d,1),p.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),h--,i())}e=d>0?requestAnimationFrame(s):void 0,r=d>0?o:void 0}function a(){LV()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function LV(){return!!document&&document.hidden}var NV=new Dt,XMe=new R,$Me=new R,gX=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=rt.generateUUID(),this.dispatch=()=>{if(ni(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(ni(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=E0e(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let a=new ds(this.object);if(a.playModeVisible=!0,a.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,c=this.page.scene.find(l);c&&(c.updateMatrixWorldSVD(),a.hiddenMatrix.copy(c.matrixWorldRigid))}a.scale.copy(this.object.scale),a.position.fromArray(this.data.position),a.rotation.fromArray(this.data.rotation),a.updateMatrix(),this.page.add(a);let o=this.controlsManager.sharedGameControlGlobals;o.createdObjects.push(a),o.nCreatedPerAction[this.uniqueId]===void 0?o.nCreatedPerAction[this.uniqueId]=1:o.nCreatedPerAction[this.uniqueId]++,a.updateWorldMatrix(!0,!0),a.traverseObject(this.traverseObjectCB),kV(),this.controlsManager.requestRender()},this.traverseObjectCB=a=>{var u,h,d,p;a.hasNonUniformScale&&a.updateMatrixWorldSVD();let o;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(a instanceof Oo)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;o=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof ds)o=a.object;else if(o=a,(u=o.dataPatched.cloner)==null?void 0:u.hideBase)return!0}else{if(a instanceof Oo)return;a instanceof ds?o=a.object:o=a}this.data.destroy==="Time"?a.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(a.userData.quantity=this.data.destroyAfterQuantity,a.userData.actionId=this.uniqueId);let l=new R().fromArray(this.data.velocity),c=o.dataPatched;if(!(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(a,o,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((h=a.rigidBody)==null||h.collider(0).setActiveEvents(1),a.userData.hasCollisionDestroy=!0),a.matrixWorld.decompose(XMe,NV,$Me),l.applyQuaternion(NV),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&((d=a.rigidBody)==null||d.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in a.object&&this.controlsManager.addBoundsTree(a),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&(a.userData.velocity=l)),((p=o.dataPatched.physics)==null?void 0:p.fusedBody)===!0))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");kV(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},vX=200,KM=.02,ZM=.3,QMe=65;new R;var zV=new R,BV=new R,KMe=new R,As=new R,Ys=new R,ku=new R,JM=new Be,FV=new Be,ZMe=new Be;new Be;var wo=new Dt,fc=new Dt,cl=new an(0,0,0,"YXZ"),JMe=new R(1,0,0),xo=new R(0,1,0),ePe=new R(0,0,1),UV=new R(1,1,1);new ca;var tPe=1,rPe=.025,iPe=16e-6,jV=12,nPe=20,pn=new to,Ua=new Ni,sPe={type:"requestRender"},aPe={type:"updateMatrix"},VV=Math.PI/6,$I=class extends Kn{constructor(e,t,r,i,n,s,a,o,l){var f;super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new Be,this.target0=new R,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=vX,this.euler0=new an(0,0,0,"YXZ"),this.position0Cam=new R,this.quat0Cam=new Dt,this.scale0Cam=new R,this.hiddenMatrix0Cam=new Be,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new to(new R(0,-40,0),new R(0,40,0)),matrix:new Be,position:new R,rotation:new Dt},this.euler=new an(0,0,0,"YXZ"),this.eulerDelta=new R,this.lastPosition=new R,this.lastCameraQuaternion=new Dt,this.lastCameraPosition=new R,this.PI_2=Math.PI/2,this.prevMouse=new re,this.velocityTarget=new R,this.velocity=new R,this.directionXZ=new R,this.rotVelocityStick=new R,this.rotVelocityTarget=new R,this.rotVelocity=new R,this.rotDirection=new R,this.nonColliderRotOffset=new Be,this.nonColliderPosOffset=new Be,this.firstPointerId=-1,this.rot=new R,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new Be,this.objectToTarget=new R,this.objectToTarget0=new R,this.objectToCamXZ=new R,this.objectToCamXZ0=new R,this.targetToCamera=new R,this.targetToCamera0=new R,this.cameraPolarAxis0=new R,this.targetPos=new R,this.targetQuat=new Dt,this.lerpFactorPos=new R().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Dt,this.objXZQuatInv=new Dt,this.objXZRotMat=new Be,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new R,this.pushedVelocity=new R,this.groundYRotation=0,this.objectRealQuat=new Dt,this.colliderWorldQuat=new Dt,this.groundNormal=new R,this.groundTilt=new Dt,this.groundTiltInv=new Dt,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new R,this.quaternion=new Dt,this.scale=new R,this.initialAction=!0,this.onPointerDown=m=>{var g;!(m.target===this.domElement||m.target instanceof HTMLElement&&m.target.tagName==="SPLINE-VIEWER"&&((g=m.target.shadowRoot)!=null&&g.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!xa&&!_4&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,v=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(_4&&L0e<15.5&&!xa?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-v*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-v*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?$I.isLocked=!0:$I.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let v=2;v<4;v++){let y=m.axes[v];g===0?v===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,v===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new R(0,0,-1).applyQuaternion(this.camera.quaternion),g=new R().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let v,y;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,y=g.projectOnVector(m)):g.y/m.y>0?y=m.multiplyScalar(g.y/m.y):y=m.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),v=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(v,this.position);let w=new an().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-w.x,w.x=0,w.z=0,w.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(w)}if(this.object instanceof ms&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*tPe,this.speedOrbit=(r.speedRotate??100)*rPe,this.mouseOrbitSensitivity=(r.speedRotate??100)*iPe,this.keyAssignments=r.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]==="▲"?g[1]="ArrowUp":g[1]==="◀"?g[1]="ArrowLeft":g[1]==="▼"?g[1]="ArrowDown":g[1]==="▶"?g[1]="ArrowRight":g[1]==="⇧"?g[1]="Shift":g[1]==="↵"?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]==="⌘"?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),r.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??fg.defaultData.gravity)*jV,this.usePhysics=this.gloabalPhysics.usePhysics??fg.defaultData.usePhysics,this.jumpPower=r.jumpPower*nPe,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??IS.defaultDataThirdPerson.orientWith,this.slopeThresh=QMe*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*KM/this.pixelsPerMeter,this.stepThresh=r.collider.height*ZM/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*KM/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*ZM/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*KM/this.pixelsPerMeter,this.stepThresh=r.collider.height*ZM/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let h=new R().fromArray(r.collider.position),d=new Dt().setFromEuler(new an().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,UV),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=r.runMultiplier??2;let p=r.navmesh.destinationHelperRadius*2;if(p>0){let m=new xt;m.push({fi:0,data:{...mn.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...mn.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let g=new pk({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Ii(K7.create({parameters:{width:p,height:p/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new an().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof ms?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},DS.list.forEach(r=>{this.actions[r]=Vs({...e,disabled:!1,type:"GameControl"},e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Sn(this.actions.idle),Sn(this.actions.move),Sn(this.actions.run),Sn(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return As.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){var o,l,c,u,h,d,p,f,m;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let g=Ys.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*jV),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,g,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(v){this.onObject=!0,this.groundNormal.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=v.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let y=v.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let w of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(w.rigidBody===y&&w.userData.isFollowingObj!==this.object.uuid){(w.hasNonUniformScale?w.matrixWorldRigid:w.matrixWorld).decompose(As,fc,Ys),this.groundVelocity.subVectors(As,w.prevT),this.object.getWorldPosition(Ys).add(this.collider.position).sub(As),this.groundYRotation=cl.setFromQuaternion(fc).y-w.prevR.y,ku.copy(Ys).applyAxisAngle(xo,this.groundYRotation),this.groundVelocity.add(ku.sub(Ys)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let g=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let v=As.subVectors(this.path[1],this.position),y=Ys.subVectors(this.path[1],this.path[0]);v.dot(y)<0?this.path.shift():(this.directionXZ.x=y.x,this.directionXZ.z=y.z),g.opacity=g.userData.opacity0}else g.opacity-=.05*g.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=KMe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let g=Ys.copy(a);g.y=0,a.set(0,a.y,g.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let g=As;this.camera.getWorldDirection(g);let v=ku.copy(xo).multiplyScalar(g.dot(xo));g.sub(v);let y=Ys.copy(this.directionXZ);y.x*=-1,this.rot.y=g.angleTo(y)*(g.cross(y).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(cl.setFromVector3(this.rot),this.moveMode==="walk"&&(cl.x=0),a.applyEuler(cl),s&&(fc.setFromUnitVectors(xo,this.groundNormal),a.applyQuaternion(fc)),r){let g=cl.set(0,this.vrEulerYOffset*VV,0);r.applyEuler(g),a.x+=r.x,a.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let g=Ys;this.pushedVelocity.set(0,0,0);for(let v of this.sharedGameControlGlobals.entitiesWithTransformAnim){let y=ku.setFromMatrixPosition(v.matrixWorld).sub(v.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),w=v.rigidBody.collider(0).castCollider(y,this.object.rigidBody.collider(0),As.copy(a).divideScalar(this.pixelsPerMeter),i,!1);y.multiplyScalar(this.pixelsPerMeter);let b=sr.is(v)?v:v.object;if(w!==null&&this.lastHitObj!==b){let E;v instanceof ds&&(E=v);let _=this.sharedGameControlGlobals.entityToCollisionEvents[b.uuid];if(_)for(let C of _)C.data.target==="character"&&(C.dispatch(E),b.dispatchEvent(KI));this.lastHitObj=b}if(w!==null){this.pushedVelocity.copy(y),g.copy(w.normal1).applyQuaternion(v.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let v=g.dot(a);v<0&&a.addScaledVector(g,-v),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(xo,this.euler.y-this.euler0.y);let g=Ys.copy(this.objectToCamXZ).normalize(),v=ku.copy(a).multiplyScalar(i);v.y=0;let y=v.sub(As.copy(g).multiplyScalar(v.dot(g))).cross(g).y;this.euler.y-=Math.atan2(y,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=rt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=rt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=rt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(cl.copy(t),cl.y=0):(cl.copy(this.euler),cl.y=0),this.nonColliderRotOffset.makeRotationFromEuler(cl)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*VV),wo.setFromAxisAngle(JMe,this.rot.x),fc.setFromAxisAngle(xo,this.rot.y),fc.multiply(wo),wo.setFromAxisAngle(ePe,this.rot.z),fc.multiply(wo),this.quaternion.copy(fc),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let g=Ys.copy(a).multiplyScalar(i/this.pixelsPerMeter),v=null;this.didHit=!1;let y=new R;for(let w=0;w<5;w++){let b=g.length(),E=ku.copy(g).normalize();if(v=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),this.colliderWorldQuat,E,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,b,!1,24,void 0,void 0,this.object.rigidBody),v!==null){this.didHit=!0;let _=this.sharedGameControlGlobals.colliderToEntity.get(v.collider.handle);if(_!==this.lastHitObj&&w===0){this.lastHitObj=_;let T=this.sharedGameControlGlobals.entityToCollisionEvents[_==null?void 0:_.uuid];if(T){for(let M of T)if(M.data.target==="character"){let D=((u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.getCollider(v.collider.handle))._parent,P;if(_.cloner){for(let I of _.cloner.children)if(I.rigidBody===D){P=I;break}}M.dispatch(P),_.dispatchEvent(KI)}}}let C=zV.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat),x=BV.copy(E).multiplyScalar(v.toi).dot(C),A=v.toi;if(A===0&&(this.position.y+=this.offset*this.pixelsPerMeter),x>this.offset&&(A=v.toi*(x-this.offset)/x,y.addScaledVector(E,A)),g.copy(E).multiplyScalar(b-A),Math.acos(-C.y)>this.slopeThresh){let T=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(y),M=ku.copy(v.witness2).applyQuaternion(this.colliderWorldQuat);M.y=0;let D=T.add(M);D.y+=this.stepThresh;let P=this.sharedGameControlGlobals.rapierWorld.castShape(D,this.colliderWorldQuat,g,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);P!==null&&P.toi===0&&(C.y=0,C.normalize())}g.addScaledVector(C,-g.dot(C))}else{w===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),y.add(g);break}}this.position.addScaledVector(y,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(As.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(wo.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let g=this.onObject?1:5,v=a.multiplyScalar(i/g);for(let y=0;y<g;y++)this.position.add(v),this.collisionAdjustment(i/g)}else this.position.addScaledVector(a,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let g=this.objectToTarget.add(this.position),v=this.targetToCamera.add(g);JM.lookAt(v,g,xo).setPosition(v),JM.decompose(this.targetPos,this.targetQuat,As),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=rt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=rt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(aPe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((m=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:m.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(sPe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=wo.setFromAxisAngle(xo,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?rt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=rt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=rt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=As.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=fc.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){xo.angleTo(e)*180/Math.PI<15||xo.angleTo(e)*180/Math.PI>85?wo.identity():wo.setFromUnitVectors(xo,e),this.groundTilt.slerp(wo,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){var n;let t=BV.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=JM.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(As,wo,Ys).compose(As,wo,UV);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Ua.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=FV.copy(a).invert(),l=ZMe.copy(FV).multiply(r);pn.copy(this.collider.segment),pn.start.applyMatrix4(l),pn.end.applyMatrix4(l);let c=zV.copy(this.position).applyMatrix4(o);Ua.expandByPoint(pn.start),Ua.expandByPoint(pn.end),Ua.min.addScalar(-this.collider.radius),Ua.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(u){return u.distanceToPoint(pn.end)},intersectsBounds:u=>u.intersectsBox(Ua),intersectsTriangle:u=>{let h=As,d=Ys,p=u.closestPointToSegment(pn,h,d);if(p<this.collider.radius){let f=this.collider.radius-p,m=d.sub(h).normalize(),g=ku.copy(c);g.addScaledVector(m,f);let v=g.applyMatrix4(a).sub(this.position);t.add(v),pn.start.addScaledVector(m,f),pn.end.addScaledVector(m,f)}}})}),Ua.makeEmpty(),pn.copy(this.collider.segment),pn.start.applyMatrix4(r),pn.end.applyMatrix4(r),Ua.expandByPoint(pn.start),Ua.expandByPoint(pn.end),Ua.min.addScalar(-this.collider.radius),Ua.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(pn.end)},intersectsBounds:s=>s.intersectsBox(Ua),intersectsTriangle:s=>{let a=As,o=Ys,l=s.closestPointToSegment(pn,a,o);if(l<this.collider.radius){let c=this.collider.radius-l,u=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(u),t.addScaledVector(u,c),pn.start.addScaledVector(u,c),pn.end.addScaledVector(u,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},yX=$I;yX.isLocked=!1;var oPe=vu(D9());function Pc(e,t){let r=new pt;if(!e.getAttribute("position"))return r.setAttribute("position",new Ze([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=DT(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new Ze(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var lPe=new Be,cPe=new Be,ul=[[0,0,0],[0,0,0],[0,0,0]];function wX(e){let t=e.elements;ul[0][0]=t[0],ul[0][1]=t[4],ul[0][2]=t[8],ul[1][0]=t[1],ul[1][1]=t[5],ul[1][2]=t[9],ul[2][0]=t[2],ul[2][1]=t[6],ul[2][2]=t[10];let{u:r,v:i}=(0,oPe.SVD)(ul),n=lPe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=cPe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var uPe=class extends _8{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new nd({color:65280,linewidth:10}),t=new R(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new R(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new R().addVectors(t,r.multiplyScalar(i)),s=new pt;return s.setFromPoints([t,n]),new eS(s,e)}},xX=e=>e instanceof Um||e instanceof jm;function hPe(e,t){return e.distance-t.distance}function bX(e,t,r){if(!(!Mc(t)||!t.visible)){Mo(t)&&t.raycast(e,r);for(let i of t.children)bX(e,i,r)}}function r_(e,t,r,i=!1){if(!i&&!r.some(s=>XS(e,s)!==void 0))return[];let n=[];return t.children.forEach(s=>bX(e,s,n)),n.sort(hPe),n}function QI(e){let t=[];if(e.length){let r=e[0].object;Mc(r)&&t.push(r);let i=r.parent;for(;i;)xX(i)&&t.push(i),i=i.parent}return t}function Dc(e,t,r,i){let n=e.frame;if(n){let s=t[0]*n.width,a=(1-t[1])*n.height;for(let o of r){let l=o===n.uuid?n:n.find(o);if(l!=null&&l.intersects(s,a))return i(l),!0}}return!1}function XS(e,t){if(Mo(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(xX(t))return _X(e,t)}function _X(e,t){if(!(!Mc(t)||!t.visible)){if(Mo(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=_X(e,r);if(i)return i}}}function dPe(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}function pPe(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}var fPe=class{constructor(e,t,r,i,n,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new uPe,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){var i;let{pageX:t,pageY:r}=((i=e.touches)==null?void 0:i.length)>0?e.touches[0]:e;this.pointerWorld=dPe(t,r,this._domRect),this.pointerScreen=pPe(t,r,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},Ko=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},Uk=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],SX=e=>{var t;return(t=Uk.find(([r,i])=>i===e))==null?void 0:t[0]},qw=e=>{var t;return(t=Uk.find(([r])=>r===e))==null?void 0:t[1]},mPe=(e,t)=>{let r=SX(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},gPe=class extends Ko{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{var i;if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=(i=this.splineEvents[SX(e.eventName)])==null?void 0:i[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{var r,i;if((r=t.data)!=null&&r.events.length){for(let[n,s]of Uk)if(t.data.events.some(a=>a.data.type===s&&!a.data.disabled)){this.objectsPerEvents.has(n)?(i=this.objectsPerEvents.get(n))==null||i.push(t):this.objectsPerEvents.set(n,[t]);let a={id:t.uuid,name:t.name},o=mPe(s,a),l=this.splineEvents[n];l?l[t.uuid]=o:this.splineEvents[n]={[t.uuid]:o}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(r=>{r.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},vPe=class{constructor(e,t,r,i,n,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=Vs(t,t.actions,i,n,s,r)}disconnect(){Sn(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch())}},yPe=class extends Ko{constructor(e,t,r){super(e),this.eventManager=t,this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=i=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=r_(n,s,[],!0);this.sceneInterects=a,a.length&&(this.eventContext.sharedAssets.raycastProperty={x:a[0].point.x,y:a[0].point.y,z:a[0].point.z,objX:a[0].object.matrixWorld.elements[12],objY:a[0].object.matrixWorld.elements[13],objZ:a[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{(n.data.type==="MouseDown"||n.data.type==="MousePress")&&(this.onCanvasRaycast(i),n.dispatch())})},this.onCanvasMouseUp=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{n.data.type==="MouseUp"?(this.onCanvasRaycast(i),n.dispatch()):n.data.type==="MousePress"&&n.dispatchRelease()})},this.onMouseDown=i=>{Tt.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseDown"))},this.onMouseUp=i=>{Tt.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=i=>{Tt.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent())},this.onMousePressRelease=i=>{Tt.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent(!0))},this.onKeyDown=i=>{this.heldKeys[i.key]||(this.handleKeyEvent(i,"KeyDown"),this.handleKeyEventHeld(i,"KeyDown",!0)),this.heldKeys[i.key]=!0},this.onKeyUp=i=>{this.handleKeyEvent(i,"KeyUp"),this.handleKeyEventHeld(i,"KeyUp",!0)},this.onKeyPressDown=i=>{this.heldKeysPress[i.key]?this.handleKeyEventHeld(i,"KeyPress"):(this.handleKeyEvent(i,"KeyPress"),this.handleKeyEventHeld(i,"KeyPress",!0)),this.heldKeysPress[i.key]=!0},this.onKeyPressUp=i=>{this.handleKeyEvent(i,"KeyPress",!0)},this.releaseHeldKey=i=>{delete this.heldKeys[i.key]},this.releaseHeldKeyPress=i=>{delete this.heldKeysPress[i.key]},this._onUserEvent=({eventName:i,target:n,reverse:s})=>{var o,l,c,u;if(!i||!n)return;let a=qw(i);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(n.dispatchEvent({type:"beginEvent",eventName:a}),(l=(o=this.eventsPerObjects[a])==null?void 0:o[n.uuid])==null||l.forEach(h=>{h.dispatchUserEvent(s)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(n.dispatchEvent({type:"beginEvent",eventName:a}),(u=(c=this.eventsPerObjects[a])==null?void 0:c[n.uuid])==null||u.forEach(h=>{h.dispatchUserEvent()})))}}connect(){var n,s,a,o,l,c;let{page:e,sharedAssets:t,domElement:r}=this.eventContext,i=(u,h)=>{var p,f;if(!((p=u.data)!=null&&p.events.length))return;let d=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let m of d){let g=this.eventsPerObjects[m];u.data.events.filter(({data:v})=>v.type===m&&v.disabled!==!0).forEach(({id:v,data:y})=>{try{let w=new vPe(v,y,u,e,t,this.eventManager);w.actions.Video.length&&(this.hasVideoAction=!0),(y.type==="MouseDown"||y.type==="MouseUp"||y.type==="MousePress")&&(y.mode==="Canvas"||y.mode==="Window")?this.canvasMouseEvents.push(w):g[u.uuid]?g[u.uuid].some(b=>b.id===w.id)||g[u.uuid].push(w):g[u.uuid]=[w]}catch{}}),(f=g[u.uuid])!=null&&f.length&&this.objectsPerTypes[m].push(u instanceof Tn&&(m==="MouseDown"||m==="MouseUp"||m==="MousePress")?h:u)}};e.traverseEntity(u=>{var h;(u instanceof us||u instanceof yn)&&((h=u.frame)==null||h.traverse(d=>{i(d,u)})),i(u)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),r.addEventListener("pointerdown",this.onCanvasMouseDown),r.addEventListener("pointerup",this.onCanvasMouseUp),((n=this.objectsPerTypes.MouseDown)!=null&&n.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown)),(s=this.objectsPerTypes.MouseUp)!=null&&s.length&&(this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),(a=this.objectsPerTypes.MousePress)!=null&&a.length&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMousePressRelease)),(o=this.objectsPerTypes.KeyDown)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(l=this.objectsPerTypes.KeyUp)!=null&&l.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(c=this.objectsPerTypes.KeyPress)!=null&&c.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([u,h])=>{h.forEach(d=>{d.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){var o,l,c,u;let{stopRaycast:t,raycaster:r,page:i,pointerScreen:n}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter(h=>!(h instanceof Tn));if(!(!s.length&&!this.useForRaycastProperty)&&!(i.uiCanvas&&Dc(i,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),h=>{this.handleObjectMouseEventDispatch(h,e)}))){if(t||this.useForRaycastProperty){let h;if(this.sceneInterects===null?h=r_(r,i,a,this.useForRaycastProperty):(h=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&h.length&&(this.eventContext.sharedAssets.raycastProperty={x:h[0].point.x,y:h[0].point.y,z:h[0].point.z,objX:h[0].object.matrixWorld.elements[12],objY:h[0].object.matrixWorld.elements[13],objZ:h[0].object.matrixWorld.elements[14]}),t){let d=[((l=(o=h[0])==null?void 0:o.uv)==null?void 0:l.x)??0,((u=(c=h[0])==null?void 0:c.uv)==null?void 0:u.y)??0];QI(h).forEach(p=>{p instanceof us&&Dc(p,d,Object.keys(this.eventsPerObjects[e]),f=>{this.handleObjectMouseEventDispatch(f,e)}),this.eventsPerObjects[e][p.uuid]&&this.handleObjectMouseEventDispatch(p,e)})}}t||a.forEach(h=>{var p,f;let d=XS(r,h);d&&(this.handleObjectMouseEventDispatch(h,e),h instanceof us&&Dc(h,[((p=d==null?void 0:d.uv)==null?void 0:p.x)??0,((f=d==null?void 0:d.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[e]),m=>{this.handleObjectMouseEventDispatch(m,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=r.filter(s=>!(s instanceof Tn)),n=[];if(r.length){if(!e){let{stopRaycast:s,raycaster:a,page:o,pointerScreen:l}=this.eventContext,c=!1;if(o.uiCanvas&&(c=Dc(o,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),u=>{n.push(u)})),s&&!c){let u=r_(a,o,i);n=QI(u),u.forEach(h=>{var d,p;h.object instanceof us&&Dc(h.object,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[t]),f=>{n.push(f)})})}else i.forEach(u=>{var d,p;let h=XS(a,u);h&&(n.push(u),u instanceof us&&Dc(u,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[t]),f=>{n.push(f)}))})}this._prevObjects.length&&this._prevObjects.forEach(s=>{n.includes(s)||this.handleObjectMouseEventDispatchRelease(s,t)}),n.length&&n.forEach(s=>{this.handleObjectMouseEventDispatch(s,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var r,i;e.dispatchEvent({type:"beginEvent",eventName:t}),(i=(r=this.eventsPerObjects[t])==null?void 0:r[e.uuid])==null||i.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(r?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},wPe=new R,xPe=new R,EX=class{constructor(e,t,r,i,n){this.actionsIn=Vs(e,e.inActions,r,i,n,t),this.actionsOut=Vs(e,e.outActions,r,i,n,t)}disconnect(){Sn(this.actionsIn),Sn(this.actionsOut)}},bPe=class extends EX{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let d of this.objects)if(!d.visible)return;let c=wPe.setFromMatrixPosition(this.objects[0].matrixWorld),u=xPe.setFromMatrixPosition(this.objects[1].matrixWorld),h=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(p=>p.dispatchConditional()),d.Particles.forEach(p=>p.dispatchConditional()),d.Video.forEach(p=>p.dispatchConditional()),d.Link.forEach(p=>p.dispatch()),d.Create.forEach(p=>p.dispatch()),d.Destroy.forEach(p=>p.dispatch()),d.Reset.forEach(p=>p.dispatch()),d.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),d.Transition.forEach(p=>p.play()),d.Animation.forEach(p=>p.play()),d.SwitchCamera.forEach(p=>p.play()),d.SceneTransition.forEach(p=>p.dispatch()),d.SetVariable.forEach(p=>p.checkConditions()),d.SetVariable.forEach(p=>p.dispatch()),d.DynamicVariablePlay.forEach(p=>p.dispatch()),d.ClearLocalStorage.forEach(p=>p.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let u=i.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},_Pe=class extends EX{constructor(e,t,r,i,n,s){var l;super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.onBegin=({target:c,state:u})=>{this.toState!==u&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Particles.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()),this.actionsOut.SetVariable.forEach(h=>h.checkConditions()),this.actionsOut.SetVariable.forEach(h=>h.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(h=>h.dispatch()),this.actionsOut.ClearLocalStorage.forEach(h=>h.dispatch()))},this.onComplete=({target:c,state:u})=>{this.toState===u&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Particles.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()),this.actionsIn.SetVariable.forEach(h=>h.checkConditions()),this.actionsIn.SetVariable.forEach(h=>h.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(h=>h.dispatch()),this.actionsOut.ClearLocalStorage.forEach(h=>h.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object)??i.scene.find2D(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){Ld(this.actionsOut).forEach(e=>{var t;(t=this.actionsOut[e])!=null&&t.length&&this.toObject.addEventListener("beginState",this.onBegin)}),Ld(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),Ld(this.actionsOut).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),Ld(this.actionsIn).forEach(e=>{var t;(t=this.actionsIn[e])!=null&&t.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},SPe=class extends Ko{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length){for(let{id:n,data:s}of r.data.events)if(!s.disabled&&s.type==="Conditional")try{let a;s.condition.type==="Comparison"||(s.condition.type==="Distance"?a=new bPe(n,s,r,e,t,this.eventManager):s.condition.type==="State"&&(a=new _Pe(n,s,r,e,t,this.eventManager))),a&&(this.eventsPerConditions[s.condition.type].push(a),(a.actionsIn.Video.length||a.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(r=>r.forEach(i=>i.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},oy=new R,Lu=new R,gd=new R,HV=new ya,EPe=.01,wr=new R,rn=new R,WV=new R,Vd=new Dt,eP=new an,TPe=new Be,tP=new ln,Lf=new R,hl=new R,Nf=.2;function rP(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var CPe=function(){let e=new Be;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&rP(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?rP(n.position,t.limits):t.reference==="local"&&(Vd.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(Vd),rP(n.position,t.limits),Vd.invert(),n.position.applyQuaternion(Vd),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(wr,n.quaternion,rn),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof js&&jc(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),APe=class{constructor(e,t,r,i,n,s,a){this.object=e,this.id=t,this.data=r,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Vs(r,r.dragDropActions.drag,i,n,s,this.object),this.actionsDrop=Vs(r,r.dragDropActions.drop,i,n,s,this.object);let o=[];this.data.objects.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(o.push(c),a[c.uuid]&&a[c.uuid].forEach(u=>{let h=i.find(u);!h||h.data.visible!==!1&&o.push(h)}))}),this.data.dropDestinations.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(this.dropDestIds.push(c.uuid),a[c.uuid]&&a[c.uuid].forEach(u=>{let h=i.find(u);!h||h.data.visible!==!1&&this.dropDestIds.push(h.uuid)}))}),this.dragItems=o.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new R().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new R().setFromMatrixPosition(l.matrixWorld),pointStart:new R,pointEnd:new R,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new R().copy(l.position),quat0:new Dt().copy(l.quaternion),snapped:!1,orientationMatrix:new Be,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Sn(this.actionsDrag),Sn(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},MPe=class extends Ko{constructor(t,r){super(t),this.eventManager=r,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=i=>{var o;if(Tt.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:u,pointEnd:h,pointStart:d}of l.dragItems){if(u===a[0].object||u===a[0].object.object||sr.is(u)&&u.isAncestorOf(a[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let p=l.activeDragItem.obj;u.hasNonUniformScale&&u.updateMatrixWorldSVD(),(p.hasNonUniformScale?p.matrixWorldRigid:p.matrixWorld).decompose(wr,Vd,rn),eP.setFromQuaternion(Vd),p.prevR===void 0?(p.prevR=eP.clone(),p.prevT=wr.clone()):(p.prevR.copy(eP),p.prevT.copy(wr)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(u,d,l.data.plane,l.data.referenceFrame),h.copy(d),(this.eventManager.controlsManager.usePhysics&&((o=u.data.physics)==null?void 0:o.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=i=>{var o,l,c,u;if(Tt.length>1)return;this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=s.raycastWithClones(n);if(Tt.length===0){let h=!1;for(let d of this.events){for(let{obj:p}of d.dragItems)if(p===((o=a[0])==null?void 0:o.object)||p===((c=(l=a[0])==null?void 0:l.object)==null?void 0:c.object)||sr.is(p)&&p.isAncestorOf((u=a[0])==null?void 0:u.object.uuid)){switch(h=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(p=>h.obj!==p.object&&!h.obj.isAncestorOf(p.object.uuid)&&!(p.object instanceof Um)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===p.object.uuid||s.scene.find(f).isAncestorOf(p.object.uuid))))[0]),d){let p=WV.copy(d.face.normal).applyMatrix3(tP.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){wr.copy(p).applyMatrix3(tP.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;wr.x>Nf?rn.x=-f.recursiveBBox.min.x:wr.x<-Nf&&(rn.x=-f.recursiveBBox.max.x),wr.y>Nf?rn.y=-f.recursiveBBox.min.y:wr.y<-Nf&&(rn.y=-f.recursiveBBox.max.y),wr.z>Nf?rn.z=-f.recursiveBBox.min.z:wr.z<-Nf&&(rn.z=-f.recursiveBBox.max.z),rn.applyMatrix3(tP.invert())}else rn.copy(p).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(rn)}this.activeEvent.data.autoOrient&&(wr.set(0,1,0).cross(p),wr.length()<1e-4&&wr.set(-1,0,0).cross(p),rn.crossVectors(WV,wr),h.orientationMatrix.makeBasis(wr,rn,p)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.stop()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(p=>{p.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(p=>{p.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(p=>p.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(p=>p.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(p=>p.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(p=>p.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(p=>{p.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.stop()}))},500),this.updateDragItem(h),h.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=i=>{var n;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((n=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:n.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(a=>{a.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(a=>a.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(a=>a.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let t={};if(this.eventContext.page.traverseEntity(i=>{i.component&&(t[i.component.uuid]?t[i.component.uuid].push(i.uuid):t[i.component.uuid]=[i.uuid])}),this.eventContext.page.traverseEntity(i=>{var n;(n=i.data)==null||n.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new APe(i,s.id,s.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,t))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let r=this.eventContext.domElement;r.addEventListener("pointerdown",this.onPointerDown),r.addEventListener("pointermove",this.onPointerMove),r.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(r=>r.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let r of t.dragItems)r.paused||this.updateDragItem(r,!0)}calcPlaneIntersectPos(t,r,i,n){let{getCamera:s,raycaster:a}=this.eventContext;s().getWorldDirection(Lu),Lu.negate();let o=Vd.identity();switch(n==="parent"?TPe.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix).decompose(wr,o,rn):n==="local"&&t.matrixWorld.decompose(wr,o,rn),i){case"x":wr.set(1,0,0).applyQuaternion(o),Lf.copy(Lu).cross(wr),hl.copy(wr).cross(Lf);break;case"y":wr.set(0,1,0).applyQuaternion(o),Lf.copy(Lu).cross(wr),hl.copy(wr).cross(Lf);break;case"z":wr.set(0,0,1).applyQuaternion(o),Lf.copy(Lu).cross(wr),hl.copy(wr).cross(Lf);break;case"xy":hl.set(0,0,1).applyQuaternion(o);break;case"yz":hl.set(1,0,0).applyQuaternion(o);break;case"xz":hl.set(0,1,0).applyQuaternion(o);break;case"adaptive":Lu.angleTo(rn.set(0,1,0))>Math.PI/6?(wr.crossVectors(rn.set(0,1,0),Lu),hl.crossVectors(wr,rn)):hl.set(0,1,0);break;default:hl.copy(Lu);break}gd.setFromMatrixPosition(t.matrixWorld);let l=t.userData.lockedPlane?t.userData.worldPosition0:gd;if(HV.setFromNormalAndCoplanarPoint(hl,l),!!a.ray.intersectPlane(HV,r)&&(i==="x"||i==="y"||i==="z")){let c=rn.subVectors(r,l).dot(wr);r.copy(l).addScaledVector(wr,c)}}updateDragItem(t,r=!1){var i,n;gd.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?oy.subVectors(t.fromPosition,gd).divideScalar(t.currentDampingFactor):t.reset==="original"?(oy.subVectors(t.obj.userData.worldPosition0,gd).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):oy.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(gd).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?oy.length()<EPe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||r)&&CPe(t,oy.add(gd),(i=this.activeEvent)!=null&&i.data.drop&&((n=this.activeEvent)!=null&&n.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},zf=new R,iP=new R,mc=new R,gc=new R,GV=new ya,PPe=.01,DPe={type:"requestRender"},IPe=function(){let e=new R,t=new R;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),qV=function(){let e=new Be;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof js&&jc(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),OPe=class{constructor(e,t,r,i,n,s){this.data=e,this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new R,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...P2.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Vs(e,e.actions,i,n,s,r)}},RPe=class extends Ko{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=r=>{if(!(Tt.length>1)){this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var s,a;let n=(s=i.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((a=i.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new OPe(n.data,n.id,i,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),xa&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,s=this.onTargetChange(i);this.pairOfEventListeners.push([n,s]),n.addEventListener("requestRender",s)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),xa&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,Sn(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(mc),e.isReset)gc.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(gc);else{let{getCamera:o,raycaster:l}=this.eventContext;if(r==="custom"?(o().getWorldDirection(iP),iP.negate(),zf.copy(iP)):r==="xy"?zf.set(0,0,1):r==="xz"?zf.set(0,1,0):r==="yz"&&zf.set(1,0,0),GV.setFromNormalAndCoplanarPoint(zf,mc),!l.ray.intersectPlane(GV,gc))return}if(!e.isReset){if(gc.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)gc.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(gc.x=mc.x),e.data.enabledTranslation[1]===!1&&(gc.y=mc.y),e.data.enabledTranslation[2]===!1&&(gc.z=mc.z);let s=IPe(mc,gc,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=zf.subVectors(s,mc).divideScalar(e.currentDampingFactor);mc.add(o),t&&qV(e.object,mc),e.paused=o.length()<PPe}else qV(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(DPe)}},ly=new R,ob=new R,cy=new Be,Bf=new Dt,Nu=new Dt,uy=new R,hy=new R,vd=new R,vc=new R,nP=new ya,kPe=1e-6,LPe={type:"requestRender"},NPe={type:"changeRotation"},YV=function(){let e=new Be;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(wX(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof js&&jc(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),zPe=class{constructor(e,t,r,i){this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Dt,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...D2.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},BPe=class extends Ko{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(Tt.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:r})=>{if(!t||!r)return;let i=qw(t);i&&i==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{var s,a;let n=(s=i.data)==null?void 0:s.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);n&&(!e.data.globalPhysics.usePhysics||((a=i.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new zPe(n.data,n.id,i,e))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),xa&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?r.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let a=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,a]),o.addEventListener("requestRender",a)}let n=this.createUserEventListener(i),s=i.object;this.pairOfUserEventListeners.push([s,n]),s.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),xa&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:r,distance:i,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:h}=e;if(u.getWorldPosition(uy),!e.isReset)if(e.target)e.target.getWorldPosition(hy);else{if(n==="custom"?(l().getWorldDirection(ob),ob.negate(),nP.setFromNormalAndCoplanarPoint(ob,uy)):(n==="xy"?ly.set(0,0,1):n==="xz"?ly.set(0,1,0):n==="yz"&&ly.set(1,0,0),nP.setFromNormalAndCoplanarPoint(ly,uy)),!c.ray.intersectPlane(nP,hy))return;i>0&&(n==="custom"||n===void 0)&&hy.addScaledVector(ob,i)}if(e.isReset||(h?t==="target"?vd.copy(h.up).applyMatrix4(cy.extractRotation(h.matrixWorld)).normalize():a.some(p=>p===!1)?(r==="x"?(vc.set(0,0,1),a[2]===!1&&vc.set(0,1,0)):r==="y"?(vc.set(1,0,0),a[0]===!1&&vc.set(0,0,1)):(vc.set(0,1,0),a[1]===!1&&vc.set(1,0,0)),vd.copy(vc).applyQuaternion(e.worldQuaternion0).normalize()):vd.set(0,1,0):n==="custom"?vd.set(0,1,0):vd.copy(ly)),e.isReset)Nu.copy(e.worldQuaternion0);else if(uy.distanceTo(hy)>s&&o&&h)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Nu.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;FPe(cy,hy,uy,vd,r,vc),Nu.setFromRotationMatrix(cy),Bf.setFromUnitVectors(vc.applyQuaternion(Nu),vd),a.some(p=>p===!1)&&t!=="target"&&Nu.premultiply(Bf).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Bf.setFromRotationMatrix(wX(u.matrixWorld)),Bf.slerp(Nu,1/e.currentDampingFactor),YV(u,cy.makeRotationFromQuaternion(Bf)),e.paused=8*(1-Bf.dot(Nu))<kPe):(YV(u,cy.makeRotationFromQuaternion(Nu)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(LPe),u.dispatchEvent(NPe)}},ja=new R,tn=new R,Pi=new R;function FPe(e,t,r,i,n,s){let a=e.elements;Pi.subVectors(t,r),Pi.lengthSq()===0&&(Pi.z=1),Pi.normalize(),tn.crossVectors(i,Pi),tn.lengthSq()===0&&(Math.abs(i.z)===1?Pi.x+=1e-4:Pi.z+=1e-4,Pi.normalize(),tn.crossVectors(i,Pi)),tn.normalize(),ja.crossVectors(Pi,tn),n==="x"?s.z===1?[tn,ja,Pi]=[Pi,tn,ja]:(tn.negate(),[tn,Pi]=[Pi,tn]):n==="y"?s.x===1?[tn,ja,Pi]=[ja,Pi,tn]:(tn.negate(),[ja,Pi]=[Pi,ja]):s.x===1&&(tn.negate(),[tn,ja]=[ja,tn]),a[0]=tn.x,a[4]=ja.x,a[8]=Pi.x,a[1]=tn.y,a[5]=ja.y,a[9]=Pi.y,a[2]=tn.z,a[6]=ja.z,a[10]=Pi.z}var UPe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=Vs(t,t.actions,i,n,s,r)}disconnect(){Sn(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch())}},jPe=class extends Ko{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=r=>{Tt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Tt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Tt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a;if(!r||!i)return;let s=qw(r);s&&s==="MouseHover"&&(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(a=this.eventsPerObjects[i.uuid])==null||a.forEach(o=>o.dispatchUserEvent(n)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,r=(n,s)=>{var a,o;if(!(!n.visible||!((a=n.data)!=null&&a.events.length))){for(let{id:l,data:c}of n.data.events)if(!c.disabled&&c.type==="MouseHover")try{let u=new UPe(l,c,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(u):this.eventsPerObjects[n.uuid]=[u]}catch{}(o=this.eventsPerObjects[n.uuid])!=null&&o.length&&this.objects.push(n instanceof Tn?s:n)}};if(e.traverseEntity(n=>{var s;(n instanceof us||n instanceof yn)&&((s=n.frame)==null||s.traverse(a=>{r(a,n)})),r(n)}),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),xa&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(n=>{n.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),xa&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n,pointerScreen:s}=this.eventContext,a=!1;if(n.uiCanvas&&(a=Dc(n,[s.x,s.y],Object.keys(this.eventsPerObjects),o=>{t.push(o)})),r&&!a){let o=r_(i,n,this.objects);t=QI(o),o.forEach(l=>{var c,u;l.object instanceof us&&Dc(l.object,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((u=l==null?void 0:l.uv)==null?void 0:u.y)??0],Object.keys(this.eventsPerObjects),h=>{t.push(h)})})}else this.objects.forEach(o=>{var c,u;let l=XS(i,o);l&&(t.push(o),o instanceof us&&Dc(o,[((c=l==null?void 0:l.uv)==null?void 0:c.x)??0,((u=l==null?void 0:l.uv)==null?void 0:u.y)??0],Object.keys(this.eventsPerObjects),h=>{t.push(h)}))})}this._prevObjects.length&&this._prevObjects.forEach(r=>{var i;t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchLeave()))}),t.length&&t.forEach(r=>{var i;r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[r.uuid])==null||i.forEach(n=>n.dispatchEnter())}),this._prevObjects=t}},VPe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=Vs(t,t.actions,i,n,s,r)}connect(){this.scrollCounter=0}disconnect(){Sn(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled()),this.actions.SetVariable.forEach(i=>i.checkConditions()),this.actions.SetVariable.forEach(i=>i.dispatch()),this.actions.DynamicVariablePlay.forEach(i=>i.dispatch()),this.actions.ClearLocalStorage.forEach(i=>i.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch())}},HPe=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=Vs(t,t.actions,i,n,a,r)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e==null?void 0:e.parentElement,r=this.domElement.getBoundingClientRect(),i={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(t){let c=t.getBoundingClientRect(),u=window.getComputedStyle(e),h=parseFloat(u.marginTop)+parseFloat(u.marginBottom),d=parseFloat(u.top),p=parseFloat(u.bottom),f=c.height-h;if(!isNaN(d))r.top===d?(i.top+=c.top-d,i.bottom+=c.top-d):r.top<0&&(i.top-=f-r.height,i.bottom-=f-r.height);else if(!isNaN(p)){let m=document.body.clientHeight??window.innerHeight,g=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);r.bottom===m-p?(i.top+=c.top-r.height+p+g,i.bottom+=c.top-r.height+p+g):r.bottom<m-p&&(i.top-=f-r.height,i.bottom-=f-r.height)}}let n=document.body,s=document.documentElement,a=window.pageYOffset||s.scrollTop||n.scrollTop,o=s.clientTop||n.clientTop||0,l=Math.round(i.top+a-o);if(this.data.startFrom==="enter"){let c=window.innerHeight,u=i.height,h=this.data.enterAnchor,d=h==="top"?c:h==="bottom"?c-u:c-u*.5;this.scrollStart=l-d}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=i,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Sn(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch()),this.actions.ClearLocalStorage.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch())}},WPe=class extends Ko{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([r,i])=>{i.forEach(n=>n.handleResize())})},this.onScroll=r=>{if(!this.isInview)return;let i={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:i}),s.forEach(a=>a.dispatch(i))})},this.onWheel=r=>{!this.isInview||r.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:r.deltaY}),n.forEach(s=>s.dispatch(r.deltaY))})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a;if(!r||!i)return;let s=qw(r);s&&s==="Scroll"&&(i.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(a=this.wheelEventsPerObject.get(i))==null||a.forEach(o=>{o.dispatchUserEvent(n)}))}}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i}=this.eventContext,n=s=>{var a,o,l;if((a=s.data)!=null&&a.events.length){for(let{id:c,data:u}of s.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!i){let h=new VPe(c,u,s,e,t,this.managers);this.wheelEventsPerObject.has(s)?(o=this.wheelEventsPerObject.get(s))==null||o.push(h):this.wheelEventsPerObject.set(s,[h])}else{let h=new HPe(c,u,s,e,t,r,this.managers);this.scrollEventsPerObject.has(s)?(l=this.scrollEventsPerObject.get(s))==null||l.push(h):this.scrollEventsPerObject.set(s,[h])}}};e.traverseEntity(s=>{var a;(s instanceof us||s instanceof yn)&&((a=s.frame)==null||a.traverse(o=>{n(o)})),n(s)}),this.intersectionObserver=new IntersectionObserver(s=>{let a=s[0];a&&(this.isInview=a.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},GPe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=Vs(t,t.actions,i,n,s,r)}disconnect(){Sn(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof jd?t.interaction.audioPlayer.play():t.interaction instanceof WI&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof Vm?t.interaction.play(r==="autoplay"):t.interaction instanceof XI&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof jd?t.interaction.audioPlayer.play():t.interaction instanceof WI&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof Vm?t.interaction.play():t.interaction instanceof XI&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},qPe=class extends Ko{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof jd&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof Vm&&s.interaction.play(a==="autoplay")}),n.actions.Particles.forEach(s=>{s.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{var a,o;if(!r||!i)return;let s=qw(r);s&&s==="Start"&&(i instanceof Tn||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(i))==null||a.forEach(l=>{l.dispatchUserEvent(n)}),(o=this.eventsAfterPerObject.get(i))==null||o.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=i=>{var n,s,a,o,l;if((n=i.data)!=null&&n.events.length)for(let{id:c,data:u}of i.data.events){if(u.disabled||u.type!=="Start")continue;let h=new GPe(c,u,i,t,e,this.eventManager);(h.actions.Transition.length||h.actions.Animation.length||h.actions.SwitchCamera.length||h.actions.Create.length||h.actions.Destroy.length||h.actions.SceneTransition.length||h.actions.Reset.length||h.actions.SetVariable.length||h.actions.DynamicVariablePlay.length||h.actions.ClearLocalStorage.length)&&(this.eventsPerObject.has(i)?(s=this.eventsPerObject.get(i))==null||s.push(h):this.eventsPerObject.set(i,[h])),h.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(a=this.eventsAfterPerObject.get(i))==null||a.push(h):this.eventsAfterPerObject.set(i,[h])),h.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(o=this.eventsAfterPerObject.get(i))==null||o.push(h):this.eventsAfterPerObject.set(i,[h])),h.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?(l=this.eventsAfterPerObject.get(i))==null||l.push(h):this.eventsAfterPerObject.set(i,[h]))}};if(t.traverseEntity(i=>{var n;(i instanceof us||i instanceof yn)&&((n=i.frame)==null||n.traverse(s=>{r(s)})),r(i)}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,s=n?document:i;s.addEventListener("pointerdown",this.onMouseDown,{once:!0}),s.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),s.addEventListener("pointerdown",this.onAny),s.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(s=>s.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},YPe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.initialDisabled=!1,this.actions=Vs(t,t.actions,i,n,s,r),this.target=t.target}disconnect(){Sn(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()))}},XPe=class extends Ko{constructor(e,t,r,i,n){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=i,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=s=>{let a=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let o=new Date,l=[],c=[];for(let d=0;d<this.propertiesToWatch.length;d++){let{objectId:p,property:f,prevValue:m}=this.propertiesToWatch[d],g=this.eventContext.scene.find(p),v=O2.propertyPaths[f];if(v[0]==="width"||v[0]==="height"||v[0]==="depth")g=g.geometry.userData.parameters[v[0]];else for(let y=0;y<v.length;y++)g=g[v[y]];m===null?this.propertiesToWatch[d].prevValue=g instanceof R?g.clone():g:(g instanceof R?!g.equals(m):m!==g)&&(c.push({objId:p,property:f}),g instanceof R?this.propertiesToWatch[d].prevValue.copy(g):this.propertiesToWatch[d].prevValue=g)}for(let d=0;d<this.variablesToWatch.length;d++){let{id:p,prevValue:f}=this.variablesToWatch[d],m=a.getVariable(p);m!==f&&(l.push(p),this.variablesToWatch[d].prevValue=m)}for(let d=0;d<this.dynamicVars.length;d++){let{id:p,expectedTime:f,last:m,data:g,timerSeconds:v,startValue:y}=this.dynamicVars[d],w=1e3;if((g.dynamicVariableType==="timer"||g.dynamicVariableType==="stopwatch")&&g.format==="number3decimal"?w=1:g.dynamicVariableType==="counter"?w=g.updateInterval:g.dynamicVariableType==="random"&&(w=g.isStatic?1/0:g.updateInterval),f===-1){this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime=s+w;continue}if(!((a.getDynamicVariablePlayState(p)==="Stopped"||a.getDynamicVariablePlayState(p)==="Restarted")&&(this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime=s+w,g.dynamicVariableType==="counter"&&a.getVariable(p)!==y&&(a.updateVariable(p,y),this.eventManager.requestRender()),(g.dynamicVariableType==="timer"||g.dynamicVariableType==="stopwatch")&&this.dynamicVars[d].timerSeconds!==y&&(this.dynamicVars[d].timerSeconds=y,a.updateVariable(p,qa.getFormattedTimerTime(y,g)),this.eventManager.requestRender()),a.getDynamicVariablePlayState(p)==="Restarted"&&a.setDynamicVariablePlayState(p,"Playing"),a.getDynamicVariablePlayState(p)==="Stopped"))){if(a.getDynamicVariablePlayState(p)==="Paused"){this.dynamicVars[d].deltaToExpectedTime===void 0&&(this.dynamicVars[d].deltaToExpectedTime=Math.max(this.dynamicVars[d].expectedTime-s,0)),this.dynamicVars[d].last=s-(w-this.dynamicVars[d].deltaToExpectedTime),this.dynamicVars[d].expectedTime=s+this.dynamicVars[d].deltaToExpectedTime;continue}else this.dynamicVars[d].deltaToExpectedTime=void 0;if(s>=f)if(this.dynamicVars[d].last=s,this.dynamicVars[d].expectedTime+=w,g.dynamicVariableType==="random"){let b=g.min+Math.random()*(g.max-g.min),E=g.decimals;b=Math.round(b*Math.pow(10,E))/Math.pow(10,E),a.updateVariable(p,b),l.push(p),this.eventManager.requestRender()}else if(g.dynamicVariableType==="counter"){let b=a.getVariable(p),E=a.getDynamicVariableToggleIsForward(p)??!0,_=a.getVariable(p)+g.increment*(E?1:-1);g.hasEnd&&(_=g.increment>0?rt.clamp(_,y,g.endValue):rt.clamp(_,g.endValue,y),_===y&&a.setDynamicVariableToggleIsForward(p,void 0),g.repeat?_===g.endValue&&(_=y):(_===y||_===g.endValue)&&a.setDynamicVariablePlayState(p,"Paused")),_!==b&&(l.push(p),a.updateVariable(p,_),this.eventManager.requestRender())}else if(g.dynamicVariableType==="time"){let b=a.getVariable(p),E=pj(o,g);if(typeof b=="object"&&"textValue"in b&&typeof E=="object"&&"textValue"in E){if(Array.isArray(b.textValue)&&Array.isArray(E.textValue)){if(b.textValue.every((_,C)=>_===E.textValue[C]))continue}else if(b.textValue===E.textValue)continue}else if(b===E)continue;a.updateVariable(p,E),l.push(p),this.eventManager.requestRender()}else{let b=ba.isTextValue(g.endValue)?XV(g.endValue.textValue):g.endValue,E=a.getDynamicVariableToggleIsForward(p)??!0,_=v+(s-m)/1e3*(g.dynamicVariableType==="timer"?-1:1)*(E?1:-1);_=Math.max(_,0),g.hasEnd&&(_=g.dynamicVariableType==="stopwatch"?rt.clamp(_,y,b):rt.clamp(_,b,y),_===y&&a.setDynamicVariableToggleIsForward(p,void 0),g.repeat?Math.abs(_-b)<(g.format==="number3decimal"?1e-4:.1)&&(_=y):(Math.abs(_-y)<(g.format==="number3decimal"?1e-4:.1)||Math.abs(_-b)<(g.format==="number3decimal"?1e-4:.1))&&a.setDynamicVariablePlayState(p,"Paused")),_!==v&&(l.push(p),this.dynamicVars[d].timerSeconds=_,a.updateVariable(p,qa.getFormattedTimerTime(_,g)),this.eventManager.requestRender())}}}let u=!1;a.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=a.mouseProperty,u=!0);let h=!1;a.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=a.raycastProperty,h=!0),this.events.forEach(d=>{(l.includes(d.data.variableId)||c.find(p=>p.objId===d.data.objectId&&p.property===d.data.property)||d.data.variableId==="mouseProperty"&&u||d.data.variableId==="raycastProperty"&&h)&&(d.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{var r;(r=t.data)==null||r.events.filter(i=>i.data.type==="VariableChange"&&!i.data.disabled).forEach(i=>{this.events.push(new $Pe(i.id,i.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:r})=>{if(!("dynamicVariableType"in r)){this.events.find(n=>n.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let i;if(r.dynamicVariableType==="timer"||r.dynamicVariableType==="stopwatch"){let n;if(ba.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let s=r.value.textValue;s.length===3?n=s[2]+s[1]*60+s[0]*3600:n=s[1]+s[0]*60}else n=r.value;i=n,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,timerSeconds:n,startValue:i})}else r.dynamicVariableType==="time"&&e.updateVariable(t,pj(new Date,r)),r.dynamicVariableType==="counter"&&(i=ba.isTextValue(r.value)?XV(r.value.textValue):r.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,startValue:i})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},$Pe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=Vs(t,t.actions,i,n,s,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch())}dispose(){Sn(this.actions)}};function XV(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var QPe="https://unpkg.com/@splinetool/runtime@1.7.2/build/",KPe="https://unpkg.com/@splinetool/navmesh-wasm@1.7.2/build/",ZPe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${QPe}' + 'navmesh.js'),
		fetch('${KPe}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,JPe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,eDe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,tDe=.001,rDe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},TX,tr,Ln;U0e.then(e=>{TX=e,tr=new e.Vec3,Ln=new e.Vec3});var iDe=new R,nDe=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(Tt.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let s=n.raycastWithClones(i);if(s.length!==0){if(this.gameControl){let a=iDe.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{var d,p,f,m,g,v,y;let s;if(n instanceof Oo)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof ds)s=n.object;else if(s=n,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((p=s.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=s.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(i&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((m=a.physics)==null?void 0:m.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let o=$S(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,u=!1,h=!1;for(let w of a.events)w.data.disabled!==!0&&(w.data.type==="GameControl"?u=!0:w.data.type==="Follow"&&(h=!0));if(u||o||h||l||c)return!0;if(this.usePhysics&&((g=a.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((v=a.physics)!=null&&v.fusedBody))return!0}else if("geometry"in n&&n.geometry&&r.push(Pc(n.geometry,n.matrixWorld)),this.usePhysics&&((y=a.physics)==null?void 0:y.fusedBody))return n.traverseObject((w,b)=>{var C,x;if(b===0)return;let E;if(w instanceof Oo)if(w.objectForSample){if(w.objectForSample.dataPatched.physics.fusedBody)return;E=w.object}else return w.object.dataPatched.physics.fusedBody===!0&&w.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(w instanceof ds)E=w.object;else if(E=w,(C=w.dataPatched.cloner)==null?void 0:C.hideBase)return!0;let _=E.dataPatched;if(!_.visible&&((x=_.physics)==null?void 0:x.enabled)!==!0)return!0;"geometry"in w&&w.geometry&&r.push(Pc(w.geometry,w.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let s;if(n instanceof Oo)return;n instanceof ds?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(i&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if($S(a)||l||c||s.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;o&&r.push(Pc(o,n.matrixWorld))},this.navmeshWasm=TX,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?ZPe:JPe)+eDe])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.setDefaultQueryExtent(new R().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=!0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=void 0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=void 0})}),i.length===0)return!1;let s=Ud(i),{positions:a,triIndices:o}=DT(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...rDe,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),s=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let o=r.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new pt;return a.setIndex(new Mt(n,1)),a.setAttribute("position",new Mt(s,3)),a}getClosestPoint(e){return tr.x=e.x,tr.y=e.y,tr.z=e.z,this.navMesh.getClosestPoint(tr)}getClosestPointToRef(e,t){tr.x=e.x,tr.y=e.y,tr.z=e.z;let r=this.navMesh.getClosestPoint(tr);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return tr.x=e.x,tr.y=e.y,tr.z=e.z,this.navMesh.getRandomPointAround(tr,t)}getRandomPointAroundToRef(e,t,r){tr.x=e.x,tr.y=e.y,tr.z=e.z;let i=this.navMesh.getRandomPointAround(tr,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return tr.x=e.x,tr.y=e.y,tr.z=e.z,Ln.x=t.x,Ln.y=t.y,Ln.z=t.z,this.navMesh.moveAlong(tr,Ln)}moveAlongToRef(e,t,r){return tr.x=e.x,tr.y=e.y,tr.z=e.z,Ln.x=t.x,Ln.y=t.y,Ln.z=t.z,this.navMesh.moveAlong(tr,Ln)}computePath(e,t){let r=this.getClosestPoint(t);if(Ln.x=r.x,Ln.y=r.y,Ln.z=r.z,Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)+Math.pow(t.z-r.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(tr,Ln),n=i.getPointCount(),s=[];for(let a=0;a<n;a++){let o=i.getPoint(a);s.push(new R(o.x,o.y,o.z))}return s}createCrowd(e,t){return new sDe(this,e,t)}setDefaultQueryExtent(e){tr.x=e.x,tr.y=e.y,tr.z=e.z,this.navMesh.setDefaultQueryExtent(tr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return tr.x=e.x,tr.y=e.y,tr.z=e.z,this.navMesh.addCylinderObstacle(tr,t,r)}addBoxObstacle(e,t,r){return tr.x=e.x,tr.y=e.y,tr.z=e.z,Ln.x=t.x,Ln.y=t.y,Ln.z=t.z,this.navMesh.addBoxObstacle(tr,Ln,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},sDe=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new R(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=tDe)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let s=0;s<i;s++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],s=this.getAgentPosition(n);if(this.transforms[i].copy(s),this._agentDestinationArmed[i]){let a=s.x-this._agentDestination[i].x,o=s.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],u=this._agentDestination[i].y+this.reachRadii[i],h=a*a+o*o;s.y>c&&s.y<u&&h<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let s=r.getPoint(t);n.push(new R(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function aDe(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&X0.traverseModuleInstances(e,r.id,(i,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var oDe={type:"change"},$V={type:"changeZoom"},lDe={type:"changePan"},Ff={type:"start"},Uf={type:"end",changed:!0},cDe={type:"end",changed:!1},sP=new Dt,QV=new re,uDe=2*Math.PI,hDe=1e-8,dDe=.01,aP=new R,lb=new re,oP=new R,cb=new Dt,KV=new Be,pDe={type:"requestRender"},CX=class extends Kn{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Na.DOLLY_ROTATE,Na.PAN],this.offset=new R,this.eye=new R,this.lastPosition=new R,this.lastQuaternion=new Dt,this.current=new re,this.overShoot=new re,this.overRatio=new re,this.spherical=new kF,this.sphericalDelta=new kF,this.panOffset=new R,this.panLeftV=new R,this.panUpV=new R,this.panV=new R,this.rotateStart=new re,this.rotateEnd=new re,this.rotateDelta=new re,this.panStart=new re,this.panEnd=new re,this.panDelta=new re,this.dollyStart=new re,this.dollyEnd=new re,this.dollyDelta=new re,this.rotationRangeFactor=new re,this.panRangeFactor=new re,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(oP,cb,aP),this.offset.copy(oP).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(sP.copy(cb).invert()),this.panOffset.applyQuaternion(sP),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(cb),this.panOffset.applyQuaternion(cb)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),oP.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(KV.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(KV));let i=this.spherical.phi%uDe;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Cr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>dDe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>hDe?(this.dispatchEvent(oDe),this.object.dispatchEvent(pDe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&xa?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(Ff),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&xa||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,aP.subVectors(this.position0,this.target0),this.spherical.setFromVector3(aP),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?lb.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):lb.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(lb).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(QV,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(lb).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&xa?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,Tt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Tt.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(Uf):this.dispatchEvent(cDe),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&xa||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!x1(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(x1(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(x1(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(Tt.length>1&&i.preventDefault(),this.touches[Tt.length-1]){case Na.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Na.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Na.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Na.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(Tt.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=F3(()=>this.dispatchEvent(Uf),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(Ff),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!Bw)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(Ff),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(Uf)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(Ff))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(Tt[0]),i.key===" "&&this.dispatchEvent(Uf))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(sP.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=dl(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=dl(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=dl(dl(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=dl(dl(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Na.ROTATE),e.panTouches===1&&(this.touches[0]=Na.PAN),e.orbitTouches===2&&(this.touches[1]=Na.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Na.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Na.ROTATE),e.panTouches===3&&(this.touches[2]=Na.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,c,u;e instanceof R?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(dl(this.spherical.theta),dl(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=dl(this.overShoot.x),this.overShoot.y=dl(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=ZV(Math.abs(this.overRatio.x)),this.overRatio.y=ZV(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof R?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(lDe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent($V)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent($V)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(Ff),this.dollyOut(e),this.dispatchEvent(Uf)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(Ff),this.dollyIn(e),this.dispatchEvent(Uf)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(QV,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(k0e===!1&&x1(e)===!1&&N0e(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Tt.length===2){let e=.5*(Tt[0].pageX+Tt[1].pageX),t=.5*(Tt[0].pageY+Tt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Tt[0].pageX,Tt[0].pageY)}handleTouchStartPan(){if(Tt.length===2){let e=.5*(Tt[0].pageX+Tt[1].pageX),t=.5*(Tt[0].pageY+Tt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Tt[0].pageX,Tt[0].pageY)}handleTouchStartDolly(){let e=Tt[0].pageX-Tt[1].pageX,t=Tt[0].pageY-Tt[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(Tt.length===2){let r=KA(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==Tt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(Tt.length===2){let t=KA(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==Tt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=KA(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function dl(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function ZV(e){return 1-Math.pow(1-e,4)}var JV=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.page=i,this.currentIntersectedObjects=[],this.actions=Vs(t,t.actions,i,n,s,r),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let o=i.scene.find(a);o&&this.triggeringObjects.push(o)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){Sn(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()))}},lr;V0e.then(e=>lr=e);var Ui=new R,bo=new Dt,zu=new R,lP=new an(0,0,0,"YXZ"),e5=new an(0,0,0,"XYZ"),_o=new R,cP=new R,uP=new R(1,1,1),jf=new Dt,ub=new Be,t5=new Be,fDe={type:"updateMatrix"},r5=new Dt,hP=new ca,KI={type:"beginEvent",eventName:"Collision"},mDe={type:"beginEvent",eventName:"Trigger"};function gDe(e){if(X0.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var $S=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),vDe=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==lr.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(Ui.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),bo.copy(t.rotation()),r.matrixWorld.compose(Ui,bo,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(fDe),n){let s=r.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(r.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of r.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{var a,o,l,c;if(i===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let u=this.sharedGameControlGlobals.createdObjects.length-1;u>=0;u--){let h=this.sharedGameControlGlobals.createdObjects[u];if(h.userData.hasCollisionDestroy&&(((a=h.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=h.rigidBody)==null?void 0:o.collider(0).handle)===r)){this.sharedGameControlGlobals.createdObjects.splice(u,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let u=this.sharedGameControlGlobals.colliderToEntity.get(r),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,r)}else if(((c=this.gameControl)==null?void 0:c.object)!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(r)){let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,t)}else{let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h!==void 0)for(let f of h)f.data.target==="scene"&&this.dispatchCollisionEvent(f,u,t);let d=this.sharedGameControlGlobals.colliderToEntity.get(r),p=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,d,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=vX,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var r,i;let t=e.dataPatched;for(let n of t.events){if(n.data.disabled===!0)continue;let s=(i=(r=n.data.actions)==null?void 0:r.find(a=>a.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var c,u;let r,i=t instanceof $b,n=t instanceof Kb;if(t instanceof Oo||i||n)return;t instanceof ds?r=t.object:r=t;let s=r.dataPatched;if(((c=s.physics)==null?void 0:c.enabled)==="visibility"?!s.visible:!((u=s.physics)!=null&&u.enabled))return!0;let a=t.geometry,o=r.userData.hasDestroy===!0,l=r.userData.hasDrag===!0;if($S(s)||o||l||r.dataPatched.events.some(h=>h.data.disabled!==!0&&h.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(Pc(a,t.matrixWorld))}),e.length>0){let t=Ud(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new t0(t)}}addRigidBody(e,t,r){let i=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&i.push(Pc(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,i);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let a,o=!r.fromCreate&&s.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;o?(a=lr.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(a=lr.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=lr.RigidBodyDesc.fixed();let l=Ud(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Ui,bo,zu),e.position0=Ui.clone().divideScalar(this.pixelsPerMeter),e.rotation0=bo.clone(),Ui.divideScalar(this.pixelsPerMeter),a.setTranslation(Ui.x,Ui.y,Ui.z).setRotation(bo),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(zu.x/this.pixelsPerMeter,zu.y/this.pixelsPerMeter,zu.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,zu.clone(),s.physics.fusedBody]);let u=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,u)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(h){console.error(h)}}e.rigidBody=c}}addBoundsTree(e){var r,i;let t=[];if(((r=e.geometry)==null?void 0:r.getAttribute("position"))!==void 0&&((i=e.geometry)==null?void 0:i.getAttribute("position").count)>0&&t.push(Pc(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=Ud(t,!1);e.bvhGeometry=n,n.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new t0(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,r,i,n=!0){var o,l;if((r==null?void 0:r.getAttribute("position").count)===0||((o=r==null?void 0:r.getIndex())==null?void 0:o.count)===0)return;let s;r&&(t.colliderType==="trimesh"?s=lr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):s=lr.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),s.setFrictionCombineRule(lr.CoefficientCombineRule.Average).setRestitutionCombineRule(lr.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),(l=this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid])!=null&&l.some(c=>c.target==="scene")&&a.setActiveEvents(lr.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{var o;if(i===0)return;let n;if(r instanceof Oo)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof ds)n=r.object;else if(n=r,(o=n.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let a=r.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(Pc(a,r.matrixWorld))}}activate(e){var d,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")continue;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null;)(p=m.data.physics)==null||p.fusedBody;f.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=f.data)}if(this.page.traverseEntity(f=>{for(let m of f.dataPatched.events)if(m.data.disabled===!1&&m.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&c&&(l.data.visible===!0||l.data.physics.enabled===!0)){r=r||c.camera===t.uuid||l.uuid===t.uuid;let f=new yX(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,i=c.joystickPosLoc,n=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,xa&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new nDe(this.usePhysics,this.isExport);let m;f.collider.type==="sphere"?m=f.collider.radius*2:m=f.collider.height,m=Math.floor(m/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:f,enablePan:m,enableZoom:g,autoRotate:v,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(f||m||g||v||y!==0)&&(this.orbitControls=new CX(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,m)=>{let g=document.body.appendChild(document.createElement("div")),[v,y,w]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],b=(u-5*v)/4+v,E={},_=f==="jmp",C=_?0:v;m<10?(m<5?E.top=C/2:E.bottom=C/2,E.left=C/2+m%5*b):m===10?(E.left=C/2,E.top=h/2):(E.right=C/2,E.top=h/2),E.top?E.top-=y[1]:E.bottom+=y[1],E.left?E.left+=y[0]:E.right-=y[0];for(let T in E)E[T]+="px";if(_){let T=g.appendChild(document.createElement("div"));Object.assign(T.style,E,{position:"absolute",width:v+"px",height:v+"px",backgroundColor:`rgba(255,255,255,${w==="show"?.4:0})`,zIndex:"9999",borderRadius:v+"px",border:w==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let M=v/16*16*.4;w==="show"&&(T.innerHTML=`
						<svg width="${M}" height="${v*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),T.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),T.addEventListener("touchend",D=>D.preventDefault()),this.joysticks[m]=[void 0,g];return}let x={zone:g,mode:"static",position:E,size:v};w==="hide"&&(x.restOpacity=0);let A=MAe.create(x);A.on("move",(T,M)=>{let D=this.gameControl;f==="pos"?M.force<.2?D.moveForce=0:(D.movementState.movePosZ=Math.sin(-M.angle.radian),D.movementState.movePosX=Math.cos(-M.angle.radian),M.force>1.2?D.movementState.run=1:D.movementState.run=0,M.force<.3?D.moveForce=(M.force-.2)/.1:D.moveForce=1):f==="rot"&&(M.force<.2?D.rotForce=0:(D.movementState.rotPosX=M.vector.y,D.movementState.rotPosY=-M.vector.x,M.force<.3?D.rotForce=(M.force-.2)/.1:D.rotForce=1)),this.requestRender()}),A.on("end",(T,M)=>{let D=this.gameControl;f==="pos"?(D.movementState.movePosZ=0,D.movementState.movePosX=0,D.moveForce=1):f==="rot"&&(D.movementState.rotPosX=0,D.movementState.rotPosY=0,D.rotForce=1)}),this.joysticks[m]=[A,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.initialDisabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new lr.World(new lr.Vector3(0,this.gravity,0)),this.events=new lr.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var v,y,w,b;let l;if(o instanceof Oo)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof ds)l=o.object;else{if(o instanceof Kb||o instanceof $b)return;if(l=o,((v=l.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((w=l.dataPatched.physics)==null?void 0:w.fusedBody)!==!0)return!0}let c=l.dataPatched,u;for(let E of c.events)E.data.disabled!==!0&&E.data.type==="GameControl"&&(u=E.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;o.updateMatrixWorldSVD();let h=$S(c),d=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,m=!1;for(let E of c.events)if(E.data.disabled!==!0){if(E.data.type==="Collision"){d=!0;let _=new YPe(E.id,E.data,l,this.page,this.sharedAssets,this.eventManager);_.initialDisabled=!0,this.collisionEvents.push(_),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(C=>C.id!==E.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(_):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[_]}else if(E.data.type==="Follow"){m=!0;let _=E.data.target;o.traverseVisible(C=>{C.userData.isFollowingObj=_})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let g=o.geometry;if(u!==void 0){let E=lr.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(Ui,bo,zu),o.position0=Ui.clone().divideScalar(this.pixelsPerMeter),o.rotation0=bo.clone(),Ui.divideScalar(this.pixelsPerMeter),E.setTranslation(Ui.x,Ui.y,Ui.z).setRotation(bo);let _=this.sharedGameControlGlobals.rapierWorld.createRigidBody(E);o.rigidBody=_;let C;u.collider.type==="sphere"?C=lr.ColliderDesc.ball(u.collider.radius/this.pixelsPerMeter):u.collider.type==="capsule"?C=lr.ColliderDesc.capsule((u.collider.height/2-u.collider.radius)/this.pixelsPerMeter,u.collider.radius/this.pixelsPerMeter):C=lr.ColliderDesc.cuboid(u.collider.width/this.pixelsPerMeter/2,u.collider.height/this.pixelsPerMeter/2,u.collider.depth/this.pixelsPerMeter/2),C.setFrictionCombineRule(lr.CoefficientCombineRule.Average).setRestitutionCombineRule(lr.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let x=this.sharedGameControlGlobals.rapierWorld.createCollider(C,_);this.sharedGameControlGlobals.colliderToEntity.set(x.handle,l),Ui.fromArray(u.collider.position).multiply(zu.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),x.setTranslationWrtParent(Ui);let A=new Dt().setFromEuler(new an().setFromVector3(new R().fromArray(u.collider.rotation)));x.setRotationWrtParent(A),x.setActiveEvents(lr.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||h||m||p||f||d?(this.addRigidBody(o,l,{hasFollow:m,hasTransformAnim:h,hasDrag:f}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(g&&e.push(Pc(g,o.matrixWorld)),c.physics.fusedBody&&o.traverseObject((E,_)=>{var T;if(_===0)return;let C;if(E instanceof Oo)if(E.objectForSample){if(E.objectForSample.dataPatched.physics.fusedBody)return;C=E.object}else return E.object.dataPatched.physics.fusedBody===!0&&E.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(E instanceof Kb||E instanceof $b)return;if(E instanceof ds)C=E.object;else if(C=E,(T=C.dataPatched.cloner)==null?void 0:T.hideBase)return!0}let x=C.dataPatched;if(x.physics.enabled==="visibility"?!x.visible:!x.physics.enabled)return!0;let A=E.geometry;(A==null?void 0:A.getAttribute("position"))!==void 0&&e.push(Pc(A,E.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((b=c.physics)==null?void 0:b.fusedBody)===!0||u)return!0}),e.length===0)return;let r=Ud(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=lr.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=lr.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(lr.CoefficientCombineRule.Multiply).setRestitutionCombineRule(lr.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[o,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(o,n);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new JV(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new Be().compose(_o.fromArray(t.data.position),jf.setFromEuler(e5.fromArray(t.data.rotation)),uP);if(t.data.triggerZone==="box"){let n=new Ni;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,r,i;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(r=this.gameControl)==null||r.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(i=this.navigationMeshWrapper)==null||i.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}return i}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Ui,bo,zu),lP.setFromQuaternion(bo);let r=t;r.prevR===void 0?(r.prevR=lP.clone(),r.prevT=Ui.clone()):(r.prevR.copy(lP),r.prevT.copy(Ui)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(Ui.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(bo))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(r))._parent,n;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===i){n=a;break}}e.dispatch(n),t.dispatchEvent(KI)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=t5.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new JV(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=lr.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=lr.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(lr.ActiveEvents.COLLISION_EVENTS),_o.fromArray(a.data.position),jf.setFromEuler(e5.fromArray(a.data.rotation)),ub.compose(_o,jf,uP).premultiply(n.matrixWorld),r?(ub.decompose(_o,jf,cP),l.setActiveCollisionTypes(lr.ActiveCollisionTypes.KINEMATIC_FIXED|lr.ActiveCollisionTypes.DYNAMIC_FIXED)):(ub.premultiply(i).decompose(_o,jf,cP),e.rigidBody.bodyType()===lr.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===lr.RigidBodyType.Fixed?l.setActiveCollisionTypes(lr.ActiveCollisionTypes.KINEMATIC_FIXED|lr.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(lr.ActiveCollisionTypes.KINEMATIC_KINEMATIC|lr.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),_o.divideScalar(this.pixelsPerMeter),l.setTranslation(_o.x,_o.y,_o.z),l.setRotation(jf),r)r.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(sr.is(o)?o:o.object)===!1)continue;let l=t5.copy(n.matrixWorld).decompose(_o,r5,cP).compose(_o,r5,uP).multiply(i),c=ub.copy(o.matrixWorld).invert().multiply(l);r instanceof Ni?e=o.bvhGeometry.boundsTree.intersectsBox(r,c):(hP.radius=r,hP.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(hP)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(mDe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(u=>u!==o)}}}};function yDe(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,s=this._loopCount,a=i===o3;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-r):n;if(i===B9){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<r){let o=Math.floor((n-r)/(t-r));n-=(t-r)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-r)}return n}var i5=!1,wDe=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=h2.parse(JSON.parse(s[2]));n.animations[a]=l;let c=this.mixer.clipAction(l,n);i5===!1&&(Object.getPrototypeOf(c)._updateTime=yDe,i5=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new ihe(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(s=>s.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=F9}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=o3)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var e,t;return((t=(e=this.activeClip)==null?void 0:e.tracks[0])==null?void 0:t.times.length)??0}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?e/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},dP=new WeakMap,xDe=class extends Lw{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new d2(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(dP.has(e)){let o=dP.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),dP.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new pt;e.index&&t.setIndex(new Mt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new Mt(s,a))}return t}_loadLibrary(e,t){let r=new d2(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=bDe.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function bDe(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(u=>{let h=u.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=r(h,d,p,c),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:o.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function r(a,o,l,c){let u=c.attributeIDs,h=c.attributeTypes,d,p,f=o.GetEncodedGeometryType(l);if(f===a.TRIANGULAR_MESH)d=new a.Mesh,p=o.DecodeBufferToMesh(l,d);else if(f===a.POINT_CLOUD)d=new a.PointCloud,p=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let m={index:null,attributes:[]};for(let g in u){let v=self[h[g]],y,w;if(c.useUniqueIDs)w=u[g],y=o.GetAttributeByUniqueId(d,w);else{if(w=o.GetAttributeId(d,a[u[g]]),w===-1)continue;y=o.GetAttribute(d,w)}m.attributes.push(n(a,o,d,g,v,y))}return f===a.TRIANGULAR_MESH&&(m.index=i(a,o,d)),a.destroy(d),m}function i(a,o,l){let c=l.num_faces()*3,u=c*4,h=a._malloc(u);o.GetTrianglesUInt32Array(l,u,h);let d=new Uint32Array(a.HEAPF32.buffer,h,c).slice();return a._free(h),{array:d,itemSize:1}}function n(a,o,l,c,u,h){let d=h.num_components(),p=l.num_points()*d,f=p*u.BYTES_PER_ELEMENT,m=s(a,u),g=a._malloc(f);o.GetAttributeDataArrayForAllPoints(l,h,m,f,g);let v=new u(a.HEAPF32.buffer,g,p).slice();return a._free(g),{name:c,array:v,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var mh;function _De(){return mh||(mh=new xDe,mh.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),mh.decoderPending}async function SDe(e){if(mh){let t={attributeIDs:mh.defaultAttributeIDs,attributeTypes:mh.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await mh.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function EDe(e,t){let[r,i]=x7(A2.deserialize(new Uint8Array(e)));return G7(r),t&&t(r),i.result().data}function TDe(e){let t=[];return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&i.geometry.data.draco!==void 0&&t.push(i)}),t}async function CDe(e){for(let t of e){let r=await SDe(t.geometry.data.draco);if(r){let i=t.geometry.data;r.index&&(i.index={array:r.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};r.attributes.forEach(({name:s,array:a,itemSize:o})=>{n[s]={array:a,itemSize:o,type:"Float32Array",normalized:!1}}),i.attributes=n,i.draco=void 0}}}var ADe=class{constructor(e,t,r,i,n,s,a,o){this.eventId=e,this.id=t,this.data=r,this.dataEvent=i,this.object=n,this.stage=!1,this.actions=Vs(i,r.actions,s,a,o,n)}disconnect(){Sn(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},MDe=class extends Ko{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(r,i)=>{this.breakpoints.forEach(n=>{let s=I2.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?r:i,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:s}=i.contentRect;this.resize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let i=n=>{var s;if(!(!n.visible||!((s=n.data)!=null&&s.events.length)))for(let{data:a,id:o}of n.data.events)a.disabled||a.type==="Resize"&&a.breakpoints.forEach(({data:l,id:c})=>{try{let u=new ADe(o,c,l,a,n,e,t,this.eventManager);this.breakpoints.push(u)}catch{}})};e.traverseEntity(n=>{var s;(n instanceof us||n instanceof yn)&&((s=n.frame)==null||s.traverse(a=>{i(a)})),i(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},PDe=class{constructor(e,t,r,i,n){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=s=>{let a=window.parent!==window,o=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(s.touches.length>1||this.preventTouchScroll||a===!1&&o===!1)&&s.preventDefault()},this.onMouseWheelPreventScroll=s=>{this.preventScroll&&s.preventDefault()},this.onMouseMove=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:s.buttons>0}},this.onMouseDown=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!0}},this.onMouseUp=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!1}},this.getMousePosition=s=>{var c;let{domRect:a}=this.eventContext,{pageX:o,pageY:l}=((c=s.touches)==null?void 0:c.length)>0?s.touches[0]:s;return{x:o-(a.left+window.scrollX),y:l-(a.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new gPe(this.eventContext),VariableChange:new XPe(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),Conditional:new SPe(this.eventContext,this),Start:new qPe(this.eventContext,this),Basic:new yPe(this.eventContext,this,this.needsRaycast),MouseHover:new jPe(this.eventContext,this),Scroll:new WPe(this.eventContext,this),Follow:new RPe(this.eventContext,this),DragDrop:new MPe(this.eventContext,this),LookAt:new BPe(this.eventContext),Resize:new MDe(this.eventContext,this)};let{page:e,domElement:t}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(r=>{r.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(r=>r.connect()),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var r;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),(r=this.controlsManager.gameControl)==null||r.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender),i.destroyedInAction=!1}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if(r.data.type==="Conditional"&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),r.data.type==="Conditional"||r.data.type==="SetVariable")for(let i of r.data.type==="Conditional"?r.data.condition:r.data.expression)"id"in i&&Array.isArray(i.id)&&(i.id[0]==="mouse"&&(this.needsMouse=!0),i.id[0]==="raycast"&&(this.needsRaycast=!0));r.data.type==="DynamicVariablePlay"&&r.data.variableId!==""&&(r.data.mode==="Play"||r.data.mode==="PlayPause"||r.data.mode==="Toggle")&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(r=>{var i;if((i=r.data)!=null&&i.events.length)for(let n of r.data.events)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let s of["inActions","outActions"])n.data[s].forEach(t);else if(n.data.type==="DragDrop")for(let s of["drag","drop"])n.data.dragDropActions[s].forEach(t);else if(n.data.type==="GameControl")for(let s of["idle","move","jump","run"])n.data.gameActions[s].forEach(t);else if(n.data.type==="Resize")for(let s of n.data.breakpoints)s.data.actions.forEach(t);else n.data.type==="LookAt"||n.data.actions.forEach(t)})}},DDe=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new re().copy(r),this._editorSize=new re().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=IDe(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function IDe(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var ODe=class{get sharedAssets(){return this.shared}constructor(e,t={},r=!0){this.shared=new fk(e.shared,t,!0,r),this.scene=new Ck(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof yn&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof ps&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},RDe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function kDe(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function a0(e){return e instanceof rw?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function LDe(e,t){let r={};return e.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof js)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof js&&i.states&&Object.keys(i.states).length)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!fs.isMergable(a))return}else{let c=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!fs.isMergable(c.material))return;s=fs.getHash(c.material)}}r[s]||(r[s]={});let o=r[s][a0(i)];if(o){if(o.push(i),i.cloner)for(let c of i.cloner.children)o.push(c)}else if(r[s][a0(i)]=[i],i.cloner)for(let c of i.cloner.children)r[s][a0(i)].push(c)}),r}function NDe(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function zDe(e,t){let r=LDe(t,e),i=NDe(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,u=new Array(i),h=0;for(let[d,p]of Object.entries(r))for(let f of Object.values(p)){if(o=0,c=0,f.forEach(g=>{g instanceof js&&(a[o++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),a[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&kDe(a[g]);let m=Ud(a.slice(0,o),!1);if(m){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new Ii(m,l[0].material);break}default:{g=new Ii(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,t.add(g);let v=y=>{h=0;for(let w of y)w.children&&v(w.children),w instanceof js&&(Array.isArray(w.material)||r[w.material.uuid]&&r[w.material.uuid][a0(w)]&&r[w.material.uuid][a0(w)].length>1||(u[h++]=w));for(let w=0;w<h;w++)t.attach(u[w])};for(let y=0;y<c;y++){let w=l[y];v(w.children),n[s++]=w}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var BDe=vu(jie(),1),FDe=new re;function UDe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var jDe=class{constructor(e,{renderOnDemand:t,renderMode:r="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=i=>{var n,s,a,o,l,c,u,h,d,p,f,m,g;if(this.time=i,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(u=this._animationControls)==null||u.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(h=this._scene)==null||h.traverseVisibleEntity(v=>{v.type==="ParticleSystem"&&(v.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(d=this._eventManager)!=null&&d.isEnabled&&(((p=this._eventManager.handlers)==null?void 0:p.Follow).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.LookAt).onAnimationFrameDamping(),((m=this._eventManager.handlers)==null?void 0:m.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let v=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=v,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(g=this._perfs)==null||g.end()},this._resize=()=>{var i,n,s,a,o,l,c,u,h,d;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=FDe.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(i=this._scene)==null?void 0:i.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((s=(n=this._frameView)==null?void 0:n.frameSize)==null?void 0:s.x)??this._viewportWidth,((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let p=Object.values(((u=this._data)==null?void 0:u.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(d=this._frameView)==null||d.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=F3(this._resize,10),this._onScroll=i=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new RDe({x:10,y:10})),B0e(e)}async load(e,t,r){UDe(e),this.disposed=!1;let i=await(await fetch(e,r)).arrayBuffer();await this.start(i,{variables:t})}async start(e,{interactive:t=!0,variables:r}={}){var l,c,u,h;if(this.disposed)return;let i=await EDe(e);this._data=i;let n=TDe(i);i.version&&(0,BDe.default)(i.version,"1.7.2")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([n.length&&_De(),Oj(i)&&Sbe(),vSe(i)&&wbe(),X0.physicsEnabled(i.scene.objects)&&H0e(),Mj(i)&&nSe(),oV(i)&&gAe(),rSe(i)&&tSe(),Zj(i)&&cCe(),aDe(i)&&j0e()].filter(Boolean)),n.length&&await CDe(n),(l=this._eventManager)==null||l.deactivate(),(c=this._controls)==null||c.deactivate(),(u=this._scene)==null||u.dispose();let s=new ODe(i);if(s.resetPersonalCameraFromDocumentData(),this._scene=s.scene,this._sharedAssetsManager=s.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let d=performance.now();zDe(i,s.scene);let p=performance.now();console.log("Merged geometries in ",p-d," ms")}Oj(i)&&this._scene.traverse(d=>{jc(d)&&d.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var d;this._requestRenderAutoMode(),(d=this._scene)==null||d.traverse(p=>{p instanceof Oo&&p.pendingMediaLoad&&p.update()})}),(h=this._scene)==null||h.traverse(d=>{d.type==="ParticleSystem"&&(d.wakeUp(),d.data.autoPlay?d.start():d.stop())});let a=Object.keys(i.shared.fonts).map(d=>this._sharedAssetsManager.getFont(d).loadingPromise);if(Promise.all(a).then(()=>{s.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),Mj(i)&&gDe(i)&&await Promise.all(a),Zj(i)){let d=[];this._scene.traverseEntity(p=>{(p instanceof us||p instanceof yn)&&p.uiCanvas&&d.push(p.uiCanvas)}),await Promise.all(d.map(p=>p.promise))}this._scene.rewriteEventsBeforeGoToPlayMode(),Fk(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new ZTe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),oV(i)&&this._scene.initializeSplatViewer(),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let o=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(o.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new DDe(this._renderer,this._camera,new re(this._viewportWidth,this._viewportHeight),new re(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&o.preset==="fullscreen"),t){let d=new fPe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new vDe(d),this._animationControls=new wDe(this._scene,this._requestRenderAutoMode),this._eventManager=new PDe(i.scene.publish,this._controls,this._animationControls,d,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),r!==void 0&&this.setVariables(r),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var d;(d=this._renderer)==null||d.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[r,i]of t)this.setVariable(r,i)}}setVariable(e,t){var i;let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){let n=t;typeof r.data.value=="number"?n=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof r.data.value=="boolean"?n=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof r.data.value!="string"&&r.data.value.textValue!==void 0&&(n=t.toString());let s=typeof n=="string"?{textValue:n}:n;(i=this._sharedAssetsManager)==null||i.updateVariable(r.id,s),this.requestRender(),this._requestRenderAutoMode()}else r===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in r.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let r=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(r)}}_getVariableValue(e){return typeof e!="string"&&ba.isTextValue(e)?ba.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(r=>r.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(r=>{if(r.uuid!==rv&&!this._scene.isInvisibleObjects(r)&&!(r instanceof yn)){let i=this._createProxyObject(r);i&&e.push(i)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,r;((t=this._controls)==null?void 0:t.orbitControls)instanceof CX&&((r=this._controls)==null||r.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},s=new qn(t,r,i,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,r,i,n,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._proxyObjectCache.forEach(o=>{WF.unsubscribe(o)}),this._variablesCache.clear(),(i=this._renderer)==null||i.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),this.dt=0,F0e(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var e,t,r;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(r=this._controls)!=null&&r.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,r;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(r=this._renderer)==null||r.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var n;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof yn&&(t=s.name)});let r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof yn||e instanceof Ck||(n=e.parent)==null?void 0:n.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},i=WF(r,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){Kq.skiaWasmUrl=e}},VDe="Expected a function",n5=NaN,HDe="[object Symbol]",WDe=/^\s+|\s+$/g,GDe=/^[-+]0x[0-9a-f]+$/i,qDe=/^0b[01]+$/i,YDe=/^0o[0-7]+$/i,XDe=parseInt,$De=typeof yy=="object"&&yy&&yy.Object===Object&&yy,QDe=typeof self=="object"&&self&&self.Object===Object&&self,KDe=$De||QDe||Function("return this")(),ZDe=Object.prototype,JDe=ZDe.toString,e2e=Math.max,t2e=Math.min,pP=function(){return KDe.Date.now()};function r2e(e,t,r){var i,n,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(VDe);t=s5(t)||0,ZI(r)&&(u=!!r.leading,h="maxWait"in r,s=h?e2e(s5(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function p(_){var C=i,x=n;return i=n=void 0,c=_,a=e.apply(x,C),a}function f(_){return c=_,o=setTimeout(v,t),u?p(_):a}function m(_){var C=_-l,x=_-c,A=t-C;return h?t2e(A,s-x):A}function g(_){var C=_-l,x=_-c;return l===void 0||C>=t||C<0||h&&x>=s}function v(){var _=pP();if(g(_))return y(_);o=setTimeout(v,m(_))}function y(_){return o=void 0,d&&i?p(_):(i=n=void 0,a)}function w(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function b(){return o===void 0?a:y(pP())}function E(){var _=pP(),C=g(_);if(i=arguments,n=this,l=_,C){if(o===void 0)return f(l);if(h)return o=setTimeout(v,t),p(l)}return o===void 0&&(o=setTimeout(v,t)),a}return E.cancel=w,E.flush=b,E}function ZI(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function i2e(e){return!!e&&typeof e=="object"}function n2e(e){return typeof e=="symbol"||i2e(e)&&JDe.call(e)==HDe}function s5(e){if(typeof e=="number")return e;if(n2e(e))return n5;if(ZI(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ZI(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(WDe,"");var r=qDe.test(e);return r||YDe.test(e)?XDe(e.slice(2),r?2:8):GDe.test(e)?n5:+e}var AX=r2e;const s2e=Ug(AX);function a2e(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}const o2e=[],l2e={width:"100%",height:"100%"},c2e=te.forwardRef(function({className:e,children:t,debounceTime:r=300,ignoreDimensions:i=o2e,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=te.useRef(null),u=te.useRef(0),[h,d]=te.useState({width:0,height:0,top:0,left:0}),p=te.useMemo(()=>{const f=Array.isArray(i)?i:[i];return s2e(m=>{d(g=>Object.keys(g).filter(v=>g[v]!==m[v]).every(v=>f.includes(v))?g:m)},r,{leading:s})},[r,s,i]);return te.useEffect(()=>{const f=a||window.ResizeObserver,m=new f(g=>{g.forEach(v=>{const{left:y,top:w,width:b,height:E}=(v==null?void 0:v.contentRect)??{};u.current=window.requestAnimationFrame(()=>{p({width:b,height:E,top:w,left:y})})})});return c.current&&m.observe(c.current),()=>{window.cancelAnimationFrame(u.current),m.disconnect(),p.cancel()}},[p,a]),k.jsx("div",{style:{...l2e,...n},ref:a2e([l,c]),className:e,...o,children:t({...h,ref:c.current,resize:p})})});te.forwardRef(({scene:e,style:t,onMouseDown:r,onMouseUp:i,onMouseHover:n,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:c,onWheel:u,onLoad:h,renderOnDemand:d=!0,children:p,...f},m)=>{const g=te.useRef(null),[v,y]=te.useState(!0);return te.useEffect(()=>{y(!0);let w;const b=[{name:"mouseDown",cb:r},{name:"mouseUp",cb:i},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:u}];if(g.current){w=new jDe(g.current,{renderOnDemand:d});async function E(){await w.load(e);for(let _ of b)_.cb&&w.addEventListener(_.name,_.cb);y(!1),h==null||h(w)}E()}return()=>{for(let E of b)E.cb&&w.removeEventListener(E.name,E.cb);w.dispose()}},[e]),k.jsx(c2e,{ref:m,parentSizeStyles:{overflow:"hidden",...t},debounceTime:50,...f,children:()=>k.jsxs(k.Fragment,{children:[v&&p,k.jsx("canvas",{ref:g,style:{display:v?"none":"block"}})]})})});function u2e(){return k.jsx("div",{className:"bg-white py-20 px-11 ",children:k.jsxs("div",{className:"container mx-auto px-11 md:px-12 flex flex-col   justify-start",children:[k.jsx("h1",{className:"text-4xl font-bold text-center text-[#008080] mb-6",children:"About YOLO Traveler Asia"}),k.jsxs("p",{className:"text-gray-600 text-lg md:text-xl mb-12 max-w-full","data-aos":"fade-up",children:["Welcome to YOLO Traveler Asia, your premier travel agency dedicated to offering unique and memorable travel experiences. Our team is committed to providing personalized services to ensure your journey is seamless and enjoyable. Whether you're looking for adventure, relaxation, or cultural exploration, we are here to craft an unforgettable journey tailored to your desires. At YOLO Traveler Asia, we believe that travel is more than just visiting new places; it is about experiencing different cultures, making lifelong memories, and creating stories to share. Our expert team of travel enthusiasts is passionate about curating bespoke itineraries that cater to your interests, preferences, and comfort.",k.jsx("br",{}),k.jsx("br",{}),"From the serene beaches of Thailand to the bustling streets of Tokyo, our diverse range of destinations and activities ensures there’s something for everyone. We prioritize sustainability and ethical travel, ensuring that our adventures not only enrich your life but also support the local communities and environments we visit. Let us take you on a journey beyond the ordinary, where each moment is designed to amaze and inspire. Join us at YOLO Traveler Asia, and let’s embark on an adventure of a lifetime together."]}),k.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center md:justify-center w-full","data-aos":"fade-up",children:[k.jsx("div",{className:"w-full md:w-1/2 lg:w-1/3 px-4 mb-8",children:k.jsxs("div",{className:"p-6 shadow-lg rounded-lg",children:[k.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Mission"}),k.jsx("p",{className:"text-gray-600",children:"At YOLO Traveler Asia, our mission is to make every trip an extraordinary experience. Whether you're seeking adventure, relaxation, or cultural exploration, we tailor each journey to your preferences. Our goal is to ensure that your travel experience is seamless, enriching, and truly unforgettable."})]})}),k.jsx("div",{className:"w-full md:w-1/2 lg:w-1/3 px-4 mb-8",children:k.jsxs("div",{className:"p-6 shadow-lg rounded-lg",children:[k.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Our Vision"}),k.jsx("p",{className:"text-gray-600",children:"We envision a world where travel is accessible, affordable, and sustainable. Our goal is to connect people with the wonders of Asia and create lifelong memories. We strive to be a bridge to the diverse cultures and landscapes that Asia has to offer, fostering understanding and appreciation through travel."})]})})]})]})})}var MX={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a5=fe.createContext&&fe.createContext(MX),h2e=["attr","size","title"];function d2e(e,t){if(e==null)return{};var r=p2e(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function p2e(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function QS(){return QS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},QS.apply(this,arguments)}function o5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function KS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o5(Object(r),!0).forEach(function(i){f2e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o5(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function f2e(e,t,r){return t=m2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m2e(e){var t=g2e(e,"string");return typeof t=="symbol"?t:t+""}function g2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PX(e){return e&&e.map((t,r)=>fe.createElement(t.tag,KS({key:r},t.attr),PX(t.child)))}function rc(e){return t=>fe.createElement(v2e,QS({attr:KS({},e.attr)},t),PX(e.child))}function v2e(e){var t=r=>{var{attr:i,size:n,title:s}=e,a=d2e(e,h2e),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),fe.createElement("svg",QS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:KS(KS({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&fe.createElement("title",null,s),e.children)};return a5!==void 0?fe.createElement(a5.Consumer,null,r=>t(r)):t(MX)}function y2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(e)}function w2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM9 15a1 1 0 011-1h6a1 1 0 110 2h-6a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(e)}function x2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function b2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function _2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0z"},child:[]}]})(e)}function S2e(e){return rc({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528.12 301.319l47.273-208C578.806 78.301 567.391 64 551.99 64H159.208l-9.166-44.81C147.758 8.021 137.93 0 126.529 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24h69.883l70.248 343.435C147.325 417.1 136 435.222 136 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-15.674-6.447-29.835-16.824-40h209.647C430.447 426.165 424 440.326 424 456c0 30.928 25.072 56 56 56s56-25.072 56-56c0-22.172-12.888-41.332-31.579-50.405l5.517-24.276c3.413-15.018-8.002-29.319-23.403-29.319H218.117l-6.545-32h293.145c11.206 0 20.92-7.754 23.403-18.681z"},child:[]}]})(e)}const ov=()=>{const e=JSON.parse(localStorage.getItem("auth")),t=e?e.userID:null,r=e?e.name:null,i=e?e.profilePhoto:null,n=e?e.isAuth:!1;return{userID:t,name:r,profilePhoto:i,isAuth:n}};var l5={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DX=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=n&63|128):(n&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(e.charCodeAt(++i)&1023),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=n&63|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=n&63|128)}return t},E2e=function(e){const t=[];let r=0,i=0;for(;r<e.length;){const n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[i++]=String.fromCharCode((n&31)<<6|s&63)}else if(n>239&&n<365){const s=e[r++],a=e[r++],o=e[r++],l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[i++]=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63)}}return t.join("")},IX={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<e.length;n+=3){const s=e[n],a=n+1<e.length,o=a?e[n+1]:0,l=n+2<e.length,c=l?e[n+2]:0,u=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),i.push(r[u],r[h],r[d],r[p])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(DX(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):E2e(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<e.length;){const s=r[e.charAt(n++)],o=n<e.length?r[e.charAt(n)]:0;++n;const c=n<e.length?r[e.charAt(n)]:64;++n;const h=n<e.length?r[e.charAt(n)]:64;if(++n,s==null||o==null||c==null||h==null)throw new T2e;const d=s<<2|o>>4;if(i.push(d),c!==64){const p=o<<4&240|c>>2;if(i.push(p),h!==64){const f=c<<6&192|h;i.push(f)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class T2e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C2e=function(e){const t=DX(e);return IX.encodeByteArray(t,!0)},ZS=function(e){return C2e(e).replace(/\./g,"")},OX=function(e){try{return IX.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2e=()=>A2e().__FIREBASE_DEFAULTS__,P2e=()=>{if(typeof process>"u"||typeof l5>"u")return;const e=l5.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},D2e=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&OX(e[1]);return t&&JSON.parse(t)},zT=()=>{try{return M2e()||P2e()||D2e()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},RX=e=>{var t,r;return(r=(t=zT())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},kX=e=>{const t=RX(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),i]:[t.substring(0,r),i]},LX=()=>{var e;return(e=zT())===null||e===void 0?void 0:e.config},NX=e=>{var t;return(t=zT())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zX(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},i=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ZS(JSON.stringify(r)),ZS(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function O2e(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qn())}function R2e(){var e;const t=(e=zT())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function k2e(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function L2e(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function N2e(){const e=Qn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function z2e(){return!R2e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function B2e(){try{return typeof indexedDB=="object"}catch{return!1}}function F2e(){return new Promise((e,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var s;t(((s=n.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2e="FirebaseError";class ic extends Error{constructor(t,r,i){super(r),this.code=t,this.customData=i,this.name=U2e,Object.setPrototypeOf(this,ic.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yw.prototype.create)}}class Yw{constructor(t,r,i){this.service=t,this.serviceName=r,this.errors=i}create(t,...r){const i=r[0]||{},n=`${this.service}/${t}`,s=this.errors[t],a=s?j2e(s,i):"Error",o=`${this.serviceName}: ${a} (${n}).`;return new ic(n,o,i)}}function j2e(e,t){return e.replace(V2e,(r,i)=>{const n=t[i];return n!=null?String(n):`<${i}?>`})}const V2e=/\{\$([^}]+)}/g;function H2e(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function JS(e,t){if(e===t)return!0;const r=Object.keys(e),i=Object.keys(t);for(const n of r){if(!i.includes(n))return!1;const s=e[n],a=t[n];if(c5(s)&&c5(a)){if(!JS(s,a))return!1}else if(s!==a)return!1}for(const n of i)if(!r.includes(n))return!1;return!0}function c5(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(e){const t=[];for(const[r,i]of Object.entries(e))Array.isArray(i)?i.forEach(n=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function W2e(e,t){const r=new G2e(e,t);return r.subscribe.bind(r)}class G2e{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,i){let n;if(t===void 0&&r===void 0&&i===void 0)throw new Error("Missing Observer.");q2e(t,["next","error","complete"])?n=t:n={next:t,error:r,complete:i},n.next===void 0&&(n.next=fP),n.error===void 0&&(n.error=fP),n.complete===void 0&&(n.complete=fP);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch{}}),this.observers.push(n),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function q2e(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function fP(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(e){return e&&e._delegate?e._delegate:e}class Gh{constructor(t,r,i){this.name=t,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2e{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const i=new I2e;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:r});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),n=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if($2e(t))try{this.getOrInitializeService({instanceIdentifier:Ed})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:n});i.resolve(s)}catch{}}}}clearInstance(t=Ed){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ed){return this.instances.has(t)}getOptions(t=Ed){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);i===o&&a.resolve(n)}return n}onInit(t,r){var i;const n=this.normalizeInstanceIdentifier(r),s=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&t(a,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const i=this.onInitCallbacks.get(r);if(i)for(const n of i)try{n(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:X2e(t),options:r}),this.instances.set(t,i),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Ed){return this.component?this.component.multipleInstances?t:Ed:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function X2e(e){return e===Ed?void 0:e}function $2e(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2e{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Y2e(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(ur||(ur={}));const K2e={debug:ur.DEBUG,verbose:ur.VERBOSE,info:ur.INFO,warn:ur.WARN,error:ur.ERROR,silent:ur.SILENT},Z2e=ur.INFO,J2e={[ur.DEBUG]:"log",[ur.VERBOSE]:"log",[ur.INFO]:"info",[ur.WARN]:"warn",[ur.ERROR]:"error"},eIe=(e,t,...r)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),n=J2e[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class jk{constructor(t){this.name=t,this._logLevel=Z2e,this._logHandler=eIe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ur))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?K2e[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ur.DEBUG,...t),this._logHandler(this,ur.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ur.VERBOSE,...t),this._logHandler(this,ur.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ur.INFO,...t),this._logHandler(this,ur.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ur.WARN,...t),this._logHandler(this,ur.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ur.ERROR,...t),this._logHandler(this,ur.ERROR,...t)}}const tIe=(e,t)=>t.some(r=>e instanceof r);let u5,h5;function rIe(){return u5||(u5=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iIe(){return h5||(h5=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const BX=new WeakMap,JI=new WeakMap,FX=new WeakMap,mP=new WeakMap,Vk=new WeakMap;function nIe(e){const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(kh(e.result)),n()},a=()=>{i(e.error),n()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&BX.set(r,e)}).catch(()=>{}),Vk.set(t,e),t}function sIe(e){if(JI.has(e))return;const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),n()},a=()=>{i(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});JI.set(e,t)}let eO={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return JI.get(e);if(t==="objectStoreNames")return e.objectStoreNames||FX.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return kh(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function aIe(e){eO=e(eO)}function oIe(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const i=e.call(gP(this),t,...r);return FX.set(i,t.sort?t.sort():[t]),kh(i)}:iIe().includes(e)?function(...t){return e.apply(gP(this),t),kh(BX.get(this))}:function(...t){return kh(e.apply(gP(this),t))}}function lIe(e){return typeof e=="function"?oIe(e):(e instanceof IDBTransaction&&sIe(e),tIe(e,rIe())?new Proxy(e,eO):e)}function kh(e){if(e instanceof IDBRequest)return nIe(e);if(mP.has(e))return mP.get(e);const t=lIe(e);return t!==e&&(mP.set(e,t),Vk.set(t,e)),t}const gP=e=>Vk.get(e);function cIe(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){const a=indexedDB.open(e,t),o=kh(a);return i&&a.addEventListener("upgradeneeded",l=>{i(kh(a.result),l.oldVersion,l.newVersion,kh(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const uIe=["get","getKey","getAll","getAllKeys","count"],hIe=["put","add","delete","clear"],vP=new Map;function d5(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(vP.get(t))return vP.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,n=hIe.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||uIe.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),n&&l.done]))[0]};return vP.set(t,s),s}aIe(e=>({...e,get:(t,r,i)=>d5(t,r)||e.get(t,r,i),has:(t,r)=>!!d5(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dIe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(pIe(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function pIe(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const tO="@firebase/app",p5="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p=new jk("@firebase/app"),fIe="@firebase/app-compat",mIe="@firebase/analytics-compat",gIe="@firebase/analytics",vIe="@firebase/app-check-compat",yIe="@firebase/app-check",wIe="@firebase/auth",xIe="@firebase/auth-compat",bIe="@firebase/database",_Ie="@firebase/database-compat",SIe="@firebase/functions",EIe="@firebase/functions-compat",TIe="@firebase/installations",CIe="@firebase/installations-compat",AIe="@firebase/messaging",MIe="@firebase/messaging-compat",PIe="@firebase/performance",DIe="@firebase/performance-compat",IIe="@firebase/remote-config",OIe="@firebase/remote-config-compat",RIe="@firebase/storage",kIe="@firebase/storage-compat",LIe="@firebase/firestore",NIe="@firebase/vertexai-preview",zIe="@firebase/firestore-compat",BIe="firebase",FIe="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO="[DEFAULT]",UIe={[tO]:"fire-core",[fIe]:"fire-core-compat",[gIe]:"fire-analytics",[mIe]:"fire-analytics-compat",[yIe]:"fire-app-check",[vIe]:"fire-app-check-compat",[wIe]:"fire-auth",[xIe]:"fire-auth-compat",[bIe]:"fire-rtdb",[_Ie]:"fire-rtdb-compat",[SIe]:"fire-fn",[EIe]:"fire-fn-compat",[TIe]:"fire-iid",[CIe]:"fire-iid-compat",[AIe]:"fire-fcm",[MIe]:"fire-fcm-compat",[PIe]:"fire-perf",[DIe]:"fire-perf-compat",[IIe]:"fire-rc",[OIe]:"fire-rc-compat",[RIe]:"fire-gcs",[kIe]:"fire-gcs-compat",[LIe]:"fire-fst",[zIe]:"fire-fst-compat",[NIe]:"fire-vertex","fire-js":"fire-js",[BIe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE=new Map,jIe=new Map,iO=new Map;function f5(e,t){try{e.container.addComponent(t)}catch(r){_p.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function Sp(e){const t=e.name;if(iO.has(t))return _p.debug(`There were multiple attempts to register component ${t}.`),!1;iO.set(t,e);for(const r of eE.values())f5(r,e);for(const r of jIe.values())f5(r,e);return!0}function BT(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function Vc(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VIe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lh=new Yw("app","Firebase",VIe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HIe{constructor(t,r,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Gh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Lh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp=FIe;function UX(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:rO,automaticDataCollectionEnabled:!1},t),n=i.name;if(typeof n!="string"||!n)throw Lh.create("bad-app-name",{appName:String(n)});if(r||(r=LX()),!r)throw Lh.create("no-options");const s=eE.get(n);if(s){if(JS(r,s.options)&&JS(i,s.config))return s;throw Lh.create("duplicate-app",{appName:n})}const a=new Q2e(n);for(const l of iO.values())a.addComponent(l);const o=new HIe(r,i,a);return eE.set(n,o),o}function Hk(e=rO){const t=eE.get(e);if(!t&&e===rO&&LX())return UX();if(!t)throw Lh.create("no-app",{appName:e});return t}function zl(e,t,r){var i;let n=(i=UIe[e])!==null&&i!==void 0?i:e;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${t}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),_p.warn(o.join(" "));return}Sp(new Gh(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIe="firebase-heartbeat-database",GIe=1,nw="firebase-heartbeat-store";let yP=null;function jX(){return yP||(yP=cIe(WIe,GIe,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(nw)}catch(r){console.warn(r)}}}}).catch(e=>{throw Lh.create("idb-open",{originalErrorMessage:e.message})})),yP}async function qIe(e){try{const r=(await jX()).transaction(nw),i=await r.objectStore(nw).get(VX(e));return await r.done,i}catch(t){if(t instanceof ic)_p.warn(t.message);else{const r=Lh.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});_p.warn(r.message)}}}async function m5(e,t){try{const i=(await jX()).transaction(nw,"readwrite");await i.objectStore(nw).put(t,VX(e)),await i.done}catch(r){if(r instanceof ic)_p.warn(r.message);else{const i=Lh.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_p.warn(i.message)}}}function VX(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YIe=1024,XIe=30*24*60*60*1e3;class $Ie{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new KIe(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,r;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=g5();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=XIe}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=g5(),{heartbeatsToSend:i,unsentEntries:n}=QIe(this._heartbeatsCache.heartbeats),s=ZS(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function g5(){return new Date().toISOString().substring(0,10)}function QIe(e,t=YIe){const r=[];let i=e.slice();for(const n of e){const s=r.find(a=>a.agent===n.agent);if(s){if(s.dates.push(n.date),v5(r)>t){s.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),v5(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class KIe{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return B2e()?F2e().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await qIe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return m5(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return m5(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function v5(e){return ZS(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZIe(e){Sp(new Gh("platform-logger",t=>new dIe(t),"PRIVATE")),Sp(new Gh("heartbeat",t=>new $Ie(t),"PRIVATE")),zl(tO,p5,e),zl(tO,p5,"esm2017"),zl("fire-js","")}ZIe("");function Wk(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function HX(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JIe=HX,WX=new Yw("auth","Firebase",HX());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tE=new jk("@firebase/auth");function eOe(e,...t){tE.logLevel<=ur.WARN&&tE.warn(`Auth (${Qp}): ${e}`,...t)}function i_(e,...t){tE.logLevel<=ur.ERROR&&tE.error(`Auth (${Qp}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(e,...t){throw qk(e,...t)}function zo(e,...t){return qk(e,...t)}function Gk(e,t,r){const i=Object.assign(Object.assign({},JIe()),{[t]:r});return new Yw("auth","Firebase",i).create(t,{appName:e.name})}function tp(e){return Gk(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tOe(e,t,r){const i=r;if(!(t instanceof i))throw i.name!==t.constructor.name&&Xl(e,"argument-error"),Gk(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qk(e,...t){if(typeof e!="string"){const r=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(r,...i)}return WX.create(e,...t)}function Bt(e,t,...r){if(!e)throw qk(t,...r)}function Hc(e){const t="INTERNAL ASSERTION FAILED: "+e;throw i_(t),new Error(t)}function hu(e,t){e||Hc(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nO(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function rOe(){return y5()==="http:"||y5()==="https:"}function y5(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iOe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rOe()||k2e()||"connection"in navigator)?navigator.onLine:!0}function nOe(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(t,r){this.shortDelay=t,this.longDelay=r,hu(r>t,"Short delay should be less than long delay!"),this.isMobile=O2e()||L2e()}get(){return iOe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(e,t){hu(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GX{static initialize(t,r,i){this.fetchImpl=t,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sOe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aOe=new $w(3e4,6e4);function Xk(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function lv(e,t,r,i,n={}){return qX(e,n,async()=>{let s={},a={};i&&(t==="GET"?a=i:s={body:JSON.stringify(i)});const o=Xw(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),GX.fetch()(YX(e,e.config.apiHost,r,o),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function qX(e,t,r){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},sOe),t);try{const n=new lOe(e),s=await Promise.race([r(),n.promise]);n.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw hb(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw hb(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw hb(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw hb(e,"user-disabled",a);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Gk(e,u,c);Xl(e,u)}}catch(n){if(n instanceof ic)throw n;Xl(e,"network-request-failed",{message:String(n)})}}async function oOe(e,t,r,i,n={}){const s=await lv(e,t,r,i,n);return"mfaPendingCredential"in s&&Xl(e,"multi-factor-auth-required",{_serverResponse:s}),s}function YX(e,t,r,i){const n=`${t}${r}?${i}`;return e.config.emulator?Yk(e.config,n):`${e.config.apiScheme}://${n}`}class lOe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,i)=>{this.timer=setTimeout(()=>i(zo(this.auth,"network-request-failed")),aOe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function hb(e,t,r){const i={appName:e.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const n=zo(e,t,i);return n.customData._tokenResponse=r,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cOe(e,t){return lv(e,"POST","/v1/accounts:delete",t)}async function XX(e,t){return lv(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function uOe(e,t=!1){const r=Ki(e),i=await r.getIdToken(t),n=$k(i);Bt(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const s=typeof n.firebase=="object"?n.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:n,token:i,authTime:o0(wP(n.auth_time)),issuedAtTime:o0(wP(n.iat)),expirationTime:o0(wP(n.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function wP(e){return Number(e)*1e3}function $k(e){const[t,r,i]=e.split(".");if(t===void 0||r===void 0||i===void 0)return i_("JWT malformed, contained fewer than 3 sections"),null;try{const n=OX(r);return n?JSON.parse(n):(i_("Failed to decode base64 JWT payload"),null)}catch(n){return i_("Caught error parsing JWT payload as JSON",n==null?void 0:n.toString()),null}}function w5(e){const t=$k(e);return Bt(t,"internal-error"),Bt(typeof t.exp<"u","internal-error"),Bt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sw(e,t,r=!1){if(r)return t;try{return await t}catch(i){throw i instanceof ic&&hOe(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function hOe({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dOe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const n=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=o0(this.lastLoginAt),this.creationTime=o0(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rE(e){var t;const r=e.auth,i=await e.getIdToken(),n=await sw(e,XX(r,{idToken:i}));Bt(n==null?void 0:n.users.length,r,"internal-error");const s=n.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?$X(s.providerUserInfo):[],o=fOe(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new sO(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,h)}async function pOe(e){const t=Ki(e);await rE(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function fOe(e,t){return[...e.filter(i=>!t.some(n=>n.providerId===i.providerId)),...t]}function $X(e){return e.map(t=>{var{providerId:r}=t,i=Wk(t,["providerId"]);return{providerId:r,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mOe(e,t){const r=await qX(e,{},async()=>{const i=Xw({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:s}=e.config,a=YX(e,n,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",GX.fetch()(a,{method:"POST",headers:o,body:i})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function gOe(e,t){return lv(e,"POST","/v2/accounts:revokeToken",Xk(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Bt(t.idToken,"internal-error"),Bt(typeof t.idToken<"u","internal-error"),Bt(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):w5(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Bt(t.length!==0,"internal-error");const r=w5(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Bt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:i,refreshToken:n,expiresIn:s}=await mOe(t,r);this.updateTokensAndExpiration(i,n,Number(s))}updateTokensAndExpiration(t,r,i){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,r){const{refreshToken:i,accessToken:n,expirationTime:s}=r,a=new Hm;return i&&(Bt(typeof i=="string","internal-error",{appName:t}),a.refreshToken=i),n&&(Bt(typeof n=="string","internal-error",{appName:t}),a.accessToken=n),s&&(Bt(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Hm,this.toJSON())}_performRefresh(){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(e,t){Bt(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class Wc{constructor(t){var{uid:r,auth:i,stsTokenManager:n}=t,s=Wk(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new dOe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new sO(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await sw(this,this.stsTokenManager.getToken(this.auth,t));return Bt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return uOe(this,t)}reload(){return pOe(this)}_assign(t){this!==t&&(Bt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new Wc(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),r&&await rE(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vc(this.auth.app))return Promise.reject(tp(this.auth));const t=await this.getIdToken();return await sw(this,cOe(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var i,n,s,a,o,l,c,u;const h=(i=r.displayName)!==null&&i!==void 0?i:void 0,d=(n=r.email)!==null&&n!==void 0?n:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,f=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,v=(c=r.createdAt)!==null&&c!==void 0?c:void 0,y=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:b,isAnonymous:E,providerData:_,stsTokenManager:C}=r;Bt(w&&C,t,"internal-error");const x=Hm.fromJSON(this.name,C);Bt(typeof w=="string",t,"internal-error"),Bu(h,t.name),Bu(d,t.name),Bt(typeof b=="boolean",t,"internal-error"),Bt(typeof E=="boolean",t,"internal-error"),Bu(p,t.name),Bu(f,t.name),Bu(m,t.name),Bu(g,t.name),Bu(v,t.name),Bu(y,t.name);const A=new Wc({uid:w,auth:t,email:d,emailVerified:b,displayName:h,isAnonymous:E,photoURL:f,phoneNumber:p,tenantId:m,stsTokenManager:x,createdAt:v,lastLoginAt:y});return _&&Array.isArray(_)&&(A.providerData=_.map(T=>Object.assign({},T))),g&&(A._redirectEventId=g),A}static async _fromIdTokenResponse(t,r,i=!1){const n=new Hm;n.updateFromServerResponse(r);const s=new Wc({uid:r.localId,auth:t,stsTokenManager:n,isAnonymous:i});return await rE(s),s}static async _fromGetAccountInfoResponse(t,r,i){const n=r.users[0];Bt(n.localId!==void 0,"internal-error");const s=n.providerUserInfo!==void 0?$X(n.providerUserInfo):[],a=!(n.email&&n.passwordHash)&&!(s!=null&&s.length),o=new Hm;o.updateFromIdToken(i);const l=new Wc({uid:n.localId,auth:t,stsTokenManager:o,isAnonymous:a}),c={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:s,metadata:new sO(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5=new Map;function Gc(e){hu(e instanceof Function,"Expected a class definition");let t=x5.get(e);return t?(hu(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,x5.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QX{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}QX.type="NONE";const b5=QX;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(e,t,r){return`firebase:${e}:${t}:${r}`}class Wm{constructor(t,r,i){this.persistence=t,this.auth=r,this.userKey=i;const{config:n,name:s}=this.auth;this.fullUserKey=n_(this.userKey,n.apiKey,s),this.fullPersistenceKey=n_("persistence",n.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Wc._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,i="authUser"){if(!r.length)return new Wm(Gc(b5),t,i);const n=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=n[0]||Gc(b5);const a=n_(i,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const h=Wc._fromJSON(t,u);c!==s&&(o=h),s=c;break}}catch{}const l=n.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Wm(s,t,i):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Wm(s,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _5(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(JX(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(KX(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(t$(t))return"Blackberry";if(r$(t))return"Webos";if(Qk(t))return"Safari";if((t.includes("chrome/")||ZX(t))&&!t.includes("edge/"))return"Chrome";if(e$(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(r);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function KX(e=Qn()){return/firefox\//i.test(e)}function Qk(e=Qn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ZX(e=Qn()){return/crios\//i.test(e)}function JX(e=Qn()){return/iemobile/i.test(e)}function e$(e=Qn()){return/android/i.test(e)}function t$(e=Qn()){return/blackberry/i.test(e)}function r$(e=Qn()){return/webos/i.test(e)}function FT(e=Qn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function vOe(e=Qn()){var t;return FT(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function yOe(){return N2e()&&document.documentMode===10}function i$(e=Qn()){return FT(e)||e$(e)||r$(e)||t$(e)||/windows phone/i.test(e)||JX(e)}function wOe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n$(e,t=[]){let r;switch(e){case"Browser":r=_5(Qn());break;case"Worker":r=`${_5(Qn())}-${e}`;break;default:r=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Qp}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xOe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const i=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});i.onAbort=r,this.queue.push(i);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const i of this.queue)await i(t),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const n of r)try{n()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bOe(e,t={}){return lv(e,"GET","/v2/passwordPolicy",Xk(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Oe=6;class SOe{constructor(t){var r,i,n,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:_Oe,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(n=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&n!==void 0?n:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,i,n,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(n=l.containsLowercaseLetter)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const i=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=t.length>=i),n&&(r.meetsMaxPasswordLength=t.length<=n)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let i;for(let n=0;n<t.length;n++)i=t.charAt(n),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,r,i,n,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EOe{constructor(t,r,i,n){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new S5(this),this.idTokenSubscription=new S5(this),this.beforeStateQueue=new xOe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WX,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Gc(r)),this._initializationPromise=this.queue(async()=>{var i,n;if(!this._deleted&&(this.persistenceManager=await Wm.create(this,t),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((n=this.currentUser)===null||n===void 0?void 0:n.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await XX(this,{idToken:t}),i=await Wc._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(Vc(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let n=i,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await rE(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=nOe()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Vc(this.app))return Promise.reject(tp(this));const r=t?Ki(t):null;return r&&Bt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Bt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Vc(this.app)?Promise.reject(tp(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Vc(this.app)?Promise.reject(tp(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gc(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await bOe(this),r=new SOe(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Yw("auth","Firebase",t())}onAuthStateChanged(t,r,i){return this.registerStateListener(this.authStateSubscription,t,r,i)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,i){return this.registerStateListener(this.idTokenSubscription,t,r,i)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(i.tenantId=this.tenantId),await gOe(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const i=await this.getOrInitRedirectPersistenceManager(r);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Gc(t)||this._popupRedirectResolver;Bt(r,this,"argument-error"),this.redirectPersistenceManager=await Wm.create(this,[Gc(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,i;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,i,n){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Bt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,i,n);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=n$(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(r["X-Firebase-Client"]=i);const n=await this._getAppCheckToken();return n&&(r["X-Firebase-AppCheck"]=n),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&eOe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function UT(e){return Ki(e)}class S5{constructor(t){this.auth=t,this.observer=null,this.addObserver=W2e(r=>this.observer=r)}get next(){return Bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kk={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TOe(e){Kk=e}function COe(e){return Kk.loadJS(e)}function AOe(){return Kk.gapiScript}function MOe(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function POe(e,t){const r=BT(e,"auth");if(r.isInitialized()){const n=r.getImmediate(),s=r.getOptions();if(JS(s,t??{}))return n;Xl(n,"already-initialized")}return r.initialize({options:t})}function DOe(e,t){const r=(t==null?void 0:t.persistence)||[],i=(Array.isArray(r)?r:[r]).map(Gc);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t==null?void 0:t.popupRedirectResolver)}function IOe(e,t,r){const i=UT(e);Bt(i._canInitEmulator,i,"emulator-config-failed"),Bt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const n=!!(r!=null&&r.disableWarnings),s=s$(t),{host:a,port:o}=OOe(t),l=o===null?"":`:${o}`;i.config.emulator={url:`${s}//${a}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:n})}),n||ROe()}function s$(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function OOe(e){const t=s$(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){const s=n[1];return{host:s,port:E5(i.substr(s.length+1))}}else{const[s,a]=i.split(":");return{host:s,port:E5(a)}}}function E5(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function ROe(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a${constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Hc("not implemented")}_getIdTokenResponse(t){return Hc("not implemented")}_linkToIdToken(t,r){return Hc("not implemented")}_getReauthenticationResolver(t){return Hc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gm(e,t){return oOe(e,"POST","/v1/accounts:signInWithIdp",Xk(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kOe="http://localhost";class Ep extends a${constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Ep(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Xl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:n}=r,s=Wk(r,["providerId","signInMethod"]);if(!i||!n)return null;const a=new Ep(i,n);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return Gm(t,r)}_linkToIdToken(t,r){const i=this.buildRequest();return i.idToken=r,Gm(t,i)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Gm(t,r)}buildRequest(){const t={requestUri:kOe,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Xw(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw extends Zk{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends Qw{constructor(){super("facebook.com")}static credential(t){return Ep._fromParams({providerId:Ju.PROVIDER_ID,signInMethod:Ju.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ju.credentialFromTaggedObject(t)}static credentialFromError(t){return Ju.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ju.credential(t.oauthAccessToken)}catch{return null}}}Ju.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ju.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc extends Qw{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Ep._fromParams({providerId:Rc.PROVIDER_ID,signInMethod:Rc.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Rc.credentialFromTaggedObject(t)}static credentialFromError(t){return Rc.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return Rc.credential(r,i)}catch{return null}}}Rc.GOOGLE_SIGN_IN_METHOD="google.com";Rc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh extends Qw{constructor(){super("github.com")}static credential(t){return Ep._fromParams({providerId:eh.PROVIDER_ID,signInMethod:eh.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return eh.credentialFromTaggedObject(t)}static credentialFromError(t){return eh.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return eh.credential(t.oauthAccessToken)}catch{return null}}}eh.GITHUB_SIGN_IN_METHOD="github.com";eh.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th extends Qw{constructor(){super("twitter.com")}static credential(t,r){return Ep._fromParams({providerId:th.PROVIDER_ID,signInMethod:th.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return th.credentialFromTaggedObject(t)}static credentialFromError(t){return th.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return th.credential(r,i)}catch{return null}}}th.TWITTER_SIGN_IN_METHOD="twitter.com";th.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,i,n=!1){const s=await Wc._fromIdTokenResponse(t,i,n),a=T5(i);return new xg({user:s,providerId:a,_tokenResponse:i,operationType:r})}static async _forOperation(t,r,i){await t._updateTokensIfNecessary(i,!0);const n=T5(i);return new xg({user:t,providerId:n,_tokenResponse:i,operationType:r})}}function T5(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE extends ic{constructor(t,r,i,n){var s;super(r.code,r.message),this.operationType=i,this.user=n,Object.setPrototypeOf(this,iE.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,r,i,n){return new iE(t,r,i,n)}}function o$(e,t,r,i){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?iE._fromErrorAndOperation(e,s,t,i):s})}async function LOe(e,t,r=!1){const i=await sw(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return xg._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NOe(e,t,r=!1){const{auth:i}=e;if(Vc(i.app))return Promise.reject(tp(i));const n="reauthenticate";try{const s=await sw(e,o$(i,n,t,e),r);Bt(s.idToken,i,"internal-error");const a=$k(s.idToken);Bt(a,i,"internal-error");const{sub:o}=a;return Bt(e.uid===o,i,"user-mismatch"),xg._forOperation(e,n,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xl(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zOe(e,t,r=!1){if(Vc(e.app))return Promise.reject(tp(e));const i="signIn",n=await o$(e,i,t),s=await xg._fromIdTokenResponse(e,i,n);return r||await e._updateCurrentUser(s.user),s}function BOe(e,t,r,i){return Ki(e).onIdTokenChanged(t,r,i)}function FOe(e,t,r){return Ki(e).beforeAuthStateChanged(t,r)}function UOe(e){return Ki(e).signOut()}const nE="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l${constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(nE,"1"),this.storage.removeItem(nE),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jOe(){const e=Qn();return Qk(e)||FT(e)}const VOe=1e3,HOe=10;class c$ extends l${constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=jOe()&&wOe(),this.fallbackToPolling=i$(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),n=this.localCache[r];i!==n&&t(r,n,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const i=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!r)return}const n=()=>{const a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);yOe()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(n,HOe):n()}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},VOe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}c$.type="LOCAL";const WOe=c$;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u$ extends l${constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}u$.type="SESSION";const h$=u$;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GOe(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(n=>n.isListeningto(t));if(r)return r;const i=new jT(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:i,eventType:n,data:s}=r.data,a=this.handlersMap[n];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:n});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await GOe(o);r.ports[0].postMessage({status:"done",eventId:i,eventType:n,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jT.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(e="",t=10){let r="";for(let i=0;i<t;i++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qOe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,i=50){const n=typeof MessageChannel<"u"?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=Jk("",20);n.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);a={messageChannel:n,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),n.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[n.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(){return window}function YOe(e){Bl().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d$(){return typeof Bl().WorkerGlobalScope<"u"&&typeof Bl().importScripts=="function"}async function XOe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $Oe(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function QOe(){return d$()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$="firebaseLocalStorageDb",KOe=1,sE="firebaseLocalStorage",f$="fbase_key";class Kw{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function VT(e,t){return e.transaction([sE],t?"readwrite":"readonly").objectStore(sE)}function ZOe(){const e=indexedDB.deleteDatabase(p$);return new Kw(e).toPromise()}function aO(){const e=indexedDB.open(p$,KOe);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(sE,{keyPath:f$})}catch(n){r(n)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(sE)?t(i):(i.close(),await ZOe(),t(await aO()))})})}async function C5(e,t,r){const i=VT(e,!0).put({[f$]:t,value:r});return new Kw(i).toPromise()}async function JOe(e,t){const r=VT(e,!1).get(t),i=await new Kw(r).toPromise();return i===void 0?null:i.value}function A5(e,t){const r=VT(e,!0).delete(t);return new Kw(r).toPromise()}const eRe=800,tRe=3;class m${constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await aO(),this.db)}async _withRetries(t){let r=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(r++>tRe)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return d$()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jT._getInstance(QOe()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await XOe(),!this.activeServiceWorker)return;this.sender=new qOe(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||$Oe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await aO();return await C5(t,nE,"1"),await A5(t,nE),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>C5(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(i=>JOe(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>A5(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(n=>{const s=VT(n,!1).getAll();return new Kw(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],i=new Set;if(t.length!==0)for(const{fbase_key:n,value:s}of t)i.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(s)&&(this.notifyListeners(n,s),r.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!i.has(n)&&(this.notifyListeners(n,null),r.push(n));return r}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eRe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}m$.type="LOCAL";const rRe=m$;new $w(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g$(e,t){return t?Gc(t):(Bt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL extends a${constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Gm(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Gm(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Gm(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function iRe(e){return zOe(e.auth,new eL(e),e.bypassAuthState)}function nRe(e){const{auth:t,user:r}=e;return Bt(r,t,"internal-error"),NOe(r,new eL(e),e.bypassAuthState)}async function sRe(e){const{auth:t,user:r}=e;return Bt(r,t,"internal-error"),LOe(r,new eL(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(t,r,i,n,s=!1){this.auth=t,this.resolver=i,this.user=n,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:i,postBody:n,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:i,tenantId:s||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return iRe;case"linkViaPopup":case"linkViaRedirect":return sRe;case"reauthViaPopup":case"reauthViaRedirect":return nRe;default:Xl(this.auth,"internal-error")}}resolve(t){hu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){hu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aRe=new $w(2e3,1e4);async function HT(e,t,r){if(Vc(e.app))return Promise.reject(zo(e,"operation-not-supported-in-this-environment"));const i=UT(e);tOe(e,t,Zk);const n=g$(i,r);return new Hd(i,"signInViaPopup",t,n).executeNotNull()}class Hd extends v${constructor(t,r,i,n,s){super(t,r,n,s),this.provider=i,this.authWindow=null,this.pollId=null,Hd.currentPopupAction&&Hd.currentPopupAction.cancel(),Hd.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Bt(t,this.auth,"internal-error"),t}async onExecution(){hu(this.filter.length===1,"Popup operations only handle one event");const t=Jk();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(zo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(zo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hd.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,aRe.get())};t()}}Hd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oRe="pendingRedirect",s_=new Map;class lRe extends v${constructor(t,r,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let t=s_.get(this.auth._key());if(!t){try{const i=await cRe(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(r){t=()=>Promise.reject(r)}s_.set(this.auth._key(),t)}return this.bypassAuthState||s_.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cRe(e,t){const r=dRe(t),i=hRe(e);if(!await i._isAvailable())return!1;const n=await i._get(r)==="true";return await i._remove(r),n}function uRe(e,t){s_.set(e._key(),t)}function hRe(e){return Gc(e._redirectPersistence)}function dRe(e){return n_(oRe,e.config.apiKey,e.name)}async function pRe(e,t,r=!1){if(Vc(e.app))return Promise.reject(tp(e));const i=UT(e),n=g$(i,t),a=await new lRe(i,n,r).execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fRe=10*60*1e3;class mRe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(r=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!gRe(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var i;if(t.error&&!y$(t)){const n=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";r.onError(zo(this.auth,n))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const i=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=fRe&&this.cachedEventUids.clear(),this.cachedEventUids.has(M5(t))}saveEventToCache(t){this.cachedEventUids.add(M5(t)),this.lastProcessedEventTime=Date.now()}}function M5(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function y$({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function gRe(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return y$(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vRe(e,t={}){return lv(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yRe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wRe=/^https?/;async function xRe(e){if(e.config.emulator)return;const{authorizedDomains:t}=await vRe(e);for(const r of t)try{if(bRe(r))return}catch{}Xl(e,"unauthorized-domain")}function bRe(e){const t=nO(),{protocol:r,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&i===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===i}if(!wRe.test(r))return!1;if(yRe.test(e))return i===e;const n=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Re=new $w(3e4,6e4);function P5(){const e=Bl().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function SRe(e){return new Promise((t,r)=>{var i,n,s;function a(){P5(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{P5(),r(zo(e,"network-request-failed"))},timeout:_Re.get()})}if(!((n=(i=Bl().gapi)===null||i===void 0?void 0:i.iframes)===null||n===void 0)&&n.Iframe)t(gapi.iframes.getContext());else if(!((s=Bl().gapi)===null||s===void 0)&&s.load)a();else{const o=MOe("iframefcb");return Bl()[o]=()=>{gapi.load?a():r(zo(e,"network-request-failed"))},COe(`${AOe()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw a_=null,t})}let a_=null;function ERe(e){return a_=a_||SRe(e),a_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TRe=new $w(5e3,15e3),CRe="__/auth/iframe",ARe="emulator/auth/iframe",MRe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PRe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DRe(e){const t=e.config;Bt(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Yk(t,ARe):`https://${e.config.authDomain}/${CRe}`,i={apiKey:t.apiKey,appName:e.name,v:Qp},n=PRe.get(e.config.apiHost);n&&(i.eid=n);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${r}?${Xw(i).slice(1)}`}async function IRe(e){const t=await ERe(e),r=Bl().gapi;return Bt(r,e,"internal-error"),t.open({where:document.body,url:DRe(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MRe,dontclear:!0},i=>new Promise(async(n,s)=>{await i.restyle({setHideOnLeave:!1});const a=zo(e,"network-request-failed"),o=Bl().setTimeout(()=>{s(a)},TRe.get());function l(){Bl().clearTimeout(o),n(i)}i.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ORe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RRe=500,kRe=600,LRe="_blank",NRe="http://localhost";class D5{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zRe(e,t,r,i=RRe,n=kRe){const s=Math.max((window.screen.availHeight-n)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},ORe),{width:i.toString(),height:n.toString(),top:s,left:a}),c=Qn().toLowerCase();r&&(o=ZX(c)?LRe:r),KX(c)&&(t=t||NRe,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[p,f])=>`${d}${p}=${f},`,"");if(vOe(c)&&o!=="_self")return BRe(t||"",o),new D5(null);const h=window.open(t||"",o,u);Bt(h,e,"popup-blocked");try{h.focus()}catch{}return new D5(h)}function BRe(e,t){const r=document.createElement("a");r.href=e,r.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FRe="__/auth/handler",URe="emulator/auth/handler",jRe=encodeURIComponent("fac");async function I5(e,t,r,i,n,s){Bt(e.config.authDomain,e,"auth-domain-config-required"),Bt(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:i,v:Qp,eventId:n};if(t instanceof Zk){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",H2e(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(s||{}))a[u]=h}if(t instanceof Qw){const u=t.getScopes().filter(h=>h!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${jRe}=${encodeURIComponent(l)}`:"";return`${VRe(e)}?${Xw(o).slice(1)}${c}`}function VRe({config:e}){return e.emulator?Yk(e,URe):`https://${e.authDomain}/${FRe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="webStorageSupport";class HRe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h$,this._completeRedirectFn=pRe,this._overrideRedirectResult=uRe}async _openPopup(t,r,i,n){var s;hu((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await I5(t,r,i,nO(),n);return zRe(t,a,Jk())}async _openRedirect(t,r,i,n){await this._originValidation(t);const s=await I5(t,r,i,nO(),n);return YOe(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:n,promise:s}=this.eventManagers[r];return n?Promise.resolve(n):(hu(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(t){const r=await IRe(t),i=new mRe(t);return r.register("authEvent",n=>(Bt(n==null?void 0:n.authEvent,t,"invalid-auth-event"),{status:i.onEvent(n.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=r,i}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(xP,{type:xP},n=>{var s;const a=(s=n==null?void 0:n[0])===null||s===void 0?void 0:s[xP];a!==void 0&&r(!!a),Xl(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=xRe(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return i$()||Qk()||FT()}}const WRe=HRe;var O5="@firebase/auth",R5="1.7.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GRe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(i=>{t((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qRe(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function YRe(e){Sp(new Gh("auth",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=i.options;Bt(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:n$(e)},c=new EOe(i,n,s,l);return DOe(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,i)=>{t.getProvider("auth-internal").initialize()})),Sp(new Gh("auth-internal",t=>{const r=UT(t.getProvider("auth").getImmediate());return(i=>new GRe(i))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),zl(O5,R5,qRe(e)),zl(O5,R5,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XRe=5*60,$Re=NX("authIdTokenMaxAge")||XRe;let k5=null;const QRe=e=>async t=>{const r=t&&await t.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>$Re)return;const n=r==null?void 0:r.token;k5!==n&&(k5=n,await fetch(e,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))};function KRe(e=Hk()){const t=BT(e,"auth");if(t.isInitialized())return t.getImmediate();const r=POe(e,{popupRedirectResolver:WRe,persistence:[rRe,WOe,h$]}),i=NX("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const a=QRe(s.toString());FOe(r,a,()=>a(r.currentUser)),BOe(r,o=>a(o))}}const n=RX("auth");return n&&IOe(r,`http://${n}`),r}function ZRe(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}TOe({loadJS(e){return new Promise((t,r)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=n=>{const s=zo("internal-error");s.customData=n,r(s)},i.type="text/javascript",i.charset="UTF-8",ZRe().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});YRe("Browser");var JRe="firebase",e3e="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zl(JRe,e3e,"app");var L5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rp,w$;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(C,x){function A(){}A.prototype=x.prototype,C.D=x.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(T,M,D){for(var P=Array(arguments.length-2),I=2;I<arguments.length;I++)P[I-2]=arguments[I];return x.prototype[M].apply(T,P)}}function r(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,r),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function n(C,x,A){A||(A=0);var T=Array(16);if(typeof x=="string")for(var M=0;16>M;++M)T[M]=x.charCodeAt(A++)|x.charCodeAt(A++)<<8|x.charCodeAt(A++)<<16|x.charCodeAt(A++)<<24;else for(M=0;16>M;++M)T[M]=x[A++]|x[A++]<<8|x[A++]<<16|x[A++]<<24;x=C.g[0],A=C.g[1],M=C.g[2];var D=C.g[3],P=x+(D^A&(M^D))+T[0]+3614090360&4294967295;x=A+(P<<7&4294967295|P>>>25),P=D+(M^x&(A^M))+T[1]+3905402710&4294967295,D=x+(P<<12&4294967295|P>>>20),P=M+(A^D&(x^A))+T[2]+606105819&4294967295,M=D+(P<<17&4294967295|P>>>15),P=A+(x^M&(D^x))+T[3]+3250441966&4294967295,A=M+(P<<22&4294967295|P>>>10),P=x+(D^A&(M^D))+T[4]+4118548399&4294967295,x=A+(P<<7&4294967295|P>>>25),P=D+(M^x&(A^M))+T[5]+1200080426&4294967295,D=x+(P<<12&4294967295|P>>>20),P=M+(A^D&(x^A))+T[6]+2821735955&4294967295,M=D+(P<<17&4294967295|P>>>15),P=A+(x^M&(D^x))+T[7]+4249261313&4294967295,A=M+(P<<22&4294967295|P>>>10),P=x+(D^A&(M^D))+T[8]+1770035416&4294967295,x=A+(P<<7&4294967295|P>>>25),P=D+(M^x&(A^M))+T[9]+2336552879&4294967295,D=x+(P<<12&4294967295|P>>>20),P=M+(A^D&(x^A))+T[10]+4294925233&4294967295,M=D+(P<<17&4294967295|P>>>15),P=A+(x^M&(D^x))+T[11]+2304563134&4294967295,A=M+(P<<22&4294967295|P>>>10),P=x+(D^A&(M^D))+T[12]+1804603682&4294967295,x=A+(P<<7&4294967295|P>>>25),P=D+(M^x&(A^M))+T[13]+4254626195&4294967295,D=x+(P<<12&4294967295|P>>>20),P=M+(A^D&(x^A))+T[14]+2792965006&4294967295,M=D+(P<<17&4294967295|P>>>15),P=A+(x^M&(D^x))+T[15]+1236535329&4294967295,A=M+(P<<22&4294967295|P>>>10),P=x+(M^D&(A^M))+T[1]+4129170786&4294967295,x=A+(P<<5&4294967295|P>>>27),P=D+(A^M&(x^A))+T[6]+3225465664&4294967295,D=x+(P<<9&4294967295|P>>>23),P=M+(x^A&(D^x))+T[11]+643717713&4294967295,M=D+(P<<14&4294967295|P>>>18),P=A+(D^x&(M^D))+T[0]+3921069994&4294967295,A=M+(P<<20&4294967295|P>>>12),P=x+(M^D&(A^M))+T[5]+3593408605&4294967295,x=A+(P<<5&4294967295|P>>>27),P=D+(A^M&(x^A))+T[10]+38016083&4294967295,D=x+(P<<9&4294967295|P>>>23),P=M+(x^A&(D^x))+T[15]+3634488961&4294967295,M=D+(P<<14&4294967295|P>>>18),P=A+(D^x&(M^D))+T[4]+3889429448&4294967295,A=M+(P<<20&4294967295|P>>>12),P=x+(M^D&(A^M))+T[9]+568446438&4294967295,x=A+(P<<5&4294967295|P>>>27),P=D+(A^M&(x^A))+T[14]+3275163606&4294967295,D=x+(P<<9&4294967295|P>>>23),P=M+(x^A&(D^x))+T[3]+4107603335&4294967295,M=D+(P<<14&4294967295|P>>>18),P=A+(D^x&(M^D))+T[8]+1163531501&4294967295,A=M+(P<<20&4294967295|P>>>12),P=x+(M^D&(A^M))+T[13]+2850285829&4294967295,x=A+(P<<5&4294967295|P>>>27),P=D+(A^M&(x^A))+T[2]+4243563512&4294967295,D=x+(P<<9&4294967295|P>>>23),P=M+(x^A&(D^x))+T[7]+1735328473&4294967295,M=D+(P<<14&4294967295|P>>>18),P=A+(D^x&(M^D))+T[12]+2368359562&4294967295,A=M+(P<<20&4294967295|P>>>12),P=x+(A^M^D)+T[5]+4294588738&4294967295,x=A+(P<<4&4294967295|P>>>28),P=D+(x^A^M)+T[8]+2272392833&4294967295,D=x+(P<<11&4294967295|P>>>21),P=M+(D^x^A)+T[11]+1839030562&4294967295,M=D+(P<<16&4294967295|P>>>16),P=A+(M^D^x)+T[14]+4259657740&4294967295,A=M+(P<<23&4294967295|P>>>9),P=x+(A^M^D)+T[1]+2763975236&4294967295,x=A+(P<<4&4294967295|P>>>28),P=D+(x^A^M)+T[4]+1272893353&4294967295,D=x+(P<<11&4294967295|P>>>21),P=M+(D^x^A)+T[7]+4139469664&4294967295,M=D+(P<<16&4294967295|P>>>16),P=A+(M^D^x)+T[10]+3200236656&4294967295,A=M+(P<<23&4294967295|P>>>9),P=x+(A^M^D)+T[13]+681279174&4294967295,x=A+(P<<4&4294967295|P>>>28),P=D+(x^A^M)+T[0]+3936430074&4294967295,D=x+(P<<11&4294967295|P>>>21),P=M+(D^x^A)+T[3]+3572445317&4294967295,M=D+(P<<16&4294967295|P>>>16),P=A+(M^D^x)+T[6]+76029189&4294967295,A=M+(P<<23&4294967295|P>>>9),P=x+(A^M^D)+T[9]+3654602809&4294967295,x=A+(P<<4&4294967295|P>>>28),P=D+(x^A^M)+T[12]+3873151461&4294967295,D=x+(P<<11&4294967295|P>>>21),P=M+(D^x^A)+T[15]+530742520&4294967295,M=D+(P<<16&4294967295|P>>>16),P=A+(M^D^x)+T[2]+3299628645&4294967295,A=M+(P<<23&4294967295|P>>>9),P=x+(M^(A|~D))+T[0]+4096336452&4294967295,x=A+(P<<6&4294967295|P>>>26),P=D+(A^(x|~M))+T[7]+1126891415&4294967295,D=x+(P<<10&4294967295|P>>>22),P=M+(x^(D|~A))+T[14]+2878612391&4294967295,M=D+(P<<15&4294967295|P>>>17),P=A+(D^(M|~x))+T[5]+4237533241&4294967295,A=M+(P<<21&4294967295|P>>>11),P=x+(M^(A|~D))+T[12]+1700485571&4294967295,x=A+(P<<6&4294967295|P>>>26),P=D+(A^(x|~M))+T[3]+2399980690&4294967295,D=x+(P<<10&4294967295|P>>>22),P=M+(x^(D|~A))+T[10]+4293915773&4294967295,M=D+(P<<15&4294967295|P>>>17),P=A+(D^(M|~x))+T[1]+2240044497&4294967295,A=M+(P<<21&4294967295|P>>>11),P=x+(M^(A|~D))+T[8]+1873313359&4294967295,x=A+(P<<6&4294967295|P>>>26),P=D+(A^(x|~M))+T[15]+4264355552&4294967295,D=x+(P<<10&4294967295|P>>>22),P=M+(x^(D|~A))+T[6]+2734768916&4294967295,M=D+(P<<15&4294967295|P>>>17),P=A+(D^(M|~x))+T[13]+1309151649&4294967295,A=M+(P<<21&4294967295|P>>>11),P=x+(M^(A|~D))+T[4]+4149444226&4294967295,x=A+(P<<6&4294967295|P>>>26),P=D+(A^(x|~M))+T[11]+3174756917&4294967295,D=x+(P<<10&4294967295|P>>>22),P=M+(x^(D|~A))+T[2]+718787259&4294967295,M=D+(P<<15&4294967295|P>>>17),P=A+(D^(M|~x))+T[9]+3951481745&4294967295,C.g[0]=C.g[0]+x&4294967295,C.g[1]=C.g[1]+(M+(P<<21&4294967295|P>>>11))&4294967295,C.g[2]=C.g[2]+M&4294967295,C.g[3]=C.g[3]+D&4294967295}i.prototype.u=function(C,x){x===void 0&&(x=C.length);for(var A=x-this.blockSize,T=this.B,M=this.h,D=0;D<x;){if(M==0)for(;D<=A;)n(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<x;)if(T[M++]=C.charCodeAt(D++),M==this.blockSize){n(this,T),M=0;break}}else for(;D<x;)if(T[M++]=C[D++],M==this.blockSize){n(this,T),M=0;break}}this.h=M,this.o+=x},i.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var x=1;x<C.length-8;++x)C[x]=0;var A=8*this.o;for(x=C.length-8;x<C.length;++x)C[x]=A&255,A/=256;for(this.u(C),C=Array(16),x=A=0;4>x;++x)for(var T=0;32>T;T+=8)C[A++]=this.g[x]>>>T&255;return C};function s(C,x){var A=o;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=x(C)}function a(C,x){this.h=x;for(var A=[],T=!0,M=C.length-1;0<=M;M--){var D=C[M]|0;T&&D==x||(A[M]=D,T=!1)}this.g=A}var o={};function l(C){return-128<=C&&128>C?s(C,function(x){return new a([x|0],0>x?-1:0)}):new a([C|0],0>C?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return h;if(0>C)return g(c(-C));for(var x=[],A=1,T=0;C>=A;T++)x[T]=C/A|0,A*=4294967296;return new a(x,0)}function u(C,x){if(C.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(C.charAt(0)=="-")return g(u(C.substring(1),x));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(x,8)),T=h,M=0;M<C.length;M+=8){var D=Math.min(8,C.length-M),P=parseInt(C.substring(M,M+D),x);8>D?(D=c(Math.pow(x,D)),T=T.j(D).add(c(P))):(T=T.j(A),T=T.add(c(P)))}return T}var h=l(0),d=l(1),p=l(16777216);e=a.prototype,e.m=function(){if(m(this))return-g(this).m();for(var C=0,x=1,A=0;A<this.g.length;A++){var T=this.i(A);C+=(0<=T?T:4294967296+T)*x,x*=4294967296}return C},e.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(f(this))return"0";if(m(this))return"-"+g(this).toString(C);for(var x=c(Math.pow(C,6)),A=this,T="";;){var M=b(A,x).g;A=v(A,M.j(x));var D=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=M,f(A))return D+T;for(;6>D.length;)D="0"+D;T=D+T}},e.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function f(C){if(C.h!=0)return!1;for(var x=0;x<C.g.length;x++)if(C.g[x]!=0)return!1;return!0}function m(C){return C.h==-1}e.l=function(C){return C=v(this,C),m(C)?-1:f(C)?0:1};function g(C){for(var x=C.g.length,A=[],T=0;T<x;T++)A[T]=~C.g[T];return new a(A,~C.h).add(d)}e.abs=function(){return m(this)?g(this):this},e.add=function(C){for(var x=Math.max(this.g.length,C.g.length),A=[],T=0,M=0;M<=x;M++){var D=T+(this.i(M)&65535)+(C.i(M)&65535),P=(D>>>16)+(this.i(M)>>>16)+(C.i(M)>>>16);T=P>>>16,D&=65535,P&=65535,A[M]=P<<16|D}return new a(A,A[A.length-1]&-2147483648?-1:0)};function v(C,x){return C.add(g(x))}e.j=function(C){if(f(this)||f(C))return h;if(m(this))return m(C)?g(this).j(g(C)):g(g(this).j(C));if(m(C))return g(this.j(g(C)));if(0>this.l(p)&&0>C.l(p))return c(this.m()*C.m());for(var x=this.g.length+C.g.length,A=[],T=0;T<2*x;T++)A[T]=0;for(T=0;T<this.g.length;T++)for(var M=0;M<C.g.length;M++){var D=this.i(T)>>>16,P=this.i(T)&65535,I=C.i(M)>>>16,B=C.i(M)&65535;A[2*T+2*M]+=P*B,y(A,2*T+2*M),A[2*T+2*M+1]+=D*B,y(A,2*T+2*M+1),A[2*T+2*M+1]+=P*I,y(A,2*T+2*M+1),A[2*T+2*M+2]+=D*I,y(A,2*T+2*M+2)}for(T=0;T<x;T++)A[T]=A[2*T+1]<<16|A[2*T];for(T=x;T<2*x;T++)A[T]=0;return new a(A,0)};function y(C,x){for(;(C[x]&65535)!=C[x];)C[x+1]+=C[x]>>>16,C[x]&=65535,x++}function w(C,x){this.g=C,this.h=x}function b(C,x){if(f(x))throw Error("division by zero");if(f(C))return new w(h,h);if(m(C))return x=b(g(C),x),new w(g(x.g),g(x.h));if(m(x))return x=b(C,g(x)),new w(g(x.g),x.h);if(30<C.g.length){if(m(C)||m(x))throw Error("slowDivide_ only works with positive integers.");for(var A=d,T=x;0>=T.l(C);)A=E(A),T=E(T);var M=_(A,1),D=_(T,1);for(T=_(T,2),A=_(A,2);!f(T);){var P=D.add(T);0>=P.l(C)&&(M=M.add(A),D=P),T=_(T,1),A=_(A,1)}return x=v(C,M.j(x)),new w(M,x)}for(M=h;0<=C.l(x);){for(A=Math.max(1,Math.floor(C.m()/x.m())),T=Math.ceil(Math.log(A)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),D=c(A),P=D.j(x);m(P)||0<P.l(C);)A-=T,D=c(A),P=D.j(x);f(D)&&(D=d),M=M.add(D),C=v(C,P)}return new w(M,C)}e.A=function(C){return b(this,C).h},e.and=function(C){for(var x=Math.max(this.g.length,C.g.length),A=[],T=0;T<x;T++)A[T]=this.i(T)&C.i(T);return new a(A,this.h&C.h)},e.or=function(C){for(var x=Math.max(this.g.length,C.g.length),A=[],T=0;T<x;T++)A[T]=this.i(T)|C.i(T);return new a(A,this.h|C.h)},e.xor=function(C){for(var x=Math.max(this.g.length,C.g.length),A=[],T=0;T<x;T++)A[T]=this.i(T)^C.i(T);return new a(A,this.h^C.h)};function E(C){for(var x=C.g.length+1,A=[],T=0;T<x;T++)A[T]=C.i(T)<<1|C.i(T-1)>>>31;return new a(A,C.h)}function _(C,x){var A=x>>5;x%=32;for(var T=C.g.length-A,M=[],D=0;D<T;D++)M[D]=0<x?C.i(D+A)>>>x|C.i(D+A+1)<<32-x:C.i(D+A);return new a(M,C.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,w$=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,rp=a}).apply(typeof L5<"u"?L5:typeof self<"u"?self:typeof window<"u"?window:{});var db=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var x$,b$,Ry,_$,o_,oO,S$,E$,T$;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(S,O,z){return S==Array.prototype||S==Object.prototype||(S[O]=z.value),S};function r(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof db=="object"&&db];for(var O=0;O<S.length;++O){var z=S[O];if(z&&z.Math==Math)return z}throw Error("Cannot find global object")}var i=r(this);function n(S,O){if(O)e:{var z=i;S=S.split(".");for(var Y=0;Y<S.length-1;Y++){var ge=S[Y];if(!(ge in z))break e;z=z[ge]}S=S[S.length-1],Y=z[S],O=O(Y),O!=Y&&O!=null&&t(z,S,{configurable:!0,writable:!0,value:O})}}function s(S,O){S instanceof String&&(S+="");var z=0,Y=!1,ge={next:function(){if(!Y&&z<S.length){var Ce=z++;return{value:O(Ce,S[Ce]),done:!1}}return Y=!0,{done:!0,value:void 0}}};return ge[Symbol.iterator]=function(){return ge},ge}n("Array.prototype.values",function(S){return S||function(){return s(this,function(O,z){return z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(S){var O=typeof S;return O=O!="object"?O:S?Array.isArray(S)?"array":O:"null",O=="array"||O=="object"&&typeof S.length=="number"}function c(S){var O=typeof S;return O=="object"&&S!=null||O=="function"}function u(S,O,z){return S.call.apply(S.bind,arguments)}function h(S,O,z){if(!S)throw Error();if(2<arguments.length){var Y=Array.prototype.slice.call(arguments,2);return function(){var ge=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ge,Y),S.apply(O,ge)}}return function(){return S.apply(O,arguments)}}function d(S,O,z){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function p(S,O){var z=Array.prototype.slice.call(arguments,1);return function(){var Y=z.slice();return Y.push.apply(Y,arguments),S.apply(this,Y)}}function f(S,O){function z(){}z.prototype=O.prototype,S.aa=O.prototype,S.prototype=new z,S.prototype.constructor=S,S.Qb=function(Y,ge,Ce){for(var Qe=Array(arguments.length-2),jr=2;jr<arguments.length;jr++)Qe[jr-2]=arguments[jr];return O.prototype[ge].apply(Y,Qe)}}function m(S){const O=S.length;if(0<O){const z=Array(O);for(let Y=0;Y<O;Y++)z[Y]=S[Y];return z}return[]}function g(S,O){for(let z=1;z<arguments.length;z++){const Y=arguments[z];if(l(Y)){const ge=S.length||0,Ce=Y.length||0;S.length=ge+Ce;for(let Qe=0;Qe<Ce;Qe++)S[ge+Qe]=Y[Qe]}else S.push(Y)}}class v{constructor(O,z){this.i=O,this.j=z,this.h=0,this.g=null}get(){let O;return 0<this.h?(this.h--,O=this.g,this.g=O.next,O.next=null):O=this.i(),O}}function y(S){return/^[\s\xa0]*$/.test(S)}function w(){var S=o.navigator;return S&&(S=S.userAgent)?S:""}function b(S){return b[" "](S),S}b[" "]=function(){};var E=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function _(S,O,z){for(const Y in S)O.call(z,S[Y],Y,S)}function C(S,O){for(const z in S)O.call(void 0,S[z],z,S)}function x(S){const O={};for(const z in S)O[z]=S[z];return O}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(S,O){let z,Y;for(let ge=1;ge<arguments.length;ge++){Y=arguments[ge];for(z in Y)S[z]=Y[z];for(let Ce=0;Ce<A.length;Ce++)z=A[Ce],Object.prototype.hasOwnProperty.call(Y,z)&&(S[z]=Y[z])}}function M(S){var O=1;S=S.split(":");const z=[];for(;0<O&&S.length;)z.push(S.shift()),O--;return S.length&&z.push(S.join(":")),z}function D(S){o.setTimeout(()=>{throw S},0)}function P(){var S=W;let O=null;return S.g&&(O=S.g,S.g=S.g.next,S.g||(S.h=null),O.next=null),O}class I{constructor(){this.h=this.g=null}add(O,z){const Y=B.get();Y.set(O,z),this.h?this.h.next=Y:this.g=Y,this.h=Y}}var B=new v(()=>new V,S=>S.reset());class V{constructor(){this.next=this.g=this.h=null}set(O,z){this.h=O,this.g=z,this.next=null}reset(){this.next=this.g=this.h=null}}let N,L=!1,W=new I,G=()=>{const S=o.Promise.resolve(void 0);N=()=>{S.then(X)}};var X=()=>{for(var S;S=P();){try{S.h.call(S.g)}catch(z){D(z)}var O=B;O.j(S),100>O.h&&(O.h++,S.next=O.g,O.g=S)}L=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(S,O){this.type=S,this.g=this.target=O,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var S=!1,O=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const z=()=>{};o.addEventListener("test",z,O),o.removeEventListener("test",z,O)}catch{}return S}();function se(S,O){if(ie.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S){var z=this.type=S.type,Y=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;if(this.target=S.target||S.srcElement,this.g=O,O=S.relatedTarget){if(E){e:{try{b(O.nodeName);var ge=!0;break e}catch{}ge=!1}ge||(O=null)}}else z=="mouseover"?O=S.fromElement:z=="mouseout"&&(O=S.toElement);this.relatedTarget=O,Y?(this.clientX=Y.clientX!==void 0?Y.clientX:Y.pageX,this.clientY=Y.clientY!==void 0?Y.clientY:Y.pageY,this.screenX=Y.screenX||0,this.screenY=Y.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=typeof S.pointerType=="string"?S.pointerType:ee[S.pointerType]||"",this.state=S.state,this.i=S,S.defaultPrevented&&se.aa.h.call(this)}}f(se,ie);var ee={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),oe=0;function le(S,O,z,Y,ge){this.listener=S,this.proxy=null,this.src=O,this.type=z,this.capture=!!Y,this.ha=ge,this.key=++oe,this.da=this.fa=!1}function de(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function xe(S){this.src=S,this.g={},this.h=0}xe.prototype.add=function(S,O,z,Y,ge){var Ce=S.toString();S=this.g[Ce],S||(S=this.g[Ce]=[],this.h++);var Qe=Se(S,O,Y,ge);return-1<Qe?(O=S[Qe],z||(O.fa=!1)):(O=new le(O,this.src,Ce,!!Y,ge),O.fa=z,S.push(O)),O};function _e(S,O){var z=O.type;if(z in S.g){var Y=S.g[z],ge=Array.prototype.indexOf.call(Y,O,void 0),Ce;(Ce=0<=ge)&&Array.prototype.splice.call(Y,ge,1),Ce&&(de(O),S.g[z].length==0&&(delete S.g[z],S.h--))}}function Se(S,O,z,Y){for(var ge=0;ge<S.length;++ge){var Ce=S[ge];if(!Ce.da&&Ce.listener==O&&Ce.capture==!!z&&Ce.ha==Y)return ge}return-1}var Le="closure_lm_"+(1e6*Math.random()|0),Oe={};function Ye(S,O,z,Y,ge){if(Y&&Y.once)return je(S,O,z,Y,ge);if(Array.isArray(O)){for(var Ce=0;Ce<O.length;Ce++)Ye(S,O[Ce],z,Y,ge);return null}return z=U(z),S&&S[ue]?S.K(O,z,c(Y)?!!Y.capture:!!Y,ge):$e(S,O,z,!1,Y,ge)}function $e(S,O,z,Y,ge,Ce){if(!O)throw Error("Invalid event type");var Qe=c(ge)?!!ge.capture:!!ge,jr=ve(S);if(jr||(S[Le]=jr=new xe(S)),z=jr.add(O,z,Y,Qe,Ce),z.proxy)return z;if(Y=He(),z.proxy=Y,Y.src=S,Y.listener=z,S.addEventListener)J||(ge=Qe),ge===void 0&&(ge=!1),S.addEventListener(O.toString(),Y,ge);else if(S.attachEvent)S.attachEvent(q(O.toString()),Y);else if(S.addListener&&S.removeListener)S.addListener(Y);else throw Error("addEventListener and attachEvent are unavailable.");return z}function He(){function S(z){return O.call(S.src,S.listener,z)}const O=j;return S}function je(S,O,z,Y,ge){if(Array.isArray(O)){for(var Ce=0;Ce<O.length;Ce++)je(S,O[Ce],z,Y,ge);return null}return z=U(z),S&&S[ue]?S.L(O,z,c(Y)?!!Y.capture:!!Y,ge):$e(S,O,z,!0,Y,ge)}function lt(S,O,z,Y,ge){if(Array.isArray(O))for(var Ce=0;Ce<O.length;Ce++)lt(S,O[Ce],z,Y,ge);else Y=c(Y)?!!Y.capture:!!Y,z=U(z),S&&S[ue]?(S=S.i,O=String(O).toString(),O in S.g&&(Ce=S.g[O],z=Se(Ce,z,Y,ge),-1<z&&(de(Ce[z]),Array.prototype.splice.call(Ce,z,1),Ce.length==0&&(delete S.g[O],S.h--)))):S&&(S=ve(S))&&(O=S.g[O.toString()],S=-1,O&&(S=Se(O,z,Y,ge)),(z=-1<S?O[S]:null)&&pe(z))}function pe(S){if(typeof S!="number"&&S&&!S.da){var O=S.src;if(O&&O[ue])_e(O.i,S);else{var z=S.type,Y=S.proxy;O.removeEventListener?O.removeEventListener(z,Y,S.capture):O.detachEvent?O.detachEvent(q(z),Y):O.addListener&&O.removeListener&&O.removeListener(Y),(z=ve(O))?(_e(z,S),z.h==0&&(z.src=null,O[Le]=null)):de(S)}}}function q(S){return S in Oe?Oe[S]:Oe[S]="on"+S}function j(S,O){if(S.da)S=!0;else{O=new se(O,this);var z=S.listener,Y=S.ha||S.src;S.fa&&pe(S),S=z.call(Y,O)}return S}function ve(S){return S=S[Le],S instanceof xe?S:null}var ze="__closure_events_fn_"+(1e9*Math.random()>>>0);function U(S){return typeof S=="function"?S:(S[ze]||(S[ze]=function(O){return S.handleEvent(O)}),S[ze])}function Fe(){Q.call(this),this.i=new xe(this),this.M=this,this.F=null}f(Fe,Q),Fe.prototype[ue]=!0,Fe.prototype.removeEventListener=function(S,O,z,Y){lt(this,S,O,z,Y)};function he(S,O){var z,Y=S.F;if(Y)for(z=[];Y;Y=Y.F)z.push(Y);if(S=S.M,Y=O.type||O,typeof O=="string")O=new ie(O,S);else if(O instanceof ie)O.target=O.target||S;else{var ge=O;O=new ie(Y,S),T(O,ge)}if(ge=!0,z)for(var Ce=z.length-1;0<=Ce;Ce--){var Qe=O.g=z[Ce];ge=Ee(Qe,Y,!0,O)&&ge}if(Qe=O.g=S,ge=Ee(Qe,Y,!0,O)&&ge,ge=Ee(Qe,Y,!1,O)&&ge,z)for(Ce=0;Ce<z.length;Ce++)Qe=O.g=z[Ce],ge=Ee(Qe,Y,!1,O)&&ge}Fe.prototype.N=function(){if(Fe.aa.N.call(this),this.i){var S=this.i,O;for(O in S.g){for(var z=S.g[O],Y=0;Y<z.length;Y++)de(z[Y]);delete S.g[O],S.h--}}this.F=null},Fe.prototype.K=function(S,O,z,Y){return this.i.add(String(S),O,!1,z,Y)},Fe.prototype.L=function(S,O,z,Y){return this.i.add(String(S),O,!0,z,Y)};function Ee(S,O,z,Y){if(O=S.i.g[String(O)],!O)return!0;O=O.concat();for(var ge=!0,Ce=0;Ce<O.length;++Ce){var Qe=O[Ce];if(Qe&&!Qe.da&&Qe.capture==z){var jr=Qe.listener,Rn=Qe.ha||Qe.src;Qe.fa&&_e(S.i,Qe),ge=jr.call(Rn,Y)!==!1&&ge}}return ge&&!Y.defaultPrevented}function me(S,O,z){if(typeof S=="function")z&&(S=d(S,z));else if(S&&typeof S.handleEvent=="function")S=d(S.handleEvent,S);else throw Error("Invalid listener argument");return 2147483647<Number(O)?-1:o.setTimeout(S,O||0)}function Je(S){S.g=me(()=>{S.g=null,S.i&&(S.i=!1,Je(S))},S.l);const O=S.h;S.h=null,S.m.apply(null,O)}class et extends Q{constructor(O,z){super(),this.m=O,this.l=z,this.h=null,this.i=!1,this.g=null}j(O){this.h=arguments,this.g?this.i=!0:Je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function at(S){Q.call(this),this.h=S,this.g={}}f(at,Q);var gt=[];function ft(S){_(S.g,function(O,z){this.g.hasOwnProperty(z)&&pe(O)},S),S.g={}}at.prototype.N=function(){at.aa.N.call(this),ft(this)},at.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mt=o.JSON.stringify,Er=o.JSON.parse,Xr=class{stringify(S){return o.JSON.stringify(S,void 0)}parse(S){return o.JSON.parse(S,void 0)}};function ae(){}ae.prototype.h=null;function Pe(S){return S.h||(S.h=S.i())}function Ne(){}var Ke={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yt(){ie.call(this,"d")}f(yt,ie);function Kt(){ie.call(this,"c")}f(Kt,ie);var Ar={},Ci=null;function ws(){return Ci=Ci||new Fe}Ar.La="serverreachability";function Mr(S){ie.call(this,Ar.La,S)}f(Mr,ie);function In(S){const O=ws();he(O,new Mr(O))}Ar.STAT_EVENT="statevent";function On(S,O){ie.call(this,Ar.STAT_EVENT,S),this.stat=O}f(On,ie);function vi(S){const O=ws();he(O,new On(O,S))}Ar.Ma="timingevent";function tf(S,O){ie.call(this,Ar.Ma,S),this.size=O}f(tf,ie);function nc(S,O){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){S()},O)}function co(){this.g=!0}co.prototype.xa=function(){this.g=!1};function K(S,O,z,Y,ge,Ce){S.info(function(){if(S.g)if(Ce)for(var Qe="",jr=Ce.split("&"),Rn=0;Rn<jr.length;Rn++){var mr=jr[Rn].split("=");if(1<mr.length){var Zn=mr[0];mr=mr[1];var Jn=Zn.split("_");Qe=2<=Jn.length&&Jn[1]=="type"?Qe+(Zn+"="+mr+"&"):Qe+(Zn+"=redacted&")}}else Qe=null;else Qe=Ce;return"XMLHTTP REQ ("+Y+") [attempt "+ge+"]: "+O+`
`+z+`
`+Qe})}function be(S,O,z,Y,ge,Ce,Qe){S.info(function(){return"XMLHTTP RESP ("+Y+") [ attempt "+ge+"]: "+O+`
`+z+`
`+Ce+" "+Qe})}function Me(S,O,z,Y){S.info(function(){return"XMLHTTP TEXT ("+O+"): "+Ie(S,z)+(Y?" "+Y:"")})}function we(S,O){S.info(function(){return"TIMEOUT: "+O})}co.prototype.info=function(){};function Ie(S,O){if(!S.g)return O;if(!O)return null;try{var z=JSON.parse(O);if(z){for(S=0;S<z.length;S++)if(Array.isArray(z[S])){var Y=z[S];if(!(2>Y.length)){var ge=Y[1];if(Array.isArray(ge)&&!(1>ge.length)){var Ce=ge[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var Qe=1;Qe<ge.length;Qe++)ge[Qe]=""}}}}return mt(z)}catch{return O}}var ut={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ot={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lt;function vt(){}f(vt,ae),vt.prototype.g=function(){return new XMLHttpRequest},vt.prototype.i=function(){return{}},Lt=new vt;function er(S,O,z,Y){this.j=S,this.i=O,this.l=z,this.R=Y||1,this.U=new at(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $t}function $t(){this.i=null,this.g="",this.h=!1}var Zt={},Nt={};function Bi(S,O,z){S.L=1,S.v=vx(sc(O)),S.m=z,S.P=!0,xs(S,null)}function xs(S,O){S.F=Date.now(),Yt(S),S.A=sc(S.v);var z=S.A,Y=S.R;Array.isArray(Y)||(Y=[String(Y)]),wN(z.i,"t",Y),S.C=0,z=S.j.J,S.h=new $t,S.g=zN(S.j,z?O:null,!S.m),0<S.O&&(S.M=new et(d(S.Y,S,S.g),S.O)),O=S.U,z=S.g,Y=S.ca;var ge="readystatechange";Array.isArray(ge)||(ge&&(gt[0]=ge.toString()),ge=gt);for(var Ce=0;Ce<ge.length;Ce++){var Qe=Ye(z,ge[Ce],Y||O.handleEvent,!1,O.h||O);if(!Qe)break;O.g[Qe.key]=Qe}O=S.H?x(S.H):{},S.m?(S.u||(S.u="POST"),O["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.A,S.u,S.m,O)):(S.u="GET",S.g.ea(S.A,S.u,null,O)),In(),K(S.i,S.u,S.A,S.l,S.R,S.m)}er.prototype.ca=function(S){S=S.target;const O=this.M;O&&ac(S)==3?O.j():this.Y(S)},er.prototype.Y=function(S){try{if(S==this.g)e:{const Jn=ac(this.g);var O=this.g.Ba();const of=this.g.Z();if(!(3>Jn)&&(Jn!=3||this.g&&(this.h.h||this.g.oa()||CN(this.g)))){this.J||Jn!=4||O==7||(O==8||0>=of?In(3):In(2)),Vt(this);var z=this.g.Z();this.X=z;t:if(Oa(this)){var Y=CN(this.g);S="";var ge=Y.length,Ce=ac(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_s(this),bs(this);var Qe="";break t}this.h.i=new o.TextDecoder}for(O=0;O<ge;O++)this.h.h=!0,S+=this.h.i.decode(Y[O],{stream:!(Ce&&O==ge-1)});Y.length=0,this.h.g+=S,this.C=0,Qe=this.h.g}else Qe=this.g.oa();if(this.o=z==200,be(this.i,this.u,this.A,this.l,this.R,Jn,z),this.o){if(this.T&&!this.K){t:{if(this.g){var jr,Rn=this.g;if((jr=Rn.g?Rn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(jr)){var mr=jr;break t}}mr=null}if(z=mr)Me(this.i,this.l,z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ra(this,z);else{this.o=!1,this.s=3,vi(12),_s(this),bs(this);break e}}if(this.P){z=!0;let uo;for(;!this.J&&this.C<Qe.length;)if(uo=$r(this,Qe),uo==Nt){Jn==4&&(this.s=4,vi(14),z=!1),Me(this.i,this.l,null,"[Incomplete Response]");break}else if(uo==Zt){this.s=4,vi(15),Me(this.i,this.l,Qe,"[Invalid Chunk]"),z=!1;break}else Me(this.i,this.l,uo,null),Ra(this,uo);if(Oa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jn!=4||Qe.length!=0||this.h.h||(this.s=1,vi(16),z=!1),this.o=this.o&&z,!z)Me(this.i,this.l,Qe,"[Invalid Chunked Response]"),_s(this),bs(this);else if(0<Qe.length&&!this.W){this.W=!0;var Zn=this.j;Zn.g==this&&Zn.ba&&!Zn.M&&(Zn.j.info("Great, no buffering proxy detected. Bytes received: "+Qe.length),kC(Zn),Zn.M=!0,vi(11))}}else Me(this.i,this.l,Qe,null),Ra(this,Qe);Jn==4&&_s(this),this.o&&!this.J&&(Jn==4?RN(this.j,this):(this.o=!1,Yt(this)))}else $J(this.g),z==400&&0<Qe.indexOf("Unknown SID")?(this.s=3,vi(12)):(this.s=0,vi(13)),_s(this),bs(this)}}}catch{}finally{}};function Oa(S){return S.g?S.u=="GET"&&S.L!=2&&S.j.Ca:!1}function $r(S,O){var z=S.C,Y=O.indexOf(`
`,z);return Y==-1?Nt:(z=Number(O.substring(z,Y)),isNaN(z)?Zt:(Y+=1,Y+z>O.length?Nt:(O=O.slice(Y,Y+z),S.C=Y+z,O)))}er.prototype.cancel=function(){this.J=!0,_s(this)};function Yt(S){S.S=Date.now()+S.I,qs(S,S.I)}function qs(S,O){if(S.B!=null)throw Error("WatchDog timer not null");S.B=nc(d(S.ba,S),O)}function Vt(S){S.B&&(o.clearTimeout(S.B),S.B=null)}er.prototype.ba=function(){this.B=null;const S=Date.now();0<=S-this.S?(we(this.i,this.A),this.L!=2&&(In(),vi(17)),_s(this),this.s=2,bs(this)):qs(this,this.S-S)};function bs(S){S.j.G==0||S.J||RN(S.j,S)}function _s(S){Vt(S);var O=S.M;O&&typeof O.ma=="function"&&O.ma(),S.M=null,ft(S.U),S.g&&(O=S.g,S.g=null,O.abort(),O.ma())}function Ra(S,O){try{var z=S.j;if(z.G!=0&&(z.g==S||$(z.h,S))){if(!S.K&&$(z.h,S)&&z.G==3){try{var Y=z.Da.g.parse(O)}catch{Y=null}if(Array.isArray(Y)&&Y.length==3){var ge=Y;if(ge[0]==0){e:if(!z.u){if(z.g)if(z.g.F+3e3<S.F)_x(z),xx(z);else break e;RC(z),vi(18)}}else z.za=ge[1],0<z.za-z.T&&37500>ge[2]&&z.F&&z.v==0&&!z.C&&(z.C=nc(d(z.Za,z),6e3));if(1>=ne(z.h)&&z.ca){try{z.ca()}catch{}z.ca=void 0}}else ud(z,11)}else if((S.K||z.g==S)&&_x(z),!y(O))for(ge=z.Da.g.parse(O),O=0;O<ge.length;O++){let mr=ge[O];if(z.T=mr[0],mr=mr[1],z.G==2)if(mr[0]=="c"){z.K=mr[1],z.ia=mr[2];const Zn=mr[3];Zn!=null&&(z.la=Zn,z.j.info("VER="+z.la));const Jn=mr[4];Jn!=null&&(z.Aa=Jn,z.j.info("SVER="+z.Aa));const of=mr[5];of!=null&&typeof of=="number"&&0<of&&(Y=1.5*of,z.L=Y,z.j.info("backChannelRequestTimeoutMs_="+Y)),Y=z;const uo=S.g;if(uo){const Ex=uo.g?uo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ex){var Ce=Y.h;Ce.g||Ex.indexOf("spdy")==-1&&Ex.indexOf("quic")==-1&&Ex.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(ce(Ce,Ce.h),Ce.h=null))}if(Y.D){const LC=uo.g?uo.g.getResponseHeader("X-HTTP-Session-Id"):null;LC&&(Y.ya=LC,Qr(Y.I,Y.D,LC))}}z.G=3,z.l&&z.l.ua(),z.ba&&(z.R=Date.now()-S.F,z.j.info("Handshake RTT: "+z.R+"ms")),Y=z;var Qe=S;if(Y.qa=NN(Y,Y.J?Y.ia:null,Y.W),Qe.K){Ve(Y.h,Qe);var jr=Qe,Rn=Y.L;Rn&&(jr.I=Rn),jr.B&&(Vt(jr),Yt(jr)),Y.g=Qe}else IN(Y);0<z.i.length&&bx(z)}else mr[0]!="stop"&&mr[0]!="close"||ud(z,7);else z.G==3&&(mr[0]=="stop"||mr[0]=="close"?mr[0]=="stop"?ud(z,7):OC(z):mr[0]!="noop"&&z.l&&z.l.ta(mr),z.v=0)}}In(4)}catch{}}var ka=class{constructor(S,O){this.g=S,this.map=O}};function F(S){this.l=S||10,o.PerformanceNavigationTiming?(S=o.performance.getEntriesByType("navigation"),S=0<S.length&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function H(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function ne(S){return S.h?1:S.g?S.g.size:0}function $(S,O){return S.h?S.h==O:S.g?S.g.has(O):!1}function ce(S,O){S.g?S.g.add(O):S.h=O}function Ve(S,O){S.h&&S.h==O?S.h=null:S.g&&S.g.has(O)&&S.g.delete(O)}F.prototype.cancel=function(){if(this.i=La(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function La(S){if(S.h!=null)return S.i.concat(S.h.D);if(S.g!=null&&S.g.size!==0){let O=S.i;for(const z of S.g.values())O=O.concat(z.D);return O}return m(S.i)}function yv(S){if(S.V&&typeof S.V=="function")return S.V();if(typeof Map<"u"&&S instanceof Map||typeof Set<"u"&&S instanceof Set)return Array.from(S.values());if(typeof S=="string")return S.split("");if(l(S)){for(var O=[],z=S.length,Y=0;Y<z;Y++)O.push(S[Y]);return O}O=[],z=0;for(Y in S)O[z++]=S[Y];return O}function rf(S){if(S.na&&typeof S.na=="function")return S.na();if(!S.V||typeof S.V!="function"){if(typeof Map<"u"&&S instanceof Map)return Array.from(S.keys());if(!(typeof Set<"u"&&S instanceof Set)){if(l(S)||typeof S=="string"){var O=[];S=S.length;for(var z=0;z<S;z++)O.push(z);return O}O=[],z=0;for(const Y in S)O[z++]=Y;return O}}}function nf(S,O){if(S.forEach&&typeof S.forEach=="function")S.forEach(O,void 0);else if(l(S)||typeof S=="string")Array.prototype.forEach.call(S,O,void 0);else for(var z=rf(S),Y=yv(S),ge=Y.length,Ce=0;Ce<ge;Ce++)O.call(void 0,Y[Ce],z&&z[Ce],S)}var ld=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wv(S,O){if(S){S=S.split("&");for(var z=0;z<S.length;z++){var Y=S[z].indexOf("="),ge=null;if(0<=Y){var Ce=S[z].substring(0,Y);ge=S[z].substring(Y+1)}else Ce=S[z];O(Ce,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function cd(S){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,S instanceof cd){this.h=S.h,mx(this,S.j),this.o=S.o,this.g=S.g,gx(this,S.s),this.l=S.l;var O=S.i,z=new _v;z.i=O.i,O.g&&(z.g=new Map(O.g),z.h=O.h),mN(this,z),this.m=S.m}else S&&(O=String(S).match(ld))?(this.h=!1,mx(this,O[1]||"",!0),this.o=xv(O[2]||""),this.g=xv(O[3]||"",!0),gx(this,O[4]),this.l=xv(O[5]||"",!0),mN(this,O[6]||"",!0),this.m=xv(O[7]||"")):(this.h=!1,this.i=new _v(null,this.h))}cd.prototype.toString=function(){var S=[],O=this.j;O&&S.push(bv(O,gN,!0),":");var z=this.g;return(z||O=="file")&&(S.push("//"),(O=this.o)&&S.push(bv(O,gN,!0),"@"),S.push(encodeURIComponent(String(z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),z=this.s,z!=null&&S.push(":",String(z))),(z=this.l)&&(this.g&&z.charAt(0)!="/"&&S.push("/"),S.push(bv(z,z.charAt(0)=="/"?FJ:BJ,!0))),(z=this.i.toString())&&S.push("?",z),(z=this.m)&&S.push("#",bv(z,jJ)),S.join("")};function sc(S){return new cd(S)}function mx(S,O,z){S.j=z?xv(O,!0):O,S.j&&(S.j=S.j.replace(/:$/,""))}function gx(S,O){if(O){if(O=Number(O),isNaN(O)||0>O)throw Error("Bad port number "+O);S.s=O}else S.s=null}function mN(S,O,z){O instanceof _v?(S.i=O,VJ(S.i,S.h)):(z||(O=bv(O,UJ)),S.i=new _v(O,S.h))}function Qr(S,O,z){S.i.set(O,z)}function vx(S){return Qr(S,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),S}function xv(S,O){return S?O?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function bv(S,O,z){return typeof S=="string"?(S=encodeURI(S).replace(O,zJ),z&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function zJ(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var gN=/[#\/\?@]/g,BJ=/[#\?:]/g,FJ=/[#\?]/g,UJ=/[#\?@]/g,jJ=/#/g;function _v(S,O){this.h=this.g=null,this.i=S||null,this.j=!!O}function bu(S){S.g||(S.g=new Map,S.h=0,S.i&&wv(S.i,function(O,z){S.add(decodeURIComponent(O.replace(/\+/g," ")),z)}))}e=_v.prototype,e.add=function(S,O){bu(this),this.i=null,S=sf(this,S);var z=this.g.get(S);return z||this.g.set(S,z=[]),z.push(O),this.h+=1,this};function vN(S,O){bu(S),O=sf(S,O),S.g.has(O)&&(S.i=null,S.h-=S.g.get(O).length,S.g.delete(O))}function yN(S,O){return bu(S),O=sf(S,O),S.g.has(O)}e.forEach=function(S,O){bu(this),this.g.forEach(function(z,Y){z.forEach(function(ge){S.call(O,ge,Y,this)},this)},this)},e.na=function(){bu(this);const S=Array.from(this.g.values()),O=Array.from(this.g.keys()),z=[];for(let Y=0;Y<O.length;Y++){const ge=S[Y];for(let Ce=0;Ce<ge.length;Ce++)z.push(O[Y])}return z},e.V=function(S){bu(this);let O=[];if(typeof S=="string")yN(this,S)&&(O=O.concat(this.g.get(sf(this,S))));else{S=Array.from(this.g.values());for(let z=0;z<S.length;z++)O=O.concat(S[z])}return O},e.set=function(S,O){return bu(this),this.i=null,S=sf(this,S),yN(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[O]),this.h+=1,this},e.get=function(S,O){return S?(S=this.V(S),0<S.length?String(S[0]):O):O};function wN(S,O,z){vN(S,O),0<z.length&&(S.i=null,S.g.set(sf(S,O),m(z)),S.h+=z.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],O=Array.from(this.g.keys());for(var z=0;z<O.length;z++){var Y=O[z];const Ce=encodeURIComponent(String(Y)),Qe=this.V(Y);for(Y=0;Y<Qe.length;Y++){var ge=Ce;Qe[Y]!==""&&(ge+="="+encodeURIComponent(String(Qe[Y]))),S.push(ge)}}return this.i=S.join("&")};function sf(S,O){return O=String(O),S.j&&(O=O.toLowerCase()),O}function VJ(S,O){O&&!S.j&&(bu(S),S.i=null,S.g.forEach(function(z,Y){var ge=Y.toLowerCase();Y!=ge&&(vN(this,Y),wN(this,ge,z))},S)),S.j=O}function HJ(S,O){const z=new co;if(o.Image){const Y=new Image;Y.onload=p(_u,z,"TestLoadImage: loaded",!0,O,Y),Y.onerror=p(_u,z,"TestLoadImage: error",!1,O,Y),Y.onabort=p(_u,z,"TestLoadImage: abort",!1,O,Y),Y.ontimeout=p(_u,z,"TestLoadImage: timeout",!1,O,Y),o.setTimeout(function(){Y.ontimeout&&Y.ontimeout()},1e4),Y.src=S}else O(!1)}function WJ(S,O){const z=new co,Y=new AbortController,ge=setTimeout(()=>{Y.abort(),_u(z,"TestPingServer: timeout",!1,O)},1e4);fetch(S,{signal:Y.signal}).then(Ce=>{clearTimeout(ge),Ce.ok?_u(z,"TestPingServer: ok",!0,O):_u(z,"TestPingServer: server error",!1,O)}).catch(()=>{clearTimeout(ge),_u(z,"TestPingServer: error",!1,O)})}function _u(S,O,z,Y,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),Y(z)}catch{}}function GJ(){this.g=new Xr}function qJ(S,O,z){const Y=z||"";try{nf(S,function(ge,Ce){let Qe=ge;c(ge)&&(Qe=mt(ge)),O.push(Y+Ce+"="+encodeURIComponent(Qe))})}catch(ge){throw O.push(Y+"type="+encodeURIComponent("_badmap")),ge}}function Sv(S){this.l=S.Ub||null,this.j=S.eb||!1}f(Sv,ae),Sv.prototype.g=function(){return new yx(this.l,this.j)},Sv.prototype.i=function(S){return function(){return S}}({});function yx(S,O){Fe.call(this),this.D=S,this.o=O,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}f(yx,Fe),e=yx.prototype,e.open=function(S,O){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=S,this.A=O,this.readyState=1,Tv(this)},e.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const O={headers:this.u,method:this.B,credentials:this.m,cache:void 0};S&&(O.body=S),(this.D||o).fetch(new Request(this.A,O)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ev(this)),this.readyState=0},e.Sa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,Tv(this)),this.g&&(this.readyState=3,Tv(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xN(this)}else S.text().then(this.Ra.bind(this),this.ga.bind(this))};function xN(S){S.j.read().then(S.Pa.bind(S)).catch(S.ga.bind(S))}e.Pa=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var O=S.value?S.value:new Uint8Array(0);(O=this.v.decode(O,{stream:!S.done}))&&(this.response=this.responseText+=O)}S.done?Ev(this):Tv(this),this.readyState==3&&xN(this)}},e.Ra=function(S){this.g&&(this.response=this.responseText=S,Ev(this))},e.Qa=function(S){this.g&&(this.response=S,Ev(this))},e.ga=function(){this.g&&Ev(this)};function Ev(S){S.readyState=4,S.l=null,S.j=null,S.v=null,Tv(S)}e.setRequestHeader=function(S,O){this.u.append(S,O)},e.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],O=this.h.entries();for(var z=O.next();!z.done;)z=z.value,S.push(z[0]+": "+z[1]),z=O.next();return S.join(`\r
`)};function Tv(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(yx.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function bN(S){let O="";return _(S,function(z,Y){O+=Y,O+=":",O+=z,O+=`\r
`}),O}function IC(S,O,z){e:{for(Y in z){var Y=!1;break e}Y=!0}Y||(z=bN(z),typeof S=="string"?z!=null&&encodeURIComponent(String(z)):Qr(S,O,z))}function yi(S){Fe.call(this),this.headers=new Map,this.o=S||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}f(yi,Fe);var YJ=/^https?$/i,XJ=["POST","PUT"];e=yi.prototype,e.Ha=function(S){this.J=S},e.ea=function(S,O,z,Y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);O=O?O.toUpperCase():"GET",this.D=S,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lt.g(),this.v=this.o?Pe(this.o):Pe(Lt),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(O,String(S),!0),this.B=!1}catch(Ce){_N(this,Ce);return}if(S=z||"",z=new Map(this.headers),Y)if(Object.getPrototypeOf(Y)===Object.prototype)for(var ge in Y)z.set(ge,Y[ge]);else if(typeof Y.keys=="function"&&typeof Y.get=="function")for(const Ce of Y.keys())z.set(Ce,Y.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(Y));Y=Array.from(z.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),ge=o.FormData&&S instanceof o.FormData,!(0<=Array.prototype.indexOf.call(XJ,O,void 0))||Y||ge||z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,Qe]of z)this.g.setRequestHeader(Ce,Qe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{TN(this),this.u=!0,this.g.send(S),this.u=!1}catch(Ce){_N(this,Ce)}};function _N(S,O){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=O,S.m=5,SN(S),wx(S)}function SN(S){S.A||(S.A=!0,he(S,"complete"),he(S,"error"))}e.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=S||7,he(this,"complete"),he(this,"abort"),wx(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wx(this,!0)),yi.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?EN(this):this.bb())},e.bb=function(){EN(this)};function EN(S){if(S.h&&typeof a<"u"&&(!S.v[1]||ac(S)!=4||S.Z()!=2)){if(S.u&&ac(S)==4)me(S.Ea,0,S);else if(he(S,"readystatechange"),ac(S)==4){S.h=!1;try{const Qe=S.Z();e:switch(Qe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var O=!0;break e;default:O=!1}var z;if(!(z=O)){var Y;if(Y=Qe===0){var ge=String(S.D).match(ld)[1]||null;!ge&&o.self&&o.self.location&&(ge=o.self.location.protocol.slice(0,-1)),Y=!YJ.test(ge?ge.toLowerCase():"")}z=Y}if(z)he(S,"complete"),he(S,"success");else{S.m=6;try{var Ce=2<ac(S)?S.g.statusText:""}catch{Ce=""}S.l=Ce+" ["+S.Z()+"]",SN(S)}}finally{wx(S)}}}}function wx(S,O){if(S.g){TN(S);const z=S.g,Y=S.v[0]?()=>{}:null;S.g=null,S.v=null,O||he(S,"ready");try{z.onreadystatechange=Y}catch{}}}function TN(S){S.I&&(o.clearTimeout(S.I),S.I=null)}e.isActive=function(){return!!this.g};function ac(S){return S.g?S.g.readyState:0}e.Z=function(){try{return 2<ac(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(S){if(this.g){var O=this.g.responseText;return S&&O.indexOf(S)==0&&(O=O.substring(S.length)),Er(O)}};function CN(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.H){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function $J(S){const O={};S=(S.g&&2<=ac(S)&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let Y=0;Y<S.length;Y++){if(y(S[Y]))continue;var z=M(S[Y]);const ge=z[0];if(z=z[1],typeof z!="string")continue;z=z.trim();const Ce=O[ge]||[];O[ge]=Ce,Ce.push(z)}C(O,function(Y){return Y.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Cv(S,O,z){return z&&z.internalChannelParams&&z.internalChannelParams[S]||O}function AN(S){this.Aa=0,this.i=[],this.j=new co,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Cv("failFast",!1,S),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Cv("baseRetryDelayMs",5e3,S),this.cb=Cv("retryDelaySeedMs",1e4,S),this.Wa=Cv("forwardChannelMaxRetries",2,S),this.wa=Cv("forwardChannelRequestTimeoutMs",2e4,S),this.pa=S&&S.xmlHttpFactory||void 0,this.Xa=S&&S.Tb||void 0,this.Ca=S&&S.useFetchStreams||!1,this.L=void 0,this.J=S&&S.supportsCrossDomainXhr||!1,this.K="",this.h=new F(S&&S.concurrentRequestLimit),this.Da=new GJ,this.P=S&&S.fastHandshake||!1,this.O=S&&S.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=S&&S.Rb||!1,S&&S.xa&&this.j.xa(),S&&S.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&S&&S.detectBufferingProxy||!1,this.ja=void 0,S&&S.longPollingTimeout&&0<S.longPollingTimeout&&(this.ja=S.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=AN.prototype,e.la=8,e.G=1,e.connect=function(S,O,z,Y){vi(0),this.W=S,this.H=O||{},z&&Y!==void 0&&(this.H.OSID=z,this.H.OAID=Y),this.F=this.X,this.I=NN(this,null,this.W),bx(this)};function OC(S){if(MN(S),S.G==3){var O=S.U++,z=sc(S.I);if(Qr(z,"SID",S.K),Qr(z,"RID",O),Qr(z,"TYPE","terminate"),Av(S,z),O=new er(S,S.j,O),O.L=2,O.v=vx(sc(z)),z=!1,o.navigator&&o.navigator.sendBeacon)try{z=o.navigator.sendBeacon(O.v.toString(),"")}catch{}!z&&o.Image&&(new Image().src=O.v,z=!0),z||(O.g=zN(O.j,null),O.g.ea(O.v)),O.F=Date.now(),Yt(O)}LN(S)}function xx(S){S.g&&(kC(S),S.g.cancel(),S.g=null)}function MN(S){xx(S),S.u&&(o.clearTimeout(S.u),S.u=null),_x(S),S.h.cancel(),S.s&&(typeof S.s=="number"&&o.clearTimeout(S.s),S.s=null)}function bx(S){if(!H(S.h)&&!S.s){S.s=!0;var O=S.Ga;N||G(),L||(N(),L=!0),W.add(O,S),S.B=0}}function QJ(S,O){return ne(S.h)>=S.h.j-(S.s?1:0)?!1:S.s?(S.i=O.D.concat(S.i),!0):S.G==1||S.G==2||S.B>=(S.Va?0:S.Wa)?!1:(S.s=nc(d(S.Ga,S,O),kN(S,S.B)),S.B++,!0)}e.Ga=function(S){if(this.s)if(this.s=null,this.G==1){if(!S){this.U=Math.floor(1e5*Math.random()),S=this.U++;const ge=new er(this,this.j,S);let Ce=this.o;if(this.S&&(Ce?(Ce=x(Ce),T(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(ge.H=Ce,Ce=null),this.P)e:{for(var O=0,z=0;z<this.i.length;z++){t:{var Y=this.i[z];if("__data__"in Y.map&&(Y=Y.map.__data__,typeof Y=="string")){Y=Y.length;break t}Y=void 0}if(Y===void 0)break;if(O+=Y,4096<O){O=z;break e}if(O===4096||z===this.i.length-1){O=z+1;break e}}O=1e3}else O=1e3;O=DN(this,ge,O),z=sc(this.I),Qr(z,"RID",S),Qr(z,"CVER",22),this.D&&Qr(z,"X-HTTP-Session-Id",this.D),Av(this,z),Ce&&(this.O?O="headers="+encodeURIComponent(String(bN(Ce)))+"&"+O:this.m&&IC(z,this.m,Ce)),ce(this.h,ge),this.Ua&&Qr(z,"TYPE","init"),this.P?(Qr(z,"$req",O),Qr(z,"SID","null"),ge.T=!0,Bi(ge,z,null)):Bi(ge,z,O),this.G=2}}else this.G==3&&(S?PN(this,S):this.i.length==0||H(this.h)||PN(this))};function PN(S,O){var z;O?z=O.l:z=S.U++;const Y=sc(S.I);Qr(Y,"SID",S.K),Qr(Y,"RID",z),Qr(Y,"AID",S.T),Av(S,Y),S.m&&S.o&&IC(Y,S.m,S.o),z=new er(S,S.j,z,S.B+1),S.m===null&&(z.H=S.o),O&&(S.i=O.D.concat(S.i)),O=DN(S,z,1e3),z.I=Math.round(.5*S.wa)+Math.round(.5*S.wa*Math.random()),ce(S.h,z),Bi(z,Y,O)}function Av(S,O){S.H&&_(S.H,function(z,Y){Qr(O,Y,z)}),S.l&&nf({},function(z,Y){Qr(O,Y,z)})}function DN(S,O,z){z=Math.min(S.i.length,z);var Y=S.l?d(S.l.Na,S.l,S):null;e:{var ge=S.i;let Ce=-1;for(;;){const Qe=["count="+z];Ce==-1?0<z?(Ce=ge[0].g,Qe.push("ofs="+Ce)):Ce=0:Qe.push("ofs="+Ce);let jr=!0;for(let Rn=0;Rn<z;Rn++){let mr=ge[Rn].g;const Zn=ge[Rn].map;if(mr-=Ce,0>mr)Ce=Math.max(0,ge[Rn].g-100),jr=!1;else try{qJ(Zn,Qe,"req"+mr+"_")}catch{Y&&Y(Zn)}}if(jr){Y=Qe.join("&");break e}}}return S=S.i.splice(0,z),O.D=S,Y}function IN(S){if(!S.g&&!S.u){S.Y=1;var O=S.Fa;N||G(),L||(N(),L=!0),W.add(O,S),S.v=0}}function RC(S){return S.g||S.u||3<=S.v?!1:(S.Y++,S.u=nc(d(S.Fa,S),kN(S,S.v)),S.v++,!0)}e.Fa=function(){if(this.u=null,ON(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var S=2*this.R;this.j.info("BP detection timer enabled: "+S),this.A=nc(d(this.ab,this),S)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,vi(10),xx(this),ON(this))};function kC(S){S.A!=null&&(o.clearTimeout(S.A),S.A=null)}function ON(S){S.g=new er(S,S.j,"rpc",S.Y),S.m===null&&(S.g.H=S.o),S.g.O=0;var O=sc(S.qa);Qr(O,"RID","rpc"),Qr(O,"SID",S.K),Qr(O,"AID",S.T),Qr(O,"CI",S.F?"0":"1"),!S.F&&S.ja&&Qr(O,"TO",S.ja),Qr(O,"TYPE","xmlhttp"),Av(S,O),S.m&&S.o&&IC(O,S.m,S.o),S.L&&(S.g.I=S.L);var z=S.g;S=S.ia,z.L=1,z.v=vx(sc(O)),z.m=null,z.P=!0,xs(z,S)}e.Za=function(){this.C!=null&&(this.C=null,xx(this),RC(this),vi(19))};function _x(S){S.C!=null&&(o.clearTimeout(S.C),S.C=null)}function RN(S,O){var z=null;if(S.g==O){_x(S),kC(S),S.g=null;var Y=2}else if($(S.h,O))z=O.D,Ve(S.h,O),Y=1;else return;if(S.G!=0){if(O.o)if(Y==1){z=O.m?O.m.length:0,O=Date.now()-O.F;var ge=S.B;Y=ws(),he(Y,new tf(Y,z)),bx(S)}else IN(S);else if(ge=O.s,ge==3||ge==0&&0<O.X||!(Y==1&&QJ(S,O)||Y==2&&RC(S)))switch(z&&0<z.length&&(O=S.h,O.i=O.i.concat(z)),ge){case 1:ud(S,5);break;case 4:ud(S,10);break;case 3:ud(S,6);break;default:ud(S,2)}}}function kN(S,O){let z=S.Ta+Math.floor(Math.random()*S.cb);return S.isActive()||(z*=2),z*O}function ud(S,O){if(S.j.info("Error code "+O),O==2){var z=d(S.fb,S),Y=S.Xa;const ge=!Y;Y=new cd(Y||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||mx(Y,"https"),vx(Y),ge?HJ(Y.toString(),z):WJ(Y.toString(),z)}else vi(2);S.G=0,S.l&&S.l.sa(O),LN(S),MN(S)}e.fb=function(S){S?(this.j.info("Successfully pinged google.com"),vi(2)):(this.j.info("Failed to ping google.com"),vi(1))};function LN(S){if(S.G=0,S.ka=[],S.l){const O=La(S.h);(O.length!=0||S.i.length!=0)&&(g(S.ka,O),g(S.ka,S.i),S.h.i.length=0,m(S.i),S.i.length=0),S.l.ra()}}function NN(S,O,z){var Y=z instanceof cd?sc(z):new cd(z);if(Y.g!="")O&&(Y.g=O+"."+Y.g),gx(Y,Y.s);else{var ge=o.location;Y=ge.protocol,O=O?O+"."+ge.hostname:ge.hostname,ge=+ge.port;var Ce=new cd(null);Y&&mx(Ce,Y),O&&(Ce.g=O),ge&&gx(Ce,ge),z&&(Ce.l=z),Y=Ce}return z=S.D,O=S.ya,z&&O&&Qr(Y,z,O),Qr(Y,"VER",S.la),Av(S,Y),Y}function zN(S,O,z){if(O&&!S.J)throw Error("Can't create secondary domain capable XhrIo object.");return O=S.Ca&&!S.pa?new yi(new Sv({eb:z})):new yi(S.pa),O.Ha(S.J),O}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function BN(){}e=BN.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Sx(){}Sx.prototype.g=function(S,O){return new ha(S,O)};function ha(S,O){Fe.call(this),this.g=new AN(O),this.l=S,this.h=O&&O.messageUrlParams||null,S=O&&O.messageHeaders||null,O&&O.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=O&&O.initMessageHeaders||null,O&&O.messageContentType&&(S?S["X-WebChannel-Content-Type"]=O.messageContentType:S={"X-WebChannel-Content-Type":O.messageContentType}),O&&O.va&&(S?S["X-WebChannel-Client-Profile"]=O.va:S={"X-WebChannel-Client-Profile":O.va}),this.g.S=S,(S=O&&O.Sb)&&!y(S)&&(this.g.m=S),this.v=O&&O.supportsCrossDomainXhr||!1,this.u=O&&O.sendRawJson||!1,(O=O&&O.httpSessionIdParam)&&!y(O)&&(this.g.D=O,S=this.h,S!==null&&O in S&&(S=this.h,O in S&&delete S[O])),this.j=new af(this)}f(ha,Fe),ha.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ha.prototype.close=function(){OC(this.g)},ha.prototype.o=function(S){var O=this.g;if(typeof S=="string"){var z={};z.__data__=S,S=z}else this.u&&(z={},z.__data__=mt(S),S=z);O.i.push(new ka(O.Ya++,S)),O.G==3&&bx(O)},ha.prototype.N=function(){this.g.l=null,delete this.j,OC(this.g),delete this.g,ha.aa.N.call(this)};function FN(S){yt.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var O=S.__sm__;if(O){e:{for(const z in O){S=z;break e}S=void 0}(this.i=S)&&(S=this.i,O=O!==null&&S in O?O[S]:void 0),this.data=O}else this.data=S}f(FN,yt);function UN(){Kt.call(this),this.status=1}f(UN,Kt);function af(S){this.g=S}f(af,BN),af.prototype.ua=function(){he(this.g,"a")},af.prototype.ta=function(S){he(this.g,new FN(S))},af.prototype.sa=function(S){he(this.g,new UN)},af.prototype.ra=function(){he(this.g,"b")},Sx.prototype.createWebChannel=Sx.prototype.g,ha.prototype.send=ha.prototype.o,ha.prototype.open=ha.prototype.m,ha.prototype.close=ha.prototype.close,T$=function(){return new Sx},E$=function(){return ws()},S$=Ar,oO={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,o_=ut,Ot.COMPLETE="complete",_$=Ot,Ne.EventType=Ke,Ke.OPEN="a",Ke.CLOSE="b",Ke.ERROR="c",Ke.MESSAGE="d",Fe.prototype.listen=Fe.prototype.K,Ry=Ne,b$=Sv,yi.prototype.listenOnce=yi.prototype.L,yi.prototype.getLastError=yi.prototype.Ka,yi.prototype.getLastErrorCode=yi.prototype.Ba,yi.prototype.getStatus=yi.prototype.Z,yi.prototype.getResponseJson=yi.prototype.Oa,yi.prototype.getResponseText=yi.prototype.oa,yi.prototype.send=yi.prototype.ea,yi.prototype.setWithCredentials=yi.prototype.Ha,x$=yi}).apply(typeof db<"u"?db:typeof self<"u"?self:typeof window<"u"?window:{});const N5="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ss.UNAUTHENTICATED=new ss(null),ss.GOOGLE_CREDENTIALS=new ss("google-credentials-uid"),ss.FIRST_PARTY=new ss("first-party-uid"),ss.MOCK_USER=new ss("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cv="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=new jk("@firebase/firestore");function dy(){return Tp.logLevel}function dt(e,...t){if(Tp.logLevel<=ur.DEBUG){const r=t.map(tL);Tp.debug(`Firestore (${cv}): ${e}`,...r)}}function du(e,...t){if(Tp.logLevel<=ur.ERROR){const r=t.map(tL);Tp.error(`Firestore (${cv}): ${e}`,...r)}}function bg(e,...t){if(Tp.logLevel<=ur.WARN){const r=t.map(tL);Tp.warn(`Firestore (${cv}): ${e}`,...r)}}function tL(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ft(e="Unexpected state"){const t=`FIRESTORE (${cv}) INTERNAL ASSERTION FAILED: `+e;throw du(t),new Error(t)}function qr(e,t){e||Ft()}function Xt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ht extends ic{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C${constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class t3e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(ss.UNAUTHENTICATED))}shutdown(){}}class r3e{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class i3e{constructor(t){this.t=t,this.currentUser=ss.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){let i=this.i;const n=l=>this.i!==i?(i=this.i,r(l)):Promise.resolve();let s=new Kc;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Kc,t.enqueueRetryable(()=>n(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await n(this.currentUser)})},o=l=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Kc)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(i=>this.i!==t?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(qr(typeof i.accessToken=="string"),new C$(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return qr(t===null||typeof t=="string"),new ss(t)}}class n3e{constructor(t,r,i){this.l=t,this.h=r,this.P=i,this.type="FirstParty",this.user=ss.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class s3e{constructor(t,r,i){this.l=t,this.h=r,this.P=i}getToken(){return Promise.resolve(new n3e(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(ss.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class a3e{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class o3e{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){const i=s=>{s.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,dt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const n=s=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>n(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?n(s):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(qr(typeof r.token=="string"),this.R=r.token,new a3e(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3e(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let i=0;i<e;i++)r[i]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A${static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const n=l3e(40);for(let s=0;s<n.length;++s)i.length<20&&n[s]<r&&(i+=t.charAt(n[s]%t.length))}return i}}function br(e,t){return e<t?-1:e>t?1:0}function _g(e,t,r){return e.length===t.length&&e.every((i,n)=>r(i,t[n]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new ht(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ht(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new ht(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ht(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Yr.fromMillis(Date.now())}static fromDate(t){return Yr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*r));return new Yr(r,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?br(this.nanoseconds,t.nanoseconds):br(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Gt(t)}static min(){return new Gt(new Yr(0,0))}static max(){return new Gt(new Yr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(t,r,i){r===void 0?r=0:r>t.length&&Ft(),i===void 0?i=t.length-r:i>t.length-r&&Ft(),this.segments=t,this.offset=r,this.len=i}get length(){return this.len}isEqual(t){return aw.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof aw?t.forEach(i=>{r.push(i)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,i=this.limit();r<i;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const i=Math.min(t.length,r.length);for(let n=0;n<i;n++){const s=t.get(n),a=r.get(n);if(s<a)return-1;if(s>a)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class ei extends aw{construct(t,r,i){return new ei(t,r,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const i of t){if(i.indexOf("//")>=0)throw new ht(Ue.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);r.push(...i.split("/").filter(n=>n.length>0))}return new ei(r)}static emptyPath(){return new ei([])}}const c3e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends aw{construct(t,r,i){return new Vn(t,r,i)}static isValidIdentifier(t){return c3e.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Vn(["__name__"])}static fromServerFormat(t){const r=[];let i="",n=0;const s=()=>{if(i.length===0)throw new ht(Ue.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(i),i=""};let a=!1;for(;n<t.length;){const o=t[n];if(o==="\\"){if(n+1===t.length)throw new ht(Ue.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[n+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ht(Ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,n+=2}else o==="`"?(a=!a,n++):o!=="."||a?(i+=o,n++):(s(),n++)}if(s(),a)throw new ht(Ue.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Vn(r)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(t){this.path=t}static fromPath(t){return new Et(ei.fromString(t))}static fromName(t){return new Et(ei.fromString(t).popFirst(5))}static empty(){return new Et(ei.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ei.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return ei.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Et(new ei(t.slice()))}}function u3e(e,t){const r=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,n=Gt.fromTimestamp(i===1e9?new Yr(r+1,0):new Yr(r,i));return new qh(n,Et.empty(),t)}function h3e(e){return new qh(e.readTime,e.key,-1)}class qh{constructor(t,r,i){this.readTime=t,this.documentKey=r,this.largestBatchId=i}static min(){return new qh(Gt.min(),Et.empty(),-1)}static max(){return new qh(Gt.max(),Et.empty(),-1)}}function d3e(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Et.comparator(e.documentKey,t.documentKey),r!==0?r:br(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3e="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class f3e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zw(e){if(e.code!==Ue.FAILED_PRECONDITION||e.message!==p3e)throw e;dt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Ft(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new We((i,n)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,n)},this.catchCallback=s=>{this.wrapFailure(r,s).next(i,n)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof We?r:We.resolve(r)}catch(r){return We.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):We.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):We.reject(r)}static resolve(t){return new We((r,i)=>{r(t)})}static reject(t){return new We((r,i)=>{i(t)})}static waitFor(t){return new We((r,i)=>{let n=0,s=0,a=!1;t.forEach(o=>{++n,o.next(()=>{++s,a&&s===n&&r()},l=>i(l))}),a=!0,s===n&&r()})}static or(t){let r=We.resolve(!1);for(const i of t)r=r.next(n=>n?We.resolve(n):i());return r}static forEach(t,r){const i=[];return t.forEach((n,s)=>{i.push(r.call(this,n,s))}),this.waitFor(i)}static mapArray(t,r){return new We((i,n)=>{const s=t.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(u=>{a[c]=u,++o,o===s&&i(a)},u=>n(u))}})}static doWhile(t,r){return new We((i,n)=>{const s=()=>{t()===!0?r().next(()=>{s()},n):i()};s()})}}function m3e(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Jw(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}rL.oe=-1;function WT(e){return e==null}function aE(e){return e===0&&1/e==-1/0}function g3e(e){return typeof e=="number"&&Number.isInteger(e)&&!aE(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Kp(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function M$(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(t,r){this.comparator=t,this.root=r||Fn.EMPTY}insert(t,r){return new mi(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(t){return new mi(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return r.value;i<0?r=r.left:i>0&&(r=r.right)}return null}indexOf(t){let r=0,i=this.root;for(;!i.isEmpty();){const n=this.comparator(t,i.key);if(n===0)return r+i.left.size;n<0?i=i.left:(r+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,i)=>(t(r,i),!1))}toString(){const t=[];return this.inorderTraversal((r,i)=>(t.push(`${r}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new pb(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new pb(this.root,t,this.comparator,!1)}getReverseIterator(){return new pb(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new pb(this.root,t,this.comparator,!0)}}class pb{constructor(t,r,i,n){this.isReverse=n,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?i(t.key,r):1,r&&n&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Fn{constructor(t,r,i,n,s){this.key=t,this.value=r,this.color=i??Fn.RED,this.left=n??Fn.EMPTY,this.right=s??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,n,s){return new Fn(t??this.key,r??this.value,i??this.color,n??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let n=this;const s=i(t,n.key);return n=s<0?n.copy(null,null,null,n.left.insert(t,r,i),null):s===0?n.copy(null,r,null,null,null):n.copy(null,null,null,null,n.right.insert(t,r,i)),n.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,n=this;if(r(t,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(t,r),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),r(t,n.key)===0){if(n.right.isEmpty())return Fn.EMPTY;i=n.right.min(),n=n.copy(i.key,i.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(t,r))}return n.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ft();const t=this.left.check();if(t!==this.right.check())throw Ft();return t+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ft()}get value(){throw Ft()}get color(){throw Ft()}get left(){throw Ft()}get right(){throw Ft()}copy(t,r,i,n,s){return this}insert(t,r,i){return new Fn(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(t){this.comparator=t,this.data=new mi(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,i)=>(t(r),!1))}forEachInRange(t,r){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const n=i.getNext();if(this.comparator(n.key,t[1])>=0)return;r(n.key)}}forEachWhile(t,r){let i;for(i=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new B5(this.data.getIterator())}getIteratorFrom(t){return new B5(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(i=>{r=r.add(i)}),r}isEqual(t){if(!(t instanceof Yn)||this.size!==t.size)return!1;const r=this.data.getIterator(),i=t.data.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(this.comparator(n,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Yn(this.comparator);return r.data=t,r}}class B5{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t){this.fields=t,t.sort(Vn.comparator)}static empty(){return new _a([])}unionWith(t){let r=new Yn(Vn.comparator);for(const i of this.fields)r=r.add(i);for(const i of t)r=r.add(i);return new _a(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return _g(this.fields,t.fields,(r,i)=>r.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(n){try{return atob(n)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new P$("Invalid base64 string: "+s):s}}(t);return new ys(r)}static fromUint8Array(t){const r=function(n){let s="";for(let a=0;a<n.length;++a)s+=String.fromCharCode(n[a]);return s}(t);return new ys(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return br(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ys.EMPTY_BYTE_STRING=new ys("");const v3e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yh(e){if(qr(!!e),typeof e=="string"){let t=0;const r=v3e.exec(e);if(qr(!!r),r[1]){let n=r[1];n=(n+"000000000").substr(0,9),t=Number(n)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Vi(e.seconds),nanos:Vi(e.nanos)}}function Vi(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Cp(e){return typeof e=="string"?ys.fromBase64String(e):ys.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function nL(e){const t=e.mapValue.fields.__previous_value__;return iL(t)?nL(t):t}function ow(e){const t=Yh(e.mapValue.fields.__local_write_time__.timestampValue);return new Yr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3e{constructor(t,r,i,n,s,a,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=i,this.host=n,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class lw{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new lw("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof lw&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ap(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?iL(e)?4:w3e(e)?9007199254740991:10:Ft()}function $l(e,t){if(e===t)return!0;const r=Ap(e);if(r!==Ap(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ow(e).isEqual(ow(t));case 3:return function(n,s){if(typeof n.timestampValue=="string"&&typeof s.timestampValue=="string"&&n.timestampValue.length===s.timestampValue.length)return n.timestampValue===s.timestampValue;const a=Yh(n.timestampValue),o=Yh(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(n,s){return Cp(n.bytesValue).isEqual(Cp(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(n,s){return Vi(n.geoPointValue.latitude)===Vi(s.geoPointValue.latitude)&&Vi(n.geoPointValue.longitude)===Vi(s.geoPointValue.longitude)}(e,t);case 2:return function(n,s){if("integerValue"in n&&"integerValue"in s)return Vi(n.integerValue)===Vi(s.integerValue);if("doubleValue"in n&&"doubleValue"in s){const a=Vi(n.doubleValue),o=Vi(s.doubleValue);return a===o?aE(a)===aE(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return _g(e.arrayValue.values||[],t.arrayValue.values||[],$l);case 10:return function(n,s){const a=n.mapValue.fields||{},o=s.mapValue.fields||{};if(z5(a)!==z5(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!$l(a[l],o[l])))return!1;return!0}(e,t);default:return Ft()}}function cw(e,t){return(e.values||[]).find(r=>$l(r,t))!==void 0}function Sg(e,t){if(e===t)return 0;const r=Ap(e),i=Ap(t);if(r!==i)return br(r,i);switch(r){case 0:case 9007199254740991:return 0;case 1:return br(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=Vi(s.integerValue||s.doubleValue),l=Vi(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return F5(e.timestampValue,t.timestampValue);case 4:return F5(ow(e),ow(t));case 5:return br(e.stringValue,t.stringValue);case 6:return function(s,a){const o=Cp(s),l=Cp(a);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=br(o[c],l[c]);if(u!==0)return u}return br(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=br(Vi(s.latitude),Vi(a.latitude));return o!==0?o:br(Vi(s.longitude),Vi(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,a){const o=s.values||[],l=a.values||[];for(let c=0;c<o.length&&c<l.length;++c){const u=Sg(o[c],l[c]);if(u)return u}return br(o.length,l.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,a){if(s===fb.mapValue&&a===fb.mapValue)return 0;if(s===fb.mapValue)return 1;if(a===fb.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=br(l[h],u[h]);if(d!==0)return d;const p=Sg(o[l[h]],c[u[h]]);if(p!==0)return p}return br(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Ft()}}function F5(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return br(e,t);const r=Yh(e),i=Yh(t),n=br(r.seconds,i.seconds);return n!==0?n:br(r.nanos,i.nanos)}function Eg(e){return lO(e)}function lO(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const i=Yh(r);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Cp(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Et.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let i="[",n=!0;for(const s of r.values||[])n?n=!1:i+=",",i+=lO(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(r){const i=Object.keys(r.fields||{}).sort();let n="{",s=!0;for(const a of i)s?s=!1:n+=",",n+=`${a}:${lO(r.fields[a])}`;return n+"}"}(e.mapValue):Ft()}function U5(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function cO(e){return!!e&&"integerValue"in e}function sL(e){return!!e&&"arrayValue"in e}function j5(e){return!!e&&"nullValue"in e}function V5(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function l_(e){return!!e&&"mapValue"in e}function l0(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Kp(e.mapValue.fields,(r,i)=>t.mapValue.fields[r]=l0(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=l0(e.arrayValue.values[r]);return t}return Object.assign({},e)}function w3e(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(t){this.value=t}static empty(){return new ta({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let i=0;i<t.length-1;++i)if(r=(r.mapValue.fields||{})[t.get(i)],!l_(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=l0(r)}setAll(t){let r=Vn.emptyPath(),i={},n=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,i,n),i={},n=[],r=o.popLast()}a?i[o.lastSegment()]=l0(a):n.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,i,n)}delete(t){const r=this.field(t.popLast());l_(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return $l(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let i=0;i<t.length;++i){let n=r.mapValue.fields[t.get(i)];l_(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},r.mapValue.fields[t.get(i)]=n),r=n}return r.mapValue.fields}applyChanges(t,r,i){Kp(r,(n,s)=>t[n]=s);for(const n of i)delete t[n]}clone(){return new ta(l0(this.value))}}function D$(e){const t=[];return Kp(e.fields,(r,i)=>{const n=new Vn([r]);if(l_(i)){const s=D$(i.mapValue).fields;if(s.length===0)t.push(n);else for(const a of s)t.push(n.child(a))}else t.push(n)}),new _a(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(t,r,i,n,s,a,o){this.key=t,this.documentType=r,this.version=i,this.readTime=n,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new cs(t,0,Gt.min(),Gt.min(),Gt.min(),ta.empty(),0)}static newFoundDocument(t,r,i,n){return new cs(t,1,r,Gt.min(),i,n,0)}static newNoDocument(t,r){return new cs(t,2,r,Gt.min(),Gt.min(),ta.empty(),0)}static newUnknownDocument(t,r){return new cs(t,3,r,Gt.min(),Gt.min(),ta.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ta.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ta.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof cs&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new cs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(t,r){this.position=t,this.inclusive=r}}function H5(e,t,r){let i=0;for(let n=0;n<e.position.length;n++){const s=t[n],a=e.position[n];if(s.field.isKeyField()?i=Et.comparator(Et.fromName(a.referenceValue),r.key):i=Sg(a,r.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function W5(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!$l(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(t,r="asc"){this.field=t,this.dir=r}}function x3e(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I${}class qi extends I${constructor(t,r,i){super(),this.field=t,this.op=r,this.value=i}static create(t,r,i){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,i):new _3e(t,r,i):r==="array-contains"?new T3e(t,i):r==="in"?new C3e(t,i):r==="not-in"?new A3e(t,i):r==="array-contains-any"?new M3e(t,i):new qi(t,r,i)}static createKeyFieldInFilter(t,r,i){return r==="in"?new S3e(t,i):new E3e(t,i)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Sg(r,this.value)):r!==null&&Ap(this.value)===Ap(r)&&this.matchesComparison(Sg(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ft()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qo extends I${constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new qo(t,r)}matches(t){return O$(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function O$(e){return e.op==="and"}function R$(e){return b3e(e)&&O$(e)}function b3e(e){for(const t of e.filters)if(t instanceof qo)return!1;return!0}function uO(e){if(e instanceof qi)return e.field.canonicalString()+e.op.toString()+Eg(e.value);if(R$(e))return e.filters.map(t=>uO(t)).join(",");{const t=e.filters.map(r=>uO(r)).join(",");return`${e.op}(${t})`}}function k$(e,t){return e instanceof qi?function(i,n){return n instanceof qi&&i.op===n.op&&i.field.isEqual(n.field)&&$l(i.value,n.value)}(e,t):e instanceof qo?function(i,n){return n instanceof qo&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((s,a,o)=>s&&k$(a,n.filters[o]),!0):!1}(e,t):void Ft()}function L$(e){return e instanceof qi?function(r){return`${r.field.canonicalString()} ${r.op} ${Eg(r.value)}`}(e):e instanceof qo?function(r){return r.op.toString()+" {"+r.getFilters().map(L$).join(" ,")+"}"}(e):"Filter"}class _3e extends qi{constructor(t,r,i){super(t,r,i),this.key=Et.fromName(i.referenceValue)}matches(t){const r=Et.comparator(t.key,this.key);return this.matchesComparison(r)}}class S3e extends qi{constructor(t,r){super(t,"in",r),this.keys=N$("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class E3e extends qi{constructor(t,r){super(t,"not-in",r),this.keys=N$("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function N$(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(i=>Et.fromName(i.referenceValue))}class T3e extends qi{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return sL(r)&&cw(r.arrayValue,this.value)}}class C3e extends qi{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&cw(this.value.arrayValue,r)}}class A3e extends qi{constructor(t,r){super(t,"not-in",r)}matches(t){if(cw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!cw(this.value.arrayValue,r)}}class M3e extends qi{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!sL(r)||!r.arrayValue.values)&&r.arrayValue.values.some(i=>cw(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3e{constructor(t,r=null,i=[],n=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=i,this.filters=n,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function G5(e,t=null,r=[],i=[],n=null,s=null,a=null){return new P3e(e,t,r,i,n,s,a)}function aL(e){const t=Xt(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(i=>uO(i)).join(","),r+="|ob:",r+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),WT(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Eg(i)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Eg(i)).join(",")),t.ue=r}return t.ue}function oL(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!x3e(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!k$(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!W5(e.startAt,t.startAt)&&W5(e.endAt,t.endAt)}function hO(e){return Et.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(t,r=null,i=[],n=[],s=null,a="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=n,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function D3e(e,t,r,i,n,s,a,o){return new ex(e,t,r,i,n,s,a,o)}function lL(e){return new ex(e)}function q5(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function z$(e){return e.collectionGroup!==null}function c0(e){const t=Xt(e);if(t.ce===null){t.ce=[];const r=new Set;for(const s of t.explicitOrderBy)t.ce.push(s),r.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Yn(Vn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.ce.push(new lE(s,i))}),r.has(Vn.keyField().canonicalString())||t.ce.push(new lE(Vn.keyField(),i))}return t.ce}function Fl(e){const t=Xt(e);return t.le||(t.le=I3e(t,c0(e))),t.le}function I3e(e,t){if(e.limitType==="F")return G5(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(n=>{const s=n.dir==="desc"?"asc":"desc";return new lE(n.field,s)});const r=e.endAt?new oE(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new oE(e.startAt.position,e.startAt.inclusive):null;return G5(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}function dO(e,t){const r=e.filters.concat([t]);return new ex(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function pO(e,t,r){return new ex(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function GT(e,t){return oL(Fl(e),Fl(t))&&e.limitType===t.limitType}function B$(e){return`${aL(Fl(e))}|lt:${e.limitType}`}function Kf(e){return`Query(target=${function(r){let i=r.path.canonicalString();return r.collectionGroup!==null&&(i+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(i+=`, filters: [${r.filters.map(n=>L$(n)).join(", ")}]`),WT(r.limit)||(i+=", limit: "+r.limit),r.orderBy.length>0&&(i+=`, orderBy: [${r.orderBy.map(n=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(n)).join(", ")}]`),r.startAt&&(i+=", startAt: ",i+=r.startAt.inclusive?"b:":"a:",i+=r.startAt.position.map(n=>Eg(n)).join(",")),r.endAt&&(i+=", endAt: ",i+=r.endAt.inclusive?"a:":"b:",i+=r.endAt.position.map(n=>Eg(n)).join(",")),`Target(${i})`}(Fl(e))}; limitType=${e.limitType})`}function qT(e,t){return t.isFoundDocument()&&function(i,n){const s=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):Et.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,n){for(const s of c0(i))if(!s.field.isKeyField()&&n.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,n){for(const s of i.filters)if(!s.matches(n))return!1;return!0}(e,t)&&function(i,n){return!(i.startAt&&!function(a,o,l){const c=H5(a,o,l);return a.inclusive?c<=0:c<0}(i.startAt,c0(i),n)||i.endAt&&!function(a,o,l){const c=H5(a,o,l);return a.inclusive?c>=0:c>0}(i.endAt,c0(i),n))}(e,t)}function O3e(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function F$(e){return(t,r)=>{let i=!1;for(const n of c0(e)){const s=R3e(n,t,r);if(s!==0)return s;i=i||n.field.isKeyField()}return 0}}function R3e(e,t,r){const i=e.field.isKeyField()?Et.comparator(t.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Sg(l,c):Ft()}(e.field,t,r);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Ft()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i!==void 0){for(const[n,s]of i)if(this.equalsFn(n,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const i=this.mapKeyFn(t),n=this.inner[i];if(n===void 0)return this.inner[i]=[[t,r]],void this.innerSize++;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return void(n[s]=[t,r]);n.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return!1;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return i.length===1?delete this.inner[r]:i.splice(n,1),this.innerSize--,!0;return!1}forEach(t){Kp(this.inner,(r,i)=>{for(const[n,s]of i)t(n,s)})}isEmpty(){return M$(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3e=new mi(Et.comparator);function pu(){return k3e}const U$=new mi(Et.comparator);function ky(...e){let t=U$;for(const r of e)t=t.insert(r.key,r);return t}function j$(e){let t=U$;return e.forEach((r,i)=>t=t.insert(r,i.overlayedDocument)),t}function Wd(){return u0()}function V$(){return u0()}function u0(){return new uv(e=>e.toString(),(e,t)=>e.isEqual(t))}const L3e=new mi(Et.comparator),N3e=new Yn(Et.comparator);function ar(...e){let t=N3e;for(const r of e)t=t.add(r);return t}const z3e=new Yn(br);function B3e(){return z3e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H$(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:aE(t)?"-0":t}}function W$(e){return{integerValue:""+e}}function F3e(e,t){return g3e(t)?W$(t):H$(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this._=void 0}}function U3e(e,t,r){return e instanceof uw?function(n,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return s&&iL(s)&&(s=nL(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,t):e instanceof hw?q$(e,t):e instanceof dw?Y$(e,t):function(n,s){const a=G$(n,s),o=Y5(a)+Y5(n.Pe);return cO(a)&&cO(n.Pe)?W$(o):H$(n.serializer,o)}(e,t)}function j3e(e,t,r){return e instanceof hw?q$(e,t):e instanceof dw?Y$(e,t):r}function G$(e,t){return e instanceof cE?function(i){return cO(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class uw extends YT{}class hw extends YT{constructor(t){super(),this.elements=t}}function q$(e,t){const r=X$(t);for(const i of e.elements)r.some(n=>$l(n,i))||r.push(i);return{arrayValue:{values:r}}}class dw extends YT{constructor(t){super(),this.elements=t}}function Y$(e,t){let r=X$(t);for(const i of e.elements)r=r.filter(n=>!$l(n,i));return{arrayValue:{values:r}}}class cE extends YT{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function Y5(e){return Vi(e.integerValue||e.doubleValue)}function X$(e){return sL(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3e{constructor(t,r){this.field=t,this.transform=r}}function H3e(e,t){return e.field.isEqual(t.field)&&function(i,n){return i instanceof hw&&n instanceof hw||i instanceof dw&&n instanceof dw?_g(i.elements,n.elements,$l):i instanceof cE&&n instanceof cE?$l(i.Pe,n.Pe):i instanceof uw&&n instanceof uw}(e.transform,t.transform)}class W3e{constructor(t,r){this.version=t,this.transformResults=r}}class io{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new io}static exists(t){return new io(void 0,t)}static updateTime(t){return new io(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function c_(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class XT{}function $$(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new cL(e.key,io.none()):new tx(e.key,e.data,io.none());{const r=e.data,i=ta.empty();let n=new Yn(Vn.comparator);for(let s of t.fields)if(!n.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?i.delete(s):i.set(s,a),n=n.add(s)}return new ad(e.key,i,new _a(n.toArray()),io.none())}}function G3e(e,t,r){e instanceof tx?function(n,s,a){const o=n.value.clone(),l=$5(n.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof ad?function(n,s,a){if(!c_(n.precondition,s))return void s.convertToUnknownDocument(a.version);const o=$5(n.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Q$(n)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,r):function(n,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function h0(e,t,r,i){return e instanceof tx?function(s,a,o,l){if(!c_(s.precondition,a))return o;const c=s.value.clone(),u=Q5(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,r,i):e instanceof ad?function(s,a,o,l){if(!c_(s.precondition,a))return o;const c=Q5(s.fieldTransforms,l,a),u=a.data;return u.setAll(Q$(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(e,t,r,i):function(s,a,o){return c_(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function q3e(e,t){let r=null;for(const i of e.fieldTransforms){const n=t.data.field(i.field),s=G$(i.transform,n||null);s!=null&&(r===null&&(r=ta.empty()),r.set(i.field,s))}return r||null}function X5(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&_g(i,n,(s,a)=>H3e(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class tx extends XT{constructor(t,r,i,n=[]){super(),this.key=t,this.value=r,this.precondition=i,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class ad extends XT{constructor(t,r,i,n,s=[]){super(),this.key=t,this.data=r,this.fieldMask=i,this.precondition=n,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Q$(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const i=e.data.field(r);t.set(r,i)}}),t}function $5(e,t,r){const i=new Map;qr(e.length===r.length);for(let n=0;n<r.length;n++){const s=e[n],a=s.transform,o=t.data.field(s.field);i.set(s.field,j3e(a,o,r[n]))}return i}function Q5(e,t,r){const i=new Map;for(const n of e){const s=n.transform,a=r.data.field(n.field);i.set(n.field,U3e(s,a,t))}return i}class cL extends XT{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Y3e extends XT{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3e{constructor(t,r,i,n){this.batchId=t,this.localWriteTime=r,this.baseMutations=i,this.mutations=n}applyToRemoteDocument(t,r){const i=r.mutationResults;for(let n=0;n<this.mutations.length;n++){const s=this.mutations[n];s.key.isEqual(t.key)&&G3e(s,t,i[n])}}applyToLocalView(t,r){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(r=h0(i,t,r,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(r=h0(i,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const i=V$();return this.mutations.forEach(n=>{const s=t.get(n.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(n.key)?null:o;const l=$$(a,o);l!==null&&i.set(n.key,l),a.isValidDocument()||a.convertToNoDocument(Gt.min())}),i}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),ar())}isEqual(t){return this.batchId===t.batchId&&_g(this.mutations,t.mutations,(r,i)=>X5(r,i))&&_g(this.baseMutations,t.baseMutations,(r,i)=>X5(r,i))}}class uL{constructor(t,r,i,n){this.batch=t,this.commitVersion=r,this.mutationResults=i,this.docVersions=n}static from(t,r,i){qr(t.mutations.length===i.length);let n=function(){return L3e}();const s=t.mutations;for(let a=0;a<s.length;a++)n=n.insert(s[a].key,i[a].version);return new uL(t,r,i,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3e{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3e{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ji,hr;function K3e(e){switch(e){default:return Ft();case Ue.CANCELLED:case Ue.UNKNOWN:case Ue.DEADLINE_EXCEEDED:case Ue.RESOURCE_EXHAUSTED:case Ue.INTERNAL:case Ue.UNAVAILABLE:case Ue.UNAUTHENTICATED:return!1;case Ue.INVALID_ARGUMENT:case Ue.NOT_FOUND:case Ue.ALREADY_EXISTS:case Ue.PERMISSION_DENIED:case Ue.FAILED_PRECONDITION:case Ue.ABORTED:case Ue.OUT_OF_RANGE:case Ue.UNIMPLEMENTED:case Ue.DATA_LOSS:return!0}}function K$(e){if(e===void 0)return du("GRPC error has no .code"),Ue.UNKNOWN;switch(e){case ji.OK:return Ue.OK;case ji.CANCELLED:return Ue.CANCELLED;case ji.UNKNOWN:return Ue.UNKNOWN;case ji.DEADLINE_EXCEEDED:return Ue.DEADLINE_EXCEEDED;case ji.RESOURCE_EXHAUSTED:return Ue.RESOURCE_EXHAUSTED;case ji.INTERNAL:return Ue.INTERNAL;case ji.UNAVAILABLE:return Ue.UNAVAILABLE;case ji.UNAUTHENTICATED:return Ue.UNAUTHENTICATED;case ji.INVALID_ARGUMENT:return Ue.INVALID_ARGUMENT;case ji.NOT_FOUND:return Ue.NOT_FOUND;case ji.ALREADY_EXISTS:return Ue.ALREADY_EXISTS;case ji.PERMISSION_DENIED:return Ue.PERMISSION_DENIED;case ji.FAILED_PRECONDITION:return Ue.FAILED_PRECONDITION;case ji.ABORTED:return Ue.ABORTED;case ji.OUT_OF_RANGE:return Ue.OUT_OF_RANGE;case ji.UNIMPLEMENTED:return Ue.UNIMPLEMENTED;case ji.DATA_LOSS:return Ue.DATA_LOSS;default:return Ft()}}(hr=ji||(ji={}))[hr.OK=0]="OK",hr[hr.CANCELLED=1]="CANCELLED",hr[hr.UNKNOWN=2]="UNKNOWN",hr[hr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hr[hr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hr[hr.NOT_FOUND=5]="NOT_FOUND",hr[hr.ALREADY_EXISTS=6]="ALREADY_EXISTS",hr[hr.PERMISSION_DENIED=7]="PERMISSION_DENIED",hr[hr.UNAUTHENTICATED=16]="UNAUTHENTICATED",hr[hr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hr[hr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hr[hr.ABORTED=10]="ABORTED",hr[hr.OUT_OF_RANGE=11]="OUT_OF_RANGE",hr[hr.UNIMPLEMENTED=12]="UNIMPLEMENTED",hr[hr.INTERNAL=13]="INTERNAL",hr[hr.UNAVAILABLE=14]="UNAVAILABLE",hr[hr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3e(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3e=new rp([4294967295,4294967295],0);function K5(e){const t=Z3e().encode(e),r=new w$;return r.update(t),new Uint8Array(r.digest())}function Z5(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),i=t.getUint32(4,!0),n=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new rp([r,i],0),new rp([n,s],0)]}class hL{constructor(t,r,i){if(this.bitmap=t,this.padding=r,this.hashCount=i,r<0||r>=8)throw new Ly(`Invalid padding: ${r}`);if(i<0)throw new Ly(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Ly(`Invalid hash count: ${i}`);if(t.length===0&&r!==0)throw new Ly(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=rp.fromNumber(this.Ie)}Ee(t,r,i){let n=t.add(r.multiply(rp.fromNumber(i)));return n.compare(J3e)===1&&(n=new rp([n.getBits(0),n.getBits(1)],0)),n.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=K5(t),[i,n]=Z5(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(i,n,s);if(!this.de(a))return!1}return!0}static create(t,r,i){const n=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new hL(s,n,r);return i.forEach(o=>a.insert(o)),a}insert(t){if(this.Ie===0)return;const r=K5(t),[i,n]=Z5(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(i,n,s);this.Ae(a)}}Ae(t){const r=Math.floor(t/8),i=t%8;this.bitmap[r]|=1<<i}}class Ly extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(t,r,i,n,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=n,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,i){const n=new Map;return n.set(t,rx.createSynthesizedTargetChangeForCurrentChange(t,r,i)),new $T(Gt.min(),n,new mi(br),pu(),ar())}}class rx{constructor(t,r,i,n,s){this.resumeToken=t,this.current=r,this.addedDocuments=i,this.modifiedDocuments=n,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,i){return new rx(i,r,ar(),ar(),ar())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(t,r,i,n){this.Re=t,this.removedTargetIds=r,this.key=i,this.Ve=n}}class Z${constructor(t,r){this.targetId=t,this.me=r}}class J${constructor(t,r,i=ys.EMPTY_BYTE_STRING,n=null){this.state=t,this.targetIds=r,this.resumeToken=i,this.cause=n}}class J5{constructor(){this.fe=0,this.ge=t6(),this.pe=ys.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}Ce(){let t=ar(),r=ar(),i=ar();return this.ge.forEach((n,s)=>{switch(s){case 0:t=t.add(n);break;case 2:r=r.add(n);break;case 1:i=i.add(n);break;default:Ft()}}),new rx(this.pe,this.ye,t,r,i)}ve(){this.we=!1,this.ge=t6()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,qr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class eke{constructor(t){this.Le=t,this.Be=new Map,this.ke=pu(),this.qe=e6(),this.Qe=new mi(br)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const i=this.Ge(r);switch(t.state){case 0:this.ze(r)&&i.De(t.resumeToken);break;case 1:i.Oe(),i.Se||i.ve(),i.De(t.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(i.Ne(),i.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),i.De(t.resumeToken));break;default:Ft()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((i,n)=>{this.ze(n)&&r(n)})}He(t){const r=t.targetId,i=t.me.count,n=this.Je(r);if(n){const s=n.target;if(hO(s))if(i===0){const a=new Et(s.path);this.Ue(r,a,cs.newNoDocument(a,Gt.min()))}else qr(i===1);else{const a=this.Ye(r);if(a!==i){const o=this.Ze(t),l=o?this.Xe(o,t,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:i="",padding:n=0},hashCount:s=0}=r;let a,o;try{a=Cp(i).toUint8Array()}catch(l){if(l instanceof P$)return bg("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new hL(a,n,s)}catch(l){return bg(l instanceof Ly?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,i){return r.me.count===i-this.nt(t,r.targetId)?0:2}nt(t,r){const i=this.Le.getRemoteKeysForTarget(r);let n=0;return i.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,s,null),n++)}),n}rt(t){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&hO(o.target)){const l=new Et(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,cs.newNoDocument(l,t))}s.be&&(r.set(a,s.Ce()),s.ve())}});let i=ar();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(i=i.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(t));const n=new $T(t,r,this.Qe,this.ke,i);return this.ke=pu(),this.qe=e6(),this.Qe=new mi(br),n}$e(t,r){if(!this.ze(t))return;const i=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,i),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,i){if(!this.ze(t))return;const n=this.Ge(t);this.it(t,r)?n.Fe(r,1):n.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),i&&(this.ke=this.ke.insert(r,i))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).Ce();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new J5,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new Yn(br),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||dt("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new J5),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function e6(){return new mi(Et.comparator)}function t6(){return new mi(Et.comparator)}const tke={asc:"ASCENDING",desc:"DESCENDING"},rke={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ike={and:"AND",or:"OR"};class nke{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function fO(e,t){return e.useProto3Json||WT(t)?t:{value:t}}function uE(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function eQ(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ske(e,t){return uE(e,t.toTimestamp())}function Ul(e){return qr(!!e),Gt.fromTimestamp(function(r){const i=Yh(r);return new Yr(i.seconds,i.nanos)}(e))}function dL(e,t){return mO(e,t).canonicalString()}function mO(e,t){const r=function(n){return new ei(["projects",n.projectId,"databases",n.database])}(e).child("documents");return t===void 0?r:r.child(t)}function tQ(e){const t=ei.fromString(e);return qr(aQ(t)),t}function gO(e,t){return dL(e.databaseId,t.path)}function bP(e,t){const r=tQ(t);if(r.get(1)!==e.databaseId.projectId)throw new ht(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new ht(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Et(iQ(r))}function rQ(e,t){return dL(e.databaseId,t)}function ake(e){const t=tQ(e);return t.length===4?ei.emptyPath():iQ(t)}function vO(e){return new ei(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function iQ(e){return qr(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function r6(e,t,r){return{name:gO(e,t),fields:r.value.mapValue.fields}}function oke(e,t){let r;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ft()}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(qr(u===void 0||typeof u=="string"),ys.fromBase64String(u||"")):(qr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),ys.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(c){const u=c.code===void 0?Ue.UNKNOWN:K$(c.code);return new ht(u,c.message||"")}(a);r=new J$(i,n,s,o||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const n=bP(e,i.document.name),s=Ul(i.document.updateTime),a=i.document.createTime?Ul(i.document.createTime):Gt.min(),o=new ta({mapValue:{fields:i.document.fields}}),l=cs.newFoundDocument(n,s,a,o),c=i.targetIds||[],u=i.removedTargetIds||[];r=new u_(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const n=bP(e,i.document),s=i.readTime?Ul(i.readTime):Gt.min(),a=cs.newNoDocument(n,s),o=i.removedTargetIds||[];r=new u_([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const n=bP(e,i.document),s=i.removedTargetIds||[];r=new u_([],s,n,null)}else{if(!("filter"in t))return Ft();{t.filter;const i=t.filter;i.targetId;const{count:n=0,unchangedNames:s}=i,a=new Q3e(n,s),o=i.targetId;r=new Z$(o,a)}}return r}function lke(e,t){let r;if(t instanceof tx)r={update:r6(e,t.key,t.value)};else if(t instanceof cL)r={delete:gO(e,t.key)};else if(t instanceof ad)r={update:r6(e,t.key,t.data),updateMask:vke(t.fieldMask)};else{if(!(t instanceof Y3e))return Ft();r={verify:gO(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(i=>function(s,a){const o=a.transform;if(o instanceof uw)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof hw)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof dw)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof cE)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Ft()}(0,i))),t.precondition.isNone||(r.currentDocument=function(n,s){return s.updateTime!==void 0?{updateTime:ske(n,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ft()}(e,t.precondition)),r}function cke(e,t){return e&&e.length>0?(qr(t!==void 0),e.map(r=>function(n,s){let a=n.updateTime?Ul(n.updateTime):Ul(s);return a.isEqual(Gt.min())&&(a=Ul(s)),new W3e(a,n.transformResults||[])}(r,t))):[]}function uke(e,t){return{documents:[rQ(e,t.path)]}}function hke(e,t){const r={structuredQuery:{}},i=t.path;let n;t.collectionGroup!==null?(n=i,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=rQ(e,n);const s=function(c){if(c.length!==0)return sQ(qo.create(c,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Zf(d.field),direction:fke(d.dir)}}(u))}(t.orderBy);a&&(r.structuredQuery.orderBy=a);const o=fO(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:r,parent:n}}function dke(e){let t=ake(e.parent);const r=e.structuredQuery,i=r.from?r.from.length:0;let n=null;if(i>0){qr(i===1);const u=r.from[0];u.allDescendants?n=u.collectionId:t=t.child(u.collectionId)}let s=[];r.where&&(s=function(h){const d=nQ(h);return d instanceof qo&&R$(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(f){return new lE(Jf(f.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,WT(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new oE(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new oE(p,d)}(r.endAt)),D3e(t,n,a,s,o,"F",l,c)}function pke(e,t){const r=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ft()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function nQ(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const i=Jf(r.unaryFilter.field);return qi.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=Jf(r.unaryFilter.field);return qi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Jf(r.unaryFilter.field);return qi.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Jf(r.unaryFilter.field);return qi.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ft()}}(e):e.fieldFilter!==void 0?function(r){return qi.create(Jf(r.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ft()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return qo.create(r.compositeFilter.filters.map(i=>nQ(i)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return Ft()}}(r.compositeFilter.op))}(e):Ft()}function fke(e){return tke[e]}function mke(e){return rke[e]}function gke(e){return ike[e]}function Zf(e){return{fieldPath:e.canonicalString()}}function Jf(e){return Vn.fromServerFormat(e.fieldPath)}function sQ(e){return e instanceof qi?function(r){if(r.op==="=="){if(V5(r.value))return{unaryFilter:{field:Zf(r.field),op:"IS_NAN"}};if(j5(r.value))return{unaryFilter:{field:Zf(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(V5(r.value))return{unaryFilter:{field:Zf(r.field),op:"IS_NOT_NAN"}};if(j5(r.value))return{unaryFilter:{field:Zf(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zf(r.field),op:mke(r.op),value:r.value}}}(e):e instanceof qo?function(r){const i=r.getFilters().map(n=>sQ(n));return i.length===1?i[0]:{compositeFilter:{op:gke(r.op),filters:i}}}(e):Ft()}function vke(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function aQ(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(t,r,i,n,s=Gt.min(),a=Gt.min(),o=ys.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=i,this.sequenceNumber=n,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new gh(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new gh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new gh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new gh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yke{constructor(t){this.ct=t}}function wke(e){const t=dke({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?pO(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xke{constructor(){this._n=new bke}addToCollectionParentIndex(t,r){return this._n.add(r),We.resolve()}getCollectionParents(t,r){return We.resolve(this._n.getEntries(r))}addFieldIndex(t,r){return We.resolve()}deleteFieldIndex(t,r){return We.resolve()}deleteAllFieldIndexes(t){return We.resolve()}createTargetIndexes(t,r){return We.resolve()}getDocumentsMatchingTarget(t,r){return We.resolve(null)}getIndexType(t,r){return We.resolve(0)}getFieldIndexes(t,r){return We.resolve([])}getNextCollectionGroupToUpdate(t){return We.resolve(null)}getMinOffset(t,r){return We.resolve(qh.min())}getMinOffsetFromCollectionGroup(t,r){return We.resolve(qh.min())}updateCollectionGroup(t,r,i){return We.resolve()}updateIndexEntries(t,r){return We.resolve()}}class bke{constructor(){this.index={}}add(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r]||new Yn(ei.comparator),s=!n.has(i);return this.index[r]=n.add(i),s}has(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r];return n&&n.has(i)}getEntries(t){return(this.index[t]||new Yn(ei.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new Tg(0)}static Ln(){return new Tg(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ke{constructor(){this.changes=new uv(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,cs.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const i=this.changes.get(r);return i!==void 0?We.resolve(i):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ske{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eke{constructor(t,r,i,n){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=n}getDocument(t,r){let i=null;return this.documentOverlayCache.getOverlay(t,r).next(n=>(i=n,this.remoteDocumentCache.getEntry(t,r))).next(n=>(i!==null&&h0(i.mutation,n,_a.empty(),Yr.now()),n))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.getLocalViewOfDocuments(t,i,ar()).next(()=>i))}getLocalViewOfDocuments(t,r,i=ar()){const n=Wd();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,i).next(s=>{let a=ky();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const i=Wd();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,ar()))}populateOverlays(t,r,i){const n=[];return i.forEach(s=>{r.has(s)||n.push(s)}),this.documentOverlayCache.getOverlays(t,n).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,i,n){let s=pu();const a=u0(),o=function(){return u0()}();return r.forEach((l,c)=>{const u=i.get(c.key);n.has(c.key)&&(u===void 0||u.mutation instanceof ad)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),h0(u.mutation,c,u.mutation.getFieldMask(),Yr.now())):a.set(c.key,_a.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new Ske(u,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(t,r){const i=u0();let n=new mi((a,o)=>a-o),s=ar();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=i.get(l)||_a.empty();u=o.applyToLocalView(c,u),i.set(l,u);const h=(n.get(o.batchId)||ar()).add(l);n=n.insert(o.batchId,h)})}).next(()=>{const a=[],o=n.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=V$();u.forEach(d=>{if(!s.has(d)){const p=$$(r.get(d),i.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,h))}return We.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,r,i,n){return function(a){return Et.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):z$(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,i,n):this.getDocumentsMatchingCollectionQuery(t,r,i,n)}getNextDocuments(t,r,i,n){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,i,n).next(s=>{const a=n-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,i.largestBatchId,n-s.size):We.resolve(Wd());let o=-1,l=s;return a.next(c=>We.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(u)?We.resolve():this.remoteDocumentCache.getEntry(t,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,ar())).next(u=>({batchId:o,changes:j$(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Et(r)).next(i=>{let n=ky();return i.isFoundDocument()&&(n=n.insert(i.key,i)),n})}getDocumentsMatchingCollectionGroupQuery(t,r,i,n){const s=r.collectionGroup;let a=ky();return this.indexManager.getCollectionParents(t,s).next(o=>We.forEach(o,l=>{const c=function(h,d){return new ex(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,i,n).next(u=>{u.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,i,n){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,i,s,n))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,cs.newInvalidDocument(u)))});let o=ky();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&h0(u.mutation,c,_a.empty(),Yr.now()),qT(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tke{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,r){return We.resolve(this.cr.get(r))}saveBundleMetadata(t,r){return this.cr.set(r.id,function(n){return{id:n.id,version:n.version,createTime:Ul(n.createTime)}}(r)),We.resolve()}getNamedQuery(t,r){return We.resolve(this.lr.get(r))}saveNamedQuery(t,r){return this.lr.set(r.name,function(n){return{name:n.name,query:wke(n.bundledQuery),readTime:Ul(n.readTime)}}(r)),We.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cke{constructor(){this.overlays=new mi(Et.comparator),this.hr=new Map}getOverlay(t,r){return We.resolve(this.overlays.get(r))}getOverlays(t,r){const i=Wd();return We.forEach(r,n=>this.getOverlay(t,n).next(s=>{s!==null&&i.set(n,s)})).next(()=>i)}saveOverlays(t,r,i){return i.forEach((n,s)=>{this.ht(t,r,s)}),We.resolve()}removeOverlaysForBatchId(t,r,i){const n=this.hr.get(i);return n!==void 0&&(n.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(i)),We.resolve()}getOverlaysForCollection(t,r,i){const n=Wd(),s=r.length+1,a=new Et(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&n.set(l.getKey(),l)}return We.resolve(n)}getOverlaysForCollectionGroup(t,r,i,n){let s=new mi((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>i){let u=s.get(c.largestBatchId);u===null&&(u=Wd(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Wd(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=n)););return We.resolve(o)}ht(t,r,i){const n=this.overlays.get(i.key);if(n!==null){const a=this.hr.get(n.largestBatchId).delete(i.key);this.hr.set(n.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new $3e(r,i));let s=this.hr.get(r);s===void 0&&(s=ar(),this.hr.set(r,s)),this.hr.set(r,s.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(){this.Pr=new Yn(gn.Ir),this.Tr=new Yn(gn.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,r){const i=new gn(t,r);this.Pr=this.Pr.add(i),this.Tr=this.Tr.add(i)}dr(t,r){t.forEach(i=>this.addReference(i,r))}removeReference(t,r){this.Ar(new gn(t,r))}Rr(t,r){t.forEach(i=>this.removeReference(i,r))}Vr(t){const r=new Et(new ei([])),i=new gn(r,t),n=new gn(r,t+1),s=[];return this.Tr.forEachInRange([i,n],a=>{this.Ar(a),s.push(a.key)}),s}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const r=new Et(new ei([])),i=new gn(r,t),n=new gn(r,t+1);let s=ar();return this.Tr.forEachInRange([i,n],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new gn(t,0),i=this.Pr.firstAfterOrEqual(r);return i!==null&&t.isEqual(i.key)}}class gn{constructor(t,r){this.key=t,this.pr=r}static Ir(t,r){return Et.comparator(t.key,r.key)||br(t.pr,r.pr)}static Er(t,r){return br(t.pr,r.pr)||Et.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ake{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.yr=1,this.wr=new Yn(gn.Ir)}checkEmpty(t){return We.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,i,n){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new X3e(s,r,i,n);this.mutationQueue.push(a);for(const o of n)this.wr=this.wr.add(new gn(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return We.resolve(a)}lookupMutationBatch(t,r){return We.resolve(this.Sr(r))}getNextMutationBatchAfterBatchId(t,r){const i=r+1,n=this.br(i),s=n<0?0:n;return We.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return We.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(t){return We.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const i=new gn(r,0),n=new gn(r,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([i,n],a=>{const o=this.Sr(a.pr);s.push(o)}),We.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let i=new Yn(br);return r.forEach(n=>{const s=new gn(n,0),a=new gn(n,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,a],o=>{i=i.add(o.pr)})}),We.resolve(this.Dr(i))}getAllMutationBatchesAffectingQuery(t,r){const i=r.path,n=i.length+1;let s=i;Et.isDocumentKey(s)||(s=s.child(""));const a=new gn(new Et(s),0);let o=new Yn(br);return this.wr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===n&&(o=o.add(l.pr)),!0)},a),We.resolve(this.Dr(o))}Dr(t){const r=[];return t.forEach(i=>{const n=this.Sr(i);n!==null&&r.push(n)}),r}removeMutationBatch(t,r){qr(this.Cr(r.batchId,"removed")===0),this.mutationQueue.shift();let i=this.wr;return We.forEach(r.mutations,n=>{const s=new gn(n.key,r.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,n.key)}).next(()=>{this.wr=i})}Mn(t){}containsKey(t,r){const i=new gn(r,0),n=this.wr.firstAfterOrEqual(i);return We.resolve(r.isEqual(n&&n.key))}performConsistencyCheck(t){return this.mutationQueue.length,We.resolve()}Cr(t,r){return this.br(t)}br(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Sr(t){const r=this.br(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mke{constructor(t){this.vr=t,this.docs=function(){return new mi(Et.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const i=r.key,n=this.docs.get(i),s=n?n.size:0,a=this.vr(r);return this.docs=this.docs.insert(i,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const i=this.docs.get(r);return We.resolve(i?i.document.mutableCopy():cs.newInvalidDocument(r))}getEntries(t,r){let i=pu();return r.forEach(n=>{const s=this.docs.get(n);i=i.insert(n,s?s.document.mutableCopy():cs.newInvalidDocument(n))}),We.resolve(i)}getDocumentsMatchingQuery(t,r,i,n){let s=pu();const a=r.path,o=new Et(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||d3e(h3e(u),i)<=0||(n.has(u.key)||qT(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return We.resolve(s)}getAllFromCollectionGroup(t,r,i,n){Ft()}Fr(t,r){return We.forEach(this.docs,i=>r(i))}newChangeBuffer(t){return new Pke(this)}getSize(t){return We.resolve(this.size)}}class Pke extends _ke{constructor(t){super(),this.ar=t}applyChanges(t){const r=[];return this.changes.forEach((i,n)=>{n.isValidDocument()?r.push(this.ar.addEntry(t,n)):this.ar.removeEntry(i)}),We.waitFor(r)}getFromCache(t,r){return this.ar.getEntry(t,r)}getAllFromCache(t,r){return this.ar.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dke{constructor(t){this.persistence=t,this.Mr=new uv(r=>aL(r),oL),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.Or=0,this.Nr=new pL,this.targetCount=0,this.Lr=Tg.Nn()}forEachTarget(t,r){return this.Mr.forEach((i,n)=>r(n)),We.resolve()}getLastRemoteSnapshotVersion(t){return We.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return We.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Lr.next(),We.resolve(this.highestTargetId)}setTargetsMetadata(t,r,i){return i&&(this.lastRemoteSnapshotVersion=i),r>this.Or&&(this.Or=r),We.resolve()}qn(t){this.Mr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.Lr=new Tg(r),this.highestTargetId=r),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,r){return this.qn(r),this.targetCount+=1,We.resolve()}updateTargetData(t,r){return this.qn(r),We.resolve()}removeTargetData(t,r){return this.Mr.delete(r.target),this.Nr.Vr(r.targetId),this.targetCount-=1,We.resolve()}removeTargets(t,r,i){let n=0;const s=[];return this.Mr.forEach((a,o)=>{o.sequenceNumber<=r&&i.get(o.targetId)===null&&(this.Mr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),n++)}),We.waitFor(s).next(()=>n)}getTargetCount(t){return We.resolve(this.targetCount)}getTargetData(t,r){const i=this.Mr.get(r)||null;return We.resolve(i)}addMatchingKeys(t,r,i){return this.Nr.dr(r,i),We.resolve()}removeMatchingKeys(t,r,i){this.Nr.Rr(r,i);const n=this.persistence.referenceDelegate,s=[];return n&&r.forEach(a=>{s.push(n.markPotentiallyOrphaned(t,a))}),We.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Nr.Vr(r),We.resolve()}getMatchingKeysForTargetId(t,r){const i=this.Nr.gr(r);return We.resolve(i)}containsKey(t,r){return We.resolve(this.Nr.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ike{constructor(t,r){this.Br={},this.overlays={},this.kr=new rL(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Dke(this),this.indexManager=new xke,this.remoteDocumentCache=function(n){return new Mke(n)}(i=>this.referenceDelegate.Kr(i)),this.serializer=new yke(r),this.$r=new Tke(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new Cke,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let i=this.Br[t.toKey()];return i||(i=new Ake(r,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,r,i){dt("MemoryPersistence","Starting transaction:",t);const n=new Oke(this.kr.next());return this.referenceDelegate.Ur(),i(n).next(s=>this.referenceDelegate.Wr(n).next(()=>s)).toPromise().then(s=>(n.raiseOnCommittedEvent(),s))}Gr(t,r){return We.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,r)))}}class Oke extends f3e{constructor(t){super(),this.currentSequenceNumber=t}}class fL{constructor(t){this.persistence=t,this.zr=new pL,this.jr=null}static Hr(t){return new fL(t)}get Jr(){if(this.jr)return this.jr;throw Ft()}addReference(t,r,i){return this.zr.addReference(i,r),this.Jr.delete(i.toString()),We.resolve()}removeReference(t,r,i){return this.zr.removeReference(i,r),this.Jr.add(i.toString()),We.resolve()}markPotentiallyOrphaned(t,r){return this.Jr.add(r.toString()),We.resolve()}removeTarget(t,r){this.zr.Vr(r.targetId).forEach(n=>this.Jr.add(n.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,r.targetId).next(n=>{n.forEach(s=>this.Jr.add(s.toString()))}).next(()=>i.removeTargetData(t,r))}Ur(){this.jr=new Set}Wr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return We.forEach(this.Jr,i=>{const n=Et.fromPath(i);return this.Yr(t,n).next(s=>{s||r.removeEntry(n,Gt.min())})}).next(()=>(this.jr=null,r.apply(t)))}updateLimboDocument(t,r){return this.Yr(t,r).next(i=>{i?this.Jr.delete(r.toString()):this.Jr.add(r.toString())})}Kr(t){return 0}Yr(t,r){return We.or([()=>We.resolve(this.zr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Gr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(t,r,i,n){this.targetId=t,this.fromCache=r,this.qi=i,this.Qi=n}static Ki(t,r){let i=ar(),n=ar();for(const s of r.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:n=n.add(s.doc.key)}return new mL(t,r.fromCache,i,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rke{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kke{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return z2e()?8:m3e(Qn())>0?6:4}()}initialize(t,r){this.zi=t,this.indexManager=r,this.$i=!0}getDocumentsMatchingQuery(t,r,i,n){const s={result:null};return this.ji(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Hi(t,r,n,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new Rke;return this.Ji(t,r,a).next(o=>{if(s.result=o,this.Ui)return this.Yi(t,r,a,o.size)})}).next(()=>s.result)}Yi(t,r,i,n){return i.documentReadCount<this.Wi?(dy()<=ur.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",Kf(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),We.resolve()):(dy()<=ur.DEBUG&&dt("QueryEngine","Query:",Kf(r),"scans",i.documentReadCount,"local documents and returns",n,"documents as results."),i.documentReadCount>this.Gi*n?(dy()<=ur.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",Kf(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Fl(r))):We.resolve())}ji(t,r){if(q5(r))return We.resolve(null);let i=Fl(r);return this.indexManager.getIndexType(t,i).next(n=>n===0?null:(r.limit!==null&&n===1&&(r=pO(r,null,"F"),i=Fl(r)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const a=ar(...s);return this.zi.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.Zi(r,o);return this.Xi(r,c,a,l.readTime)?this.ji(t,pO(r,null,"F")):this.es(t,c,r,l)}))})))}Hi(t,r,i,n){return q5(r)||n.isEqual(Gt.min())?We.resolve(null):this.zi.getDocuments(t,i).next(s=>{const a=this.Zi(r,s);return this.Xi(r,a,i,n)?We.resolve(null):(dy()<=ur.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Kf(r)),this.es(t,a,r,u3e(n,-1)).next(o=>o))})}Zi(t,r){let i=new Yn(F$(t));return r.forEach((n,s)=>{qT(t,s)&&(i=i.add(s))}),i}Xi(t,r,i,n){if(t.limit===null)return!1;if(i.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(n)>0)}Ji(t,r,i){return dy()<=ur.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",Kf(r)),this.zi.getDocumentsMatchingQuery(t,r,qh.min(),i)}es(t,r,i,n){return this.zi.getDocumentsMatchingQuery(t,i,n).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lke{constructor(t,r,i,n){this.persistence=t,this.ts=r,this.serializer=n,this.ns=new mi(br),this.rs=new uv(s=>aL(s),oL),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(i)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Eke(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.ns))}}function Nke(e,t,r,i){return new Lke(e,t,r,i)}async function oQ(e,t){const r=Xt(e);return await r.persistence.runTransaction("Handle user change","readonly",i=>{let n;return r.mutationQueue.getAllMutationBatches(i).next(s=>(n=s,r._s(t),r.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],o=[];let l=ar();for(const c of n){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(i,l).next(c=>({us:c,removedBatchIds:a,addedBatchIds:o}))})})}function zke(e,t){const r=Xt(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const n=t.batch.keys(),s=r.os.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,d=h.keys();let p=We.resolve();return d.forEach(f=>{p=p.next(()=>u.getEntry(l,f)).next(m=>{const g=c.docVersions.get(f);qr(g!==null),m.version.compareTo(g)<0&&(h.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,i,t,s).next(()=>s.apply(i)).next(()=>r.mutationQueue.performConsistencyCheck(i)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(i,n,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let l=ar();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(i,n))})}function lQ(e){const t=Xt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Qr.getLastRemoteSnapshotVersion(r))}function Bke(e,t){const r=Xt(e),i=t.snapshotVersion;let n=r.ns;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.os.newChangeBuffer({trackRemovals:!0});n=r.ns;const o=[];t.targetChanges.forEach((u,h)=>{const d=n.get(h);if(!d)return;o.push(r.Qr.removeMatchingKeys(s,u.removedDocuments,h).next(()=>r.Qr.addMatchingKeys(s,u.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(h)!==null?p=p.withResumeToken(ys.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,i)),n=n.insert(h,p),function(m,g,v){return m.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,p,u)&&o.push(r.Qr.updateTargetData(s,p))});let l=pu(),c=ar();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(Fke(s,a,t.documentUpdates).next(u=>{l=u.cs,c=u.ls})),!i.isEqual(Gt.min())){const u=r.Qr.getLastRemoteSnapshotVersion(s).next(h=>r.Qr.setTargetsMetadata(s,s.currentSequenceNumber,i));o.push(u)}return We.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.ns=n,s))}function Fke(e,t,r){let i=ar(),n=ar();return r.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let a=pu();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(n=n.add(o)),l.isNoDocument()&&l.version.isEqual(Gt.min())?(t.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(o,l)):dt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{cs:a,ls:n}})}function Uke(e,t){const r=Xt(e);return r.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function jke(e,t){const r=Xt(e);return r.persistence.runTransaction("Allocate target","readwrite",i=>{let n;return r.Qr.getTargetData(i,t).next(s=>s?(n=s,We.resolve(n)):r.Qr.allocateTargetId(i).next(a=>(n=new gh(t,a,"TargetPurposeListen",i.currentSequenceNumber),r.Qr.addTargetData(i,n).next(()=>n))))}).then(i=>{const n=r.ns.get(i.targetId);return(n===null||i.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.ns=r.ns.insert(i.targetId,i),r.rs.set(t,i.targetId)),i})}async function yO(e,t,r){const i=Xt(e),n=i.ns.get(t),s=r?"readwrite":"readwrite-primary";try{r||await i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,n))}catch(a){if(!Jw(a))throw a;dt("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}i.ns=i.ns.remove(t),i.rs.delete(n.target)}function i6(e,t,r){const i=Xt(e);let n=Gt.min(),s=ar();return i.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const h=Xt(l),d=h.rs.get(u);return d!==void 0?We.resolve(h.ns.get(d)):h.Qr.getTargetData(c,u)}(i,a,Fl(t)).next(o=>{if(o)return n=o.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>i.ts.getDocumentsMatchingQuery(a,t,r?n:Gt.min(),r?s:ar())).next(o=>(Vke(i,O3e(t),o),{documents:o,hs:s})))}function Vke(e,t,r){let i=e.ss.get(t)||Gt.min();r.forEach((n,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.ss.set(t,i)}class n6{constructor(){this.activeTargetIds=B3e()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Hke{constructor(){this.no=new n6,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,i){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,r,i){this.ro[t]=r}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new n6,Promise.resolve()}handleUserChange(t,r,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wke{io(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){dt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){dt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mb=null;function _P(){return mb===null?mb=function(){return 268435456+Math.round(2147483648*Math.random())}():mb++,"0x"+mb.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gke={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qke{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}Ao(t){this.Ro=t}onMessage(t){this.Vo=t}close(){this.ho()}send(t){this.lo(t)}mo(){this.Io()}fo(){this.Eo()}po(t){this.Ro(t)}yo(t){this.Vo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="WebChannelConnection";class Yke extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const i=r.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=i+"://"+r.host,this.So=`projects/${n}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${n}`:`project_id=${n}&database_id=${s}`}get Do(){return!1}Co(r,i,n,s,a){const o=_P(),l=this.vo(r,i.toUriEncodedString());dt("RestConnection",`Sending RPC '${r}' ${o}:`,l,n);const c={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(c,s,a),this.Mo(r,l,c,n).then(u=>(dt("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw bg("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",n),u})}xo(r,i,n,s,a,o){return this.Co(r,i,n,s,a)}Fo(r,i,n){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cv}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,a)=>r[a]=s),n&&n.headers.forEach((s,a)=>r[a]=s)}vo(r,i){const n=Gke[r];return`${this.wo}/v1/${i}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Mo(t,r,i,n){const s=_P();return new Promise((a,o)=>{const l=new x$;l.setWithCredentials(!0),l.listenOnce(_$.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case o_.NO_ERROR:const u=l.getResponseJson();dt(is,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(u)),a(u);break;case o_.TIMEOUT:dt(is,`RPC '${t}' ${s} timed out`),o(new ht(Ue.DEADLINE_EXCEEDED,"Request time out"));break;case o_.HTTP_ERROR:const h=l.getStatus();if(dt(is,`RPC '${t}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const f=function(g){const v=g.toLowerCase().replace(/_/g,"-");return Object.values(Ue).indexOf(v)>=0?v:Ue.UNKNOWN}(p.status);o(new ht(f,p.message))}else o(new ht(Ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ht(Ue.UNAVAILABLE,"Connection failed."));break;default:Ft()}}finally{dt(is,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(n);dt(is,`RPC '${t}' ${s} sending request:`,n),l.send(r,"POST",c,i,15)})}Oo(t,r,i){const n=_P(),s=[this.wo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=T$(),o=E$(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new b$({})),this.Fo(l.initMessageHeaders,r,i),l.encodeInitMessageHeaders=!0;const u=s.join("");dt(is,`Creating RPC '${t}' stream ${n}: ${u}`,l);const h=a.createWebChannel(u,l);let d=!1,p=!1;const f=new qke({lo:g=>{p?dt(is,`Not sending because RPC '${t}' stream ${n} is closed:`,g):(d||(dt(is,`Opening RPC '${t}' stream ${n} transport.`),h.open(),d=!0),dt(is,`RPC '${t}' stream ${n} sending:`,g),h.send(g))},ho:()=>h.close()}),m=(g,v,y)=>{g.listen(v,w=>{try{y(w)}catch(b){setTimeout(()=>{throw b},0)}})};return m(h,Ry.EventType.OPEN,()=>{p||(dt(is,`RPC '${t}' stream ${n} transport opened.`),f.mo())}),m(h,Ry.EventType.CLOSE,()=>{p||(p=!0,dt(is,`RPC '${t}' stream ${n} transport closed`),f.po())}),m(h,Ry.EventType.ERROR,g=>{p||(p=!0,bg(is,`RPC '${t}' stream ${n} transport errored:`,g),f.po(new ht(Ue.UNAVAILABLE,"The operation could not be completed")))}),m(h,Ry.EventType.MESSAGE,g=>{var v;if(!p){const y=g.data[0];qr(!!y);const w=y,b=w.error||((v=w[0])===null||v===void 0?void 0:v.error);if(b){dt(is,`RPC '${t}' stream ${n} received error:`,b);const E=b.status;let _=function(A){const T=ji[A];if(T!==void 0)return K$(T)}(E),C=b.message;_===void 0&&(_=Ue.INTERNAL,C="Unknown error status: "+E+" with message "+b.message),p=!0,f.po(new ht(_,C)),h.close()}else dt(is,`RPC '${t}' stream ${n} received:`,y),f.yo(y)}}),m(o,S$.STAT_EVENT,g=>{g.stat===oO.PROXY?dt(is,`RPC '${t}' stream ${n} detected buffering proxy`):g.stat===oO.NOPROXY&&dt(is,`RPC '${t}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{f.fo()},0),f}}function SP(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(e){return new nke(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{constructor(t,r,i=1e3,n=1.5,s=6e4){this.oi=t,this.timerId=r,this.No=i,this.Lo=n,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(t){this.cancel();const r=Math.floor(this.ko+this.Uo()),i=Math.max(0,Date.now()-this.Qo),n=Math.max(0,r-i);n>0&&dt("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.ko} ms, delay with jitter: ${r} ms, last attempt: ${i} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,n,()=>(this.Qo=Date.now(),t())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uQ{constructor(t,r,i,n,s,a,o,l){this.oi=t,this.Go=i,this.zo=n,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new cQ(t,r)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(t){this.s_(),this.stream.send(t)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(t,r){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,t!==4?this.Yo.reset():r&&r.code===Ue.RESOURCE_EXHAUSTED?(du(r.toString()),du("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):r&&r.code===Ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ao(r)}__(){}auth(){this.state=1;const t=this.a_(this.jo),r=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,n])=>{this.jo===r&&this.u_(i,n)},i=>{t(()=>{const n=new ht(Ue.UNKNOWN,"Fetching auth token failed: "+i.message);return this.c_(n)})})}u_(t,r){const i=this.a_(this.jo);this.stream=this.l_(t,r),this.stream.Po(()=>{i(()=>this.listener.Po())}),this.stream.To(()=>{i(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(n=>{i(()=>this.c_(n))}),this.stream.onMessage(n=>{i(()=>this.onMessage(n))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(t){return dt("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}a_(t){return r=>{this.oi.enqueueAndForget(()=>this.jo===t?r():(dt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Xke extends uQ{constructor(t,r,i,n,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s}l_(t,r){return this.connection.Oo("Listen",t,r)}onMessage(t){this.Yo.reset();const r=oke(this.serializer,t),i=function(s){if(!("targetChange"in s))return Gt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Gt.min():a.readTime?Ul(a.readTime):Gt.min()}(t);return this.listener.h_(r,i)}P_(t){const r={};r.database=vO(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=hO(l)?{documents:uke(s,l)}:{query:hke(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=eQ(s,a.resumeToken);const c=fO(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Gt.min())>0){o.readTime=uE(s,a.snapshotVersion.toTimestamp());const c=fO(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const i=pke(this.serializer,t);i&&(r.labels=i),this.i_(r)}I_(t){const r={};r.database=vO(this.serializer),r.removeTarget=t,this.i_(r)}}class $ke extends uQ{constructor(t,r,i,n,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(t,r){return this.connection.Oo("Write",t,r)}onMessage(t){if(qr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.T_){this.Yo.reset();const r=cke(t.writeResults,t.commitTime),i=Ul(t.commitTime);return this.listener.A_(i,r)}return qr(!t.writeResults||t.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const t={};t.database=vO(this.serializer),this.i_(t)}d_(t){const r={streamToken:this.lastStreamToken,writes:t.map(i=>lke(this.serializer,i))};this.i_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qke extends class{}{constructor(t,r,i,n){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=i,this.serializer=n,this.m_=!1}f_(){if(this.m_)throw new ht(Ue.FAILED_PRECONDITION,"The client has already been terminated.")}Co(t,r,i,n){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(t,mO(r,i),n,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ht(Ue.UNKNOWN,s.toString())})}xo(t,r,i,n,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.xo(t,mO(r,i),n,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ht(Ue.UNKNOWN,a.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class Kke{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(t){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.S_("Offline")))}set(t){this.C_(),this.g_=0,t==="Online"&&(this.y_=!1),this.S_(t)}S_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}b_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(du(r),this.y_=!1):dt("OnlineStateTracker",r)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zke{constructor(t,r,i,n,s){this.localStore=t,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(a=>{i.enqueueAndForget(async()=>{Zp(this)&&(dt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Xt(l);c.M_.add(4),await ix(c),c.N_.set("Unknown"),c.M_.delete(4),await KT(c)}(this))})}),this.N_=new Kke(i,n)}}async function KT(e){if(Zp(e))for(const t of e.x_)await t(!0)}async function ix(e){for(const t of e.x_)await t(!1)}function hQ(e,t){const r=Xt(e);r.F_.has(t.targetId)||(r.F_.set(t.targetId,t),wL(r)?yL(r):hv(r).Xo()&&vL(r,t))}function gL(e,t){const r=Xt(e),i=hv(r);r.F_.delete(t),i.Xo()&&dQ(r,t),r.F_.size===0&&(i.Xo()?i.n_():Zp(r)&&r.N_.set("Unknown"))}function vL(e,t){if(e.L_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Gt.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}hv(e).P_(t)}function dQ(e,t){e.L_.xe(t),hv(e).I_(t)}function yL(e){e.L_=new eke({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.F_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),hv(e).start(),e.N_.w_()}function wL(e){return Zp(e)&&!hv(e).Zo()&&e.F_.size>0}function Zp(e){return Xt(e).M_.size===0}function pQ(e){e.L_=void 0}async function Jke(e){e.N_.set("Online")}async function eLe(e){e.F_.forEach((t,r)=>{vL(e,t)})}async function tLe(e,t){pQ(e),wL(e)?(e.N_.D_(t),yL(e)):e.N_.set("Unknown")}async function rLe(e,t,r){if(e.N_.set("Online"),t instanceof J$&&t.state===2&&t.cause)try{await async function(n,s){const a=s.cause;for(const o of s.targetIds)n.F_.has(o)&&(await n.remoteSyncer.rejectListen(o,a),n.F_.delete(o),n.L_.removeTarget(o))}(e,t)}catch(i){dt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),await hE(e,i)}else if(t instanceof u_?e.L_.Ke(t):t instanceof Z$?e.L_.He(t):e.L_.We(t),!r.isEqual(Gt.min()))try{const i=await lQ(e.localStore);r.compareTo(i)>=0&&await function(s,a){const o=s.L_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.F_.get(c);u&&s.F_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.F_.get(l);if(!u)return;s.F_.set(l,u.withResumeToken(ys.EMPTY_BYTE_STRING,u.snapshotVersion)),dQ(s,l);const h=new gh(u.target,l,c,u.sequenceNumber);vL(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(i){dt("RemoteStore","Failed to raise snapshot:",i),await hE(e,i)}}async function hE(e,t,r){if(!Jw(t))throw t;e.M_.add(1),await ix(e),e.N_.set("Offline"),r||(r=()=>lQ(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{dt("RemoteStore","Retrying IndexedDB access"),await r(),e.M_.delete(1),await KT(e)})}function fQ(e,t){return t().catch(r=>hE(e,r,t))}async function ZT(e){const t=Xt(e),r=Xh(t);let i=t.v_.length>0?t.v_[t.v_.length-1].batchId:-1;for(;iLe(t);)try{const n=await Uke(t.localStore,i);if(n===null){t.v_.length===0&&r.n_();break}i=n.batchId,nLe(t,n)}catch(n){await hE(t,n)}mQ(t)&&gQ(t)}function iLe(e){return Zp(e)&&e.v_.length<10}function nLe(e,t){e.v_.push(t);const r=Xh(e);r.Xo()&&r.E_&&r.d_(t.mutations)}function mQ(e){return Zp(e)&&!Xh(e).Zo()&&e.v_.length>0}function gQ(e){Xh(e).start()}async function sLe(e){Xh(e).V_()}async function aLe(e){const t=Xh(e);for(const r of e.v_)t.d_(r.mutations)}async function oLe(e,t,r){const i=e.v_.shift(),n=uL.from(i,t,r);await fQ(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await ZT(e)}async function lLe(e,t){t&&Xh(e).E_&&await async function(i,n){if(function(a){return K3e(a)&&a!==Ue.ABORTED}(n.code)){const s=i.v_.shift();Xh(i).t_(),await fQ(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,n)),await ZT(i)}}(e,t),mQ(e)&&gQ(e)}async function a6(e,t){const r=Xt(e);r.asyncQueue.verifyOperationInProgress(),dt("RemoteStore","RemoteStore received new credentials");const i=Zp(r);r.M_.add(3),await ix(r),i&&r.N_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.M_.delete(3),await KT(r)}async function cLe(e,t){const r=Xt(e);t?(r.M_.delete(2),await KT(r)):t||(r.M_.add(2),await ix(r),r.N_.set("Unknown"))}function hv(e){return e.B_||(e.B_=function(r,i,n){const s=Xt(r);return s.f_(),new Xke(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Po:Jke.bind(null,e),To:eLe.bind(null,e),Ao:tLe.bind(null,e),h_:rLe.bind(null,e)}),e.x_.push(async t=>{t?(e.B_.t_(),wL(e)?yL(e):e.N_.set("Unknown")):(await e.B_.stop(),pQ(e))})),e.B_}function Xh(e){return e.k_||(e.k_=function(r,i,n){const s=Xt(r);return s.f_(),new $ke(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Po:()=>Promise.resolve(),To:sLe.bind(null,e),Ao:lLe.bind(null,e),R_:aLe.bind(null,e),A_:oLe.bind(null,e)}),e.x_.push(async t=>{t?(e.k_.t_(),await ZT(e)):(await e.k_.stop(),e.v_.length>0&&(dt("RemoteStore",`Stopping write stream with ${e.v_.length} pending writes`),e.v_=[]))})),e.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(t,r,i,n,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=i,this.op=n,this.removalCallback=s,this.deferred=new Kc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,i,n,s){const a=Date.now()+i,o=new xL(t,r,a,n,s);return o.start(i),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ht(Ue.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bL(e,t){if(du("AsyncQueue",`${t}: ${e}`),Jw(e))return new ht(Ue.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(t){this.comparator=t?(r,i)=>t(r,i)||Et.comparator(r.key,i.key):(r,i)=>Et.comparator(r.key,i.key),this.keyedMap=ky(),this.sortedSet=new mi(this.comparator)}static emptySet(t){return new qm(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,i)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof qm)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(!n.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const i=new qm;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=r,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(){this.q_=new mi(Et.comparator)}track(t){const r=t.doc.key,i=this.q_.get(r);i?t.type!==0&&i.type===3?this.q_=this.q_.insert(r,t):t.type===3&&i.type!==1?this.q_=this.q_.insert(r,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.q_=this.q_.insert(r,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.q_=this.q_.insert(r,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.q_=this.q_.remove(r):t.type===1&&i.type===2?this.q_=this.q_.insert(r,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.q_=this.q_.insert(r,{type:2,doc:t.doc}):Ft():this.q_=this.q_.insert(r,t)}Q_(){const t=[];return this.q_.inorderTraversal((r,i)=>{t.push(i)}),t}}class Cg{constructor(t,r,i,n,s,a,o,l,c){this.query=t,this.docs=r,this.oldDocs=i,this.docChanges=n,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,i,n,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Cg(t,r,qm.emptySet(r),a,i,n,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&GT(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,i=t.docChanges;if(r.length!==i.length)return!1;for(let n=0;n<r.length;n++)if(r[n].type!==i[n].type||!r[n].doc.isEqual(i[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uLe{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(t=>t.G_())}}class hLe{constructor(){this.queries=new uv(t=>B$(t),GT),this.onlineState="Unknown",this.z_=new Set}}async function vQ(e,t){const r=Xt(e);let i=3;const n=t.query;let s=r.queries.get(n);s?!s.W_()&&t.G_()&&(i=2):(s=new uLe,i=t.G_()?0:1);try{switch(i){case 0:s.K_=await r.onListen(n,!0);break;case 1:s.K_=await r.onListen(n,!1);break;case 2:await r.onFirstRemoteStoreListen(n)}}catch(a){const o=bL(a,`Initialization of query '${Kf(t.query)}' failed`);return void t.onError(o)}r.queries.set(n,s),s.U_.push(t),t.j_(r.onlineState),s.K_&&t.H_(s.K_)&&_L(r)}async function yQ(e,t){const r=Xt(e),i=t.query;let n=3;const s=r.queries.get(i);if(s){const a=s.U_.indexOf(t);a>=0&&(s.U_.splice(a,1),s.U_.length===0?n=t.G_()?0:1:!s.W_()&&t.G_()&&(n=2))}switch(n){case 0:return r.queries.delete(i),r.onUnlisten(i,!0);case 1:return r.queries.delete(i),r.onUnlisten(i,!1);case 2:return r.onLastRemoteStoreUnlisten(i);default:return}}function dLe(e,t){const r=Xt(e);let i=!1;for(const n of t){const s=n.query,a=r.queries.get(s);if(a){for(const o of a.U_)o.H_(n)&&(i=!0);a.K_=n}}i&&_L(r)}function pLe(e,t,r){const i=Xt(e),n=i.queries.get(t);if(n)for(const s of n.U_)s.onError(r);i.queries.delete(t)}function _L(e){e.z_.forEach(t=>{t.next()})}var wO,l6;(l6=wO||(wO={})).J_="default",l6.Cache="cache";class wQ{constructor(t,r,i){this.query=t,this.Y_=r,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=i||{}}H_(t){if(!this.options.includeMetadataChanges){const i=[];for(const n of t.docChanges)n.type!==3&&i.push(n);t=new Cg(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.Z_?this.ea(t)&&(this.Y_.next(t),r=!0):this.ta(t,this.onlineState)&&(this.na(t),r=!0),this.X_=t,r}onError(t){this.Y_.error(t)}j_(t){this.onlineState=t;let r=!1;return this.X_&&!this.Z_&&this.ta(this.X_,t)&&(this.na(this.X_),r=!0),r}ta(t,r){if(!t.fromCache||!this.G_())return!0;const i=r!=="Offline";return(!this.options.ra||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ea(t){if(t.docChanges.length>0)return!0;const r=this.X_&&this.X_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}na(t){t=Cg.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Z_=!0,this.Y_.next(t)}G_(){return this.options.source!==wO.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xQ{constructor(t){this.key=t}}class bQ{constructor(t){this.key=t}}class fLe{constructor(t,r){this.query=t,this.la=r,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=ar(),this.mutatedKeys=ar(),this.Ia=F$(t),this.Ta=new qm(this.Ia)}get Ea(){return this.la}da(t,r){const i=r?r.Aa:new o6,n=r?r.Ta:this.Ta;let s=r?r.mutatedKeys:this.mutatedKeys,a=n,o=!1;const l=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,c=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(t.inorderTraversal((u,h)=>{const d=n.get(u),p=qT(this.query,h)?h:null,f=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;d&&p?d.data.isEqual(p.data)?f!==m&&(i.track({type:3,doc:p}),g=!0):this.Ra(d,p)||(i.track({type:2,doc:p}),g=!0,(l&&this.Ia(p,l)>0||c&&this.Ia(p,c)<0)&&(o=!0)):!d&&p?(i.track({type:0,doc:p}),g=!0):d&&!p&&(i.track({type:1,doc:d}),g=!0,(l||c)&&(o=!0)),g&&(p?(a=a.add(p),s=m?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{Ta:a,Aa:i,Xi:o,mutatedKeys:s}}Ra(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,i,n){const s=this.Ta;this.Ta=t.Ta,this.mutatedKeys=t.mutatedKeys;const a=t.Aa.Q_();a.sort((u,h)=>function(p,f){const m=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ft()}};return m(p)-m(f)}(u.type,h.type)||this.Ia(u.doc,h.doc)),this.Va(i),n=n!=null&&n;const o=r&&!n?this.ma():[],l=this.Pa.size===0&&this.current&&!n?1:0,c=l!==this.ha;return this.ha=l,a.length!==0||c?{snapshot:new Cg(this.query,t.Ta,s,a,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),fa:o}:{fa:o}}j_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new o6,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(t){return!this.la.has(t)&&!!this.Ta.has(t)&&!this.Ta.get(t).hasLocalMutations}Va(t){t&&(t.addedDocuments.forEach(r=>this.la=this.la.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.la=this.la.delete(r)),this.current=t.current)}ma(){if(!this.current)return[];const t=this.Pa;this.Pa=ar(),this.Ta.forEach(i=>{this.ga(i.key)&&(this.Pa=this.Pa.add(i.key))});const r=[];return t.forEach(i=>{this.Pa.has(i)||r.push(new bQ(i))}),this.Pa.forEach(i=>{t.has(i)||r.push(new xQ(i))}),r}pa(t){this.la=t.hs,this.Pa=ar();const r=this.da(t.documents);return this.applyChanges(r,!0)}ya(){return Cg.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class mLe{constructor(t,r,i){this.query=t,this.targetId=r,this.view=i}}class gLe{constructor(t){this.key=t,this.wa=!1}}class vLe{constructor(t,r,i,n,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=i,this.sharedClientState=n,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Sa={},this.ba=new uv(o=>B$(o),GT),this.Da=new Map,this.Ca=new Set,this.va=new mi(Et.comparator),this.Fa=new Map,this.Ma=new pL,this.xa={},this.Oa=new Map,this.Na=Tg.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function yLe(e,t,r=!0){const i=AQ(e);let n;const s=i.ba.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.ya()):n=await _Q(i,t,r,!0),n}async function wLe(e,t){const r=AQ(e);await _Q(r,t,!0,!1)}async function _Q(e,t,r,i){const n=await jke(e.localStore,Fl(t)),s=n.targetId,a=r?e.sharedClientState.addLocalQueryTarget(s):"not-current";let o;return i&&(o=await xLe(e,t,s,a==="current",n.resumeToken)),e.isPrimaryClient&&r&&hQ(e.remoteStore,n),o}async function xLe(e,t,r,i,n){e.Ba=(h,d,p)=>async function(m,g,v,y){let w=g.view.da(v);w.Xi&&(w=await i6(m.localStore,g.query,!1).then(({documents:C})=>g.view.da(C,w)));const b=y&&y.targetChanges.get(g.targetId),E=y&&y.targetMismatches.get(g.targetId)!=null,_=g.view.applyChanges(w,m.isPrimaryClient,b,E);return u6(m,g.targetId,_.fa),_.snapshot}(e,h,d,p);const s=await i6(e.localStore,t,!0),a=new fLe(t,s.hs),o=a.da(s.documents),l=rx.createSynthesizedTargetChangeForCurrentChange(r,i&&e.onlineState!=="Offline",n),c=a.applyChanges(o,e.isPrimaryClient,l);u6(e,r,c.fa);const u=new mLe(t,r,a);return e.ba.set(t,u),e.Da.has(r)?e.Da.get(r).push(t):e.Da.set(r,[t]),c.snapshot}async function bLe(e,t,r){const i=Xt(e),n=i.ba.get(t),s=i.Da.get(n.targetId);if(s.length>1)return i.Da.set(n.targetId,s.filter(a=>!GT(a,t))),void i.ba.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await yO(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),r&&gL(i.remoteStore,n.targetId),xO(i,n.targetId)}).catch(Zw)):(xO(i,n.targetId),await yO(i.localStore,n.targetId,!0))}async function _Le(e,t){const r=Xt(e),i=r.ba.get(t),n=r.Da.get(i.targetId);r.isPrimaryClient&&n.length===1&&(r.sharedClientState.removeLocalQueryTarget(i.targetId),gL(r.remoteStore,i.targetId))}async function SLe(e,t,r){const i=DLe(e);try{const n=await function(a,o){const l=Xt(a),c=Yr.now(),u=o.reduce((p,f)=>p.add(f.key),ar());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let f=pu(),m=ar();return l.os.getEntries(p,u).next(g=>{f=g,f.forEach((v,y)=>{y.isValidDocument()||(m=m.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,f)).next(g=>{h=g;const v=[];for(const y of o){const w=q3e(y,h.get(y.key).overlayedDocument);w!=null&&v.push(new ad(y.key,w,D$(w.value.mapValue),io.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,v,o)}).next(g=>{d=g;const v=g.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(p,g.batchId,v)})}).then(()=>({batchId:d.batchId,changes:j$(h)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(n.batchId),function(a,o,l){let c=a.xa[a.currentUser.toKey()];c||(c=new mi(br)),c=c.insert(o,l),a.xa[a.currentUser.toKey()]=c}(i,n.batchId,r),await nx(i,n.changes),await ZT(i.remoteStore)}catch(n){const s=bL(n,"Failed to persist write");r.reject(s)}}async function SQ(e,t){const r=Xt(e);try{const i=await Bke(r.localStore,t);t.targetChanges.forEach((n,s)=>{const a=r.Fa.get(s);a&&(qr(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1),n.addedDocuments.size>0?a.wa=!0:n.modifiedDocuments.size>0?qr(a.wa):n.removedDocuments.size>0&&(qr(a.wa),a.wa=!1))}),await nx(r,i,t)}catch(i){await Zw(i)}}function c6(e,t,r){const i=Xt(e);if(i.isPrimaryClient&&r===0||!i.isPrimaryClient&&r===1){const n=[];i.ba.forEach((s,a)=>{const o=a.view.j_(t);o.snapshot&&n.push(o.snapshot)}),function(a,o){const l=Xt(a);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.U_)d.j_(o)&&(c=!0)}),c&&_L(l)}(i.eventManager,t),n.length&&i.Sa.h_(n),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function ELe(e,t,r){const i=Xt(e);i.sharedClientState.updateQueryState(t,"rejected",r);const n=i.Fa.get(t),s=n&&n.key;if(s){let a=new mi(Et.comparator);a=a.insert(s,cs.newNoDocument(s,Gt.min()));const o=ar().add(s),l=new $T(Gt.min(),new Map,new mi(br),a,o);await SQ(i,l),i.va=i.va.remove(s),i.Fa.delete(t),SL(i)}else await yO(i.localStore,t,!1).then(()=>xO(i,t,r)).catch(Zw)}async function TLe(e,t){const r=Xt(e),i=t.batch.batchId;try{const n=await zke(r.localStore,t);TQ(r,i,null),EQ(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),await nx(r,n)}catch(n){await Zw(n)}}async function CLe(e,t,r){const i=Xt(e);try{const n=await function(a,o){const l=Xt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(qr(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(i.localStore,t);TQ(i,t,r),EQ(i,t),i.sharedClientState.updateMutationState(t,"rejected",r),await nx(i,n)}catch(n){await Zw(n)}}function EQ(e,t){(e.Oa.get(t)||[]).forEach(r=>{r.resolve()}),e.Oa.delete(t)}function TQ(e,t,r){const i=Xt(e);let n=i.xa[i.currentUser.toKey()];if(n){const s=n.get(t);s&&(r?s.reject(r):s.resolve(),n=n.remove(t)),i.xa[i.currentUser.toKey()]=n}}function xO(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Da.get(t))e.ba.delete(i),r&&e.Sa.ka(i,r);e.Da.delete(t),e.isPrimaryClient&&e.Ma.Vr(t).forEach(i=>{e.Ma.containsKey(i)||CQ(e,i)})}function CQ(e,t){e.Ca.delete(t.path.canonicalString());const r=e.va.get(t);r!==null&&(gL(e.remoteStore,r),e.va=e.va.remove(t),e.Fa.delete(r),SL(e))}function u6(e,t,r){for(const i of r)i instanceof xQ?(e.Ma.addReference(i.key,t),ALe(e,i)):i instanceof bQ?(dt("SyncEngine","Document no longer in limbo: "+i.key),e.Ma.removeReference(i.key,t),e.Ma.containsKey(i.key)||CQ(e,i.key)):Ft()}function ALe(e,t){const r=t.key,i=r.path.canonicalString();e.va.get(r)||e.Ca.has(i)||(dt("SyncEngine","New document in limbo: "+r),e.Ca.add(i),SL(e))}function SL(e){for(;e.Ca.size>0&&e.va.size<e.maxConcurrentLimboResolutions;){const t=e.Ca.values().next().value;e.Ca.delete(t);const r=new Et(ei.fromString(t)),i=e.Na.next();e.Fa.set(i,new gLe(r)),e.va=e.va.insert(r,i),hQ(e.remoteStore,new gh(Fl(lL(r.path)),i,"TargetPurposeLimboResolution",rL.oe))}}async function nx(e,t,r){const i=Xt(e),n=[],s=[],a=[];i.ba.isEmpty()||(i.ba.forEach((o,l)=>{a.push(i.Ba(l,t,r).then(c=>{if((c||r)&&i.isPrimaryClient){const u=c&&!c.fromCache;i.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){n.push(c);const u=mL.Ki(l.targetId,c);s.push(u)}}))}),await Promise.all(a),i.Sa.h_(n),await async function(l,c){const u=Xt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>We.forEach(c,d=>We.forEach(d.qi,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>We.forEach(d.Qi,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Jw(h))throw h;dt("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.ns.get(d),f=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(f);u.ns=u.ns.insert(d,m)}}}(i.localStore,s))}async function MLe(e,t){const r=Xt(e);if(!r.currentUser.isEqual(t)){dt("SyncEngine","User change. New user:",t.toKey());const i=await oQ(r.localStore,t);r.currentUser=t,function(s,a){s.Oa.forEach(o=>{o.forEach(l=>{l.reject(new ht(Ue.CANCELLED,a))})}),s.Oa.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await nx(r,i.us)}}function PLe(e,t){const r=Xt(e),i=r.Fa.get(t);if(i&&i.wa)return ar().add(i.key);{let n=ar();const s=r.Da.get(t);if(!s)return n;for(const a of s){const o=r.ba.get(a);n=n.unionWith(o.view.Ea)}return n}}function AQ(e){const t=Xt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=SQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=PLe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ELe.bind(null,t),t.Sa.h_=dLe.bind(null,t.eventManager),t.Sa.ka=pLe.bind(null,t.eventManager),t}function DLe(e){const t=Xt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=TLe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=CLe.bind(null,t),t}class h6{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=QT(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return Nke(this.persistence,new kke,t.initialUser,this.serializer)}createPersistence(t){return new Ike(fL.Hr,this.serializer)}createSharedClientState(t){return new Hke}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ILe{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>c6(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=MLe.bind(null,this.syncEngine),await cLe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new hLe}()}createDatastore(t){const r=QT(t.databaseInfo.databaseId),i=function(s){return new Yke(s)}(t.databaseInfo);return function(s,a,o,l){return new Qke(s,a,o,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,n,s,a,o){return new Zke(i,n,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>c6(this.syncEngine,r,0),function(){return s6.D()?new s6:new Wke}())}createSyncEngine(t,r){return function(n,s,a,o,l,c,u){const h=new vLe(n,s,a,o,l,c);return u&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t;await async function(i){const n=Xt(i);dt("RemoteStore","RemoteStore shutting down."),n.M_.add(5),await ix(n),n.O_.shutdown(),n.N_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MQ{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ka(this.observer.next,t)}error(t){this.observer.error?this.Ka(this.observer.error,t):du("Uncaught Error in snapshot listener:",t.toString())}$a(){this.muted=!0}Ka(t,r){this.muted||setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OLe{constructor(t,r,i,n){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=n,this.user=ss.UNAUTHENTICATED,this.clientId=A$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async s=>{dt("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(dt("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ht(Ue.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Kc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=bL(r,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function EP(e,t){e.asyncQueue.verifyOperationInProgress(),dt("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let i=r.initialUser;e.setCredentialChangeListener(async n=>{i.isEqual(n)||(await oQ(t.localStore,n),i=n)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function d6(e,t){e.asyncQueue.verifyOperationInProgress();const r=await kLe(e);dt("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(i=>a6(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,n)=>a6(t.remoteStore,n)),e._onlineComponents=t}function RLe(e){return e.name==="FirebaseError"?e.code===Ue.FAILED_PRECONDITION||e.code===Ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function kLe(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){dt("FirestoreClient","Using user provided OfflineComponentProvider");try{await EP(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!RLe(r))throw r;bg("Error using user provided cache. Falling back to memory cache: "+r),await EP(e,new h6)}}else dt("FirestoreClient","Using default OfflineComponentProvider"),await EP(e,new h6);return e._offlineComponents}async function PQ(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(dt("FirestoreClient","Using user provided OnlineComponentProvider"),await d6(e,e._uninitializedComponentsProvider._online)):(dt("FirestoreClient","Using default OnlineComponentProvider"),await d6(e,new ILe))),e._onlineComponents}function LLe(e){return PQ(e).then(t=>t.syncEngine)}async function DQ(e){const t=await PQ(e),r=t.eventManager;return r.onListen=yLe.bind(null,t.syncEngine),r.onUnlisten=bLe.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=wLe.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=_Le.bind(null,t.syncEngine),r}function NLe(e,t,r={}){const i=new Kc;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new MQ({next:d=>{a.enqueueAndForget(()=>yQ(s,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new ht(Ue.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new ht(Ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new wQ(lL(o.path),u,{includeMetadataChanges:!0,ra:!0});return vQ(s,h)}(await DQ(e),e.asyncQueue,t,r,i)),i.promise}function zLe(e,t,r={}){const i=new Kc;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new MQ({next:d=>{a.enqueueAndForget(()=>yQ(s,h)),d.fromCache&&l.source==="server"?c.reject(new ht(Ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new wQ(o,u,{includeMetadataChanges:!0,ra:!0});return vQ(s,h)}(await DQ(e),e.asyncQueue,t,r,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IQ(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p6=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OQ(e,t,r){if(!r)throw new ht(Ue.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function BLe(e,t,r,i){if(t===!0&&i===!0)throw new ht(Ue.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function f6(e){if(!Et.isDocumentKey(e))throw new ht(Ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function m6(e){if(Et.isDocumentKey(e))throw new ht(Ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function JT(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Ft()}function Yo(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ht(Ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=JT(e);throw new ht(Ue.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(t){var r,i;if(t.host===void 0){if(t.ssl!==void 0)throw new ht(Ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new ht(Ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}BLe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IQ((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ht(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ht(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ht(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,n){return i.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class eC{constructor(t,r,i,n){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=i,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new g6({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ht(Ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new ht(Ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new g6(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new t3e;switch(i.type){case"firstParty":return new s3e(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ht(Ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const i=p6.get(r);i&&(dt("ComponentProvider","Removing Datastore"),p6.delete(r),i.terminate())}(this),Promise.resolve()}}function FLe(e,t,r,i={}){var n;const s=(e=Yo(e,eC))._getSettings(),a=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&bg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),i.mockUserToken){let o,l;if(typeof i.mockUserToken=="string")o=i.mockUserToken,l=ss.MOCK_USER;else{o=zX(i.mockUserToken,(n=e._app)===null||n===void 0?void 0:n.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new ht(Ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ss(c)}e._authCredentials=new r3e(new C$(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(t,r,i){this.converter=r,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new dv(this.firestore,t,this._query)}}class Fs{constructor(t,r,i){this.converter=r,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nh(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Fs(this.firestore,t,this._key)}}class Nh extends dv{constructor(t,r,i){super(t,r,lL(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Fs(this.firestore,null,new Et(t))}withConverter(t){return new Nh(this.firestore,t,this._path)}}function hs(e,t,...r){if(e=Ki(e),OQ("collection","path",t),e instanceof eC){const i=ei.fromString(t,...r);return m6(i),new Nh(e,null,i)}{if(!(e instanceof Fs||e instanceof Nh))throw new ht(Ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ei.fromString(t,...r));return m6(i),new Nh(e.firestore,null,i)}}function Ql(e,t,...r){if(e=Ki(e),arguments.length===1&&(t=A$.newId()),OQ("doc","path",t),e instanceof eC){const i=ei.fromString(t,...r);return f6(i),new Fs(e,null,new Et(i))}{if(!(e instanceof Fs||e instanceof Nh))throw new ht(Ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(ei.fromString(t,...r));return f6(i),new Fs(e.firestore,e instanceof Nh?e.converter:null,new Et(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ULe{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new cQ(this,"async_queue_retry"),this.hu=()=>{const r=SP();r&&dt("AsyncQueue","Visibility state changed to "+r.visibilityState),this.Yo.Wo()};const t=SP();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Pu(),this.Iu(t)}enterRestrictedMode(t){if(!this.ou){this.ou=!0,this.cu=t||!1;const r=SP();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.hu)}}enqueue(t){if(this.Pu(),this.ou)return new Promise(()=>{});const r=new Kc;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.su.push(t),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(t){if(!Jw(t))throw t;dt("AsyncQueue","Operation failed with retryable error: "+t)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(t){const r=this.iu.then(()=>(this.uu=!0,t().catch(i=>{this.au=i,this.uu=!1;const n=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(i);throw du("INTERNAL UNHANDLED ERROR: ",n),i}).then(i=>(this.uu=!1,i))));return this.iu=r,r}enqueueAfterDelay(t,r,i){this.Pu(),this.lu.indexOf(t)>-1&&(r=0);const n=xL.createAndSchedule(this,t,r,i,s=>this.Eu(s));return this._u.push(n),n}Pu(){this.au&&Ft()}verifyOperationInProgress(){}async du(){let t;do t=this.iu,await t;while(t!==this.iu)}Au(t){for(const r of this._u)if(r.timerId===t)return!0;return!1}Ru(t){return this.du().then(()=>{this._u.sort((r,i)=>r.targetTimeMs-i.targetTimeMs);for(const r of this._u)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.du()})}Vu(t){this.lu.push(t)}Eu(t){const r=this._u.indexOf(t);this._u.splice(r,1)}}class Jp extends eC{constructor(t,r,i,n){super(t,r,i,n),this.type="firestore",this._queue=function(){return new ULe}(),this._persistenceKey=(n==null?void 0:n.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||RQ(this),this._firestoreClient.terminate()}}function jLe(e,t){const r=typeof e=="object"?e:Hk(),i=typeof e=="string"?e:t||"(default)",n=BT(r,"firestore").getImmediate({identifier:i});if(!n._initialized){const s=kX("firestore");s&&FLe(n,...s)}return n}function EL(e){return e._firestoreClient||RQ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function RQ(e){var t,r,i;const n=e._freezeSettings(),s=function(o,l,c,u){return new y3e(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,IQ(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new OLe(e._authCredentials,e._appCheckCredentials,e._queue,s),!((r=n.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((i=n.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:n.localCache.kind,_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ag(ys.fromBase64String(t))}catch(r){throw new ht(Ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Ag(ys.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new ht(Ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new ht(Ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new ht(Ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return br(this._lat,t._lat)||br(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VLe=/^__.*__$/;class HLe{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return this.fieldMask!==null?new ad(t,this.data,this.fieldMask,r,this.fieldTransforms):new tx(t,this.data,r,this.fieldTransforms)}}class kQ{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return new ad(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function LQ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ft()}}class CL{constructor(t,r,i,n,s,a){this.settings=t,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=n,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(t){return new CL(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.gu({path:i,yu:!1});return n.wu(t),n}Su(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.gu({path:i,yu:!1});return n.mu(),n}bu(t){return this.gu({path:void 0,yu:!0})}Du(t){return dE(t,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}mu(){if(this.path)for(let t=0;t<this.path.length;t++)this.wu(this.path.get(t))}wu(t){if(t.length===0)throw this.Du("Document fields must not be empty");if(LQ(this.fu)&&VLe.test(t))throw this.Du('Document fields cannot begin and end with "__"')}}class WLe{constructor(t,r,i){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=i||QT(t)}Fu(t,r,i,n=!1){return new CL({fu:t,methodName:r,vu:i,path:Vn.emptyPath(),yu:!1,Cu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iC(e){const t=e._freezeSettings(),r=QT(e._databaseId);return new WLe(e._databaseId,!!t.ignoreUndefinedProperties,r)}function NQ(e,t,r,i,n,s={}){const a=e.Fu(s.merge||s.mergeFields?2:0,t,r,n);ML("Data must be an object, but it was:",a,i);const o=zQ(i,a);let l,c;if(s.merge)l=new _a(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=bO(t,h,r);if(!a.contains(d))throw new ht(Ue.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);FQ(u,d)||u.push(d)}l=new _a(u),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new HLe(new ta(o),l,c)}class nC extends rC{_toFieldTransform(t){if(t.fu!==2)throw t.fu===1?t.Du(`${this._methodName}() can only appear at the top level of your update data`):t.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof nC}}class AL extends rC{_toFieldTransform(t){return new V3e(t.path,new uw)}isEqual(t){return t instanceof AL}}function GLe(e,t,r,i){const n=e.Fu(1,t,r);ML("Data must be an object, but it was:",n,i);const s=[],a=ta.empty();Kp(i,(l,c)=>{const u=PL(t,l,r);c=Ki(c);const h=n.Su(u);if(c instanceof nC)s.push(u);else{const d=sx(c,h);d!=null&&(s.push(u),a.set(u,d))}});const o=new _a(s);return new kQ(a,o,n.fieldTransforms)}function qLe(e,t,r,i,n,s){const a=e.Fu(1,t,r),o=[bO(t,i,r)],l=[n];if(s.length%2!=0)throw new ht(Ue.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(bO(t,s[d])),l.push(s[d+1]);const c=[],u=ta.empty();for(let d=o.length-1;d>=0;--d)if(!FQ(c,o[d])){const p=o[d];let f=l[d];f=Ki(f);const m=a.Su(p);if(f instanceof nC)c.push(p);else{const g=sx(f,m);g!=null&&(c.push(p),u.set(p,g))}}const h=new _a(c);return new kQ(u,h,a.fieldTransforms)}function YLe(e,t,r,i=!1){return sx(r,e.Fu(i?4:3,t))}function sx(e,t){if(BQ(e=Ki(e)))return ML("Unsupported field value:",t,e),zQ(e,t);if(e instanceof rC)return function(i,n){if(!LQ(n.fu))throw n.Du(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n.Du(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(n);s&&n.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.yu&&t.fu!==4)throw t.Du("Nested arrays are not supported");return function(i,n){const s=[];let a=0;for(const o of i){let l=sx(o,n.bu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(i,n){if((i=Ki(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return F3e(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Yr.fromDate(i);return{timestampValue:uE(n.serializer,s)}}if(i instanceof Yr){const s=new Yr(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:uE(n.serializer,s)}}if(i instanceof TL)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Ag)return{bytesValue:eQ(n.serializer,i._byteString)};if(i instanceof Fs){const s=n.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw n.Du(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:dL(i.firestore._databaseId||n.databaseId,i._key.path)}}throw n.Du(`Unsupported field value: ${JT(i)}`)}(e,t)}function zQ(e,t){const r={};return M$(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Kp(e,(i,n)=>{const s=sx(n,t.pu(i));s!=null&&(r[i]=s)}),{mapValue:{fields:r}}}function BQ(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Yr||e instanceof TL||e instanceof Ag||e instanceof Fs||e instanceof rC)}function ML(e,t,r){if(!BQ(r)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(r)){const i=JT(r);throw i==="an object"?t.Du(e+" a custom object"):t.Du(e+" "+i)}}function bO(e,t,r){if((t=Ki(t))instanceof tC)return t._internalPath;if(typeof t=="string")return PL(e,t);throw dE("Field path arguments must be of type string or ",e,!1,void 0,r)}const XLe=new RegExp("[~\\*/\\[\\]]");function PL(e,t,r){if(t.search(XLe)>=0)throw dE(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new tC(...t.split("."))._internalPath}catch{throw dE(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function dE(e,t,r,i,n){const s=i&&!i.isEmpty(),a=n!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new ht(Ue.INVALID_ARGUMENT,o+e+l)}function FQ(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UQ{constructor(t,r,i,n,s){this._firestore=t,this._userDataWriter=r,this._key=i,this._document=n,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new $Le(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(DL("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class $Le extends UQ{data(){return super.data()}}function DL(e,t){return typeof t=="string"?PL(e,t):t instanceof tC?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QLe(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new ht(Ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class IL{}class KLe extends IL{}function OL(e,t,...r){let i=[];t instanceof IL&&i.push(t),i=i.concat(r),function(s){const a=s.filter(l=>l instanceof RL).length,o=s.filter(l=>l instanceof sC).length;if(a>1||a>0&&o>0)throw new ht(Ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const n of i)e=n._apply(e);return e}class sC extends KLe{constructor(t,r,i){super(),this._field=t,this._op=r,this._value=i,this.type="where"}static _create(t,r,i){return new sC(t,r,i)}_apply(t){const r=this._parse(t);return jQ(t._query,r),new dv(t.firestore,t.converter,dO(t._query,r))}_parse(t){const r=iC(t.firestore);return function(s,a,o,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ht(Ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){y6(h,u);const p=[];for(const f of h)p.push(v6(l,s,f));d={arrayValue:{values:p}}}else d=v6(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||y6(h,u),d=YLe(o,a,h,u==="in"||u==="not-in");return qi.create(c,u,d)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function vh(e,t,r){const i=t,n=DL("where",e);return sC._create(n,i,r)}class RL extends IL{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new RL(t,r)}_parse(t){const r=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return r.length===1?r[0]:qo.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(n,s){let a=n;const o=s.getFlattenedFilters();for(const l of o)jQ(a,l),a=dO(a,l)}(t._query,r),new dv(t.firestore,t.converter,dO(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function v6(e,t,r){if(typeof(r=Ki(r))=="string"){if(r==="")throw new ht(Ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!z$(t)&&r.indexOf("/")!==-1)throw new ht(Ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const i=t.path.child(ei.fromString(r));if(!Et.isDocumentKey(i))throw new ht(Ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return U5(e,new Et(i))}if(r instanceof Fs)return U5(e,r._key);throw new ht(Ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${JT(r)}.`)}function y6(e,t){if(!Array.isArray(e)||e.length===0)throw new ht(Ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function jQ(e,t){const r=function(n,s){for(const a of n)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new ht(Ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ht(Ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class ZLe{convertValue(t,r="none"){switch(Ap(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Cp(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 10:return this.convertObject(t.mapValue,r);default:throw Ft()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const i={};return Kp(t,(n,s)=>{i[n]=this.convertValue(s,r)}),i}convertGeoPoint(t){return new TL(Vi(t.latitude),Vi(t.longitude))}convertArray(t,r){return(t.values||[]).map(i=>this.convertValue(i,r))}convertServerTimestamp(t,r){switch(r){case"previous":const i=nL(t);return i==null?null:this.convertValue(i,r);case"estimate":return this.convertTimestamp(ow(t));default:return null}}convertTimestamp(t){const r=Yh(t);return new Yr(r.seconds,r.nanos)}convertDocumentKey(t,r){const i=ei.fromString(t);qr(aQ(i));const n=new lw(i.get(1),i.get(3)),s=new Et(i.popFirst(5));return n.isEqual(r)||du(`Document ${s} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VQ(e,t,r){let i;return i=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class HQ extends UQ{constructor(t,r,i,n,s,a){super(t,r,i,n,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new h_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const i=this._document.data.field(DL("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,r.serverTimestamps)}}}class h_ extends HQ{data(t={}){return super.data(t)}}class JLe{constructor(t,r,i,n){this._firestore=t,this._userDataWriter=r,this._snapshot=n,this.metadata=new Ny(n.hasPendingWrites,n.fromCache),this.query=i}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(i=>{t.call(r,new h_(this._firestore,this._userDataWriter,i.key,i,new Ny(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ht(Ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(n,s){if(n._snapshot.oldDocs.isEmpty()){let a=0;return n._snapshot.docChanges.map(o=>{const l=new h_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Ny(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new h_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Ny(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:eNe(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function eNe(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ft()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tNe(e){e=Yo(e,Fs);const t=Yo(e.firestore,Jp);return NLe(EL(t),e._key).then(r=>iNe(t,e,r))}class WQ extends ZLe{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ag(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Fs(this.firestore,null,r)}}function Kl(e){e=Yo(e,dv);const t=Yo(e.firestore,Jp),r=EL(t),i=new WQ(t);return QLe(e._query),zLe(r,e._query).then(n=>new JLe(t,i,e,n))}function rNe(e,t,r){e=Yo(e,Fs);const i=Yo(e.firestore,Jp),n=VQ(e.converter,t,r);return oC(i,[NQ(iC(i),"setDoc",e._key,n,e.converter!==null,r).toMutation(e._key,io.none())])}function kL(e,t,r,...i){e=Yo(e,Fs);const n=Yo(e.firestore,Jp),s=iC(n);let a;return a=typeof(t=Ki(t))=="string"||t instanceof tC?qLe(s,"updateDoc",e._key,t,r,i):GLe(s,"updateDoc",e._key,t),oC(n,[a.toMutation(e._key,io.exists(!0))])}function aC(e){return oC(Yo(e.firestore,Jp),[new cL(e._key,io.none())])}function ip(e,t){const r=Yo(e.firestore,Jp),i=Ql(e),n=VQ(e.converter,t);return oC(r,[NQ(iC(e.firestore),"addDoc",i._key,n,e.converter!==null,{}).toMutation(i._key,io.exists(!1))]).then(()=>i)}function oC(e,t){return function(i,n){const s=new Kc;return i.asyncQueue.enqueueAndForget(async()=>SLe(await LLe(i),n,s)),s.promise}(EL(e),t)}function iNe(e,t,r){const i=r.docs.get(t._key),n=new WQ(e);return new HQ(e,n,t._key,i,new Ny(r.hasPendingWrites,r.fromCache),t.converter)}function GQ(){return new AL("serverTimestamp")}(function(t,r=!0){(function(n){cv=n})(Qp),Sp(new Gh("firestore",(i,{instanceIdentifier:n,options:s})=>{const a=i.getProvider("app").getImmediate(),o=new Jp(new i3e(i.getProvider("auth-internal")),new o3e(i.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ht(Ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lw(c.options.projectId,u)}(a,n),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),zl(N5,"4.6.3",t),zl(N5,"4.6.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qQ="firebasestorage.googleapis.com",YQ="storageBucket",nNe=2*60*1e3,sNe=10*60*1e3,aNe=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi extends ic{constructor(t,r,i=0){super(TP(t),`Firebase Storage: ${r} (${TP(t)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gi.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return TP(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var si;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(si||(si={}));function TP(e){return"storage/"+e}function LL(){const e="An unknown error occurred, please check the error payload for server response.";return new gi(si.UNKNOWN,e)}function oNe(e){return new gi(si.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function lNe(e){return new gi(si.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cNe(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gi(si.UNAUTHENTICATED,e)}function uNe(){return new gi(si.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function hNe(e){return new gi(si.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function XQ(){return new gi(si.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $Q(){return new gi(si.CANCELED,"User canceled the upload/download.")}function dNe(e){return new gi(si.INVALID_URL,"Invalid URL '"+e+"'.")}function pNe(e){return new gi(si.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function fNe(){return new gi(si.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+YQ+"' property when initializing the app?")}function QQ(){return new gi(si.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function mNe(){return new gi(si.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function gNe(){return new gi(si.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function vNe(e){return new gi(si.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function _O(e){return new gi(si.INVALID_ARGUMENT,e)}function KQ(){return new gi(si.APP_DELETED,"The Firebase app was deleted.")}function yNe(e){return new gi(si.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function d0(e,t){return new gi(si.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function py(e){throw new gi(si.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let i;try{i=Sa.makeFromUrl(t,r)}catch{return new Sa(t,"")}if(i.path==="")return i;throw pNe(t)}static makeFromUrl(t,r){let i=null;const n="([A-Za-z0-9.\\-_]+)";function s(b){b.path.charAt(b.path.length-1)==="/"&&(b.path_=b.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+n+a,"i"),l={bucket:1,path:3};function c(b){b.path_=decodeURIComponent(b.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${n}/o${d}`,"i"),f={bucket:1,path:3},m=r===qQ?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",v=new RegExp(`^https?://${m}/${n}/${g}`,"i"),w=[{regex:o,indices:l,postModify:s},{regex:p,indices:f,postModify:c},{regex:v,indices:{bucket:1,path:2},postModify:c}];for(let b=0;b<w.length;b++){const E=w[b],_=E.regex.exec(t);if(_){const C=_[E.indices.bucket];let x=_[E.indices.path];x||(x=""),i=new Sa(C,x),E.postModify(i);break}}if(i==null)throw dNe(t);return i}}class wNe{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xNe(e,t,r){let i=1,n=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,t.apply(null,g))}function h(g){n=setTimeout(()=>{n=null,e(p,l())},g)}function d(){s&&clearTimeout(s)}function p(g,...v){if(c){d();return}if(g){d(),u.call(null,g,...v);return}if(l()||a){d(),u.call(null,g,...v);return}i<64&&(i*=2);let w;o===1?(o=2,w=0):w=(i+Math.random())*1e3,h(w)}let f=!1;function m(g){f||(f=!0,d(),!c&&(n!==null?(g||(o=2),clearTimeout(n),h(0)):g||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,m(!0)},r),m}function bNe(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _Ne(e){return e!==void 0}function SNe(e){return typeof e=="function"}function ENe(e){return typeof e=="object"&&!Array.isArray(e)}function lC(e){return typeof e=="string"||e instanceof String}function w6(e){return NL()&&e instanceof Blob}function NL(){return typeof Blob<"u"}function x6(e,t,r,i){if(i<t)throw _O(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>r)throw _O(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(e,t,r){let i=t;return r==null&&(i=`https://${t}`),`${r}://${i}/v0${e}`}function ZQ(e){const t=encodeURIComponent;let r="?";for(const i in e)if(e.hasOwnProperty(i)){const n=t(i)+"="+t(e[i]);r=r+n+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var np;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(np||(np={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JQ(e,t){const r=e>=500&&e<600,n=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||n||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TNe{constructor(t,r,i,n,s,a,o,l,c,u,h,d=!0){this.url_=t,this.method_=r,this.headers_=i,this.body_=n,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,f)=>{this.resolve_=p,this.reject_=f,this.start_()})}start_(){const t=(i,n)=>{if(n){i(!1,new gb(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===np.NO_ERROR,l=s.getStatus();if(!o||JQ(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===np.ABORT;i(!1,new gb(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new gb(c,s))})},r=(i,n)=>{const s=this.resolve_,a=this.reject_,o=n.connection;if(n.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());_Ne(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=LL();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(n.canceled){const l=this.appDelete_?KQ():$Q();a(l)}else{const l=XQ();a(l)}};this.canceled_?r(!1,new gb(!1,null,!0)):this.backoffId_=xNe(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&bNe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gb{constructor(t,r,i){this.wasSuccessCode=t,this.connection=r,this.canceled=!!i}}function CNe(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function ANe(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function MNe(e,t){t&&(e["X-Firebase-GMPID"]=t)}function PNe(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function DNe(e,t,r,i,n,s,a=!0){const o=ZQ(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return MNe(c,t),CNe(c,r),ANe(c,s),PNe(c,i),new TNe(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function INe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function ONe(...e){const t=INe();if(t!==void 0){const r=new t;for(let i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}else{if(NL())return new Blob(e);throw new gi(si.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function RNe(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kNe(e){if(typeof atob>"u")throw vNe("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dl={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class CP{constructor(t,r){this.data=t,this.contentType=r||null}}function LNe(e,t){switch(e){case Dl.RAW:return new CP(eK(t));case Dl.BASE64:case Dl.BASE64URL:return new CP(tK(e,t));case Dl.DATA_URL:return new CP(zNe(t),BNe(t))}throw LL()}function eK(e){const t=[];for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const s=i,a=e.charCodeAt(++r);i=65536|(s&1023)<<10|a&1023,t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(t)}function NNe(e){let t;try{t=decodeURIComponent(e)}catch{throw d0(Dl.DATA_URL,"Malformed data URL.")}return eK(t)}function tK(e,t){switch(e){case Dl.BASE64:{const n=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(n||s)throw d0(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case Dl.BASE64URL:{const n=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(n||s)throw d0(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=kNe(t)}catch(n){throw n.message.includes("polyfill")?n:d0(e,"Invalid character found")}const i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return i}class rK{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw d0(Dl.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=r[1]||null;i!=null&&(this.base64=FNe(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=t.substring(t.indexOf(",")+1)}}function zNe(e){const t=new rK(e);return t.base64?tK(Dl.BASE64,t.rest):NNe(t.rest)}function BNe(e){return new rK(e).contentType}function FNe(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(t,r){let i=0,n="";w6(t)?(this.data_=t,i=t.size,n=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),i=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),i=t.length),this.size_=i,this.type_=n}size(){return this.size_}type(){return this.type_}slice(t,r){if(w6(this.data_)){const i=this.data_,n=RNe(i,t,r);return n===null?null:new rh(n)}else{const i=new Uint8Array(this.data_.buffer,t,r-t);return new rh(i,!0)}}static getBlob(...t){if(NL()){const r=t.map(i=>i instanceof rh?i.data_:i);return new rh(ONe.apply(null,r))}else{const r=t.map(a=>lC(a)?LNe(Dl.RAW,a).data:a.data_);let i=0;r.forEach(a=>{i+=a.byteLength});const n=new Uint8Array(i);let s=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)n[s++]=a[o]}),new rh(n,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iK(e){let t;try{t=JSON.parse(e)}catch{return null}return ENe(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UNe(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function jNe(e,t){const r=t.split("/").filter(i=>i.length>0).join("/");return e.length===0?r:e+"/"+r}function nK(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VNe(e,t){return t}class Ms{constructor(t,r,i,n){this.server=t,this.local=r||t,this.writable=!!i,this.xform=n||VNe}}let vb=null;function HNe(e){return!lC(e)||e.length<2?e:nK(e)}function sK(){if(vb)return vb;const e=[];e.push(new Ms("bucket")),e.push(new Ms("generation")),e.push(new Ms("metageneration")),e.push(new Ms("name","fullPath",!0));function t(s,a){return HNe(a)}const r=new Ms("name");r.xform=t,e.push(r);function i(s,a){return a!==void 0?Number(a):a}const n=new Ms("size");return n.xform=i,e.push(n),e.push(new Ms("timeCreated")),e.push(new Ms("updated")),e.push(new Ms("md5Hash",null,!0)),e.push(new Ms("cacheControl",null,!0)),e.push(new Ms("contentDisposition",null,!0)),e.push(new Ms("contentEncoding",null,!0)),e.push(new Ms("contentLanguage",null,!0)),e.push(new Ms("contentType",null,!0)),e.push(new Ms("metadata","customMetadata",!0)),vb=e,vb}function WNe(e,t){function r(){const i=e.bucket,n=e.fullPath,s=new Sa(i,n);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:r})}function GNe(e,t,r){const i={};i.type="file";const n=r.length;for(let s=0;s<n;s++){const a=r[s];i[a.local]=a.xform(i,t[a.server])}return WNe(i,e),i}function aK(e,t,r){const i=iK(t);return i===null?null:GNe(e,i,r)}function qNe(e,t,r,i){const n=iK(t);if(n===null||!lC(n.downloadTokens))return null;const s=n.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(c=>{const u=e.bucket,h=e.fullPath,d="/b/"+a(u)+"/o/"+a(h),p=ax(d,r,i),f=ZQ({alt:"media",token:c});return p+f})[0]}function oK(e,t){const r={},i=t.length;for(let n=0;n<i;n++){const s=t[n];s.writable&&(r[s.server]=e[s.local])}return JSON.stringify(r)}class pv{constructor(t,r,i,n){this.url=t,this.method=r,this.handler=i,this.timeout=n,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(e){if(!e)throw LL()}function zL(e,t){function r(i,n){const s=aK(e,n,t);return Zc(s!==null),s}return r}function YNe(e,t){function r(i,n){const s=aK(e,n,t);return Zc(s!==null),qNe(s,n,e.host,e._protocol)}return r}function ox(e){function t(r,i){let n;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?n=uNe():n=cNe():r.getStatus()===402?n=lNe(e.bucket):r.getStatus()===403?n=hNe(e.path):n=i,n.status=r.getStatus(),n.serverResponse=i.serverResponse,n}return t}function lK(e){const t=ox(e);function r(i,n){let s=t(i,n);return i.getStatus()===404&&(s=oNe(e.path)),s.serverResponse=n.serverResponse,s}return r}function XNe(e,t,r){const i=t.fullServerUrl(),n=ax(i,e.host,e._protocol),s="GET",a=e.maxOperationRetryTime,o=new pv(n,s,zL(e,r),a);return o.errorHandler=lK(t),o}function $Ne(e,t,r){const i=t.fullServerUrl(),n=ax(i,e.host,e._protocol),s="GET",a=e.maxOperationRetryTime,o=new pv(n,s,YNe(e,r),a);return o.errorHandler=lK(t),o}function QNe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function cK(e,t,r){const i=Object.assign({},r);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=QNe(null,t)),i}function KNe(e,t,r,i,n){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let w="";for(let b=0;b<2;b++)w=w+Math.random().toString().slice(2);return w}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=cK(t,i,n),u=oK(c,r),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",p=rh.getBlob(h,i,d);if(p===null)throw QQ();const f={name:c.fullPath},m=ax(s,e.host,e._protocol),g="POST",v=e.maxUploadRetryTime,y=new pv(m,g,zL(e,r),v);return y.urlParams=f,y.headers=a,y.body=p.uploadData(),y.errorHandler=ox(t),y}class pE{constructor(t,r,i,n){this.current=t,this.total=r,this.finalized=!!i,this.metadata=n||null}}function BL(e,t){let r=null;try{r=e.getResponseHeader("X-Goog-Upload-Status")}catch{Zc(!1)}return Zc(!!r&&(t||["active"]).indexOf(r)!==-1),r}function ZNe(e,t,r,i,n){const s=t.bucketOnlyServerUrl(),a=cK(t,i,n),o={name:a.fullPath},l=ax(s,e.host,e._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=oK(a,r),d=e.maxUploadRetryTime;function p(m){BL(m);let g;try{g=m.getResponseHeader("X-Goog-Upload-URL")}catch{Zc(!1)}return Zc(lC(g)),g}const f=new pv(l,c,p,d);return f.urlParams=o,f.headers=u,f.body=h,f.errorHandler=ox(t),f}function JNe(e,t,r,i){const n={"X-Goog-Upload-Command":"query"};function s(c){const u=BL(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Zc(!1)}h||Zc(!1);const d=Number(h);return Zc(!isNaN(d)),new pE(d,i.size(),u==="final")}const a="POST",o=e.maxUploadRetryTime,l=new pv(r,a,s,o);return l.headers=n,l.errorHandler=ox(t),l}const b6=256*1024;function eze(e,t,r,i,n,s,a,o){const l=new pE(0,0);if(a?(l.current=a.current,l.total=a.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw mNe();const c=l.total-l.current;let u=c;n>0&&(u=Math.min(u,n));const h=l.current,d=h+u;let p="";u===0?p="finalize":c===u?p="upload, finalize":p="upload";const f={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":`${l.current}`},m=i.slice(h,d);if(m===null)throw QQ();function g(b,E){const _=BL(b,["active","final"]),C=l.current+u,x=i.size();let A;return _==="final"?A=zL(t,s)(b,E):A=null,new pE(C,x,_==="final",A)}const v="POST",y=t.maxUploadRetryTime,w=new pv(r,v,g,y);return w.headers=f,w.body=m.uploadData(),w.progressCallback=o||null,w.errorHandler=ox(e),w}const Qs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function AP(e){switch(e){case"running":case"pausing":case"canceling":return Qs.RUNNING;case"paused":return Qs.PAUSED;case"success":return Qs.SUCCESS;case"canceled":return Qs.CANCELED;case"error":return Qs.ERROR;default:return Qs.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tze=class{constructor(t,r,i){if(SNe(t)||r!=null||i!=null)this.next=t,this.error=r??void 0,this.complete=i??void 0;else{const s=t;this.next=s.next,this.error=s.error,this.complete=s.complete}}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}class rze{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=np.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=np.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=np.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,i,n){if(this.sent_)throw py("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),n!==void 0)for(const s in n)n.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,n[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw py("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw py("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw py("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw py("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class ize extends rze{initXhr(){this.xhr_.responseType="text"}}function em(){return new ize}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nze{constructor(t,r,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=r,this._metadata=i,this._mappings=sK(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=n=>{if(this._request=void 0,this._chunkMultiplier=1,n._codeEquals(si.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(JQ(n.status,[]))if(s)n=XQ();else{this.sleepTime=Math.max(this.sleepTime*2,aNe),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=n,this._transition("error")}},this._metadataErrorHandler=n=>{this._request=void 0,n._codeEquals(si.CANCELED)?this.completeTransitions_():(this._error=n,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((n,s)=>{this._resolve=n,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const t=this._transferred;return r=>this._updateProgress(t+r)}_shouldDoResumable(t){return t.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(t){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([r,i])=>{switch(this._state){case"running":t(r,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((t,r)=>{const i=ZNe(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),n=this._ref.storage._makeRequest(i,em,t,r);this._request=n,n.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const t=this._uploadUrl;this._resolveToken((r,i)=>{const n=JNe(this._ref.storage,this._ref._location,t,this._blob),s=this._ref.storage._makeRequest(n,em,r,i);this._request=s,s.getPromise().then(a=>{a=a,this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const t=b6*this._chunkMultiplier,r=new pE(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((n,s)=>{let a;try{a=eze(this._ref._location,this._ref.storage,i,this._blob,t,this._mappings,r,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const o=this._ref.storage._makeRequest(a,em,n,s,!1);this._request=o,o.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){b6*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((t,r)=>{const i=XNe(this._ref.storage,this._ref._location,this._mappings),n=this._ref.storage._makeRequest(i,em,t,r);this._request=n,n.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((t,r)=>{const i=KNe(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),n=this._ref.storage._makeRequest(i,em,t,r);this._request=n,n.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(t){const r=this._transferred;this._transferred=t,this._transferred!==r&&this._notifyObservers()}_transition(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const r=this._state==="paused";this._state=t,r&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=$Q(),this._state=t,this._notifyObservers();break;case"error":this._state=t,this._notifyObservers();break;case"success":this._state=t,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const t=AP(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}}on(t,r,i,n){const s=new tze(r||void 0,i||void 0,n||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(t,r){return this._promise.then(t,r)}catch(t){return this.then(null,t)}_addObserver(t){this._observers.push(t),this._notifyObserver(t)}_removeObserver(t){const r=this._observers.indexOf(t);r!==-1&&this._observers.splice(r,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(r=>{this._notifyObserver(r)})}_finishPromise(){if(this._resolve!==void 0){let t=!0;switch(AP(this._state)){case Qs.SUCCESS:Vf(this._resolve.bind(null,this.snapshot))();break;case Qs.CANCELED:case Qs.ERROR:const r=this._reject;Vf(r.bind(null,this._error))();break;default:t=!1;break}t&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(t){switch(AP(this._state)){case Qs.RUNNING:case Qs.PAUSED:t.next&&Vf(t.next.bind(t,this.snapshot))();break;case Qs.SUCCESS:t.complete&&Vf(t.complete.bind(t))();break;case Qs.CANCELED:case Qs.ERROR:t.error&&Vf(t.error.bind(t,this._error))();break;default:t.error&&Vf(t.error.bind(t,this._error))()}}resume(){const t=this._state==="paused"||this._state==="pausing";return t&&this._transition("running"),t}pause(){const t=this._state==="running";return t&&this._transition("pausing"),t}cancel(){const t=this._state==="running"||this._state==="pausing";return t&&this._transition("canceling"),t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(t,r){this._service=t,r instanceof Sa?this._location=r:this._location=Sa.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Mp(t,r)}get root(){const t=new Sa(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return nK(this._location.path)}get storage(){return this._service}get parent(){const t=UNe(this._location.path);if(t===null)return null;const r=new Sa(this._location.bucket,t);return new Mp(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw yNe(t)}}function sze(e,t,r){return e._throwIfRoot("uploadBytesResumable"),new nze(e,new rh(t),r)}function aze(e){e._throwIfRoot("getDownloadURL");const t=$Ne(e.storage,e._location,sK());return e.storage.makeRequestWithTokens(t,em).then(r=>{if(r===null)throw gNe();return r})}function oze(e,t){const r=jNe(e._location.path,t),i=new Sa(e._location.bucket,r);return new Mp(e.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lze(e){return/^[A-Za-z]+:\/\//.test(e)}function cze(e,t){return new Mp(e,t)}function uK(e,t){if(e instanceof FL){const r=e;if(r._bucket==null)throw fNe();const i=new Mp(r,r._bucket);return t!=null?uK(i,t):i}else return t!==void 0?oze(e,t):e}function uze(e,t){if(t&&lze(t)){if(e instanceof FL)return cze(e,t);throw _O("To use ref(service, url), the first argument must be a Storage instance.")}else return uK(e,t)}function _6(e,t){const r=t==null?void 0:t[YQ];return r==null?null:Sa.makeFromBucketSpec(r,e)}function hze(e,t,r,i={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:n}=i;n&&(e._overrideAuthToken=typeof n=="string"?n:zX(n,e.app.options.projectId))}class FL{constructor(t,r,i,n,s){this.app=t,this._authProvider=r,this._appCheckProvider=i,this._url=n,this._firebaseVersion=s,this._bucket=null,this._host=qQ,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=nNe,this._maxUploadRetryTime=sNe,this._requests=new Set,n!=null?this._bucket=Sa.makeFromBucketSpec(n,this._host):this._bucket=_6(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Sa.makeFromBucketSpec(this._url,t):this._bucket=_6(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){x6("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){x6("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Mp(this,t)}_makeRequest(t,r,i,n,s=!0){if(this._deleted)return new wNe(KQ());{const a=DNe(t,this._appId,i,n,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[i,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,i,n).getPromise()}}const S6="@firebase/storage",E6="0.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK="storage";function dK(e,t,r){return e=Ki(e),sze(e,t,r)}function pK(e){return e=Ki(e),aze(e)}function fK(e,t){return e=Ki(e),uze(e,t)}function dze(e=Hk(),t){e=Ki(e);const i=BT(e,hK).getImmediate({identifier:t}),n=kX("storage");return n&&pze(i,...n),i}function pze(e,t,r,i={}){hze(e,t,r,i)}function fze(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),n=e.getProvider("app-check-internal");return new FL(r,i,n,t,Qp)}function mze(){Sp(new Gh(hK,fze,"PUBLIC").setMultipleInstances(!0)),zl(S6,E6,""),zl(S6,E6,"esm2017")}mze();const gze={apiKey:"AIzaSyB-YqAkrOw6xzNoTXKe4RHCwj90fqcv1os",authDomain:"database-4bac1.firebaseapp.com",databaseURL:"https://database-4bac1-default-rtdb.firebaseio.com",projectId:"database-4bac1",storageBucket:"database-4bac1.appspot.com",messagingSenderId:"125697044088",appId:"1:125697044088:web:b4a67ecb3c55436406078d",measurementId:"G-0ETJP2NJXT"},UL=UX(gze),Jr=jLe(UL),Pp=KRe(UL),cC=new Rc,mK=dze(UL),vze=[{id:1,name:"Home",link:"/"},{id:2,name:"About",link:"/about"},{id:3,name:"Features",link:"/features"},{id:4,name:"Blog",link:"/blog"},{id:5,name:"Contacts",link:"/contact"}],yze=({showMenu:e})=>{const{name:t,profilePhoto:r}=ov(),i=rd(),n=()=>{HT(Pp).then(()=>{console.log("Sign-in successful!")}).catch(a=>{console.error("Error signing in:",a.message)})},s=async()=>{try{await UOe(Pp),localStorage.clear(),i("/"),window.location.reload()}catch(a){console.error(a)}};return k.jsxs("div",{className:`fixed bottom-0 top-0 z-20 flex h-screen w-[55%] flex-col justify-between
      bg-white dark:bg-dark dark:text-white px-8 pb-6 pt-16 text-black
      duration-300 md:hidden rounded-r-xl shadow-md
      ${e?"left-0":"-left-[100%]"}`,children:[k.jsxs("div",{children:[k.jsxs("div",{className:"flex items-center justify-start gap-3",children:[k.jsx("img",{src:r,alt:"Profile",className:"h-10 w-10 object-cover rounded-full"}),k.jsxs("div",{children:[k.jsxs("h1",{className:"text-lg",children:["Hello ",t]}),k.jsx("h1",{className:"text-sm text-slate-500",children:"Premium User"})]})]}),k.jsx("nav",{className:"mt-12",children:k.jsxs("ul",{children:[vze.map(({id:a,name:o,link:l})=>k.jsx("li",{className:"py-4",children:k.jsx(n3,{to:l,className:"text-lg font-medium text-black dark:text-white duration-300",children:o})},a)),k.jsx("li",{className:"py-4",children:k.jsx("button",{onClick:n,className:"text-lg font-medium text-black dark:text-white duration-300",children:"Sign In"})}),k.jsx("li",{className:"py-4",children:k.jsx("button",{onClick:s,className:"text-lg font-medium text-black dark:text-white duration-300",children:"Sign Out"})})]})})]}),k.jsx("div",{className:"footer",children:k.jsxs("h1",{className:"text-lg",children:["Made by ",k.jsx("a",{href:"https://github.com/nazdev20",className:"text-blue-500 hover:underline",children:"Naz"})]})})]})},T6=[{id:1,name:"Home",link:"/"},{id:2,name:"About",link:"/about"},{id:4,name:"Team",link:"/team"},{id:3,name:"Testimonial",link:"/testimonial"},{id:5,name:"Contacts",link:"/contacts"}],gK=()=>{ov();const[e,t]=te.useState(!1),r=rd();Dw();const i=te.useRef(null),n=()=>{t(!e)},s=o=>{const l=document.getElementById(o);if(l){const c=i.current.offsetHeight,u=l.offsetTop-c;window.scrollTo({top:u,behavior:"smooth"})}},a=()=>{r("/list")};return k.jsxs(k.Fragment,{children:[k.jsxs("nav",{ref:i,className:"flex fixed top-0 left-0 z-50 w-full bg-[#008080] p-4 sm:p-8 items-center justify-between",children:[k.jsx("div",{className:"flex items-center justify-center ml-5",children:k.jsxs("div",{className:"text-[25px] font-bold",children:[k.jsx("span",{className:"text-secondary",children:"Yolo"}),k.jsx("span",{className:"text-primary",children:"Traveler"}),k.jsx("span",{className:"text-fourth",children:"Asia"})]})}),k.jsx("div",{className:"hidden md:flex items-center flex-1 justify-center ml-4 mr-4",children:k.jsx("ul",{className:"flex flex-wrap justify-center gap-x-12 sm:gap-x-16 md:gap-x-20 space-x-4 sm:space-x-8 font-bold text-lg",children:T6.map(o=>k.jsx("li",{children:k.jsx(n3,{to:o.link,className:"text-[#ffffff] hover:text-[#FF6F61] transition-colors duration-300",onClick:()=>s(o.id),children:o.name})},o.id))})}),k.jsxs("div",{className:"flex items-center space-x-3 ",children:[" ",k.jsx("h1",{className:"font-bold text-white",children:"Cart"}),k.jsx(S2e,{className:"cursor-pointer transition-all text-[#FF6F61]",size:25,onClick:a}),k.jsx("div",{className:"md:hidden ml-4 ",children:e?k.jsx(y2e,{onClick:n,className:"cursor-pointer transition-all",size:30}):k.jsx(w2e,{onClick:n,className:"cursor-pointer transition-all",size:30})})]})]}),k.jsx(yze,{showMenu:e,toggleMenu:n,links:T6})]})};var vK={exports:{}},wze="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",xze=wze,bze=xze;function yK(){}function wK(){}wK.resetWarningCache=yK;var _ze=function(){function e(i,n,s,a,o,l){if(l!==bze){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:wK,resetWarningCache:yK};return r.PropTypes=r,r};vK.exports=_ze();var xK=vK.exports;function bK(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=bK(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r);return i}function Xn(){for(var e,t,r=0,i="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=bK(e))&&(i&&(i+=" "),i+=t);return i}function Dp(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function ot(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function pw(e){if(!Dp(e)&&typeof e!="number")return!1;const t=ot(e);return!isNaN(Number(t))}const Sze={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Eze=(e,t,r)=>{let i;const n=Sze[e];return typeof n=="string"?i=n:t===1?i=n.one:i=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function MP(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Tze={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Cze={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Aze={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Mze={date:MP({formats:Tze,defaultWidth:"full"}),time:MP({formats:Cze,defaultWidth:"full"}),dateTime:MP({formats:Aze,defaultWidth:"full"})},Pze={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Dze=(e,t,r,i)=>Pze[e];function fy(e){return(t,r)=>{const i=r!=null&&r.context?String(r.context):"standalone";let n;if(i==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return n[s]}}const Ize={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Oze={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Rze={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kze={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Lze={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Nze={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zze=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Bze={ordinalNumber:zze,era:fy({values:Ize,defaultWidth:"wide"}),quarter:fy({values:Oze,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fy({values:Rze,defaultWidth:"wide"}),day:fy({values:kze,defaultWidth:"wide"}),dayPeriod:fy({values:Lze,defaultWidth:"wide",formattingValues:Nze,defaultFormattingWidth:"wide"})};function my(e){return(t,r={})=>{const i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;const a=s[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?Uze(o,h=>h.test(a)):Fze(o,h=>h.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function Fze(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Uze(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function jze(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const n=i[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(n.length);return{value:a,rest:o}}}const Vze=/^(\d+)(th|st|nd|rd)?/i,Hze=/\d+/i,Wze={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Gze={any:[/^b/i,/^(a|c)/i]},qze={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Yze={any:[/1/i,/2/i,/3/i,/4/i]},Xze={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$ze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Qze={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Kze={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Zze={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Jze={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},eBe={ordinalNumber:jze({matchPattern:Vze,parsePattern:Hze,valueCallback:e=>parseInt(e,10)}),era:my({matchPatterns:Wze,defaultMatchWidth:"wide",parsePatterns:Gze,defaultParseWidth:"any"}),quarter:my({matchPatterns:qze,defaultMatchWidth:"wide",parsePatterns:Yze,defaultParseWidth:"any",valueCallback:e=>e+1}),month:my({matchPatterns:Xze,defaultMatchWidth:"wide",parsePatterns:$ze,defaultParseWidth:"any"}),day:my({matchPatterns:Qze,defaultMatchWidth:"wide",parsePatterns:Kze,defaultParseWidth:"any"}),dayPeriod:my({matchPatterns:Zze,defaultMatchWidth:"any",parsePatterns:Jze,defaultParseWidth:"any"})},_K={code:"en-US",formatDistance:Eze,formatLong:Mze,formatRelative:Dze,localize:Bze,match:eBe,options:{weekStartsOn:0,firstWeekContainsDate:1}};let tBe={};function ef(){return tBe}const SK=6048e5,rBe=864e5,uC=6e4,hC=36e5,iBe=1e3;function jl(e){const t=ot(e);return t.setHours(0,0,0,0),t}function fE(e){const t=ot(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function fw(e,t){const r=jl(e),i=jl(t),n=+r-fE(r),s=+i-fE(i);return Math.round((n-s)/rBe)}function Or(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function dC(e){const t=ot(e),r=Or(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function nBe(e){const t=ot(e);return fw(t,dC(t))+1}function fu(e,t){var o,l,c,u;const r=ef(),i=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,n=ot(e),s=n.getDay(),a=(s<i?7:0)+s-i;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function Mg(e){return fu(e,{weekStartsOn:1})}function EK(e){const t=ot(e),r=t.getFullYear(),i=Or(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const n=Mg(i),s=Or(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const a=Mg(s);return t.getTime()>=n.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function sBe(e){const t=EK(e),r=Or(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Mg(r)}function jL(e){const t=ot(e),r=+Mg(t)-+sBe(t);return Math.round(r/SK)+1}function VL(e,t){var u,h,d,p;const r=ot(e),i=r.getFullYear(),n=ef(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((p=(d=n.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,a=Or(e,0);a.setFullYear(i+1,0,s),a.setHours(0,0,0,0);const o=fu(a,t),l=Or(e,0);l.setFullYear(i,0,s),l.setHours(0,0,0,0);const c=fu(l,t);return r.getTime()>=o.getTime()?i+1:r.getTime()>=c.getTime()?i:i-1}function aBe(e,t){var o,l,c,u;const r=ef(),i=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,n=VL(e,t),s=Or(e,0);return s.setFullYear(n,0,i),s.setHours(0,0,0,0),fu(s,t)}function TK(e,t){const r=ot(e),i=+fu(r,t)-+aBe(r,t);return Math.round(i/SK)+1}function Ir(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const Fu={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return Ir(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ir(r+1,2)},d(e,t){return Ir(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ir(e.getHours()%12||12,t.length)},H(e,t){return Ir(e.getHours(),t.length)},m(e,t){return Ir(e.getMinutes(),t.length)},s(e,t){return Ir(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),n=Math.trunc(i*Math.pow(10,r-3));return Ir(n,t.length)}},Hf={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},C6={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),n=i>0?i:1-i;return r.ordinalNumber(n,{unit:"year"})}return Fu.y(e,t)},Y:function(e,t,r,i){const n=VL(e,i),s=n>0?n:1-n;if(t==="YY"){const a=s%100;return Ir(a,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ir(s,t.length)},R:function(e,t){const r=EK(e);return Ir(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ir(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Ir(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Ir(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return Fu.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Ir(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const n=TK(e,i);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Ir(n,t.length)},I:function(e,t,r){const i=jL(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Ir(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Fu.d(e,t)},D:function(e,t,r){const i=nBe(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Ir(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const n=e.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Ir(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const n=e.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Ir(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),n=i===0?7:i;switch(t){case"i":return String(n);case"ii":return Ir(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let n;switch(i===12?n=Hf.noon:i===0?n=Hf.midnight:n=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let n;switch(i>=17?n=Hf.evening:i>=12?n=Hf.afternoon:i>=4?n=Hf.morning:n=Hf.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Fu.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Fu.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Ir(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Ir(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Fu.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Fu.s(e,t)},S:function(e,t){return Fu.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return M6(i);case"XXXX":case"XX":return Td(i);case"XXXXX":case"XXX":default:return Td(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return M6(i);case"xxxx":case"xx":return Td(i);case"xxxxx":case"xxx":default:return Td(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+A6(i,":");case"OOOO":default:return"GMT"+Td(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+A6(i,":");case"zzzz":default:return"GMT"+Td(i,":")}},t:function(e,t,r){const i=Math.trunc(e.getTime()/1e3);return Ir(i,t.length)},T:function(e,t,r){const i=e.getTime();return Ir(i,t.length)}};function A6(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Math.trunc(i/60),s=i%60;return s===0?r+String(n):r+String(n)+t+Ir(s,2)}function M6(e,t){return e%60===0?(e>0?"-":"+")+Ir(Math.abs(e)/60,2):Td(e,t)}function Td(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Ir(Math.trunc(i/60),2),s=Ir(i%60,2);return r+n+t+s}const P6=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},CK=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},oBe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],n=r[2];if(!n)return P6(e,t);let s;switch(i){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",P6(i,t)).replace("{{time}}",CK(n,t))},mE={p:CK,P:oBe},lBe=/^D+$/,cBe=/^Y+$/,uBe=["D","DD","YY","YYYY"];function AK(e){return lBe.test(e)}function MK(e){return cBe.test(e)}function SO(e,t,r){const i=hBe(e,t,r);if(console.warn(i),uBe.includes(e))throw new RangeError(i)}function hBe(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const dBe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,pBe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,fBe=/^'([^]*?)'?$/,mBe=/''/g,gBe=/[a-zA-Z]/;function EO(e,t,r){var u,h,d,p,f,m,g,v;const i=ef(),n=(r==null?void 0:r.locale)??i.locale??_K,s=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((p=(d=i.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,a=(r==null?void 0:r.weekStartsOn)??((m=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:m.weekStartsOn)??i.weekStartsOn??((v=(g=i.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??0,o=ot(e);if(!pw(o))throw new RangeError("Invalid time value");let l=t.match(pBe).map(y=>{const w=y[0];if(w==="p"||w==="P"){const b=mE[w];return b(y,n.formatLong)}return y}).join("").match(dBe).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const w=y[0];if(w==="'")return{isToken:!1,value:vBe(y)};if(C6[w])return{isToken:!0,value:y};if(w.match(gBe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:y}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:n};return l.map(y=>{if(!y.isToken)return y.value;const w=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&MK(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&AK(w))&&SO(w,t,String(e));const b=C6[w[0]];return b(o,w,n.localize,c)}).join("")}function vBe(e){const t=e.match(fBe);return t?t[1].replace(mBe,"'"):e}function HL(e,t){const r=+ot(e);return Or(e,r+t)}function TO(e,t){return HL(e,t*uC)}function yBe(e,t){return HL(e,t*hC)}function od(e,t){const r=ot(e);return isNaN(t)?Or(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function gE(e,t){const r=t*7;return od(e,r)}function Xo(e,t){const r=ot(e);if(isNaN(t))return Or(e,NaN);if(!t)return r;const i=r.getDate(),n=Or(e,r.getTime());n.setMonth(r.getMonth()+t+1,0);const s=n.getDate();return i>=s?n:(r.setFullYear(n.getFullYear(),n.getMonth(),i),r)}function WL(e,t){const r=t*3;return Xo(e,r)}function Jc(e,t){return Xo(e,t*12)}function wBe(e,t){return od(e,-t)}function D6(e,t){return gE(e,-t)}function Pg(e,t){return Xo(e,-t)}function PK(e,t){return WL(e,-t)}function Dg(e,t){return Jc(e,-t)}function eu(e){return ot(e).getSeconds()}function Vl(e){return ot(e).getMinutes()}function Hl(e){return ot(e).getHours()}function xBe(e){return ot(e).getDay()}function I6(e){return ot(e).getDate()}function zs(e){return ot(e).getMonth()}function sp(e){const t=ot(e);return Math.trunc(t.getMonth()/3)+1}function rr(e){return ot(e).getFullYear()}function CO(e){return ot(e).getTime()}function d_(e,t){const r=ot(e);return r.setSeconds(t),r}function p_(e,t){const r=ot(e);return r.setMinutes(t),r}function f_(e,t){const r=ot(e);return r.setHours(t),r}function bBe(e){const t=ot(e),r=t.getFullYear(),i=t.getMonth(),n=Or(e,0);return n.setFullYear(r,i+1,0),n.setHours(0,0,0,0),n.getDate()}function Os(e,t){const r=ot(e),i=r.getFullYear(),n=r.getDate(),s=Or(e,0);s.setFullYear(i,t,15),s.setHours(0,0,0,0);const a=bBe(s);return r.setMonth(t,Math.min(n,a)),r}function tm(e,t){const r=ot(e),i=Math.trunc(r.getMonth()/3)+1,n=t-i;return Os(r,r.getMonth()+n*3)}function yl(e,t){const r=ot(e);return isNaN(+r)?Or(e,NaN):(r.setFullYear(t),r)}function O6(e){let t;return e.forEach(r=>{const i=ot(r);(!t||t>i||isNaN(+i))&&(t=i)}),t||new Date(NaN)}function R6(e){let t;return e.forEach(function(r){const i=ot(r);(t===void 0||t<i||isNaN(Number(i)))&&(t=i)}),t||new Date(NaN)}function vE(e,t){const r=ot(e),i=ot(t),n=r.getFullYear()-i.getFullYear(),s=r.getMonth()-i.getMonth();return n*12+s}function yE(e,t){const r=ot(e),i=ot(t);return r.getFullYear()-i.getFullYear()}function wE(e,t){const r=ot(e),i=ot(t),n=r.getFullYear()-i.getFullYear(),s=sp(r)-sp(i);return n*4+s}function DK(e){const t=ot(e);return t.setDate(1),t.setHours(0,0,0,0),t}function AO(e){const t=ot(e),r=t.getMonth(),i=r-r%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}function MO(e){const t=ot(e);return t.setHours(23,59,59,999),t}function _Be(e,t){var o,l,c,u;const r=ef(),i=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,n=ot(e),s=n.getDay(),a=(s<i?-7:0)+6-(s-i);return n.setDate(n.getDate()+a),n.setHours(23,59,59,999),n}function SBe(e){const t=ot(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function IK(e){const t=ot(e),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function EBe(e,t){const r=ot(e),i=ot(t);return+r==+i}function TBe(e,t){const r=jl(e),i=jl(t);return+r==+i}function CBe(e,t){const r=ot(e),i=ot(t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function ABe(e,t){const r=ot(e),i=ot(t);return r.getFullYear()===i.getFullYear()}function MBe(e,t){const r=AO(e),i=AO(t);return+r==+i}function $h(e,t){const r=ot(e),i=ot(t);return r.getTime()>i.getTime()}function Ip(e,t){const r=ot(e),i=ot(t);return+r<+i}function mw(e,t){const r=+ot(e),[i,n]=[+ot(t.start),+ot(t.end)].sort((s,a)=>s-a);return r>=i&&r<=n}function PBe(){return Object.assign({},ef())}function DBe(e,t){const r=t instanceof Date?Or(t,0):new t(0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}const IBe=10;class OK{constructor(){st(this,"subPriority",0)}validate(t,r){return!0}}class OBe extends OK{constructor(t,r,i,n,s){super(),this.value=t,this.validateValue=r,this.setValue=i,this.priority=n,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,i){return this.setValue(t,r,this.value,i)}}class RBe extends OK{constructor(){super(...arguments);st(this,"priority",IBe);st(this,"subPriority",-1)}set(r,i){return i.timestampIsSet?r:Or(r,DBe(r,Date))}}class Sr{run(t,r,i,n){const s=this.parse(t,r,i,n);return s?{setter:new OBe(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,i){return!0}}class kBe extends Sr{constructor(){super(...arguments);st(this,"priority",140);st(this,"incompatibleTokens",["R","u","t","T"])}parse(r,i,n){switch(i){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"})||n.era(r,{width:"narrow"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})||n.era(r,{width:"abbreviated"})||n.era(r,{width:"narrow"})}}set(r,i,n){return i.era=n,r.setFullYear(n,0,1),r.setHours(0,0,0,0),r}}const Oi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Cl={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ri(e,t){return e&&{value:t(e.value),rest:e.rest}}function hi(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function Al(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const i=r[1]==="+"?1:-1,n=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,a=r[5]?parseInt(r[5],10):0;return{value:i*(n*hC+s*uC+a*iBe),rest:t.slice(r[0].length)}}function RK(e){return hi(Oi.anyDigitsSigned,e)}function Ti(e,t){switch(e){case 1:return hi(Oi.singleDigit,t);case 2:return hi(Oi.twoDigits,t);case 3:return hi(Oi.threeDigits,t);case 4:return hi(Oi.fourDigits,t);default:return hi(new RegExp("^\\d{1,"+e+"}"),t)}}function xE(e,t){switch(e){case 1:return hi(Oi.singleDigitSigned,t);case 2:return hi(Oi.twoDigitsSigned,t);case 3:return hi(Oi.threeDigitsSigned,t);case 4:return hi(Oi.fourDigitsSigned,t);default:return hi(new RegExp("^-?\\d{1,"+e+"}"),t)}}function GL(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function kK(e,t){const r=t>0,i=r?t:1-t;let n;if(i<=50)n=e||100;else{const s=i+50,a=Math.trunc(s/100)*100,o=e>=s%100;n=e+a-(o?100:0)}return r?n:1-n}function LK(e){return e%400===0||e%4===0&&e%100!==0}class LBe extends Sr{constructor(){super(...arguments);st(this,"priority",130);st(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,i,n){const s=a=>({year:a,isTwoDigitYear:i==="yy"});switch(i){case"y":return Ri(Ti(4,r),s);case"yo":return Ri(n.ordinalNumber(r,{unit:"year"}),s);default:return Ri(Ti(i.length,r),s)}}validate(r,i){return i.isTwoDigitYear||i.year>0}set(r,i,n){const s=r.getFullYear();if(n.isTwoDigitYear){const o=kK(n.year,s);return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}const a=!("era"in i)||i.era===1?n.year:1-n.year;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class NBe extends Sr{constructor(){super(...arguments);st(this,"priority",130);st(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,i,n){const s=a=>({year:a,isTwoDigitYear:i==="YY"});switch(i){case"Y":return Ri(Ti(4,r),s);case"Yo":return Ri(n.ordinalNumber(r,{unit:"year"}),s);default:return Ri(Ti(i.length,r),s)}}validate(r,i){return i.isTwoDigitYear||i.year>0}set(r,i,n,s){const a=VL(r,s);if(n.isTwoDigitYear){const l=kK(n.year,a);return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),fu(r,s)}const o=!("era"in i)||i.era===1?n.year:1-n.year;return r.setFullYear(o,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),fu(r,s)}}class zBe extends Sr{constructor(){super(...arguments);st(this,"priority",130);st(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,i){return xE(i==="R"?4:i.length,r)}set(r,i,n){const s=Or(r,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),Mg(s)}}class BBe extends Sr{constructor(){super(...arguments);st(this,"priority",130);st(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,i){return xE(i==="u"?4:i.length,r)}set(r,i,n){return r.setFullYear(n,0,1),r.setHours(0,0,0,0),r}}class FBe extends Sr{constructor(){super(...arguments);st(this,"priority",120);st(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,i,n){switch(i){case"Q":case"QQ":return Ti(i.length,r);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"})||n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})||n.quarter(r,{width:"abbreviated",context:"formatting"})||n.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,i){return i>=1&&i<=4}set(r,i,n){return r.setMonth((n-1)*3,1),r.setHours(0,0,0,0),r}}class UBe extends Sr{constructor(){super(...arguments);st(this,"priority",120);st(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,i,n){switch(i){case"q":case"qq":return Ti(i.length,r);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"})||n.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})||n.quarter(r,{width:"abbreviated",context:"standalone"})||n.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,i){return i>=1&&i<=4}set(r,i,n){return r.setMonth((n-1)*3,1),r.setHours(0,0,0,0),r}}class jBe extends Sr{constructor(){super(...arguments);st(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);st(this,"priority",110)}parse(r,i,n){const s=a=>a-1;switch(i){case"M":return Ri(hi(Oi.month,r),s);case"MM":return Ri(Ti(2,r),s);case"Mo":return Ri(n.ordinalNumber(r,{unit:"month"}),s);case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"})||n.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})||n.month(r,{width:"abbreviated",context:"formatting"})||n.month(r,{width:"narrow",context:"formatting"})}}validate(r,i){return i>=0&&i<=11}set(r,i,n){return r.setMonth(n,1),r.setHours(0,0,0,0),r}}class VBe extends Sr{constructor(){super(...arguments);st(this,"priority",110);st(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,i,n){const s=a=>a-1;switch(i){case"L":return Ri(hi(Oi.month,r),s);case"LL":return Ri(Ti(2,r),s);case"Lo":return Ri(n.ordinalNumber(r,{unit:"month"}),s);case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"})||n.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})||n.month(r,{width:"abbreviated",context:"standalone"})||n.month(r,{width:"narrow",context:"standalone"})}}validate(r,i){return i>=0&&i<=11}set(r,i,n){return r.setMonth(n,1),r.setHours(0,0,0,0),r}}function HBe(e,t,r){const i=ot(e),n=TK(i,r)-t;return i.setDate(i.getDate()-n*7),i}class WBe extends Sr{constructor(){super(...arguments);st(this,"priority",100);st(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,i,n){switch(i){case"w":return hi(Oi.week,r);case"wo":return n.ordinalNumber(r,{unit:"week"});default:return Ti(i.length,r)}}validate(r,i){return i>=1&&i<=53}set(r,i,n,s){return fu(HBe(r,n,s),s)}}function GBe(e,t){const r=ot(e),i=jL(r)-t;return r.setDate(r.getDate()-i*7),r}class qBe extends Sr{constructor(){super(...arguments);st(this,"priority",100);st(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,i,n){switch(i){case"I":return hi(Oi.week,r);case"Io":return n.ordinalNumber(r,{unit:"week"});default:return Ti(i.length,r)}}validate(r,i){return i>=1&&i<=53}set(r,i,n){return Mg(GBe(r,n))}}const YBe=[31,28,31,30,31,30,31,31,30,31,30,31],XBe=[31,29,31,30,31,30,31,31,30,31,30,31];class $Be extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"subPriority",1);st(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,i,n){switch(i){case"d":return hi(Oi.date,r);case"do":return n.ordinalNumber(r,{unit:"date"});default:return Ti(i.length,r)}}validate(r,i){const n=r.getFullYear(),s=LK(n),a=r.getMonth();return s?i>=1&&i<=XBe[a]:i>=1&&i<=YBe[a]}set(r,i,n){return r.setDate(n),r.setHours(0,0,0,0),r}}class QBe extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"subpriority",1);st(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,i,n){switch(i){case"D":case"DD":return hi(Oi.dayOfYear,r);case"Do":return n.ordinalNumber(r,{unit:"date"});default:return Ti(i.length,r)}}validate(r,i){const n=r.getFullYear();return LK(n)?i>=1&&i<=366:i>=1&&i<=365}set(r,i,n){return r.setMonth(0,n),r.setHours(0,0,0,0),r}}function qL(e,t,r){var h,d,p,f;const i=ef(),n=(r==null?void 0:r.weekStartsOn)??((d=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??i.weekStartsOn??((f=(p=i.locale)==null?void 0:p.options)==null?void 0:f.weekStartsOn)??0,s=ot(e),a=s.getDay(),l=(t%7+7)%7,c=7-n,u=t<0||t>6?t-(a+c)%7:(l+c)%7-(a+c)%7;return od(s,u)}class KBe extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,i,n){switch(i){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})||n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"})}}validate(r,i){return i>=0&&i<=6}set(r,i,n,s){return r=qL(r,n,s),r.setHours(0,0,0,0),r}}class ZBe extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,i,n,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(i){case"e":case"ee":return Ri(Ti(i.length,r),a);case"eo":return Ri(n.ordinalNumber(r,{unit:"day"}),a);case"eee":return n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})||n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"})}}validate(r,i){return i>=0&&i<=6}set(r,i,n,s){return r=qL(r,n,s),r.setHours(0,0,0,0),r}}class JBe extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,i,n,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(i){case"c":case"cc":return Ri(Ti(i.length,r),a);case"co":return Ri(n.ordinalNumber(r,{unit:"day"}),a);case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"})||n.day(r,{width:"short",context:"standalone"})||n.day(r,{width:"narrow",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"})||n.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})||n.day(r,{width:"abbreviated",context:"standalone"})||n.day(r,{width:"short",context:"standalone"})||n.day(r,{width:"narrow",context:"standalone"})}}validate(r,i){return i>=0&&i<=6}set(r,i,n,s){return r=qL(r,n,s),r.setHours(0,0,0,0),r}}function eFe(e){let r=ot(e).getDay();return r===0&&(r=7),r}function tFe(e,t){const r=ot(e),i=eFe(r),n=t-i;return od(r,n)}class rFe extends Sr{constructor(){super(...arguments);st(this,"priority",90);st(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,i,n){const s=a=>a===0?7:a;switch(i){case"i":case"ii":return Ti(i.length,r);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return Ri(n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return Ri(n.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return Ri(n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return Ri(n.day(r,{width:"wide",context:"formatting"})||n.day(r,{width:"abbreviated",context:"formatting"})||n.day(r,{width:"short",context:"formatting"})||n.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,i){return i>=1&&i<=7}set(r,i,n){return r=tFe(r,n),r.setHours(0,0,0,0),r}}class iFe extends Sr{constructor(){super(...arguments);st(this,"priority",80);st(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,i,n){switch(i){case"a":case"aa":case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})||n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,i,n){return r.setHours(GL(n),0,0,0),r}}class nFe extends Sr{constructor(){super(...arguments);st(this,"priority",80);st(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,i,n){switch(i){case"b":case"bb":case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})||n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,i,n){return r.setHours(GL(n),0,0,0),r}}class sFe extends Sr{constructor(){super(...arguments);st(this,"priority",80);st(this,"incompatibleTokens",["a","b","t","T"])}parse(r,i,n){switch(i){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})||n.dayPeriod(r,{width:"abbreviated",context:"formatting"})||n.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,i,n){return r.setHours(GL(n),0,0,0),r}}class aFe extends Sr{constructor(){super(...arguments);st(this,"priority",70);st(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,i,n){switch(i){case"h":return hi(Oi.hour12h,r);case"ho":return n.ordinalNumber(r,{unit:"hour"});default:return Ti(i.length,r)}}validate(r,i){return i>=1&&i<=12}set(r,i,n){const s=r.getHours()>=12;return s&&n<12?r.setHours(n+12,0,0,0):!s&&n===12?r.setHours(0,0,0,0):r.setHours(n,0,0,0),r}}class oFe extends Sr{constructor(){super(...arguments);st(this,"priority",70);st(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,i,n){switch(i){case"H":return hi(Oi.hour23h,r);case"Ho":return n.ordinalNumber(r,{unit:"hour"});default:return Ti(i.length,r)}}validate(r,i){return i>=0&&i<=23}set(r,i,n){return r.setHours(n,0,0,0),r}}class lFe extends Sr{constructor(){super(...arguments);st(this,"priority",70);st(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,i,n){switch(i){case"K":return hi(Oi.hour11h,r);case"Ko":return n.ordinalNumber(r,{unit:"hour"});default:return Ti(i.length,r)}}validate(r,i){return i>=0&&i<=11}set(r,i,n){return r.getHours()>=12&&n<12?r.setHours(n+12,0,0,0):r.setHours(n,0,0,0),r}}class cFe extends Sr{constructor(){super(...arguments);st(this,"priority",70);st(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,i,n){switch(i){case"k":return hi(Oi.hour24h,r);case"ko":return n.ordinalNumber(r,{unit:"hour"});default:return Ti(i.length,r)}}validate(r,i){return i>=1&&i<=24}set(r,i,n){const s=n<=24?n%24:n;return r.setHours(s,0,0,0),r}}class uFe extends Sr{constructor(){super(...arguments);st(this,"priority",60);st(this,"incompatibleTokens",["t","T"])}parse(r,i,n){switch(i){case"m":return hi(Oi.minute,r);case"mo":return n.ordinalNumber(r,{unit:"minute"});default:return Ti(i.length,r)}}validate(r,i){return i>=0&&i<=59}set(r,i,n){return r.setMinutes(n,0,0),r}}class hFe extends Sr{constructor(){super(...arguments);st(this,"priority",50);st(this,"incompatibleTokens",["t","T"])}parse(r,i,n){switch(i){case"s":return hi(Oi.second,r);case"so":return n.ordinalNumber(r,{unit:"second"});default:return Ti(i.length,r)}}validate(r,i){return i>=0&&i<=59}set(r,i,n){return r.setSeconds(n,0),r}}class dFe extends Sr{constructor(){super(...arguments);st(this,"priority",30);st(this,"incompatibleTokens",["t","T"])}parse(r,i){const n=s=>Math.trunc(s*Math.pow(10,-i.length+3));return Ri(Ti(i.length,r),n)}set(r,i,n){return r.setMilliseconds(n),r}}class pFe extends Sr{constructor(){super(...arguments);st(this,"priority",10);st(this,"incompatibleTokens",["t","T","x"])}parse(r,i){switch(i){case"X":return Al(Cl.basicOptionalMinutes,r);case"XX":return Al(Cl.basic,r);case"XXXX":return Al(Cl.basicOptionalSeconds,r);case"XXXXX":return Al(Cl.extendedOptionalSeconds,r);case"XXX":default:return Al(Cl.extended,r)}}set(r,i,n){return i.timestampIsSet?r:Or(r,r.getTime()-fE(r)-n)}}class fFe extends Sr{constructor(){super(...arguments);st(this,"priority",10);st(this,"incompatibleTokens",["t","T","X"])}parse(r,i){switch(i){case"x":return Al(Cl.basicOptionalMinutes,r);case"xx":return Al(Cl.basic,r);case"xxxx":return Al(Cl.basicOptionalSeconds,r);case"xxxxx":return Al(Cl.extendedOptionalSeconds,r);case"xxx":default:return Al(Cl.extended,r)}}set(r,i,n){return i.timestampIsSet?r:Or(r,r.getTime()-fE(r)-n)}}class mFe extends Sr{constructor(){super(...arguments);st(this,"priority",40);st(this,"incompatibleTokens","*")}parse(r){return RK(r)}set(r,i,n){return[Or(r,n*1e3),{timestampIsSet:!0}]}}class gFe extends Sr{constructor(){super(...arguments);st(this,"priority",20);st(this,"incompatibleTokens","*")}parse(r){return RK(r)}set(r,i,n){return[Or(r,n),{timestampIsSet:!0}]}}const vFe={G:new kBe,y:new LBe,Y:new NBe,R:new zBe,u:new BBe,Q:new FBe,q:new UBe,M:new jBe,L:new VBe,w:new WBe,I:new qBe,d:new $Be,D:new QBe,E:new KBe,e:new ZBe,c:new JBe,i:new rFe,a:new iFe,b:new nFe,B:new sFe,h:new aFe,H:new oFe,K:new lFe,k:new cFe,m:new uFe,s:new hFe,S:new dFe,X:new pFe,x:new fFe,t:new mFe,T:new gFe},yFe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,wFe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,xFe=/^'([^]*?)'?$/,bFe=/''/g,_Fe=/\S/,SFe=/[a-zA-Z]/;function PP(e,t,r,i){var m,g,v,y,w,b,E,_;const n=PBe(),s=(i==null?void 0:i.locale)??n.locale??_K,a=(i==null?void 0:i.firstWeekContainsDate)??((g=(m=i==null?void 0:i.locale)==null?void 0:m.options)==null?void 0:g.firstWeekContainsDate)??n.firstWeekContainsDate??((y=(v=n.locale)==null?void 0:v.options)==null?void 0:y.firstWeekContainsDate)??1,o=(i==null?void 0:i.weekStartsOn)??((b=(w=i==null?void 0:i.locale)==null?void 0:w.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((_=(E=n.locale)==null?void 0:E.options)==null?void 0:_.weekStartsOn)??0;if(t==="")return e===""?ot(r):Or(r,NaN);const l={firstWeekContainsDate:a,weekStartsOn:o,locale:s},c=[new RBe],u=t.match(wFe).map(C=>{const x=C[0];if(x in mE){const A=mE[x];return A(C,s.formatLong)}return C}).join("").match(yFe),h=[];for(let C of u){!(i!=null&&i.useAdditionalWeekYearTokens)&&MK(C)&&SO(C,t,e),!(i!=null&&i.useAdditionalDayOfYearTokens)&&AK(C)&&SO(C,t,e);const x=C[0],A=vFe[x];if(A){const{incompatibleTokens:T}=A;if(Array.isArray(T)){const D=h.find(P=>T.includes(P.token)||P.token===x);if(D)throw new RangeError(`The format string mustn't contain \`${D.fullToken}\` and \`${C}\` at the same time`)}else if(A.incompatibleTokens==="*"&&h.length>0)throw new RangeError(`The format string mustn't contain \`${C}\` and any other token at the same time`);h.push({token:x,fullToken:C});const M=A.run(e,C,s.match,l);if(!M)return Or(r,NaN);c.push(M.setter),e=M.rest}else{if(x.match(SFe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");if(C==="''"?C="'":x==="'"&&(C=EFe(C)),e.indexOf(C)===0)e=e.slice(C.length);else return Or(r,NaN)}}if(e.length>0&&_Fe.test(e))return Or(r,NaN);const d=c.map(C=>C.priority).sort((C,x)=>x-C).filter((C,x,A)=>A.indexOf(C)===x).map(C=>c.filter(x=>x.priority===C).sort((x,A)=>A.subPriority-x.subPriority)).map(C=>C[0]);let p=ot(r);if(isNaN(p.getTime()))return Or(r,NaN);const f={};for(const C of d){if(!C.validate(p,l))return Or(r,NaN);const x=C.set(p,f,l);Array.isArray(x)?(p=x[0],Object.assign(f,x[1])):p=x}return Or(r,p)}function EFe(e){return e.match(xFe)[1].replace(bFe,"'")}function TFe(e,t){const r=(t==null?void 0:t.additionalDigits)??2,i=PFe(e);let n;if(i.date){const l=DFe(i.date,r);n=IFe(l.restDateString,l.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);const s=n.getTime();let a=0,o;if(i.time&&(a=OFe(i.time),isNaN(a)))return new Date(NaN);if(i.timezone){if(o=RFe(i.timezone),isNaN(o))return new Date(NaN)}else{const l=new Date(s+a),c=new Date(0);return c.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),c.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),c}return new Date(s+a+o)}const yb={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},CFe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,AFe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,MFe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function PFe(e){const t={},r=e.split(yb.dateTimeDelimiter);let i;if(r.length>2)return t;if(/:/.test(r[0])?i=r[0]:(t.date=r[0],i=r[1],yb.timeZoneDelimiter.test(t.date)&&(t.date=e.split(yb.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const n=yb.timezone.exec(i);n?(t.time=i.replace(n[1],""),t.timezone=n[1]):t.time=i}return t}function DFe(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(r);if(!i)return{year:NaN,restDateString:""};const n=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?n:s*100,restDateString:e.slice((i[1]||i[2]).length)}}function IFe(e,t){if(t===null)return new Date(NaN);const r=e.match(CFe);if(!r)return new Date(NaN);const i=!!r[4],n=gy(r[1]),s=gy(r[2])-1,a=gy(r[3]),o=gy(r[4]),l=gy(r[5])-1;if(i)return BFe(t,o,l)?kFe(t,o,l):new Date(NaN);{const c=new Date(0);return!NFe(t,s,a)||!zFe(t,n)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(n,a)),c)}}function gy(e){return e?parseInt(e):1}function OFe(e){const t=e.match(AFe);if(!t)return NaN;const r=DP(t[1]),i=DP(t[2]),n=DP(t[3]);return FFe(r,i,n)?r*hC+i*uC+n*1e3:NaN}function DP(e){return e&&parseFloat(e.replace(",","."))||0}function RFe(e){if(e==="Z")return 0;const t=e.match(MFe);if(!t)return 0;const r=t[1]==="+"?-1:1,i=parseInt(t[2]),n=t[3]&&parseInt(t[3])||0;return UFe(i,n)?r*(i*hC+n*uC):NaN}function kFe(e,t,r){const i=new Date(0);i.setUTCFullYear(e,0,4);const n=i.getUTCDay()||7,s=(t-1)*7+r+1-n;return i.setUTCDate(i.getUTCDate()+s),i}const LFe=[31,null,31,30,31,30,31,31,30,31,30,31];function NK(e){return e%400===0||e%4===0&&e%100!==0}function NFe(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(LFe[t]||(NK(e)?29:28))}function zFe(e,t){return t>=1&&t<=(NK(e)?366:365)}function BFe(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function FFe(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function UFe(e,t){return t>=0&&t<=59}function jFe(e,t){return HL(e,t*1e3)}function VFe(e,t){let r=ot(e);return isNaN(+r)?Or(e,NaN):(t.year!=null&&r.setFullYear(t.year),t.month!=null&&(r=Os(r,t.month)),t.date!=null&&r.setDate(t.date),t.hours!=null&&r.setHours(t.hours),t.minutes!=null&&r.setMinutes(t.minutes),t.seconds!=null&&r.setSeconds(t.seconds),t.milliseconds!=null&&r.setMilliseconds(t.milliseconds),r)}function HFe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,PO(e,t)}function PO(e,t){return PO=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},PO(e,t)}function WFe(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function k6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GFe(e,t,r){return e===t?!0:e.correspondingElement?e.correspondingElement.classList.contains(r):e.classList.contains(r)}function qFe(e,t,r){if(e===t)return!0;for(;e.parentNode||e.host;){if(e.parentNode&&GFe(e,t,r))return!0;e=e.parentNode||e.host}return e}function YFe(e){return document.documentElement.clientWidth<=e.clientX||document.documentElement.clientHeight<=e.clientY}var XFe=function(){if(!(typeof window>"u"||typeof window.addEventListener!="function")){var t=!1,r=Object.defineProperty({},"passive",{get:function(){t=!0}}),i=function(){};return window.addEventListener("testPassiveEventSupport",i,r),window.removeEventListener("testPassiveEventSupport",i,r),t}};function $Fe(e){return e===void 0&&(e=0),function(){return++e}}var QFe=$Fe(),DO,wb={},IP={},KFe=["touchstart","touchmove"],ZFe="ignore-react-onclickoutside";function L6(e,t){var r={},i=KFe.indexOf(t)!==-1;return i&&DO&&(r.passive=!e.props.preventDefault),r}function pC(e,t){var r,i,n=e.displayName||e.name||"Component";return i=r=function(s){HFe(a,s);function a(l){var c;return c=s.call(this,l)||this,c.__outsideClickHandler=function(u){if(typeof c.__clickOutsideHandlerProp=="function"){c.__clickOutsideHandlerProp(u);return}var h=c.getInstance();if(typeof h.props.handleClickOutside=="function"){h.props.handleClickOutside(u);return}if(typeof h.handleClickOutside=="function"){h.handleClickOutside(u);return}throw new Error("WrappedComponent: "+n+" lacks a handleClickOutside(event) function for processing outside click events.")},c.__getComponentNode=function(){var u=c.getInstance();return t&&typeof t.setClickOutsideRef=="function"?t.setClickOutsideRef()(u):typeof u.setClickOutsideRef=="function"?u.setClickOutsideRef():Mw.findDOMNode(u)},c.enableOnClickOutside=function(){if(!(typeof document>"u"||IP[c._uid])){typeof DO>"u"&&(DO=XFe()),IP[c._uid]=!0;var u=c.props.eventTypes;u.forEach||(u=[u]),wb[c._uid]=function(h){if(c.componentNode!==null&&(c.props.preventDefault&&h.preventDefault(),c.props.stopPropagation&&h.stopPropagation(),!(c.props.excludeScrollbar&&YFe(h)))){var d=h.composed&&h.composedPath&&h.composedPath().shift()||h.target;qFe(d,c.componentNode,c.props.outsideClickIgnoreClass)===document&&c.__outsideClickHandler(h)}},u.forEach(function(h){document.addEventListener(h,wb[c._uid],L6(k6(c),h))})}},c.disableOnClickOutside=function(){delete IP[c._uid];var u=wb[c._uid];if(u&&typeof document<"u"){var h=c.props.eventTypes;h.forEach||(h=[h]),h.forEach(function(d){return document.removeEventListener(d,u,L6(k6(c),d))}),delete wb[c._uid]}},c.getRef=function(u){return c.instanceRef=u},c._uid=QFe(),c}var o=a.prototype;return o.getInstance=function(){if(e.prototype&&!e.prototype.isReactComponent)return this;var c=this.instanceRef;return c.getInstance?c.getInstance():c},o.componentDidMount=function(){if(!(typeof document>"u"||!document.createElement)){var c=this.getInstance();if(t&&typeof t.handleClickOutside=="function"&&(this.__clickOutsideHandlerProp=t.handleClickOutside(c),typeof this.__clickOutsideHandlerProp!="function"))throw new Error("WrappedComponent: "+n+" lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=this.__getComponentNode(),!this.props.disableOnClickOutside&&this.enableOnClickOutside()}},o.componentDidUpdate=function(){this.componentNode=this.__getComponentNode()},o.componentWillUnmount=function(){this.disableOnClickOutside()},o.render=function(){var c=this.props;c.excludeScrollbar;var u=WFe(c,["excludeScrollbar"]);return e.prototype&&e.prototype.isReactComponent?u.ref=this.getRef:u.wrappedRef=this.getRef,u.disableOnClickOutside=this.disableOnClickOutside,u.enableOnClickOutside=this.enableOnClickOutside,te.createElement(e,u)},a}(te.Component),r.displayName="OnClickOutside("+n+")",r.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:t&&t.excludeScrollbar||!1,outsideClickIgnoreClass:ZFe,preventDefault:!1,stopPropagation:!1},r.getClass=function(){return e.getClass?e.getClass():e},i}function Qh(e){return zK(e)?(e.nodeName||"").toLowerCase():"#document"}function Ca(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function xu(e){var t;return(t=(zK(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function zK(e){return e instanceof Node||e instanceof Ca(e).Node}function Ea(e){return e instanceof Element||e instanceof Ca(e).Element}function Zl(e){return e instanceof HTMLElement||e instanceof Ca(e).HTMLElement}function N6(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ca(e).ShadowRoot}function lx(e){const{overflow:t,overflowX:r,overflowY:i,display:n}=lo(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!["inline","contents"].includes(n)}function JFe(e){return["table","td","th"].includes(Qh(e))}function YL(e){const t=XL(),r=lo(e);return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(r.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(r.contain||"").includes(i))}function e4e(e){let t=Ig(e);for(;Zl(t)&&!fC(t);){if(YL(t))return t;t=Ig(t)}return null}function XL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fC(e){return["html","body","#document"].includes(Qh(e))}function lo(e){return Ca(e).getComputedStyle(e)}function mC(e){return Ea(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ig(e){if(Qh(e)==="html")return e;const t=e.assignedSlot||e.parentNode||N6(e)&&e.host||xu(e);return N6(t)?t.host:t}function BK(e){const t=Ig(e);return fC(t)?e.ownerDocument?e.ownerDocument.body:e.body:Zl(t)&&lx(t)?t:BK(t)}function gw(e,t,r){var i;t===void 0&&(t=[]),r===void 0&&(r=!0);const n=BK(e),s=n===((i=e.ownerDocument)==null?void 0:i.body),a=Ca(n);return s?t.concat(a,a.visualViewport||[],lx(n)?n:[],a.frameElement&&r?gw(a.frameElement):[]):t.concat(n,gw(n,[],r))}const Og=Math.min,ap=Math.max,bE=Math.round,xb=Math.floor,Kh=e=>({x:e,y:e}),t4e={left:"right",right:"left",bottom:"top",top:"bottom"},r4e={start:"end",end:"start"};function i4e(e,t,r){return ap(e,Og(t,r))}function gC(e,t){return typeof e=="function"?e(t):e}function Rg(e){return e.split("-")[0]}function cx(e){return e.split("-")[1]}function n4e(e){return e==="x"?"y":"x"}function $L(e){return e==="y"?"height":"width"}function QL(e){return["top","bottom"].includes(Rg(e))?"y":"x"}function KL(e){return n4e(QL(e))}function s4e(e,t,r){r===void 0&&(r=!1);const i=cx(e),n=KL(e),s=$L(n);let a=n==="x"?i===(r?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=_E(a)),[a,_E(a)]}function a4e(e){const t=_E(e);return[IO(e),t,IO(t)]}function IO(e){return e.replace(/start|end/g,t=>r4e[t])}function o4e(e,t,r){const i=["left","right"],n=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return r?t?n:i:t?i:n;case"left":case"right":return t?s:a;default:return[]}}function l4e(e,t,r,i){const n=cx(e);let s=o4e(Rg(e),r==="start",i);return n&&(s=s.map(a=>a+"-"+n),t&&(s=s.concat(s.map(IO)))),s}function _E(e){return e.replace(/left|right|bottom|top/g,t=>t4e[t])}function c4e(e){return{top:0,right:0,bottom:0,left:0,...e}}function FK(e){return typeof e!="number"?c4e(e):{top:e,right:e,bottom:e,left:e}}function SE(e){const{x:t,y:r,width:i,height:n}=e;return{width:i,height:n,top:r,left:t,right:t+i,bottom:r+n,x:t,y:r}}function z6(e,t,r){let{reference:i,floating:n}=e;const s=QL(t),a=KL(t),o=$L(a),l=Rg(t),c=s==="y",u=i.x+i.width/2-n.width/2,h=i.y+i.height/2-n.height/2,d=i[o]/2-n[o]/2;let p;switch(l){case"top":p={x:u,y:i.y-n.height};break;case"bottom":p={x:u,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:h};break;case"left":p={x:i.x-n.width,y:h};break;default:p={x:i.x,y:i.y}}switch(cx(t)){case"start":p[a]-=d*(r&&c?-1:1);break;case"end":p[a]+=d*(r&&c?-1:1);break}return p}const u4e=async(e,t,r)=>{const{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:n}),{x:u,y:h}=z6(c,i,l),d=i,p={},f=0;for(let m=0;m<o.length;m++){const{name:g,fn:v}=o[m],{x:y,y:w,data:b,reset:E}=await v({x:u,y:h,initialPlacement:i,placement:d,strategy:n,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=y??u,h=w??h,p={...p,[g]:{...p[g],...b}},E&&f<=50&&(f++,typeof E=="object"&&(E.placement&&(d=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:n}):E.rects),{x:u,y:h}=z6(c,d,l)),m=-1)}return{x:u,y:h,placement:d,strategy:n,middlewareData:p}};async function h4e(e,t){var r;t===void 0&&(t={});const{x:i,y:n,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=gC(t,e),f=FK(p),g=o[d?h==="floating"?"reference":"floating":h],v=SE(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(g)))==null||r?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),y=h==="floating"?{...a.floating,x:i,y:n}:a.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),b=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},E=SE(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:y,offsetParent:w,strategy:l}):y);return{top:(v.top-E.top+f.top)/b.y,bottom:(E.bottom-v.bottom+f.bottom)/b.y,left:(v.left-E.left+f.left)/b.x,right:(E.right-v.right+f.right)/b.x}}const d4e=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:i,placement:n,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=gC(e,t)||{};if(c==null)return{};const h=FK(u),d={x:r,y:i},p=KL(n),f=$L(p),m=await a.getDimensions(c),g=p==="y",v=g?"top":"left",y=g?"bottom":"right",w=g?"clientHeight":"clientWidth",b=s.reference[f]+s.reference[p]-d[p]-s.floating[f],E=d[p]-s.reference[p],_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let C=_?_[w]:0;(!C||!await(a.isElement==null?void 0:a.isElement(_)))&&(C=o.floating[w]||s.floating[f]);const x=b/2-E/2,A=C/2-m[f]/2-1,T=Og(h[v],A),M=Og(h[y],A),D=T,P=C-m[f]-M,I=C/2-m[f]/2+x,B=i4e(D,I,P),V=!l.arrow&&cx(n)!=null&&I!==B&&s.reference[f]/2-(I<D?T:M)-m[f]/2<0,N=V?I<D?I-D:I-P:0;return{[p]:d[p]+N,data:{[p]:B,centerOffset:I-B-N,...V&&{alignmentOffset:N}},reset:V}}}),p4e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,i;const{placement:n,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:m=!0,...g}=gC(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const v=Rg(n),y=Rg(o)===o,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=d||(y||!m?[_E(o)]:a4e(o));!d&&f!=="none"&&b.push(...l4e(o,m,f,w));const E=[o,...b],_=await h4e(t,g),C=[];let x=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&C.push(_[v]),h){const D=s4e(n,a,w);C.push(_[D[0]],_[D[1]])}if(x=[...x,{placement:n,overflows:C}],!C.every(D=>D<=0)){var A,T;const D=(((A=s.flip)==null?void 0:A.index)||0)+1,P=E[D];if(P)return{data:{index:D,overflows:x},reset:{placement:P}};let I=(T=x.filter(B=>B.overflows[0]<=0).sort((B,V)=>B.overflows[1]-V.overflows[1])[0])==null?void 0:T.placement;if(!I)switch(p){case"bestFit":{var M;const B=(M=x.map(V=>[V.placement,V.overflows.filter(N=>N>0).reduce((N,L)=>N+L,0)]).sort((V,N)=>V[1]-N[1])[0])==null?void 0:M[0];B&&(I=B);break}case"initialPlacement":I=o;break}if(n!==I)return{reset:{placement:I}}}return{}}}};async function f4e(e,t){const{placement:r,platform:i,elements:n}=e,s=await(i.isRTL==null?void 0:i.isRTL(n.floating)),a=Rg(r),o=cx(r),l=QL(r)==="y",c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,h=gC(t,e);let{mainAxis:d,crossAxis:p,alignmentAxis:f}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return o&&typeof f=="number"&&(p=o==="end"?f*-1:f),l?{x:p*u,y:d*c}:{x:d*c,y:p*u}}const m4e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,i;const{x:n,y:s,placement:a,middlewareData:o}=t,l=await f4e(t,e);return a===((r=o.offset)==null?void 0:r.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:n+l.x,y:s+l.y,data:{...l,placement:a}}}}};function UK(e){const t=lo(e);let r=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const n=Zl(e),s=n?e.offsetWidth:r,a=n?e.offsetHeight:i,o=bE(r)!==s||bE(i)!==a;return o&&(r=s,i=a),{width:r,height:i,$:o}}function ZL(e){return Ea(e)?e:e.contextElement}function Ym(e){const t=ZL(e);if(!Zl(t))return Kh(1);const r=t.getBoundingClientRect(),{width:i,height:n,$:s}=UK(t);let a=(s?bE(r.width):r.width)/i,o=(s?bE(r.height):r.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const g4e=Kh(0);function jK(e){const t=Ca(e);return!XL()||!t.visualViewport?g4e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function v4e(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Ca(e)?!1:t}function Op(e,t,r,i){t===void 0&&(t=!1),r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=ZL(e);let a=Kh(1);t&&(i?Ea(i)&&(a=Ym(i)):a=Ym(e));const o=v4e(s,r,i)?jK(s):Kh(0);let l=(n.left+o.x)/a.x,c=(n.top+o.y)/a.y,u=n.width/a.x,h=n.height/a.y;if(s){const d=Ca(s),p=i&&Ea(i)?Ca(i):i;let f=d,m=f.frameElement;for(;m&&i&&p!==f;){const g=Ym(m),v=m.getBoundingClientRect(),y=lo(m),w=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,b=v.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,h*=g.y,l+=w,c+=b,f=Ca(m),m=f.frameElement}}return SE({width:u,height:h,x:l,y:c})}const y4e=[":popover-open",":modal"];function VK(e){return y4e.some(t=>{try{return e.matches(t)}catch{return!1}})}function w4e(e){let{elements:t,rect:r,offsetParent:i,strategy:n}=e;const s=n==="fixed",a=xu(i),o=t?VK(t.floating):!1;if(i===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=Kh(1);const u=Kh(0),h=Zl(i);if((h||!h&&!s)&&((Qh(i)!=="body"||lx(a))&&(l=mC(i)),Zl(i))){const d=Op(i);c=Ym(i),u.x=d.x+i.clientLeft,u.y=d.y+i.clientTop}return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x,y:r.y*c.y-l.scrollTop*c.y+u.y}}function x4e(e){return Array.from(e.getClientRects())}function HK(e){return Op(xu(e)).left+mC(e).scrollLeft}function b4e(e){const t=xu(e),r=mC(e),i=e.ownerDocument.body,n=ap(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=ap(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-r.scrollLeft+HK(e);const o=-r.scrollTop;return lo(i).direction==="rtl"&&(a+=ap(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:o}}function _4e(e,t){const r=Ca(e),i=xu(e),n=r.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;const c=XL();(!c||c&&t==="fixed")&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o,y:l}}function S4e(e,t){const r=Op(e,!0,t==="fixed"),i=r.top+e.clientTop,n=r.left+e.clientLeft,s=Zl(e)?Ym(e):Kh(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=n*s.x,c=i*s.y;return{width:a,height:o,x:l,y:c}}function B6(e,t,r){let i;if(t==="viewport")i=_4e(e,r);else if(t==="document")i=b4e(xu(e));else if(Ea(t))i=S4e(t,r);else{const n=jK(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return SE(i)}function WK(e,t){const r=Ig(e);return r===t||!Ea(r)||fC(r)?!1:lo(r).position==="fixed"||WK(r,t)}function E4e(e,t){const r=t.get(e);if(r)return r;let i=gw(e,[],!1).filter(o=>Ea(o)&&Qh(o)!=="body"),n=null;const s=lo(e).position==="fixed";let a=s?Ig(e):e;for(;Ea(a)&&!fC(a);){const o=lo(a),l=YL(a);!l&&o.position==="fixed"&&(n=null),(s?!l&&!n:!l&&o.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||lx(a)&&!l&&WK(e,a))?i=i.filter(u=>u!==a):n=o,a=Ig(a)}return t.set(e,i),i}function T4e(e){let{element:t,boundary:r,rootBoundary:i,strategy:n}=e;const a=[...r==="clippingAncestors"?E4e(t,this._c):[].concat(r),i],o=a[0],l=a.reduce((c,u)=>{const h=B6(t,u,n);return c.top=ap(h.top,c.top),c.right=Og(h.right,c.right),c.bottom=Og(h.bottom,c.bottom),c.left=ap(h.left,c.left),c},B6(t,o,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function C4e(e){const{width:t,height:r}=UK(e);return{width:t,height:r}}function A4e(e,t,r){const i=Zl(t),n=xu(t),s=r==="fixed",a=Op(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Kh(0);if(i||!i&&!s)if((Qh(t)!=="body"||lx(n))&&(o=mC(t)),i){const h=Op(t,!0,s,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else n&&(l.x=HK(n));const c=a.left+o.scrollLeft-l.x,u=a.top+o.scrollTop-l.y;return{x:c,y:u,width:a.width,height:a.height}}function F6(e,t){return!Zl(e)||lo(e).position==="fixed"?null:t?t(e):e.offsetParent}function GK(e,t){const r=Ca(e);if(!Zl(e)||VK(e))return r;let i=F6(e,t);for(;i&&JFe(i)&&lo(i).position==="static";)i=F6(i,t);return i&&(Qh(i)==="html"||Qh(i)==="body"&&lo(i).position==="static"&&!YL(i))?r:i||e4e(e)||r}const M4e=async function(e){const t=this.getOffsetParent||GK,r=this.getDimensions,i=await r(e.floating);return{reference:A4e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function P4e(e){return lo(e).direction==="rtl"}const qK={convertOffsetParentRelativeRectToViewportRelativeRect:w4e,getDocumentElement:xu,getClippingRect:T4e,getOffsetParent:GK,getElementRects:M4e,getClientRects:x4e,getDimensions:C4e,getScale:Ym,isElement:Ea,isRTL:P4e};function D4e(e,t){let r=null,i;const n=xu(e);function s(){var o;clearTimeout(i),(o=r)==null||o.disconnect(),r=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const{left:c,top:u,width:h,height:d}=e.getBoundingClientRect();if(o||t(),!h||!d)return;const p=xb(u),f=xb(n.clientWidth-(c+h)),m=xb(n.clientHeight-(u+d)),g=xb(c),y={rootMargin:-p+"px "+-f+"px "+-m+"px "+-g+"px",threshold:ap(0,Og(1,l))||1};let w=!0;function b(E){const _=E[0].intersectionRatio;if(_!==l){if(!w)return a();_?a(!1,_):i=setTimeout(()=>{a(!1,1e-7)},1e3)}w=!1}try{r=new IntersectionObserver(b,{...y,root:n.ownerDocument})}catch{r=new IntersectionObserver(b,y)}r.observe(e)}return a(!0),s}function I4e(e,t,r,i){i===void 0&&(i={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=ZL(e),u=n||s?[...c?gw(c):[],...gw(t)]:[];u.forEach(v=>{n&&v.addEventListener("scroll",r,{passive:!0}),s&&v.addEventListener("resize",r)});const h=c&&o?D4e(c,r):null;let d=-1,p=null;a&&(p=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(t)})),r()}),c&&!l&&p.observe(c),p.observe(t));let f,m=l?Op(e):null;l&&g();function g(){const v=Op(e);m&&(v.x!==m.x||v.y!==m.y||v.width!==m.width||v.height!==m.height)&&r(),m=v,f=requestAnimationFrame(g)}return r(),()=>{var v;u.forEach(y=>{n&&y.removeEventListener("scroll",r),s&&y.removeEventListener("resize",r)}),h==null||h(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(f)}}const O4e=m4e,R4e=p4e,U6=d4e,k4e=(e,t,r)=>{const i=new Map,n={platform:qK,...r},s={...n.platform,_c:i};return u4e(e,t,{...n,platform:s})},L4e=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:i,padding:n}=typeof e=="function"?e(r):e;return i&&t(i)?i.current!=null?U6({element:i.current,padding:n}).fn(r):{}:i?U6({element:i,padding:n}).fn(r):{}}}};var m_=typeof document<"u"?te.useLayoutEffect:te.useEffect;function EE(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,i,n;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(i=r;i--!==0;)if(!EE(e[i],t[i]))return!1;return!0}if(n=Object.keys(e),r=n.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!{}.hasOwnProperty.call(t,n[i]))return!1;for(i=r;i--!==0;){const s=n[i];if(!(s==="_owner"&&e.$$typeof)&&!EE(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function YK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function j6(e,t){const r=YK(e);return Math.round(t*r)/r}function V6(e){const t=te.useRef(e);return m_(()=>{t.current=e}),t}function N4e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:n,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,h]=te.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[d,p]=te.useState(i);EE(d,i)||p(i);const[f,m]=te.useState(null),[g,v]=te.useState(null),y=te.useCallback(N=>{N!==_.current&&(_.current=N,m(N))},[]),w=te.useCallback(N=>{N!==C.current&&(C.current=N,v(N))},[]),b=s||f,E=a||g,_=te.useRef(null),C=te.useRef(null),x=te.useRef(u),A=l!=null,T=V6(l),M=V6(n),D=te.useCallback(()=>{if(!_.current||!C.current)return;const N={placement:t,strategy:r,middleware:d};M.current&&(N.platform=M.current),k4e(_.current,C.current,N).then(L=>{const W={...L,isPositioned:!0};P.current&&!EE(x.current,W)&&(x.current=W,Mw.flushSync(()=>{h(W)}))})},[d,t,r,M]);m_(()=>{c===!1&&x.current.isPositioned&&(x.current.isPositioned=!1,h(N=>({...N,isPositioned:!1})))},[c]);const P=te.useRef(!1);m_(()=>(P.current=!0,()=>{P.current=!1}),[]),m_(()=>{if(b&&(_.current=b),E&&(C.current=E),b&&E){if(T.current)return T.current(b,E,D);D()}},[b,E,D,T,A]);const I=te.useMemo(()=>({reference:_,floating:C,setReference:y,setFloating:w}),[y,w]),B=te.useMemo(()=>({reference:b,floating:E}),[b,E]),V=te.useMemo(()=>{const N={position:r,left:0,top:0};if(!B.floating)return N;const L=j6(B.floating,u.x),W=j6(B.floating,u.y);return o?{...N,transform:"translate("+L+"px, "+W+"px)",...YK(B.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:L,top:W}},[r,o,B.floating,u.x,u.y]);return te.useMemo(()=>({...u,update:D,refs:I,elements:B,floatingStyles:V}),[u,D,I,B,V])}const z4e=uR.useInsertionEffect,B4e=z4e||(e=>e());function F4e(e){const t=te.useRef(()=>{});return B4e(()=>{t.current=e}),te.useCallback(function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return t.current==null?void 0:t.current(...i)},[])}var XK=typeof document<"u"?te.useLayoutEffect:te.useEffect;function OO(){return OO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},OO.apply(this,arguments)}let OP=!1,U4e=0;const H6=()=>"floating-ui-"+U4e++;function j4e(){const[e,t]=te.useState(()=>OP?H6():void 0);return XK(()=>{e==null&&t(H6())},[]),te.useEffect(()=>{OP||(OP=!0)},[]),e}const V4e=uR.useId,$K=V4e||j4e,H4e=te.forwardRef(function(t,r){let{context:{placement:i,elements:{floating:n},middlewareData:{arrow:s}},width:a=14,height:o=7,tipRadius:l=0,strokeWidth:c=0,staticOffset:u,stroke:h,d,style:{transform:p,...f}={},...m}=t;const g=$K();if(!n)return null;c*=2;const v=c/2,y=a/2*(l/-8+1),w=o/2*l/4,[b,E]=i.split("-"),_=qK.isRTL(n),C=!!d,x=b==="top"||b==="bottom",A=u&&E==="end"?"bottom":"top";let T=u&&E==="end"?"right":"left";u&&_&&(T=E==="end"?"left":"right");const M=(s==null?void 0:s.x)!=null?u||s.x:"",D=(s==null?void 0:s.y)!=null?u||s.y:"",P=d||"M0,0"+(" H"+a)+(" L"+(a-y)+","+(o-w))+(" Q"+a/2+","+o+" "+y+","+(o-w))+" Z",I={top:C?"rotate(180deg)":"",left:C?"rotate(90deg)":"rotate(-90deg)",bottom:C?"":"rotate(180deg)",right:C?"rotate(-90deg)":"rotate(90deg)"}[b];return te.createElement("svg",OO({},m,{"aria-hidden":!0,ref:r,width:C?a:a+c,height:a,viewBox:"0 0 "+a+" "+(o>a?o:a),style:{position:"absolute",pointerEvents:"none",[T]:M,[A]:D,[b]:x||C?"100%":"calc(100% - "+c/2+"px)",transform:""+I+(p??""),...f}}),c>0&&te.createElement("path",{clipPath:"url(#"+g+")",fill:"none",stroke:h,strokeWidth:c+(d?0:1),d:P}),te.createElement("path",{stroke:c&&!d?m.fill:"none",d:P}),te.createElement("clipPath",{id:g},te.createElement("rect",{x:-v,y:v*(C?-1:1),width:a+c,height:a})))});function W4e(){const e=new Map;return{emit(t,r){var i;(i=e.get(t))==null||i.forEach(n=>n(r))},on(t,r){e.set(t,[...e.get(t)||[],r])},off(t,r){var i;e.set(t,((i=e.get(t))==null?void 0:i.filter(n=>n!==r))||[])}}}const G4e=te.createContext(null),q4e=te.createContext(null),Y4e=()=>{var e;return((e=te.useContext(G4e))==null?void 0:e.id)||null},X4e=()=>te.useContext(q4e);function $4e(e){var t;e===void 0&&(e={});const{open:r=!1,onOpenChange:i,nodeId:n}=e,[s,a]=te.useState(null),o=((t=e.elements)==null?void 0:t.reference)||s,l=N4e(e),c=X4e(),u=Y4e()!=null,h=F4e((E,_,C)=>{E&&(p.current.openEvent=_),f.emit("openchange",{open:E,event:_,reason:C,nested:u}),i==null||i(E,_,C)}),d=te.useRef(null),p=te.useRef({}),f=te.useState(()=>W4e())[0],m=$K(),g=te.useCallback(E=>{const _=Ea(E)?{getBoundingClientRect:()=>E.getBoundingClientRect(),contextElement:E}:E;l.refs.setReference(_)},[l.refs]),v=te.useCallback(E=>{(Ea(E)||E===null)&&(d.current=E,a(E)),(Ea(l.refs.reference.current)||l.refs.reference.current===null||E!==null&&!Ea(E))&&l.refs.setReference(E)},[l.refs]),y=te.useMemo(()=>({...l.refs,setReference:v,setPositionReference:g,domReference:d}),[l.refs,v,g]),w=te.useMemo(()=>({...l.elements,domReference:o}),[l.elements,o]),b=te.useMemo(()=>({...l,refs:y,elements:w,dataRef:p,nodeId:n,floatingId:m,events:f,open:r,onOpenChange:h}),[l,n,m,f,r,h,y,w]);return XK(()=>{const E=c==null?void 0:c.nodesRef.current.find(_=>_.id===n);E&&(E.context=b)}),te.useMemo(()=>({...l,context:b,refs:y,elements:w}),[l,y,w,b])}/*!
  react-datepicker v6.9.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/function An(e,t,r){return t=TE(t),Z4e(e,QK()?Reflect.construct(t,r||[],TE(e).constructor):t.apply(e,r))}function QK(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QK=function(){return!!e})()}function W6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function kc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W6(Object(r),!0).forEach(function(i){Z(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W6(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Q4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KK(e){var t=Q4e(e,"string");return typeof t=="symbol"?t:t+""}function RO(e){"@babel/helpers - typeof";return RO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RO(e)}function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G6(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,KK(i.key),i)}}function Pn(e,t,r){return t&&G6(e.prototype,t),r&&G6(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z(e,t,r){return t=KK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vw(){return vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},vw.apply(this,arguments)}function Dn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kO(e,t)}function TE(e){return TE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TE(e)}function kO(e,t){return kO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},kO(e,t)}function K4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z4e(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K4e(e)}function Zh(e){return J4e(e)||eUe(e)||tUe(e)||rUe()}function J4e(e){if(Array.isArray(e))return LO(e)}function eUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tUe(e,t){if(e){if(typeof e=="string")return LO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(e,t)}}function LO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function rUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ux=12,iUe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;function kr(e){var t=e?typeof e=="string"||e instanceof String?TFe(e):ot(e):new Date;return Gu(t)?t:null}function nUe(e,t,r,i,n){var s=null,a=tu(r)||tu(op()),o=!0;return Array.isArray(t)?(t.forEach(function(l){var c=PP(e,l,new Date,{locale:a,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});i&&(o=Gu(c,n)&&e===ii(c,l,r)),Gu(c,n)&&o&&(s=c)}),s):(s=PP(e,t,new Date,{locale:a,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0}),i?o=Gu(s)&&e===ii(s,t,r):Gu(s)||(t=t.match(iUe).map(function(l){var c=l[0];if(c==="p"||c==="P"){var u=mE[c];return a?u(l,a.formatLong):c}return l}).join(""),e.length>0&&(s=PP(e,t.slice(0,e.length),new Date,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})),Gu(s)||(s=new Date(e))),Gu(s)&&o?s:null)}function Gu(e,t){return t=t||new Date("1/1/1000"),pw(e)&&!Ip(e,t)}function ii(e,t,r){if(r==="en")return EO(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var i=tu(r);return r&&!i&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),!i&&op()&&tu(op())&&(i=tu(op())),EO(e,t,{locale:i||null,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Ga(e,t){var r=t.dateFormat,i=t.locale;return e&&ii(e,Array.isArray(r)?r[0]:r,i)||""}function sUe(e,t,r){if(!e)return"";var i=Ga(e,r),n=t?Ga(t,r):"";return"".concat(i," - ").concat(n)}function aUe(e,t){if(!(e!=null&&e.length))return"";var r=Ga(e[0],t);if(e.length===1)return r;if(e.length===2){var i=Ga(e[1],t);return"".concat(r,", ").concat(i)}var n=e.length-1;return"".concat(r," (+").concat(n,")")}function RP(e,t){var r=t.hour,i=r===void 0?0:r,n=t.minute,s=n===void 0?0:n,a=t.second,o=a===void 0?0:a;return f_(p_(d_(e,o),s),i)}function oUe(e,t){return t&&tu(t)||op()&&tu(op()),jL(e)}function lUe(e,t){return ii(e,"ddd",t)}function cUe(e){return jl(e)}function zh(e,t,r){var i=tu(t||op());return fu(e,{locale:i,weekStartsOn:r})}function Bh(e){return DK(e)}function zy(e){return dC(e)}function q6(e){return AO(e)}function Y6(){return jl(kr())}function uUe(e){return _Be(e)}function bl(e,t){return e&&t?ABe(e,t):!e&&!t}function ma(e,t){return e&&t?CBe(e,t):!e&&!t}function CE(e,t){return e&&t?MBe(e,t):!e&&!t}function xr(e,t){return e&&t?TBe(e,t):!e&&!t}function Gd(e,t){return e&&t?EBe(e,t):!e&&!t}function By(e,t,r){var i,n=jl(t),s=MO(r);try{i=mw(e,{start:n,end:s})}catch{i=!1}return i}function op(){var e=typeof window<"u"?window:globalThis;return e.__localeId__}function tu(e){if(typeof e=="string"){var t=typeof window<"u"?window:globalThis;return t.__localeData__?t.__localeData__[e]:null}else return e}function hUe(e,t,r){return t(ii(e,"EEEE",r))}function dUe(e,t){return ii(e,"EEEEEE",t)}function pUe(e,t){return ii(e,"EEE",t)}function JL(e,t){return ii(Os(kr(),e),"LLLL",t)}function ZK(e,t){return ii(Os(kr(),e),"LLL",t)}function fUe(e,t){return ii(tm(kr(),e),"QQQ",t)}function vC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.maxDate,n=t.excludeDates,s=t.excludeDateIntervals,a=t.includeDates,o=t.includeDateIntervals,l=t.filterDate;return yC(e,{minDate:r,maxDate:i})||n&&n.some(function(c){return xr(e,c.date?c.date:c)})||s&&s.some(function(c){var u=c.start,h=c.end;return mw(e,{start:u,end:h})})||a&&!a.some(function(c){return xr(e,c)})||o&&!o.some(function(c){var u=c.start,h=c.end;return mw(e,{start:u,end:h})})||l&&!l(kr(e))||!1}function eN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.excludeDates,i=t.excludeDateIntervals;return i&&i.length>0?i.some(function(n){var s=n.start,a=n.end;return mw(e,{start:s,end:a})}):r&&r.some(function(n){return xr(e,n.date?n.date:n)})||!1}function g_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.maxDate,n=t.excludeDates,s=t.includeDates,a=t.filterDate;return yC(e,{minDate:DK(r),maxDate:SBe(i)})||n&&n.some(function(o){return ma(e,o)})||s&&!s.some(function(o){return ma(e,o)})||a&&!a(kr(e))||!1}function bb(e,t,r,i){var n=rr(e),s=zs(e),a=rr(t),o=zs(t),l=rr(i);if(n===a&&n===l)return s<=r&&r<=o;if(n<a)return l===n&&s<=r||l===a&&o>=r||l<a&&l>n}function kP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.maxDate,n=t.excludeDates,s=t.includeDates,a=t.filterDate;return yC(e,{minDate:r,maxDate:i})||n&&n.some(function(o){return CE(e,o)})||s&&!s.some(function(o){return CE(e,o)})||a&&!a(kr(e))||!1}function _b(e,t,r){if(!pw(t)||!pw(r))return!1;var i=rr(t),n=rr(r);return i<=e&&n>=e}function JK(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.maxDate,n=t.excludeDates,s=t.includeDates,a=t.filterDate,o=new Date(e,0,1);return yC(o,{minDate:dC(r),maxDate:IK(i)})||n&&n.some(function(l){return bl(o,l)})||s&&!s.some(function(l){return bl(o,l)})||a&&!a(kr(o))||!1}function Sb(e,t,r,i){var n=rr(e),s=sp(e),a=rr(t),o=sp(t),l=rr(i);if(n===a&&n===l)return s<=r&&r<=o;if(n<a)return l===n&&s<=r||l===a&&o>=r||l<a&&l>n}function yC(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.maxDate;return r&&fw(e,r)<0||i&&fw(e,i)>0}function X6(e,t){return t.some(function(r){return Hl(r)===Hl(e)&&Vl(r)===Vl(e)&&eu(r)===eu(e)})}function $6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.excludeTimes,i=t.includeTimes,n=t.filterTime;return r&&X6(e,r)||i&&!X6(e,i)||n&&!n(e)||!1}function Q6(e,t){var r=t.minTime,i=t.maxTime;if(!r||!i)throw new Error("Both minTime and maxTime props required");var n=kr();n=f_(n,Hl(e)),n=p_(n,Vl(e)),n=d_(n,eu(e));var s=kr();s=f_(s,Hl(r)),s=p_(s,Vl(r)),s=d_(s,eu(r));var a=kr();a=f_(a,Hl(i)),a=p_(a,Vl(i)),a=d_(a,eu(i));var o;try{o=!mw(n,{start:s,end:a})}catch{o=!1}return o}function K6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.includeDates,n=Pg(e,1);return r&&vE(r,n)>0||i&&i.every(function(s){return vE(s,n)>0})||!1}function Z6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,i=t.includeDates,n=Xo(e,1);return r&&vE(n,r)>0||i&&i.every(function(s){return vE(n,s)>0})||!1}function mUe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.includeDates,n=dC(e),s=PK(n,1);return r&&wE(r,s)>0||i&&i.every(function(a){return wE(a,s)>0})||!1}function gUe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,i=t.includeDates,n=IK(e),s=WL(n,1);return r&&wE(s,r)>0||i&&i.every(function(a){return wE(s,a)>0})||!1}function J6(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.includeDates,n=Dg(e,1);return r&&yE(r,n)>0||i&&i.every(function(s){return yE(s,n)>0})||!1}function vUe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.minDate,i=t.yearItemNumber,n=i===void 0?ux:i,s=zy(Dg(e,n)),a=yh(s,n),o=a.endPeriod,l=r&&rr(r);return l&&l>o||!1}function eH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,i=t.includeDates,n=Jc(e,1);return r&&yE(n,r)>0||i&&i.every(function(s){return yE(n,s)>0})||!1}function yUe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.maxDate,i=t.yearItemNumber,n=i===void 0?ux:i,s=Jc(e,n),a=yh(s,n),o=a.startPeriod,l=r&&rr(r);return l&&l<o||!1}function eZ(e){var t=e.minDate,r=e.includeDates;if(r&&t){var i=r.filter(function(n){return fw(n,t)>=0});return O6(i)}else return r?O6(r):t}function tZ(e){var t=e.maxDate,r=e.includeDates;if(r&&t){var i=r.filter(function(n){return fw(n,t)<=0});return R6(i)}else return r?R6(r):t}function tH(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"react-datepicker__day--highlighted",r=new Map,i=0,n=e.length;i<n;i++){var s=e[i];if(Dp(s)){var a=ii(s,"MM.dd.yyyy"),o=r.get(a)||[];o.includes(t)||(o.push(t),r.set(a,o))}else if(RO(s)==="object"){var l=Object.keys(s),c=l[0],u=s[l[0]];if(typeof c=="string"&&u.constructor===Array)for(var h=0,d=u.length;h<d;h++){var p=ii(u[h],"MM.dd.yyyy"),f=r.get(p)||[];f.includes(c)||(f.push(c),r.set(p,f))}}}return r}function wUe(e,t){return e.length!==t.length?!1:e.every(function(r,i){return r===t[i]})}function xUe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"react-datepicker__day--holidays",r=new Map;return e.forEach(function(i){var n=i.date,s=i.holidayName;if(Dp(n)){var a=ii(n,"MM.dd.yyyy"),o=r.get(a)||{};if(!("className"in o&&o.className===t&&wUe(o.holidayNames,[s]))){o.className=t;var l=o.holidayNames;o.holidayNames=l?[].concat(Zh(l),[s]):[s],r.set(a,o)}}}),r}function bUe(e,t,r,i,n){for(var s=n.length,a=[],o=0;o<s;o++){var l=e;l=yBe(l,Hl(n[o])),l=TO(l,Vl(n[o])),l=jFe(l,eu(n[o]));var c=TO(e,(r+1)*i);$h(l,t)&&Ip(l,c)&&a.push(n[o])}return a}function rH(e){return e<10?"0".concat(e):"".concat(e)}function yh(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ux,r=Math.ceil(rr(e)/t)*t,i=r-(t-1);return{startPeriod:i,endPeriod:r}}function _Ue(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+r-+t)/36e5)}function iH(e){var t=e.getSeconds(),r=e.getMilliseconds();return ot(e.getTime()-t*1e3-r)}function SUe(e,t){return iH(e).getTime()===iH(t).getTime()}function nH(e){if(!Dp(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function sH(e,t){if(!Dp(e)||!Dp(t))throw new Error("Invalid date received");var r=nH(e),i=nH(t);return Ip(r,i)}function rZ(e){var t=" ";return e.key===t}function EUe(e,t,r,i){for(var n=[],s=0;s<2*t+1;s++){var a=e+t-s,o=!0;r&&(o=rr(r)<=a),i&&o&&(o=rr(i)>=a),o&&n.push(a)}return n}var TUe=function(e){function t(r){var i;Mn(this,t),i=An(this,t,[r]),Z(i,"renderOptions",function(){var o=i.props.year,l=i.state.yearsList.map(function(h){return fe.createElement("div",{className:o===h?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:h,onClick:i.onChange.bind(i,h),"aria-selected":o===h?"true":void 0},o===h?fe.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",h)}),c=i.props.minDate?rr(i.props.minDate):null,u=i.props.maxDate?rr(i.props.maxDate):null;return(!u||!i.state.yearsList.find(function(h){return h===u}))&&l.unshift(fe.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:i.incrementYears},fe.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!c||!i.state.yearsList.find(function(h){return h===c}))&&l.push(fe.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:i.decrementYears},fe.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),l}),Z(i,"onChange",function(o){i.props.onChange(o)}),Z(i,"handleClickOutside",function(){i.props.onCancel()}),Z(i,"shiftYears",function(o){var l=i.state.yearsList.map(function(c){return c+o});i.setState({yearsList:l})}),Z(i,"incrementYears",function(){return i.shiftYears(1)}),Z(i,"decrementYears",function(){return i.shiftYears(-1)});var n=r.yearDropdownItemNumber,s=r.scrollableYearDropdown,a=n||(s?10:5);return i.state={yearsList:EUe(i.props.year,a,i.props.minDate,i.props.maxDate)},i.dropdownRef=te.createRef(),i}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){var i=this.dropdownRef.current;if(i){var n=i.children?Array.from(i.children):null,s=n?n.find(function(a){return a.ariaSelected}):null;i.scrollTop=s?s.offsetTop+(s.clientHeight-i.clientHeight)/2:(i.scrollHeight-i.clientHeight)/2}}},{key:"render",value:function(){var i=Xn({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return fe.createElement("div",{className:i,ref:this.dropdownRef},this.renderOptions())}}])}(fe.Component),CUe=pC(TUe),AUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"state",{dropdownVisible:!1}),Z(r,"renderSelectOptions",function(){for(var a=r.props.minDate?rr(r.props.minDate):1900,o=r.props.maxDate?rr(r.props.maxDate):2100,l=[],c=a;c<=o;c++)l.push(fe.createElement("option",{key:c,value:c},c));return l}),Z(r,"onSelectChange",function(a){r.onChange(a.target.value)}),Z(r,"renderSelectMode",function(){return fe.createElement("select",{value:r.props.year,className:"react-datepicker__year-select",onChange:r.onSelectChange},r.renderSelectOptions())}),Z(r,"renderReadView",function(a){return fe.createElement("div",{key:"read",style:{visibility:a?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(l){return r.toggleDropdown(l)}},fe.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},r.props.year))}),Z(r,"renderDropdown",function(){return fe.createElement(CUe,{key:"dropdown",year:r.props.year,onChange:r.onChange,onCancel:r.toggleDropdown,minDate:r.props.minDate,maxDate:r.props.maxDate,scrollableYearDropdown:r.props.scrollableYearDropdown,yearDropdownItemNumber:r.props.yearDropdownItemNumber})}),Z(r,"renderScrollMode",function(){var a=r.state.dropdownVisible,o=[r.renderReadView(!a)];return a&&o.unshift(r.renderDropdown()),o}),Z(r,"onChange",function(a){r.toggleDropdown(),a!==r.props.year&&r.props.onChange(a)}),Z(r,"toggleDropdown",function(a){r.setState({dropdownVisible:!r.state.dropdownVisible},function(){r.props.adjustDateOnChange&&r.handleYearChange(r.props.date,a)})}),Z(r,"handleYearChange",function(a,o){r.onSelect(a,o),r.setOpen()}),Z(r,"onSelect",function(a,o){r.props.onSelect&&r.props.onSelect(a,o)}),Z(r,"setOpen",function(){r.props.setOpen&&r.props.setOpen(!0)}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i;switch(this.props.dropdownMode){case"scroll":i=this.renderScrollMode();break;case"select":i=this.renderSelectMode();break}return fe.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},i)}}])}(fe.Component),MUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"isSelectedMonth",function(a){return r.props.month===a}),Z(r,"renderOptions",function(){return r.props.monthNames.map(function(a,o){return fe.createElement("div",{className:r.isSelectedMonth(o)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:a,onClick:r.onChange.bind(r,o),"aria-selected":r.isSelectedMonth(o)?"true":void 0},r.isSelectedMonth(o)?fe.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",a)})}),Z(r,"onChange",function(a){return r.props.onChange(a)}),Z(r,"handleClickOutside",function(){return r.props.onCancel()}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){return fe.createElement("div",{className:"react-datepicker__month-dropdown"},this.renderOptions())}}])}(fe.Component),PUe=pC(MUe),DUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"state",{dropdownVisible:!1}),Z(r,"renderSelectOptions",function(a){return a.map(function(o,l){return fe.createElement("option",{key:l,value:l},o)})}),Z(r,"renderSelectMode",function(a){return fe.createElement("select",{value:r.props.month,className:"react-datepicker__month-select",onChange:function(l){return r.onChange(l.target.value)}},r.renderSelectOptions(a))}),Z(r,"renderReadView",function(a,o){return fe.createElement("div",{key:"read",style:{visibility:a?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:r.toggleDropdown},fe.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},o[r.props.month]))}),Z(r,"renderDropdown",function(a){return fe.createElement(PUe,{key:"dropdown",month:r.props.month,monthNames:a,onChange:r.onChange,onCancel:r.toggleDropdown})}),Z(r,"renderScrollMode",function(a){var o=r.state.dropdownVisible,l=[r.renderReadView(!o,a)];return o&&l.unshift(r.renderDropdown(a)),l}),Z(r,"onChange",function(a){r.toggleDropdown(),a!==r.props.month&&r.props.onChange(a)}),Z(r,"toggleDropdown",function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(a){return ZK(a,i.props.locale)}:function(a){return JL(a,i.props.locale)}),s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode(n);break;case"select":s=this.renderSelectMode(n);break}return fe.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},s)}}])}(fe.Component);function IUe(e,t){for(var r=[],i=Bh(e),n=Bh(t);!$h(i,n);)r.push(kr(i)),i=Xo(i,1);return r}var OUe=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"renderOptions",function(){return i.state.monthYearsList.map(function(n){var s=CO(n),a=bl(i.props.date,n)&&ma(i.props.date,n);return fe.createElement("div",{className:a?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:s,onClick:i.onChange.bind(i,s),"aria-selected":a?"true":void 0},a?fe.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",ii(n,i.props.dateFormat,i.props.locale))})}),Z(i,"onChange",function(n){return i.props.onChange(n)}),Z(i,"handleClickOutside",function(){i.props.onCancel()}),i.state={monthYearsList:IUe(i.props.minDate,i.props.maxDate)},i}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i=Xn({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return fe.createElement("div",{className:i},this.renderOptions())}}])}(fe.Component),RUe=pC(OUe),kUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"state",{dropdownVisible:!1}),Z(r,"renderSelectOptions",function(){for(var a=Bh(r.props.minDate),o=Bh(r.props.maxDate),l=[];!$h(a,o);){var c=CO(a);l.push(fe.createElement("option",{key:c,value:c},ii(a,r.props.dateFormat,r.props.locale))),a=Xo(a,1)}return l}),Z(r,"onSelectChange",function(a){r.onChange(a.target.value)}),Z(r,"renderSelectMode",function(){return fe.createElement("select",{value:CO(Bh(r.props.date)),className:"react-datepicker__month-year-select",onChange:r.onSelectChange},r.renderSelectOptions())}),Z(r,"renderReadView",function(a){var o=ii(r.props.date,r.props.dateFormat,r.props.locale);return fe.createElement("div",{key:"read",style:{visibility:a?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:function(c){return r.toggleDropdown(c)}},fe.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),fe.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},o))}),Z(r,"renderDropdown",function(){return fe.createElement(RUe,{key:"dropdown",date:r.props.date,dateFormat:r.props.dateFormat,onChange:r.onChange,onCancel:r.toggleDropdown,minDate:r.props.minDate,maxDate:r.props.maxDate,scrollableMonthYearDropdown:r.props.scrollableMonthYearDropdown,locale:r.props.locale})}),Z(r,"renderScrollMode",function(){var a=r.state.dropdownVisible,o=[r.renderReadView(!a)];return a&&o.unshift(r.renderDropdown()),o}),Z(r,"onChange",function(a){r.toggleDropdown();var o=kr(parseInt(a));bl(r.props.date,o)&&ma(r.props.date,o)||r.props.onChange(o)}),Z(r,"toggleDropdown",function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i;switch(this.props.dropdownMode){case"scroll":i=this.renderScrollMode();break;case"select":i=this.renderSelectMode();break}return fe.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},i)}}])}(fe.Component),LUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"dayEl",fe.createRef()),Z(r,"handleClick",function(a){!r.isDisabled()&&r.props.onClick&&r.props.onClick(a)}),Z(r,"handleMouseEnter",function(a){!r.isDisabled()&&r.props.onMouseEnter&&r.props.onMouseEnter(a)}),Z(r,"handleOnKeyDown",function(a){var o=a.key;o===" "&&(a.preventDefault(),a.key="Enter"),r.props.handleOnKeyDown(a)}),Z(r,"isSameDay",function(a){return xr(r.props.day,a)}),Z(r,"isKeyboardSelected",function(){var a;if(r.props.disabledKeyboardNavigation)return!1;var o=r.props.selectsMultiple?(a=r.props.selectedDates)===null||a===void 0?void 0:a.some(function(l){return r.isSameDayOrWeek(l)}):r.isSameDayOrWeek(r.props.selected);return!o&&r.isSameDayOrWeek(r.props.preSelection)}),Z(r,"isDisabled",function(){return vC(r.props.day,r.props)}),Z(r,"isExcluded",function(){return eN(r.props.day,r.props)}),Z(r,"isStartOfWeek",function(){return xr(r.props.day,zh(r.props.day,r.props.locale,r.props.calendarStartDay))}),Z(r,"isSameWeek",function(a){return r.props.showWeekPicker&&xr(a,zh(r.props.day,r.props.locale,r.props.calendarStartDay))}),Z(r,"isSameDayOrWeek",function(a){return r.isSameDay(a)||r.isSameWeek(a)}),Z(r,"getHighLightedClass",function(){var a=r.props,o=a.day,l=a.highlightDates;if(!l)return!1;var c=ii(o,"MM.dd.yyyy");return l.get(c)}),Z(r,"getHolidaysClass",function(){var a=r.props,o=a.day,l=a.holidays;if(!l)return!1;var c=ii(o,"MM.dd.yyyy");if(l.has(c))return[l.get(c).className]}),Z(r,"isInRange",function(){var a=r.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:By(o,l,c)}),Z(r,"isInSelectingRange",function(){var a,o=r.props,l=o.day,c=o.selectsStart,u=o.selectsEnd,h=o.selectsRange,d=o.selectsDisabledDaysInRange,p=o.startDate,f=o.endDate,m=(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection;return!(c||u||h)||!m||!d&&r.isDisabled()?!1:c&&f&&(Ip(m,f)||Gd(m,f))?By(l,m,f):u&&p&&($h(m,p)||Gd(m,p))||h&&p&&!f&&($h(m,p)||Gd(m,p))?By(l,p,m):!1}),Z(r,"isSelectingRangeStart",function(){var a;if(!r.isInSelectingRange())return!1;var o=r.props,l=o.day,c=o.startDate,u=o.selectsStart,h=(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection;return u?xr(l,h):xr(l,c)}),Z(r,"isSelectingRangeEnd",function(){var a;if(!r.isInSelectingRange())return!1;var o=r.props,l=o.day,c=o.endDate,u=o.selectsEnd,h=o.selectsRange,d=(a=r.props.selectingDate)!==null&&a!==void 0?a:r.props.preSelection;return u||h?xr(l,d):xr(l,c)}),Z(r,"isRangeStart",function(){var a=r.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:xr(l,o)}),Z(r,"isRangeEnd",function(){var a=r.props,o=a.day,l=a.startDate,c=a.endDate;return!l||!c?!1:xr(c,o)}),Z(r,"isWeekend",function(){var a=xBe(r.props.day);return a===0||a===6}),Z(r,"isAfterMonth",function(){return r.props.month!==void 0&&(r.props.month+1)%12===zs(r.props.day)}),Z(r,"isBeforeMonth",function(){return r.props.month!==void 0&&(zs(r.props.day)+1)%12===r.props.month}),Z(r,"isCurrentDay",function(){return r.isSameDay(kr())}),Z(r,"isSelected",function(){if(r.props.selectsMultiple){var a;return(a=r.props.selectedDates)===null||a===void 0?void 0:a.some(function(o){return r.isSameDayOrWeek(o)})}return r.isSameDayOrWeek(r.props.selected)}),Z(r,"getClassNames",function(a){var o=r.props.dayClassName?r.props.dayClassName(a):void 0;return Xn("react-datepicker__day",o,"react-datepicker__day--"+lUe(r.props.day),{"react-datepicker__day--disabled":r.isDisabled(),"react-datepicker__day--excluded":r.isExcluded(),"react-datepicker__day--selected":r.isSelected(),"react-datepicker__day--keyboard-selected":r.isKeyboardSelected(),"react-datepicker__day--range-start":r.isRangeStart(),"react-datepicker__day--range-end":r.isRangeEnd(),"react-datepicker__day--in-range":r.isInRange(),"react-datepicker__day--in-selecting-range":r.isInSelectingRange(),"react-datepicker__day--selecting-range-start":r.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":r.isSelectingRangeEnd(),"react-datepicker__day--today":r.isCurrentDay(),"react-datepicker__day--weekend":r.isWeekend(),"react-datepicker__day--outside-month":r.isAfterMonth()||r.isBeforeMonth()},r.getHighLightedClass("react-datepicker__day--highlighted"),r.getHolidaysClass())}),Z(r,"getAriaLabel",function(){var a=r.props,o=a.day,l=a.ariaLabelPrefixWhenEnabled,c=l===void 0?"Choose":l,u=a.ariaLabelPrefixWhenDisabled,h=u===void 0?"Not available":u,d=r.isDisabled()||r.isExcluded()?h:c;return"".concat(d," ").concat(ii(o,"PPPP",r.props.locale))}),Z(r,"getTitle",function(){var a=r.props,o=a.day,l=a.holidays,c=l===void 0?new Map:l,u=a.excludeDates,h=ii(o,"MM.dd.yyyy"),d=[];return c.has(h)&&d.push.apply(d,Zh(c.get(h).holidayNames)),r.isExcluded()&&d.push(u==null?void 0:u.filter(function(p){return xr(p.date?p.date:p,o)}).map(function(p){return p.message})),d.join(", ")}),Z(r,"getTabIndex",function(a,o){var l=a||r.props.selected,c=o||r.props.preSelection,u=!(r.props.showWeekPicker&&(r.props.showWeekNumber||!r.isStartOfWeek()))&&(r.isKeyboardSelected()||r.isSameDay(l)&&xr(c,l))?0:-1;return u}),Z(r,"handleFocusDay",function(){var a,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=!1;r.getTabIndex()===0&&!o.isInputFocused&&r.isSameDay(r.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(l=!0),r.props.inline&&!r.props.shouldFocusDayInline&&(l=!1),r.props.containerRef&&r.props.containerRef.current&&r.props.containerRef.current.contains(document.activeElement)&&document.activeElement.classList.contains("react-datepicker__day")&&(l=!0),r.props.monthShowsDuplicateDaysEnd&&r.isAfterMonth()&&(l=!1),r.props.monthShowsDuplicateDaysStart&&r.isBeforeMonth()&&(l=!1)),l&&((a=r.dayEl.current)===null||a===void 0||a.focus({preventScroll:!0}))}),Z(r,"renderDayContents",function(){return r.props.monthShowsDuplicateDaysEnd&&r.isAfterMonth()||r.props.monthShowsDuplicateDaysStart&&r.isBeforeMonth()?null:r.props.renderDayContents?r.props.renderDayContents(I6(r.props.day),r.props.day):I6(r.props.day)}),Z(r,"render",function(){return fe.createElement("div",{ref:r.dayEl,className:r.getClassNames(r.props.day),onKeyDown:r.handleOnKeyDown,onClick:r.handleClick,onMouseEnter:r.props.usePointerEvent?void 0:r.handleMouseEnter,onPointerEnter:r.props.usePointerEvent?r.handleMouseEnter:void 0,tabIndex:r.getTabIndex(),"aria-label":r.getAriaLabel(),role:"option",title:r.getTitle(),"aria-disabled":r.isDisabled(),"aria-current":r.isCurrentDay()?"date":void 0,"aria-selected":r.isSelected()||r.isInRange()},r.renderDayContents(),r.getTitle()!==""&&fe.createElement("span",{className:"overlay"},r.getTitle()))}),r}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){this.handleFocusDay()}},{key:"componentDidUpdate",value:function(i){this.handleFocusDay(i)}}])}(fe.Component),NUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"weekNumberEl",fe.createRef()),Z(r,"handleClick",function(a){r.props.onClick&&r.props.onClick(a)}),Z(r,"handleOnKeyDown",function(a){var o=a.key;o===" "&&(a.preventDefault(),a.key="Enter"),r.props.handleOnKeyDown(a)}),Z(r,"isKeyboardSelected",function(){return!r.props.disabledKeyboardNavigation&&!xr(r.props.date,r.props.selected)&&xr(r.props.date,r.props.preSelection)}),Z(r,"getTabIndex",function(){return r.props.showWeekPicker&&r.props.showWeekNumber&&(r.isKeyboardSelected()||xr(r.props.date,r.props.selected)&&xr(r.props.preSelection,r.props.selected))?0:-1}),Z(r,"handleFocusWeekNumber",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=!1;r.getTabIndex()===0&&!a.isInputFocused&&xr(r.props.date,r.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(o=!0),r.props.inline&&!r.props.shouldFocusDayInline&&(o=!1),r.props.containerRef&&r.props.containerRef.current&&r.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(o=!0)),o&&r.weekNumberEl.current&&r.weekNumberEl.current.focus({preventScroll:!0})}),r}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){this.handleFocusWeekNumber()}},{key:"componentDidUpdate",value:function(i){this.handleFocusWeekNumber(i)}},{key:"render",value:function(){var i=this.props,n=i.weekNumber,s=i.ariaLabelPrefix,a=s===void 0?"week ":s,o=i.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!o,"react-datepicker__week-number--selected":!!o&&xr(this.props.date,this.props.selected),"react-datepicker__week-number--keyboard-selected":this.isKeyboardSelected()};return fe.createElement("div",{ref:this.weekNumberEl,className:Xn(l),"aria-label":"".concat(a," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)}}],[{key:"defaultProps",get:function(){return{ariaLabelPrefix:"week "}}}])}(fe.Component),zUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"handleDayClick",function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o)}),Z(r,"handleDayMouseEnter",function(a){r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)}),Z(r,"handleWeekClick",function(a,o,l){typeof r.props.onWeekSelect=="function"&&r.props.onWeekSelect(a,o,l),r.props.showWeekPicker&&r.handleDayClick(a,l),r.props.shouldCloseOnSelect&&r.props.setOpen(!1)}),Z(r,"formatWeekNumber",function(a){return r.props.formatWeekNumber?r.props.formatWeekNumber(a):oUe(a)}),Z(r,"renderDays",function(){var a=r.startOfWeek(),o=[],l=r.formatWeekNumber(a);if(r.props.showWeekNumber){var c=r.props.onWeekSelect||r.props.showWeekPicker?r.handleWeekClick.bind(r,a,l):void 0;o.push(fe.createElement(NUe,{key:"W",weekNumber:l,date:a,onClick:c,selected:r.props.selected,preSelection:r.props.preSelection,ariaLabelPrefix:r.props.ariaLabelPrefix,showWeekPicker:r.props.showWeekPicker,showWeekNumber:r.props.showWeekNumber,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,handleOnKeyDown:r.props.handleOnKeyDown,isInputFocused:r.props.isInputFocused,containerRef:r.props.containerRef}))}return o.concat([0,1,2,3,4,5,6].map(function(u){var h=od(a,u);return fe.createElement(LUe,{ariaLabelPrefixWhenEnabled:r.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:r.props.disabledDayAriaLabelPrefix,key:h.valueOf(),day:h,month:r.props.month,onClick:r.handleDayClick.bind(r,h),usePointerEvent:r.props.usePointerEvent,onMouseEnter:r.handleDayMouseEnter.bind(r,h),minDate:r.props.minDate,maxDate:r.props.maxDate,calendarStartDay:r.props.calendarStartDay,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,highlightDates:r.props.highlightDates,holidays:r.props.holidays,selectingDate:r.props.selectingDate,filterDate:r.props.filterDate,preSelection:r.props.preSelection,selected:r.props.selected,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,showWeekPicker:r.props.showWeekPicker,showWeekNumber:r.props.showWeekNumber,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,selectsMultiple:r.props.selectsMultiple,selectedDates:r.props.selectedDates,startDate:r.props.startDate,endDate:r.props.endDate,dayClassName:r.props.dayClassName,renderDayContents:r.props.renderDayContents,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,handleOnKeyDown:r.props.handleOnKeyDown,isInputFocused:r.props.isInputFocused,containerRef:r.props.containerRef,inline:r.props.inline,shouldFocusDayInline:r.props.shouldFocusDayInline,monthShowsDuplicateDaysEnd:r.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:r.props.monthShowsDuplicateDaysStart,locale:r.props.locale})}))}),Z(r,"startOfWeek",function(){return zh(r.props.day,r.props.locale,r.props.calendarStartDay)}),Z(r,"isKeyboardSelected",function(){return!r.props.disabledKeyboardNavigation&&!xr(r.startOfWeek(),r.props.selected)&&xr(r.startOfWeek(),r.props.preSelection)}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i={"react-datepicker__week":!0,"react-datepicker__week--selected":xr(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return fe.createElement("div",{className:Xn(i)},this.renderDays())}}],[{key:"defaultProps",get:function(){return{shouldCloseOnSelect:!0}}}])}(fe.Component),BUe=6,Xm={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},LP=Z(Z(Z({},Xm.TWO_COLUMNS,{grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2}),Xm.THREE_COLUMNS,{grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3}),Xm.FOUR_COLUMNS,{grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4}),Eb=1;function aH(e,t){return e?Xm.FOUR_COLUMNS:t?Xm.TWO_COLUMNS:Xm.THREE_COLUMNS}var FUe=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"MONTH_REFS",Zh(Array(12)).map(function(){return fe.createRef()})),Z(r,"QUARTER_REFS",Zh(Array(4)).map(function(){return fe.createRef()})),Z(r,"isDisabled",function(a){return vC(a,r.props)}),Z(r,"isExcluded",function(a){return eN(a,r.props)}),Z(r,"handleDayClick",function(a,o){r.props.onDayClick&&r.props.onDayClick(a,o,r.props.orderInDisplay)}),Z(r,"handleDayMouseEnter",function(a){r.props.onDayMouseEnter&&r.props.onDayMouseEnter(a)}),Z(r,"handleMouseLeave",function(){r.props.onMouseLeave&&r.props.onMouseLeave()}),Z(r,"isRangeStartMonth",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate;return!c||!u?!1:ma(Os(l,a),c)}),Z(r,"isRangeStartQuarter",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate;return!c||!u?!1:CE(tm(l,a),c)}),Z(r,"isRangeEndMonth",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate;return!c||!u?!1:ma(Os(l,a),u)}),Z(r,"isRangeEndQuarter",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate;return!c||!u?!1:CE(tm(l,a),u)}),Z(r,"isInSelectingRangeMonth",function(a){var o,l=r.props,c=l.day,u=l.selectsStart,h=l.selectsEnd,d=l.selectsRange,p=l.startDate,f=l.endDate,m=(o=r.props.selectingDate)!==null&&o!==void 0?o:r.props.preSelection;return!(u||h||d)||!m?!1:u&&f?bb(m,f,a,c):h&&p||d&&p&&!f?bb(p,m,a,c):!1}),Z(r,"isSelectingMonthRangeStart",function(a){var o;if(!r.isInSelectingRangeMonth(a))return!1;var l=r.props,c=l.day,u=l.startDate,h=l.selectsStart,d=Os(c,a),p=(o=r.props.selectingDate)!==null&&o!==void 0?o:r.props.preSelection;return h?ma(d,p):ma(d,u)}),Z(r,"isSelectingMonthRangeEnd",function(a){var o;if(!r.isInSelectingRangeMonth(a))return!1;var l=r.props,c=l.day,u=l.endDate,h=l.selectsEnd,d=l.selectsRange,p=Os(c,a),f=(o=r.props.selectingDate)!==null&&o!==void 0?o:r.props.preSelection;return h||d?ma(p,f):ma(p,u)}),Z(r,"isInSelectingRangeQuarter",function(a){var o,l=r.props,c=l.day,u=l.selectsStart,h=l.selectsEnd,d=l.selectsRange,p=l.startDate,f=l.endDate,m=(o=r.props.selectingDate)!==null&&o!==void 0?o:r.props.preSelection;return!(u||h||d)||!m?!1:u&&f?Sb(m,f,a,c):h&&p||d&&p&&!f?Sb(p,m,a,c):!1}),Z(r,"isWeekInMonth",function(a){var o=r.props.day,l=od(a,6);return ma(a,o)||ma(l,o)}),Z(r,"isCurrentMonth",function(a,o){return rr(a)===rr(kr())&&o===zs(kr())}),Z(r,"isCurrentQuarter",function(a,o){return rr(a)===rr(kr())&&o===sp(kr())}),Z(r,"isSelectedMonth",function(a,o,l){return zs(l)===o&&rr(a)===rr(l)}),Z(r,"isSelectedQuarter",function(a,o,l){return sp(a)===o&&rr(a)===rr(l)}),Z(r,"renderWeeks",function(){for(var a=[],o=r.props.fixedHeight,l=0,c=!1,u=zh(Bh(r.props.day),r.props.locale,r.props.calendarStartDay),h=r.props.showWeekPicker?zh(r.props.selected,r.props.locale,r.props.calendarStartDay):r.props.selected,d=r.props.showWeekPicker?zh(r.props.preSelection,r.props.locale,r.props.calendarStartDay):r.props.preSelection;a.push(fe.createElement(zUe,{ariaLabelPrefix:r.props.weekAriaLabelPrefix,chooseDayAriaLabelPrefix:r.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:r.props.disabledDayAriaLabelPrefix,key:l,day:u,month:zs(r.props.day),onDayClick:r.handleDayClick,usePointerEvent:r.props.usePointerEvent,onDayMouseEnter:r.handleDayMouseEnter,onWeekSelect:r.props.onWeekSelect,formatWeekNumber:r.props.formatWeekNumber,locale:r.props.locale,minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,inline:r.props.inline,shouldFocusDayInline:r.props.shouldFocusDayInline,highlightDates:r.props.highlightDates,holidays:r.props.holidays,selectingDate:r.props.selectingDate,filterDate:r.props.filterDate,preSelection:d,selected:h,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,selectsMultiple:r.props.selectsMultiple,selectedDates:r.props.selectedDates,showWeekNumber:r.props.showWeekNumbers,showWeekPicker:r.props.showWeekPicker,startDate:r.props.startDate,endDate:r.props.endDate,dayClassName:r.props.dayClassName,setOpen:r.props.setOpen,shouldCloseOnSelect:r.props.shouldCloseOnSelect,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,renderDayContents:r.props.renderDayContents,handleOnKeyDown:r.props.handleOnKeyDown,isInputFocused:r.props.isInputFocused,containerRef:r.props.containerRef,calendarStartDay:r.props.calendarStartDay,monthShowsDuplicateDaysEnd:r.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:r.props.monthShowsDuplicateDaysStart})),!c;){l++,u=gE(u,1);var p=o&&l>=BUe,f=!o&&!r.isWeekInMonth(u);if(p||f)if(r.props.peekNextMonth)c=!0;else break}return a}),Z(r,"onMonthClick",function(a,o){var l=Os(r.props.day,o);g_(l,r.props)||r.handleDayClick(Bh(l),a)}),Z(r,"onMonthMouseEnter",function(a){var o=Os(r.props.day,a);g_(o,r.props)||r.handleDayMouseEnter(Bh(o))}),Z(r,"handleMonthNavigation",function(a,o){r.isDisabled(o)||r.isExcluded(o)||(r.props.setPreSelection(o),r.MONTH_REFS[a].current&&r.MONTH_REFS[a].current.focus())}),Z(r,"onMonthKeyDown",function(a,o){var l=r.props,c=l.selected,u=l.preSelection,h=l.disabledKeyboardNavigation,d=l.showTwoColumnMonthYearPicker,p=l.showFourColumnMonthYearPicker,f=l.setPreSelection,m=l.handleOnMonthKeyDown,g=a.key;if(g!=="Tab"&&a.preventDefault(),!h){var v=aH(p,d),y=LP[v].verticalNavigationOffset,w=LP[v].grid;switch(g){case"Enter":r.onMonthClick(a,o),f(c);break;case"ArrowRight":r.handleMonthNavigation(o===11?0:o+Eb,Xo(u,Eb));break;case"ArrowLeft":r.handleMonthNavigation(o===0?11:o-Eb,Pg(u,Eb));break;case"ArrowUp":r.handleMonthNavigation(w[0].includes(o)?o+12-y:o-y,Pg(u,y));break;case"ArrowDown":r.handleMonthNavigation(w[w.length-1].includes(o)?o-12+y:o+y,Xo(u,y));break}}m&&m(a)}),Z(r,"onQuarterClick",function(a,o){var l=tm(r.props.day,o);kP(l,r.props)||r.handleDayClick(q6(l),a)}),Z(r,"onQuarterMouseEnter",function(a){var o=tm(r.props.day,a);kP(o,r.props)||r.handleDayMouseEnter(q6(o))}),Z(r,"handleQuarterNavigation",function(a,o){r.isDisabled(o)||r.isExcluded(o)||(r.props.setPreSelection(o),r.QUARTER_REFS[a-1].current&&r.QUARTER_REFS[a-1].current.focus())}),Z(r,"onQuarterKeyDown",function(a,o){var l=a.key;if(!r.props.disabledKeyboardNavigation)switch(l){case"Enter":r.onQuarterClick(a,o),r.props.setPreSelection(r.props.selected);break;case"ArrowRight":r.handleQuarterNavigation(o===4?1:o+1,WL(r.props.preSelection,1));break;case"ArrowLeft":r.handleQuarterNavigation(o===1?4:o-1,PK(r.props.preSelection,1));break}}),Z(r,"isMonthDisabled",function(a){var o=r.props,l=o.day,c=o.minDate,u=o.maxDate,h=o.excludeDates,d=o.includeDates,p=Os(l,a);return(c||u||h||d)&&g_(p,r.props)}),Z(r,"getMonthClassNames",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate,h=o.selected,d=o.preSelection,p=o.monthClassName,f=p?p(Os(l,a)):void 0;return Xn("react-datepicker__month-text","react-datepicker__month-".concat(a),f,{"react-datepicker__month-text--disabled":r.isMonthDisabled(a),"react-datepicker__month-text--selected":r.isSelectedMonth(l,a,h),"react-datepicker__month-text--keyboard-selected":!r.props.disabledKeyboardNavigation&&r.isSelectedMonth(l,a,d),"react-datepicker__month-text--in-selecting-range":r.isInSelectingRangeMonth(a),"react-datepicker__month-text--in-range":bb(c,u,a,l),"react-datepicker__month-text--range-start":r.isRangeStartMonth(a),"react-datepicker__month-text--range-end":r.isRangeEndMonth(a),"react-datepicker__month-text--selecting-range-start":r.isSelectingMonthRangeStart(a),"react-datepicker__month-text--selecting-range-end":r.isSelectingMonthRangeEnd(a),"react-datepicker__month-text--today":r.isCurrentMonth(l,a)})}),Z(r,"getTabIndex",function(a){var o=zs(r.props.preSelection),l=!r.props.disabledKeyboardNavigation&&a===o?"0":"-1";return l}),Z(r,"getQuarterTabIndex",function(a){var o=sp(r.props.preSelection),l=!r.props.disabledKeyboardNavigation&&a===o?"0":"-1";return l}),Z(r,"getAriaLabel",function(a){var o=r.props,l=o.chooseDayAriaLabelPrefix,c=l===void 0?"Choose":l,u=o.disabledDayAriaLabelPrefix,h=u===void 0?"Not available":u,d=o.day,p=o.locale,f=Os(d,a),m=r.isDisabled(f)||r.isExcluded(f)?h:c;return"".concat(m," ").concat(ii(f,"MMMM yyyy",p))}),Z(r,"getQuarterClassNames",function(a){var o=r.props,l=o.day,c=o.startDate,u=o.endDate,h=o.selected,d=o.minDate,p=o.maxDate,f=o.preSelection,m=o.disabledKeyboardNavigation;return Xn("react-datepicker__quarter-text","react-datepicker__quarter-".concat(a),{"react-datepicker__quarter-text--disabled":(d||p)&&kP(tm(l,a),r.props),"react-datepicker__quarter-text--selected":r.isSelectedQuarter(l,a,h),"react-datepicker__quarter-text--keyboard-selected":!m&&r.isSelectedQuarter(l,a,f),"react-datepicker__quarter-text--in-selecting-range":r.isInSelectingRangeQuarter(a),"react-datepicker__quarter-text--in-range":Sb(c,u,a,l),"react-datepicker__quarter-text--range-start":r.isRangeStartQuarter(a),"react-datepicker__quarter-text--range-end":r.isRangeEndQuarter(a)})}),Z(r,"getMonthContent",function(a){var o=r.props,l=o.showFullMonthYearPicker,c=o.renderMonthContent,u=o.locale,h=o.day,d=ZK(a,u),p=JL(a,u);return c?c(a,d,p,h):l?p:d}),Z(r,"getQuarterContent",function(a){var o=r.props,l=o.renderQuarterContent,c=o.locale,u=fUe(a,c);return l?l(a,u):u}),Z(r,"renderMonths",function(){var a=r.props,o=a.showTwoColumnMonthYearPicker,l=a.showFourColumnMonthYearPicker,c=a.day,u=a.selected,h=LP[aH(l,o)].grid;return h.map(function(d,p){return fe.createElement("div",{className:"react-datepicker__month-wrapper",key:p},d.map(function(f,m){return fe.createElement("div",{ref:r.MONTH_REFS[f],key:m,onClick:function(v){r.onMonthClick(v,f)},onKeyDown:function(v){rZ(v)&&(v.preventDefault(),v.key="Enter"),r.onMonthKeyDown(v,f)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onMonthMouseEnter(f)},onPointerEnter:r.props.usePointerEvent?function(){return r.onMonthMouseEnter(f)}:void 0,tabIndex:r.getTabIndex(f),className:r.getMonthClassNames(f),"aria-disabled":r.isMonthDisabled(f),role:"option","aria-label":r.getAriaLabel(f),"aria-current":r.isCurrentMonth(c,f)?"date":void 0,"aria-selected":r.isSelectedMonth(c,f,u)},r.getMonthContent(f))}))})}),Z(r,"renderQuarters",function(){var a=r.props,o=a.day,l=a.selected,c=[1,2,3,4];return fe.createElement("div",{className:"react-datepicker__quarter-wrapper"},c.map(function(u,h){return fe.createElement("div",{key:h,ref:r.QUARTER_REFS[h],role:"option",onClick:function(p){r.onQuarterClick(p,u)},onKeyDown:function(p){r.onQuarterKeyDown(p,u)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onQuarterMouseEnter(u)},onPointerEnter:r.props.usePointerEvent?function(){return r.onQuarterMouseEnter(u)}:void 0,className:r.getQuarterClassNames(u),"aria-selected":r.isSelectedQuarter(o,u,l),tabIndex:r.getQuarterTabIndex(u),"aria-current":r.isCurrentQuarter(o,u)?"date":void 0},r.getQuarterContent(u))}))}),Z(r,"getClassNames",function(){var a=r.props,o=a.selectingDate,l=a.selectsStart,c=a.selectsEnd,u=a.showMonthYearPicker,h=a.showQuarterYearPicker,d=a.showWeekPicker;return Xn("react-datepicker__month",{"react-datepicker__month--selecting-range":o&&(l||c)},{"react-datepicker__monthPicker":u},{"react-datepicker__quarterPicker":h},{"react-datepicker__weekPicker":d})}),r}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i=this.props,n=i.showMonthYearPicker,s=i.showQuarterYearPicker,a=i.day,o=i.ariaLabelPrefix,l=o===void 0?"Month ":o,c=l?l.trim()+" ":"";return fe.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(c).concat(ii(a,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():s?this.renderQuarters():this.renderWeeks())}}])}(fe.Component),iZ=function(e){function t(){var r;Mn(this,t);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return r=An(this,t,[].concat(n)),Z(r,"state",{height:null}),Z(r,"scrollToTheSelectedTime",function(){requestAnimationFrame(function(){r.list&&(r.list.scrollTop=r.centerLi&&t.calcCenterPosition(r.props.monthRef?r.props.monthRef.clientHeight-r.header.clientHeight:r.list.clientHeight,r.centerLi))})}),Z(r,"handleClick",function(a){(r.props.minTime||r.props.maxTime)&&Q6(a,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&$6(a,r.props)||r.props.onChange(a)}),Z(r,"isSelectedTime",function(a){return r.props.selected&&SUe(r.props.selected,a)}),Z(r,"isDisabledTime",function(a){return(r.props.minTime||r.props.maxTime)&&Q6(a,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&$6(a,r.props)}),Z(r,"liClasses",function(a){var o=["react-datepicker__time-list-item",r.props.timeClassName?r.props.timeClassName(a):void 0];return r.isSelectedTime(a)&&o.push("react-datepicker__time-list-item--selected"),r.isDisabledTime(a)&&o.push("react-datepicker__time-list-item--disabled"),r.props.injectTimes&&(Hl(a)*3600+Vl(a)*60+eu(a))%(r.props.intervals*60)!==0&&o.push("react-datepicker__time-list-item--injected"),o.join(" ")}),Z(r,"handleOnKeyDown",function(a,o){a.key===" "&&(a.preventDefault(),a.key="Enter"),(a.key==="ArrowUp"||a.key==="ArrowLeft")&&a.target.previousSibling&&(a.preventDefault(),a.target.previousSibling.focus()),(a.key==="ArrowDown"||a.key==="ArrowRight")&&a.target.nextSibling&&(a.preventDefault(),a.target.nextSibling.focus()),a.key==="Enter"&&r.handleClick(o),r.props.handleOnKeyDown(a)}),Z(r,"renderTimes",function(){for(var a=[],o=r.props.format?r.props.format:"p",l=r.props.intervals,c=r.props.selected||r.props.openToDate||kr(),u=cUe(c),h=r.props.injectTimes&&r.props.injectTimes.sort(function(y,w){return y-w}),d=60*_Ue(c),p=d/l,f=0;f<p;f++){var m=TO(u,f*l);if(a.push(m),h){var g=bUe(u,m,f,l,h);a=a.concat(g)}}var v=a.reduce(function(y,w){return w.getTime()<=c.getTime()?w:y},a[0]);return a.map(function(y,w){return fe.createElement("li",{key:w,onClick:r.handleClick.bind(r,y),className:r.liClasses(y),ref:function(E){y===v&&(r.centerLi=E)},onKeyDown:function(E){r.handleOnKeyDown(E,y)},tabIndex:y===v?0:-1,role:"option","aria-selected":r.isSelectedTime(y)?"true":void 0,"aria-disabled":r.isDisabledTime(y)?"true":void 0},ii(y,o,r.props.locale))})}),r}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){this.scrollToTheSelectedTime(),this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})}},{key:"render",value:function(){var i=this,n=this.state.height;return fe.createElement("div",{className:"react-datepicker__time-container ".concat(this.props.todayButton?"react-datepicker__time-container--with-today-button":"")},fe.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(this.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(a){i.header=a}},fe.createElement("div",{className:"react-datepicker-time__header"},this.props.timeCaption)),fe.createElement("div",{className:"react-datepicker__time"},fe.createElement("div",{className:"react-datepicker__time-box"},fe.createElement("ul",{className:"react-datepicker__time-list",ref:function(a){i.list=a},style:n?{height:n}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))}}],[{key:"defaultProps",get:function(){return{intervals:30,onTimeChange:function(){},todayButton:null,timeCaption:"Time"}}}])}(fe.Component);Z(iZ,"calcCenterPosition",function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)});var oH=3,UUe=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"YEAR_REFS",Zh(Array(i.props.yearItemNumber)).map(function(){return fe.createRef()})),Z(i,"isDisabled",function(n){return vC(n,i.props)}),Z(i,"isExcluded",function(n){return eN(n,i.props)}),Z(i,"selectingDate",function(){var n;return(n=i.props.selectingDate)!==null&&n!==void 0?n:i.props.preSelection}),Z(i,"updateFocusOnPaginate",function(n){var s=(function(){this.YEAR_REFS[n].current.focus()}).bind(i);window.requestAnimationFrame(s)}),Z(i,"handleYearClick",function(n,s){i.props.onDayClick&&i.props.onDayClick(n,s)}),Z(i,"handleYearNavigation",function(n,s){var a=i.props,o=a.date,l=a.yearItemNumber,c=yh(o,l),u=c.startPeriod;i.isDisabled(s)||i.isExcluded(s)||(i.props.setPreSelection(s),n-u<0?i.updateFocusOnPaginate(l-(u-n)):n-u>=l?i.updateFocusOnPaginate(Math.abs(l-(n-u))):i.YEAR_REFS[n-u].current.focus())}),Z(i,"isSameDay",function(n,s){return xr(n,s)}),Z(i,"isCurrentYear",function(n){return n===rr(kr())}),Z(i,"isRangeStart",function(n){return i.props.startDate&&i.props.endDate&&bl(yl(kr(),n),i.props.startDate)}),Z(i,"isRangeEnd",function(n){return i.props.startDate&&i.props.endDate&&bl(yl(kr(),n),i.props.endDate)}),Z(i,"isInRange",function(n){return _b(n,i.props.startDate,i.props.endDate)}),Z(i,"isInSelectingRange",function(n){var s=i.props,a=s.selectsStart,o=s.selectsEnd,l=s.selectsRange,c=s.startDate,u=s.endDate;return!(a||o||l)||!i.selectingDate()?!1:a&&u?_b(n,i.selectingDate(),u):o&&c||l&&c&&!u?_b(n,c,i.selectingDate()):!1}),Z(i,"isSelectingRangeStart",function(n){if(!i.isInSelectingRange(n))return!1;var s=i.props,a=s.startDate,o=s.selectsStart,l=yl(kr(),n);return o?bl(l,i.selectingDate()):bl(l,a)}),Z(i,"isSelectingRangeEnd",function(n){if(!i.isInSelectingRange(n))return!1;var s=i.props,a=s.endDate,o=s.selectsEnd,l=s.selectsRange,c=yl(kr(),n);return o||l?bl(c,i.selectingDate()):bl(c,a)}),Z(i,"isKeyboardSelected",function(n){var s=zy(yl(i.props.date,n));return!i.props.disabledKeyboardNavigation&&!i.props.inline&&!xr(s,zy(i.props.selected))&&xr(s,zy(i.props.preSelection))}),Z(i,"onYearClick",function(n,s){var a=i.props.date;i.handleYearClick(zy(yl(a,s)),n)}),Z(i,"onYearKeyDown",function(n,s){var a=n.key,o=i.props,l=o.date,c=o.yearItemNumber,u=o.handleOnKeyDown;if(a!=="Tab"&&n.preventDefault(),!i.props.disabledKeyboardNavigation)switch(a){case"Enter":i.onYearClick(n,s),i.props.setPreSelection(i.props.selected);break;case"ArrowRight":i.handleYearNavigation(s+1,Jc(i.props.preSelection,1));break;case"ArrowLeft":i.handleYearNavigation(s-1,Dg(i.props.preSelection,1));break;case"ArrowUp":{var h=yh(l,c),d=h.startPeriod,p=oH,f=s-p;if(f<d){var m=c%p;s>=d&&s<d+m?p=m:p+=m,f=s-p}i.handleYearNavigation(f,Dg(i.props.preSelection,p));break}case"ArrowDown":{var g=yh(l,c),v=g.endPeriod,y=oH,w=s+y;if(w>v){var b=c%y;s<=v&&s>v-b?y=b:y+=b,w=s+y}i.handleYearNavigation(w,Jc(i.props.preSelection,y));break}}u&&u(n)}),Z(i,"getYearClassNames",function(n){var s=i.props,a=s.date,o=s.minDate,l=s.maxDate,c=s.selected,u=s.excludeDates,h=s.includeDates,d=s.filterDate,p=s.yearClassName;return Xn("react-datepicker__year-text","react-datepicker__year-".concat(n),p?p(yl(a,n)):void 0,{"react-datepicker__year-text--selected":n===rr(c),"react-datepicker__year-text--disabled":(o||l||u||h||d)&&JK(n,i.props),"react-datepicker__year-text--keyboard-selected":i.isKeyboardSelected(n),"react-datepicker__year-text--range-start":i.isRangeStart(n),"react-datepicker__year-text--range-end":i.isRangeEnd(n),"react-datepicker__year-text--in-range":i.isInRange(n),"react-datepicker__year-text--in-selecting-range":i.isInSelectingRange(n),"react-datepicker__year-text--selecting-range-start":i.isSelectingRangeStart(n),"react-datepicker__year-text--selecting-range-end":i.isSelectingRangeEnd(n),"react-datepicker__year-text--today":i.isCurrentYear(n)})}),Z(i,"getYearTabIndex",function(n){if(i.props.disabledKeyboardNavigation)return"-1";var s=rr(i.props.preSelection);return n===s?"0":"-1"}),Z(i,"getYearContainerClassNames",function(){var n=i.props,s=n.selectingDate,a=n.selectsStart,o=n.selectsEnd,l=n.selectsRange;return Xn("react-datepicker__year",{"react-datepicker__year--selecting-range":s&&(a||o||l)})}),Z(i,"getYearContent",function(n){return i.props.renderYearContent?i.props.renderYearContent(n):n}),i}return Dn(t,e),Pn(t,[{key:"render",value:function(){for(var i=this,n=[],s=this.props,a=s.date,o=s.yearItemNumber,l=s.onYearMouseEnter,c=s.onYearMouseLeave,u=yh(a,o),h=u.startPeriod,d=u.endPeriod,p=function(g){n.push(fe.createElement("div",{ref:i.YEAR_REFS[g-h],onClick:function(y){i.onYearClick(y,g)},onKeyDown:function(y){rZ(y)&&(y.preventDefault(),y.key="Enter"),i.onYearKeyDown(y,g)},tabIndex:i.getYearTabIndex(g),className:i.getYearClassNames(g),onMouseEnter:i.props.usePointerEvent?void 0:function(v){return l(v,g)},onPointerEnter:i.props.usePointerEvent?function(v){return l(v,g)}:void 0,onMouseLeave:i.props.usePointerEvent?void 0:function(v){return c(v,g)},onPointerLeave:i.props.usePointerEvent?function(v){return c(v,g)}:void 0,key:g,"aria-current":i.isCurrentYear(g)?"date":void 0},i.getYearContent(g)))},f=h;f<=d;f++)p(f);return fe.createElement("div",{className:this.getYearContainerClassNames()},fe.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))}}])}(fe.Component),jUe=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"onTimeChange",function(n){i.setState({time:n});var s=i.props.date,a=s instanceof Date&&!isNaN(s),o=a?s:new Date;o.setHours(n.split(":")[0]),o.setMinutes(n.split(":")[1]),i.props.onChange(o)}),Z(i,"renderTimeInput",function(){var n=i.state.time,s=i.props,a=s.date,o=s.timeString,l=s.customTimeInput;return l?fe.cloneElement(l,{date:a,value:n,onChange:i.onTimeChange}):fe.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",required:!0,value:n,onChange:function(u){i.onTimeChange(u.target.value||o)}})}),i.state={time:i.props.timeString},i}return Dn(t,e),Pn(t,[{key:"render",value:function(){return fe.createElement("div",{className:"react-datepicker__input-time-container"},fe.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),fe.createElement("div",{className:"react-datepicker-time__input-container"},fe.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))}}],[{key:"getDerivedStateFromProps",value:function(i,n){return i.timeString!==n.time?{time:i.timeString}:null}}])}(fe.Component);function VUe(e){var t=e.showTimeSelectOnly,r=t===void 0?!1:t,i=e.showTime,n=i===void 0?!1:i,s=e.className,a=e.children,o=r?"Choose Time":"Choose Date".concat(n?" and Time":"");return fe.createElement("div",{className:s,role:"dialog","aria-label":o,"aria-modal":"true"},a)}var HUe=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],WUe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=(t.className||"").split(/\s+/);return HUe.some(function(i){return r.indexOf(i)>=0})},GUe=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"handleClickOutside",function(n){i.props.onClickOutside(n)}),Z(i,"setClickOutsideRef",function(){return i.containerRef.current}),Z(i,"handleDropdownFocus",function(n){WUe(n.target)&&i.props.onDropdownFocus()}),Z(i,"getDateInView",function(){var n=i.props,s=n.preSelection,a=n.selected,o=n.openToDate,l=eZ(i.props),c=tZ(i.props),u=kr(),h=o||a||s;return h||(l&&Ip(u,l)?l:c&&$h(u,c)?c:u)}),Z(i,"increaseMonth",function(){i.setState(function(n){var s=n.date;return{date:Xo(s,1)}},function(){return i.handleMonthChange(i.state.date)})}),Z(i,"decreaseMonth",function(){i.setState(function(n){var s=n.date;return{date:Pg(s,1)}},function(){return i.handleMonthChange(i.state.date)})}),Z(i,"handleDayClick",function(n,s,a){i.props.onSelect(n,s,a),i.props.setPreSelection&&i.props.setPreSelection(n)}),Z(i,"handleDayMouseEnter",function(n){i.setState({selectingDate:n}),i.props.onDayMouseEnter&&i.props.onDayMouseEnter(n)}),Z(i,"handleMonthMouseLeave",function(){i.setState({selectingDate:null}),i.props.onMonthMouseLeave&&i.props.onMonthMouseLeave()}),Z(i,"handleYearMouseEnter",function(n,s){i.setState({selectingDate:yl(kr(),s)}),i.props.onYearMouseEnter&&i.props.onYearMouseEnter(n,s)}),Z(i,"handleYearMouseLeave",function(n,s){i.props.onYearMouseLeave&&i.props.onYearMouseLeave(n,s)}),Z(i,"handleYearChange",function(n){i.props.onYearChange&&(i.props.onYearChange(n),i.setState({isRenderAriaLiveMessage:!0})),i.props.adjustDateOnChange&&(i.props.onSelect&&i.props.onSelect(n),i.props.setOpen&&i.props.setOpen(!0)),i.props.setPreSelection&&i.props.setPreSelection(n)}),Z(i,"handleMonthChange",function(n){i.handleCustomMonthChange(n),i.props.adjustDateOnChange&&(i.props.onSelect&&i.props.onSelect(n),i.props.setOpen&&i.props.setOpen(!0)),i.props.setPreSelection&&i.props.setPreSelection(n)}),Z(i,"handleCustomMonthChange",function(n){i.props.onMonthChange&&(i.props.onMonthChange(n),i.setState({isRenderAriaLiveMessage:!0}))}),Z(i,"handleMonthYearChange",function(n){i.handleYearChange(n),i.handleMonthChange(n)}),Z(i,"changeYear",function(n){i.setState(function(s){var a=s.date;return{date:yl(a,n)}},function(){return i.handleYearChange(i.state.date)})}),Z(i,"changeMonth",function(n){i.setState(function(s){var a=s.date;return{date:Os(a,n)}},function(){return i.handleMonthChange(i.state.date)})}),Z(i,"changeMonthYear",function(n){i.setState(function(s){var a=s.date;return{date:yl(Os(a,zs(n)),rr(n))}},function(){return i.handleMonthYearChange(i.state.date)})}),Z(i,"header",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.state.date,s=zh(n,i.props.locale,i.props.calendarStartDay),a=[];return i.props.showWeekNumbers&&a.push(fe.createElement("div",{key:"W",className:"react-datepicker__day-name"},i.props.weekLabel||"#")),a.concat([0,1,2,3,4,5,6].map(function(o){var l=od(s,o),c=i.formatWeekday(l,i.props.locale),u=i.props.weekDayClassName?i.props.weekDayClassName(l):void 0;return fe.createElement("div",{key:o,"aria-label":ii(l,"EEEE",i.props.locale),className:Xn("react-datepicker__day-name",u)},c)}))}),Z(i,"formatWeekday",function(n,s){return i.props.formatWeekDay?hUe(n,i.props.formatWeekDay,s):i.props.useWeekdaysShort?pUe(n,s):dUe(n,s)}),Z(i,"decreaseYear",function(){i.setState(function(n){var s=n.date;return{date:Dg(s,i.props.showYearPicker?i.props.yearItemNumber:1)}},function(){return i.handleYearChange(i.state.date)})}),Z(i,"clearSelectingDate",function(){i.setState({selectingDate:null})}),Z(i,"renderPreviousButton",function(){if(!i.props.renderCustomHeader){var n;switch(!0){case i.props.showMonthYearPicker:n=J6(i.state.date,i.props);break;case i.props.showYearPicker:n=vUe(i.state.date,i.props);break;case i.props.showQuarterYearPicker:n=mUe(i.state.date,i.props);break;default:n=K6(i.state.date,i.props);break}if(!(!i.props.forceShowMonthNavigation&&!i.props.showDisabledMonthNavigation&&n||i.props.showTimeSelectOnly)){var s=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],a=["react-datepicker__navigation","react-datepicker__navigation--previous"],o=i.decreaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(o=i.decreaseYear),n&&i.props.showDisabledMonthNavigation&&(a.push("react-datepicker__navigation--previous--disabled"),o=null);var l=i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker,c=i.props,u=c.previousMonthButtonLabel,h=c.previousYearButtonLabel,d=i.props,p=d.previousMonthAriaLabel,f=p===void 0?typeof u=="string"?u:"Previous Month":p,m=d.previousYearAriaLabel,g=m===void 0?typeof h=="string"?h:"Previous Year":m;return fe.createElement("button",{type:"button",className:a.join(" "),onClick:o,onKeyDown:i.props.handleOnKeyDown,"aria-label":l?g:f},fe.createElement("span",{className:s.join(" ")},l?i.props.previousYearButtonLabel:i.props.previousMonthButtonLabel))}}}),Z(i,"increaseYear",function(){i.setState(function(n){var s=n.date;return{date:Jc(s,i.props.showYearPicker?i.props.yearItemNumber:1)}},function(){return i.handleYearChange(i.state.date)})}),Z(i,"renderNextButton",function(){if(!i.props.renderCustomHeader){var n;switch(!0){case i.props.showMonthYearPicker:n=eH(i.state.date,i.props);break;case i.props.showYearPicker:n=yUe(i.state.date,i.props);break;case i.props.showQuarterYearPicker:n=gUe(i.state.date,i.props);break;default:n=Z6(i.state.date,i.props);break}if(!(!i.props.forceShowMonthNavigation&&!i.props.showDisabledMonthNavigation&&n||i.props.showTimeSelectOnly)){var s=["react-datepicker__navigation","react-datepicker__navigation--next"],a=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];i.props.showTimeSelect&&s.push("react-datepicker__navigation--next--with-time"),i.props.todayButton&&s.push("react-datepicker__navigation--next--with-today-button");var o=i.increaseMonth;(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker)&&(o=i.increaseYear),n&&i.props.showDisabledMonthNavigation&&(s.push("react-datepicker__navigation--next--disabled"),o=null);var l=i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker,c=i.props,u=c.nextMonthButtonLabel,h=c.nextYearButtonLabel,d=i.props,p=d.nextMonthAriaLabel,f=p===void 0?typeof u=="string"?u:"Next Month":p,m=d.nextYearAriaLabel,g=m===void 0?typeof h=="string"?h:"Next Year":m;return fe.createElement("button",{type:"button",className:s.join(" "),onClick:o,onKeyDown:i.props.handleOnKeyDown,"aria-label":l?g:f},fe.createElement("span",{className:a.join(" ")},l?i.props.nextYearButtonLabel:i.props.nextMonthButtonLabel))}}}),Z(i,"renderCurrentMonth",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i.state.date,s=["react-datepicker__current-month"];return i.props.showYearDropdown&&s.push("react-datepicker__current-month--hasYearDropdown"),i.props.showMonthDropdown&&s.push("react-datepicker__current-month--hasMonthDropdown"),i.props.showMonthYearDropdown&&s.push("react-datepicker__current-month--hasMonthYearDropdown"),fe.createElement("div",{className:s.join(" ")},ii(n,i.props.dateFormat,i.props.locale))}),Z(i,"renderYearDropdown",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!i.props.showYearDropdown||n))return fe.createElement(AUe,{adjustDateOnChange:i.props.adjustDateOnChange,date:i.state.date,onSelect:i.props.onSelect,setOpen:i.props.setOpen,dropdownMode:i.props.dropdownMode,onChange:i.changeYear,minDate:i.props.minDate,maxDate:i.props.maxDate,year:rr(i.state.date),scrollableYearDropdown:i.props.scrollableYearDropdown,yearDropdownItemNumber:i.props.yearDropdownItemNumber})}),Z(i,"renderMonthDropdown",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!i.props.showMonthDropdown||n))return fe.createElement(DUe,{dropdownMode:i.props.dropdownMode,locale:i.props.locale,onChange:i.changeMonth,month:zs(i.state.date),useShortMonthInDropdown:i.props.useShortMonthInDropdown})}),Z(i,"renderMonthYearDropdown",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!i.props.showMonthYearDropdown||n))return fe.createElement(kUe,{dropdownMode:i.props.dropdownMode,locale:i.props.locale,dateFormat:i.props.dateFormat,onChange:i.changeMonthYear,minDate:i.props.minDate,maxDate:i.props.maxDate,date:i.state.date,scrollableMonthYearDropdown:i.props.scrollableMonthYearDropdown})}),Z(i,"handleTodayButtonClick",function(n){i.props.onSelect(Y6(),n),i.props.setPreSelection&&i.props.setPreSelection(Y6())}),Z(i,"renderTodayButton",function(){if(!(!i.props.todayButton||i.props.showTimeSelectOnly))return fe.createElement("div",{className:"react-datepicker__today-button",onClick:function(s){return i.handleTodayButtonClick(s)}},i.props.todayButton)}),Z(i,"renderDefaultHeader",function(n){var s=n.monthDate,a=n.i;return fe.createElement("div",{className:"react-datepicker__header ".concat(i.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},i.renderCurrentMonth(s),fe.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(i.props.dropdownMode),onFocus:i.handleDropdownFocus},i.renderMonthDropdown(a!==0),i.renderMonthYearDropdown(a!==0),i.renderYearDropdown(a!==0)),fe.createElement("div",{className:"react-datepicker__day-names"},i.header(s)))}),Z(i,"renderCustomHeader",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=n.monthDate,a=n.i;if(i.props.showTimeSelect&&!i.state.monthContainer||i.props.showTimeSelectOnly)return null;var o=K6(i.state.date,i.props),l=Z6(i.state.date,i.props),c=J6(i.state.date,i.props),u=eH(i.state.date,i.props),h=!i.props.showMonthYearPicker&&!i.props.showQuarterYearPicker&&!i.props.showYearPicker;return fe.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:i.props.onDropdownFocus},i.props.renderCustomHeader(kc(kc({},i.state),{},{customHeaderCount:a,monthDate:s,changeMonth:i.changeMonth,changeYear:i.changeYear,decreaseMonth:i.decreaseMonth,increaseMonth:i.increaseMonth,decreaseYear:i.decreaseYear,increaseYear:i.increaseYear,prevMonthButtonDisabled:o,nextMonthButtonDisabled:l,prevYearButtonDisabled:c,nextYearButtonDisabled:u})),h&&fe.createElement("div",{className:"react-datepicker__day-names"},i.header(s)))}),Z(i,"renderYearHeader",function(n){var s=n.monthDate,a=i.props,o=a.showYearPicker,l=a.yearItemNumber,c=yh(s,l),u=c.startPeriod,h=c.endPeriod;return fe.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},o?"".concat(u," - ").concat(h):rr(s))}),Z(i,"renderHeader",function(n){switch(!0){case i.props.renderCustomHeader!==void 0:return i.renderCustomHeader(n);case(i.props.showMonthYearPicker||i.props.showQuarterYearPicker||i.props.showYearPicker):return i.renderYearHeader(n);default:return i.renderDefaultHeader(n)}}),Z(i,"renderMonths",function(){var n;if(!(i.props.showTimeSelectOnly||i.props.showYearPicker)){for(var s=[],a=i.props.showPreviousMonths?i.props.monthsShown-1:0,o=i.props.showMonthYearPicker||i.props.showQuarterYearPicker?Jc(i.state.date,a):Pg(i.state.date,a),l=(n=i.props.monthSelectedIn)!==null&&n!==void 0?n:a,c=0;c<i.props.monthsShown;++c){var u=c-l+a,h=i.props.showMonthYearPicker||i.props.showQuarterYearPicker?Jc(o,u):Xo(o,u),d="month-".concat(c),p=c<i.props.monthsShown-1,f=c>0;s.push(fe.createElement("div",{key:d,ref:function(g){i.monthContainer=g},className:"react-datepicker__month-container"},i.renderHeader({monthDate:h,i:c}),fe.createElement(FUe,{chooseDayAriaLabelPrefix:i.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:i.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:i.props.weekAriaLabelPrefix,ariaLabelPrefix:i.props.monthAriaLabelPrefix,onChange:i.changeMonthYear,day:h,dayClassName:i.props.dayClassName,calendarStartDay:i.props.calendarStartDay,monthClassName:i.props.monthClassName,onDayClick:i.handleDayClick,handleOnKeyDown:i.props.handleOnDayKeyDown,handleOnMonthKeyDown:i.props.handleOnKeyDown,usePointerEvent:i.props.usePointerEvent,onDayMouseEnter:i.handleDayMouseEnter,onMouseLeave:i.handleMonthMouseLeave,onWeekSelect:i.props.onWeekSelect,orderInDisplay:c,formatWeekNumber:i.props.formatWeekNumber,locale:i.props.locale,minDate:i.props.minDate,maxDate:i.props.maxDate,excludeDates:i.props.excludeDates,excludeDateIntervals:i.props.excludeDateIntervals,highlightDates:i.props.highlightDates,holidays:i.props.holidays,selectingDate:i.state.selectingDate,includeDates:i.props.includeDates,includeDateIntervals:i.props.includeDateIntervals,inline:i.props.inline,shouldFocusDayInline:i.props.shouldFocusDayInline,fixedHeight:i.props.fixedHeight,filterDate:i.props.filterDate,preSelection:i.props.preSelection,setPreSelection:i.props.setPreSelection,selected:i.props.selected,selectsStart:i.props.selectsStart,selectsEnd:i.props.selectsEnd,selectsRange:i.props.selectsRange,selectsDisabledDaysInRange:i.props.selectsDisabledDaysInRange,selectsMultiple:i.props.selectsMultiple,selectedDates:i.props.selectedDates,showWeekNumbers:i.props.showWeekNumbers,startDate:i.props.startDate,endDate:i.props.endDate,peekNextMonth:i.props.peekNextMonth,setOpen:i.props.setOpen,shouldCloseOnSelect:i.props.shouldCloseOnSelect,renderDayContents:i.props.renderDayContents,renderMonthContent:i.props.renderMonthContent,renderQuarterContent:i.props.renderQuarterContent,renderYearContent:i.props.renderYearContent,disabledKeyboardNavigation:i.props.disabledKeyboardNavigation,showMonthYearPicker:i.props.showMonthYearPicker,showFullMonthYearPicker:i.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:i.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:i.props.showFourColumnMonthYearPicker,showYearPicker:i.props.showYearPicker,showQuarterYearPicker:i.props.showQuarterYearPicker,showWeekPicker:i.props.showWeekPicker,isInputFocused:i.props.isInputFocused,containerRef:i.containerRef,monthShowsDuplicateDaysEnd:p,monthShowsDuplicateDaysStart:f})))}return s}}),Z(i,"renderYears",function(){if(!i.props.showTimeSelectOnly&&i.props.showYearPicker)return fe.createElement("div",{className:"react-datepicker__year--container"},i.renderHeader({monthDate:i.state.date}),fe.createElement(UUe,vw({onDayClick:i.handleDayClick,selectingDate:i.state.selectingDate,clearSelectingDate:i.clearSelectingDate,date:i.state.date},i.props,{onYearMouseEnter:i.handleYearMouseEnter,onYearMouseLeave:i.handleYearMouseLeave})))}),Z(i,"renderTimeSection",function(){if(i.props.showTimeSelect&&(i.state.monthContainer||i.props.showTimeSelectOnly))return fe.createElement(iZ,{selected:i.props.selected,openToDate:i.props.openToDate,onChange:i.props.onTimeChange,timeClassName:i.props.timeClassName,format:i.props.timeFormat,includeTimes:i.props.includeTimes,intervals:i.props.timeIntervals,minTime:i.props.minTime,maxTime:i.props.maxTime,excludeTimes:i.props.excludeTimes,filterTime:i.props.filterTime,timeCaption:i.props.timeCaption,todayButton:i.props.todayButton,showMonthDropdown:i.props.showMonthDropdown,showMonthYearDropdown:i.props.showMonthYearDropdown,showYearDropdown:i.props.showYearDropdown,withPortal:i.props.withPortal,monthRef:i.state.monthContainer,injectTimes:i.props.injectTimes,locale:i.props.locale,handleOnKeyDown:i.props.handleOnKeyDown,showTimeSelectOnly:i.props.showTimeSelectOnly})}),Z(i,"renderInputTimeSection",function(){var n=new Date(i.props.selected),s=Gu(n)&&!!i.props.selected,a=s?"".concat(rH(n.getHours()),":").concat(rH(n.getMinutes())):"";if(i.props.showTimeInput)return fe.createElement(jUe,{date:n,timeString:a,timeInputLabel:i.props.timeInputLabel,onChange:i.props.onTimeChange,customTimeInput:i.props.customTimeInput})}),Z(i,"renderAriaLiveRegion",function(){var n=yh(i.state.date,i.props.yearItemNumber),s=n.startPeriod,a=n.endPeriod,o;return i.props.showYearPicker?o="".concat(s," - ").concat(a):i.props.showMonthYearPicker||i.props.showQuarterYearPicker?o=rr(i.state.date):o="".concat(JL(zs(i.state.date),i.props.locale)," ").concat(rr(i.state.date)),fe.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},i.state.isRenderAriaLiveMessage&&o)}),Z(i,"renderChildren",function(){if(i.props.children)return fe.createElement("div",{className:"react-datepicker__children-container"},i.props.children)}),i.containerRef=fe.createRef(),i.state={date:i.getDateInView(),selectingDate:null,monthContainer:null,isRenderAriaLiveMessage:!1},i}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){var i=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){i.setState({monthContainer:i.monthContainer})}())}},{key:"componentDidUpdate",value:function(i){var n=this;if(this.props.preSelection&&(!xr(this.props.preSelection,i.preSelection)||this.props.monthSelectedIn!==i.monthSelectedIn)){var s=!ma(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return s&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!xr(this.props.openToDate,i.openToDate)&&this.setState({date:this.props.openToDate})}},{key:"render",value:function(){var i=this.props.container||VUe;return fe.createElement("div",{style:{display:"contents"},ref:this.containerRef},fe.createElement(i,{className:Xn("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren()))}}],[{key:"defaultProps",get:function(){return{onDropdownFocus:function(){},monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",customTimeInput:null,yearItemNumber:ux}}}])}(fe.Component),qUe=function(t){var r=t.icon,i=t.className,n=i===void 0?"":i,s=t.onClick,a="react-datepicker__calendar-icon";return fe.isValidElement(r)?fe.cloneElement(r,{className:"".concat(r.props.className||""," ").concat(a," ").concat(n),onClick:function(l){typeof r.props.onClick=="function"&&r.props.onClick(l),typeof s=="function"&&s(l)}}):typeof r=="string"?fe.createElement("i",{className:"".concat(a," ").concat(r," ").concat(n),"aria-hidden":"true",onClick:s}):fe.createElement("svg",{className:"".concat(a," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},fe.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},YUe=qUe,nZ=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),i.el=document.createElement("div"),i}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){this.portalRoot.removeChild(this.el)}},{key:"render",value:function(){return Tre.createPortal(this.props.children,this.el)}}])}(fe.Component),XUe="[tabindex], a, button, input, select, textarea",$Ue=function(t){return!t.disabled&&t.tabIndex!==-1},sZ=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"getTabChildren",function(){return Array.prototype.slice.call(i.tabLoopRef.current.querySelectorAll(XUe),1,-1).filter($Ue)}),Z(i,"handleFocusStart",function(){var n=i.getTabChildren();n&&n.length>1&&n[n.length-1].focus()}),Z(i,"handleFocusEnd",function(){var n=i.getTabChildren();n&&n.length>1&&n[0].focus()}),i.tabLoopRef=fe.createRef(),i}return Dn(t,e),Pn(t,[{key:"render",value:function(){return this.props.enableTabLoop?fe.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},fe.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:"0",onFocus:this.handleFocusStart}),this.props.children,fe.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:"0",onFocus:this.handleFocusEnd})):this.props.children}}],[{key:"defaultProps",get:function(){return{enableTabLoop:!0}}}])}(fe.Component);function QUe(e){var t=function(i){var n=kc(kc({},i),{},{popperModifiers:i.popperModifiers||[],popperProps:i.popperProps||{},hidePopper:typeof i.hidePopper=="boolean"?i.hidePopper:!0}),s=fe.useRef(),a=$4e(kc({open:!n.hidePopper,whileElementsMounted:I4e,placement:n.popperPlacement,middleware:[R4e({padding:15}),O4e(10),L4e({element:s})].concat(Zh(n.popperModifiers))},n.popperProps));return fe.createElement(e,vw({},n,{popperProps:kc(kc({},a),{},{arrowRef:s})}))};return t}var KUe=function(e){function t(){return Mn(this,t),An(this,t,arguments)}return Dn(t,e),Pn(t,[{key:"render",value:function(){var i=this.props,n=i.className,s=i.wrapperClassName,a=i.hidePopper,o=i.popperComponent,l=i.targetComponent,c=i.enableTabLoop,u=i.popperOnKeyDown,h=i.portalId,d=i.portalHost,p=i.popperProps,f=i.showArrow,m;if(!a){var g=Xn("react-datepicker-popper",n);m=fe.createElement(sZ,{enableTabLoop:c},fe.createElement("div",{ref:p.refs.setFloating,style:p.floatingStyles,className:g,"data-placement":p.placement,onKeyDown:u},o,f&&fe.createElement(H4e,{ref:p.arrowRef,context:p.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(m=fe.createElement(this.props.popperContainer,{},m)),h&&!a&&(m=fe.createElement(nZ,{portalId:h,portalHost:d},m));var v=Xn("react-datepicker-wrapper",s);return fe.createElement(fe.Fragment,null,fe.createElement("div",{ref:p.refs.setReference,className:v},l),m)}}],[{key:"defaultProps",get:function(){return{hidePopper:!0}}}])}(fe.Component),ZUe=QUe(KUe),lH="react-datepicker-ignore-onclickoutside",JUe=pC(GUe);function eje(e,t){return e&&t?zs(e)!==zs(t)||rr(e)!==rr(t):e!==t}var NP="Date input not valid.",cH=function(e){function t(r){var i;return Mn(this,t),i=An(this,t,[r]),Z(i,"getPreSelection",function(){return i.props.openToDate?i.props.openToDate:i.props.selectsEnd&&i.props.startDate?i.props.startDate:i.props.selectsStart&&i.props.endDate?i.props.endDate:kr()}),Z(i,"modifyHolidays",function(){var n;return(n=i.props.holidays)===null||n===void 0?void 0:n.reduce(function(s,a){var o=new Date(a.date);return pw(o)?[].concat(Zh(s),[kc(kc({},a),{},{date:o})]):s},[])}),Z(i,"calcInitialState",function(){var n,s=i.getPreSelection(),a=eZ(i.props),o=tZ(i.props),l=a&&Ip(s,jl(a))?a:o&&$h(s,MO(o))?o:s;return{open:i.props.startOpen||!1,preventFocus:!1,preSelection:(n=i.props.selectsRange?i.props.startDate:i.props.selected)!==null&&n!==void 0?n:l,highlightDates:tH(i.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1}}),Z(i,"clearPreventFocusTimeout",function(){i.preventFocusTimeout&&clearTimeout(i.preventFocusTimeout)}),Z(i,"setFocus",function(){i.input&&i.input.focus&&i.input.focus({preventScroll:!0})}),Z(i,"setBlur",function(){i.input&&i.input.blur&&i.input.blur(),i.cancelFocusInput()}),Z(i,"setOpen",function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i.setState({open:n,preSelection:n&&i.state.open?i.state.preSelection:i.calcInitialState().preSelection,lastPreSelectChange:zP},function(){n||i.setState(function(a){return{focused:s?a.focused:!1}},function(){!s&&i.setBlur(),i.setState({inputValue:null})})})}),Z(i,"inputOk",function(){return Dp(i.state.preSelection)}),Z(i,"isCalendarOpen",function(){return i.props.open===void 0?i.state.open&&!i.props.disabled&&!i.props.readOnly:i.props.open}),Z(i,"handleFocus",function(n){i.state.preventFocus||(i.props.onFocus(n),!i.props.preventOpenOnFocus&&!i.props.readOnly&&i.setOpen(!0)),i.setState({focused:!0})}),Z(i,"sendFocusBackToInput",function(){i.preventFocusTimeout&&i.clearPreventFocusTimeout(),i.setState({preventFocus:!0},function(){i.preventFocusTimeout=setTimeout(function(){i.setFocus(),i.setState({preventFocus:!1})})})}),Z(i,"cancelFocusInput",function(){clearTimeout(i.inputFocusTimeout),i.inputFocusTimeout=null}),Z(i,"deferFocusInput",function(){i.cancelFocusInput(),i.inputFocusTimeout=setTimeout(function(){return i.setFocus()},1)}),Z(i,"handleDropdownFocus",function(){i.cancelFocusInput()}),Z(i,"handleBlur",function(n){(!i.state.open||i.props.withPortal||i.props.showTimeInput)&&i.props.onBlur(n),i.setState({focused:!1})}),Z(i,"handleCalendarClickOutside",function(n){i.props.inline||i.setOpen(!1),i.props.onClickOutside(n),i.props.withPortal&&n.preventDefault()}),Z(i,"handleChange",function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];var o=s[0];if(!(i.props.onChangeRaw&&(i.props.onChangeRaw.apply(i,s),typeof o.isDefaultPrevented!="function"||o.isDefaultPrevented()))){i.setState({inputValue:o.target.value,lastPreSelectChange:tje});var l=nUe(o.target.value,i.props.dateFormat,i.props.locale,i.props.strictParsing,i.props.minDate);i.props.showTimeSelectOnly&&i.props.selected&&l&&!xr(l,i.props.selected)&&(l=VFe(i.props.selected,{hours:Hl(l),minutes:Vl(l),seconds:eu(l)})),(l||!o.target.value)&&i.setSelected(l,o,!0)}}),Z(i,"handleSelect",function(n,s,a){if(i.props.shouldCloseOnSelect&&!i.props.showTimeSelect&&i.sendFocusBackToInput(),i.props.onChangeRaw&&i.props.onChangeRaw(s),i.setSelected(n,s,!1,a),i.props.showDateSelect&&i.setState({isRenderAriaLiveMessage:!0}),!i.props.shouldCloseOnSelect||i.props.showTimeSelect)i.setPreSelection(n);else if(!i.props.inline){i.props.selectsRange||i.setOpen(!1);var o=i.props,l=o.startDate,c=o.endDate;l&&!c&&(i.props.swapRange||!sH(n,l))&&i.setOpen(!1)}}),Z(i,"setSelected",function(n,s,a,o){var l=n;if(i.props.showYearPicker){if(l!==null&&JK(rr(l),i.props))return}else if(i.props.showMonthYearPicker){if(l!==null&&g_(l,i.props))return}else if(l!==null&&vC(l,i.props))return;var c=i.props,u=c.onChange,h=c.selectsRange,d=c.startDate,p=c.endDate,f=c.selectsMultiple,m=c.selectedDates,g=c.minTime,v=c.swapRange;if(!Gd(i.props.selected,l)||i.props.allowSameDay||h||f)if(l!==null&&(i.props.selected&&(!a||!i.props.showTimeSelect&&!i.props.showTimeSelectOnly&&!i.props.showTimeInput)&&(l=RP(l,{hour:Hl(i.props.selected),minute:Vl(i.props.selected),second:eu(i.props.selected)})),!a&&(i.props.showTimeSelect||i.props.showTimeSelectOnly)&&g&&(l=RP(l,{hour:g.getHours(),minute:g.getMinutes(),second:g.getSeconds()})),i.props.inline||i.setState({preSelection:l}),i.props.focusSelectedMonth||i.setState({monthSelectedIn:o})),h){var y=!d&&!p,w=d&&!p,b=d&&p;y?u([l,null],s):w&&(l===null?u([null,null],s):sH(l,d)?u(v?[l,d]:[l,null],s):u([d,l],s)),b&&u([l,null],s)}else if(f)if(!(m!=null&&m.length))u([l],s);else{var E=m.some(function(C){return xr(C,l)});if(E){var _=m.filter(function(C){return!xr(C,l)});u(_,s)}else u([].concat(Zh(m),[l]),s)}else u(l,s);a||(i.props.onSelect(l,s),i.setState({inputValue:null}))}),Z(i,"setPreSelection",function(n){var s=typeof i.props.minDate<"u",a=typeof i.props.maxDate<"u",o=!0;if(n){var l=jl(n);if(s&&a)o=By(n,i.props.minDate,i.props.maxDate);else if(s){var c=jl(i.props.minDate);o=$h(n,c)||Gd(l,c)}else if(a){var u=MO(i.props.maxDate);o=Ip(n,u)||Gd(l,u)}}o&&i.setState({preSelection:n})}),Z(i,"toggleCalendar",function(){i.setOpen(!i.state.open)}),Z(i,"handleTimeChange",function(n){var s=i.props.selected?i.props.selected:i.getPreSelection(),a=i.props.selected?n:RP(s,{hour:Hl(n),minute:Vl(n)});i.setState({preSelection:a}),i.props.onChange(a),i.props.shouldCloseOnSelect&&(i.sendFocusBackToInput(),i.setOpen(!1)),i.props.showTimeInput&&i.setOpen(!0),(i.props.showTimeSelectOnly||i.props.showTimeSelect)&&i.setState({isRenderAriaLiveMessage:!0}),i.setState({inputValue:null})}),Z(i,"onInputClick",function(){!i.props.disabled&&!i.props.readOnly&&i.setOpen(!0),i.props.onInputClick()}),Z(i,"onInputKeyDown",function(n){i.props.onKeyDown(n);var s=n.key;if(!i.state.open&&!i.props.inline&&!i.props.preventOpenOnFocus){(s==="ArrowDown"||s==="ArrowUp"||s==="Enter")&&i.onInputClick();return}if(i.state.open){if(s==="ArrowDown"||s==="ArrowUp"){n.preventDefault();var a=i.props.showWeekPicker&&i.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':i.props.showFullMonthYearPicker||i.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',o=i.calendar.componentNode&&i.calendar.componentNode.querySelector(a);o&&o.focus({preventScroll:!0});return}var l=kr(i.state.preSelection);s==="Enter"?(n.preventDefault(),i.inputOk()&&i.state.lastPreSelectChange===zP?(i.handleSelect(l,n),!i.props.shouldCloseOnSelect&&i.setPreSelection(l)):i.setOpen(!1)):s==="Escape"?(n.preventDefault(),i.sendFocusBackToInput(),i.setOpen(!1)):s==="Tab"&&i.setOpen(!1),i.inputOk()||i.props.onInputError({code:1,msg:NP})}}),Z(i,"onPortalKeyDown",function(n){var s=n.key;s==="Escape"&&(n.preventDefault(),i.setState({preventFocus:!0},function(){i.setOpen(!1),setTimeout(function(){i.setFocus(),i.setState({preventFocus:!1})})}))}),Z(i,"onDayKeyDown",function(n){i.props.onKeyDown(n);var s=n.key,a=n.shiftKey,o=kr(i.state.preSelection);if(s==="Enter")n.preventDefault(),i.handleSelect(o,n),!i.props.shouldCloseOnSelect&&i.setPreSelection(o);else if(s==="Escape")n.preventDefault(),i.setOpen(!1),i.inputOk()||i.props.onInputError({code:1,msg:NP});else if(!i.props.disabledKeyboardNavigation){var l;switch(s){case"ArrowLeft":i.props.showWeekPicker?l=D6(o,1):l=wBe(o,1);break;case"ArrowRight":i.props.showWeekPicker?l=gE(o,1):l=od(o,1);break;case"ArrowUp":l=D6(o,1);break;case"ArrowDown":l=gE(o,1);break;case"PageUp":l=a?Dg(o,1):Pg(o,1);break;case"PageDown":l=a?Jc(o,1):Xo(o,1);break;case"Home":l=zh(o,i.props.locale,i.props.calendarStartDay);break;case"End":l=uUe(o);break;default:l=null;break}if(!l){i.props.onInputError&&i.props.onInputError({code:1,msg:NP});return}if(n.preventDefault(),i.setState({lastPreSelectChange:zP}),i.props.adjustDateOnChange&&i.setSelected(l),i.setPreSelection(l),i.props.inline){var c=zs(o),u=zs(l),h=rr(o),d=rr(l);c!==u||h!==d?i.setState({shouldFocusDayInline:!0}):i.setState({shouldFocusDayInline:!1})}}}),Z(i,"onPopperKeyDown",function(n){var s=n.key;s==="Escape"&&(n.preventDefault(),i.sendFocusBackToInput())}),Z(i,"onClearClick",function(n){n&&n.preventDefault&&n.preventDefault(),i.sendFocusBackToInput(),i.props.selectsRange?i.props.onChange([null,null],n):i.props.onChange(null,n),i.setState({inputValue:null})}),Z(i,"clear",function(){i.onClearClick()}),Z(i,"onScroll",function(n){typeof i.props.closeOnScroll=="boolean"&&i.props.closeOnScroll?(n.target===document||n.target===document.documentElement||n.target===document.body)&&i.setOpen(!1):typeof i.props.closeOnScroll=="function"&&i.props.closeOnScroll(n)&&i.setOpen(!1)}),Z(i,"renderCalendar",function(){return!i.props.inline&&!i.isCalendarOpen()?null:fe.createElement(JUe,{ref:function(s){i.calendar=s},locale:i.props.locale,calendarStartDay:i.props.calendarStartDay,chooseDayAriaLabelPrefix:i.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:i.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:i.props.weekAriaLabelPrefix,monthAriaLabelPrefix:i.props.monthAriaLabelPrefix,adjustDateOnChange:i.props.adjustDateOnChange,setOpen:i.setOpen,shouldCloseOnSelect:i.props.shouldCloseOnSelect,dateFormat:i.props.dateFormatCalendar,useWeekdaysShort:i.props.useWeekdaysShort,formatWeekDay:i.props.formatWeekDay,dropdownMode:i.props.dropdownMode,selected:i.props.selected,preSelection:i.state.preSelection,onSelect:i.handleSelect,onWeekSelect:i.props.onWeekSelect,openToDate:i.props.openToDate,minDate:i.props.minDate,maxDate:i.props.maxDate,selectsStart:i.props.selectsStart,selectsEnd:i.props.selectsEnd,selectsRange:i.props.selectsRange,selectsMultiple:i.props.selectsMultiple,selectedDates:i.props.selectedDates,startDate:i.props.startDate,endDate:i.props.endDate,excludeDates:i.props.excludeDates,excludeDateIntervals:i.props.excludeDateIntervals,filterDate:i.props.filterDate,onClickOutside:i.handleCalendarClickOutside,formatWeekNumber:i.props.formatWeekNumber,highlightDates:i.state.highlightDates,holidays:xUe(i.modifyHolidays()),includeDates:i.props.includeDates,includeDateIntervals:i.props.includeDateIntervals,includeTimes:i.props.includeTimes,injectTimes:i.props.injectTimes,inline:i.props.inline,shouldFocusDayInline:i.state.shouldFocusDayInline,peekNextMonth:i.props.peekNextMonth,showMonthDropdown:i.props.showMonthDropdown,showPreviousMonths:i.props.showPreviousMonths,useShortMonthInDropdown:i.props.useShortMonthInDropdown,showMonthYearDropdown:i.props.showMonthYearDropdown,showWeekNumbers:i.props.showWeekNumbers,showYearDropdown:i.props.showYearDropdown,withPortal:i.props.withPortal,forceShowMonthNavigation:i.props.forceShowMonthNavigation,showDisabledMonthNavigation:i.props.showDisabledMonthNavigation,scrollableYearDropdown:i.props.scrollableYearDropdown,scrollableMonthYearDropdown:i.props.scrollableMonthYearDropdown,todayButton:i.props.todayButton,weekLabel:i.props.weekLabel,outsideClickIgnoreClass:lH,fixedHeight:i.props.fixedHeight,monthsShown:i.props.monthsShown,monthSelectedIn:i.state.monthSelectedIn,onDropdownFocus:i.handleDropdownFocus,onMonthChange:i.props.onMonthChange,onYearChange:i.props.onYearChange,dayClassName:i.props.dayClassName,weekDayClassName:i.props.weekDayClassName,monthClassName:i.props.monthClassName,timeClassName:i.props.timeClassName,showDateSelect:i.props.showDateSelect,showTimeSelect:i.props.showTimeSelect,showTimeSelectOnly:i.props.showTimeSelectOnly,onTimeChange:i.handleTimeChange,timeFormat:i.props.timeFormat,timeIntervals:i.props.timeIntervals,minTime:i.props.minTime,maxTime:i.props.maxTime,excludeTimes:i.props.excludeTimes,filterTime:i.props.filterTime,timeCaption:i.props.timeCaption,className:i.props.calendarClassName,container:i.props.calendarContainer,yearItemNumber:i.props.yearItemNumber,yearDropdownItemNumber:i.props.yearDropdownItemNumber,previousMonthAriaLabel:i.props.previousMonthAriaLabel,previousMonthButtonLabel:i.props.previousMonthButtonLabel,nextMonthAriaLabel:i.props.nextMonthAriaLabel,nextMonthButtonLabel:i.props.nextMonthButtonLabel,previousYearAriaLabel:i.props.previousYearAriaLabel,previousYearButtonLabel:i.props.previousYearButtonLabel,nextYearAriaLabel:i.props.nextYearAriaLabel,nextYearButtonLabel:i.props.nextYearButtonLabel,timeInputLabel:i.props.timeInputLabel,disabledKeyboardNavigation:i.props.disabledKeyboardNavigation,renderCustomHeader:i.props.renderCustomHeader,popperProps:i.props.popperProps,renderDayContents:i.props.renderDayContents,renderMonthContent:i.props.renderMonthContent,renderQuarterContent:i.props.renderQuarterContent,renderYearContent:i.props.renderYearContent,onDayMouseEnter:i.props.onDayMouseEnter,onMonthMouseLeave:i.props.onMonthMouseLeave,onYearMouseEnter:i.props.onYearMouseEnter,onYearMouseLeave:i.props.onYearMouseLeave,selectsDisabledDaysInRange:i.props.selectsDisabledDaysInRange,showTimeInput:i.props.showTimeInput,showMonthYearPicker:i.props.showMonthYearPicker,showFullMonthYearPicker:i.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:i.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:i.props.showFourColumnMonthYearPicker,showYearPicker:i.props.showYearPicker,showQuarterYearPicker:i.props.showQuarterYearPicker,showWeekPicker:i.props.showWeekPicker,excludeScrollbar:i.props.excludeScrollbar,handleOnKeyDown:i.props.onKeyDown,handleOnDayKeyDown:i.onDayKeyDown,isInputFocused:i.state.focused,customTimeInput:i.props.customTimeInput,setPreSelection:i.setPreSelection,usePointerEvent:i.props.usePointerEvent,yearClassName:i.props.yearClassName},i.props.children)}),Z(i,"renderAriaLiveRegion",function(){var n=i.props,s=n.dateFormat,a=n.locale,o=i.props.showTimeInput||i.props.showTimeSelect,l=o?"PPPPp":"PPPP",c;return i.props.selectsRange?c="Selected start date: ".concat(Ga(i.props.startDate,{dateFormat:l,locale:a}),". ").concat(i.props.endDate?"End date: "+Ga(i.props.endDate,{dateFormat:l,locale:a}):""):i.props.showTimeSelectOnly?c="Selected time: ".concat(Ga(i.props.selected,{dateFormat:s,locale:a})):i.props.showYearPicker?c="Selected year: ".concat(Ga(i.props.selected,{dateFormat:"yyyy",locale:a})):i.props.showMonthYearPicker?c="Selected month: ".concat(Ga(i.props.selected,{dateFormat:"MMMM yyyy",locale:a})):i.props.showQuarterYearPicker?c="Selected quarter: ".concat(Ga(i.props.selected,{dateFormat:"yyyy, QQQ",locale:a})):c="Selected date: ".concat(Ga(i.props.selected,{dateFormat:l,locale:a})),fe.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},c)}),Z(i,"renderDateInput",function(){var n,s=Xn(i.props.className,Z({},lH,i.state.open)),a=i.props.customInput||fe.createElement("input",{type:"text"}),o=i.props.customInputRef||"ref",l=typeof i.props.value=="string"?i.props.value:typeof i.state.inputValue=="string"?i.state.inputValue:i.props.selectsRange?sUe(i.props.startDate,i.props.endDate,i.props):i.props.selectsMultiple?aUe(i.props.selectedDates,i.props):Ga(i.props.selected,i.props);return fe.cloneElement(a,(n={},Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(n,o,function(c){i.input=c}),"value",l),"onBlur",i.handleBlur),"onChange",i.handleChange),"onClick",i.onInputClick),"onFocus",i.handleFocus),"onKeyDown",i.onInputKeyDown),"id",i.props.id),"name",i.props.name),"form",i.props.form),Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(n,"autoFocus",i.props.autoFocus),"placeholder",i.props.placeholderText),"disabled",i.props.disabled),"autoComplete",i.props.autoComplete),"className",Xn(a.props.className,s)),"title",i.props.title),"readOnly",i.props.readOnly),"required",i.props.required),"tabIndex",i.props.tabIndex),"aria-describedby",i.props.ariaDescribedBy),Z(Z(Z(n,"aria-invalid",i.props.ariaInvalid),"aria-labelledby",i.props.ariaLabelledBy),"aria-required",i.props.ariaRequired)))}),Z(i,"renderClearButton",function(){var n=i.props,s=n.isClearable,a=n.disabled,o=n.selected,l=n.startDate,c=n.endDate,u=n.clearButtonTitle,h=n.clearButtonClassName,d=h===void 0?"":h,p=n.ariaLabelClose,f=p===void 0?"Close":p,m=n.selectedDates;return s&&(o!=null||l!=null||c!=null||m!=null&&m.length)?fe.createElement("button",{type:"button",className:Xn("react-datepicker__close-icon",d,{"react-datepicker__close-icon--disabled":a}),disabled:a,"aria-label":f,onClick:i.onClearClick,title:u,tabIndex:-1}):null}),i.state=i.calcInitialState(),i.preventFocusTimeout=null,i}return Dn(t,e),Pn(t,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll,!0)}},{key:"componentDidUpdate",value:function(i,n){i.inline&&eje(i.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&i.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),i.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:tH(this.props.highlightDates)}),!n.focused&&!Gd(i.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&this.props.onCalendarOpen(),n.open===!0&&this.state.open===!1&&this.props.onCalendarClose())}},{key:"componentWillUnmount",value:function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0)}},{key:"renderInputContainer",value:function(){var i=this.props,n=i.showIcon,s=i.icon,a=i.calendarIconClassname,o=i.toggleCalendarOnIconClick,l=this.state.open;return fe.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&fe.createElement(YUe,vw({icon:s,className:"".concat(a," ").concat(l&&"react-datepicker-ignore-onclickoutside")},o?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())}},{key:"render",value:function(){var i=this.renderCalendar();if(this.props.inline)return i;if(this.props.withPortal){var n=this.state.open?fe.createElement(sZ,{enableTabLoop:this.props.enableTabLoop},fe.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},i)):null;return this.state.open&&this.props.portalId&&(n=fe.createElement(nZ,{portalId:this.props.portalId,portalHost:this.props.portalHost},n)),fe.createElement("div",null,this.renderInputContainer(),n)}return fe.createElement(ZUe,{className:this.props.popperClassName,wrapperClassName:this.props.wrapperClassName,hidePopper:!this.isCalendarOpen(),portalId:this.props.portalId,portalHost:this.props.portalHost,popperModifiers:this.props.popperModifiers,targetComponent:this.renderInputContainer(),popperContainer:this.props.popperContainer,popperComponent:i,popperPlacement:this.props.popperPlacement,popperProps:this.props.popperProps,popperOnKeyDown:this.onPopperKeyDown,enableTabLoop:this.props.enableTabLoop,showArrow:this.props.showPopperArrow})}}],[{key:"defaultProps",get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",onChange:function(){},disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",onFocus:function(){},onBlur:function(){},onKeyDown:function(){},onInputClick:function(){},onSelect:function(){},onClickOutside:function(){},onMonthChange:function(){},onCalendarOpen:function(){},onCalendarClose:function(){},preventOpenOnFocus:!1,onYearChange:function(){},onInputError:function(){},monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:ux,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}}}])}(fe.Component),tje="input",zP="navigate";function rje(e){return rc({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M15.545 6.558a9.4 9.4 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.7 7.7 0 0 1 5.352 2.082l-2.284 2.284A4.35 4.35 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.8 4.8 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.7 3.7 0 0 0 1.599-2.431H8v-3.08z"},child:[]}]})(e)}const aZ=({message:e,onConfirm:t,onCancel:r})=>{const i=rd(),n=async()=>{try{const s=await HT(Pp,cC),a={userID:s.user.uid,name:s.user.displayName,profilePhoto:s.user.photoURL,isAuth:!0};localStorage.setItem("auth",JSON.stringify(a)),i("/"),window.location.reload()}catch(s){console.error("Error signing in with Google:",s.message)}};return k.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-500 bg-opacity-50 z-50",children:k.jsxs("div",{className:"bg-white p-6 rounded-md shadow-lg flex flex-col items-center",children:[k.jsx("p",{className:"text-lg mb-4",children:e}),k.jsxs("div",{className:"flex justify-center items-center",children:[k.jsxs("button",{onClick:n,className:"flex items-center bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded-md mr-2",children:[k.jsx(rje,{}),"  Sign in with Google"]}),k.jsx("button",{onClick:r,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold px-4 py-2 rounded-md",children:"Cancel"})]})]})})},ije=()=>{const e=hs(Jr,"cart"),{userID:t}=ov(),r=n=>{const s={year:"numeric",month:"short",day:"2-digit"};return new Date(n).toLocaleDateString("en-US",s)};return{addTransaction:async({name:n,description:s,price:a,totalAmountToPay:o,imageUrl:l,startDate:c,endDate:u,Agebracket:h,amountToPay:d,quantity:p})=>{if(!t)throw new Error("User is not authenticated");try{await ip(e,{userID:t,name:n,description:s,price:a,totalAmountToPay:o,imageUrl:l,startDate:r(c),endDate:r(u),Agebracket:h,amountToPay:d,quantity:p,createdAt:GQ()}),console.log("Transaction added successfully")}catch(f){throw console.error("Error adding transaction:",f),f}}}},oZ=()=>{const[e,t]=te.useState(null);return te.useEffect(()=>{const r=Pp.onAuthStateChanged(i=>{t(i)});return()=>r()},[]),{user:e,provider:cC,signOut:async()=>{try{await signOut()}catch(r){console.error("Error signing out:",r.message)}}}},lZ=({item:e,onClose:t})=>{const r=rd(),{addTransaction:i}=ije(),{user:n}=oZ(),[s,a]=te.useState(new Date),[o,l]=te.useState(new Date),[c,u]=te.useState({adult:0,child:0,senior:0}),[h,d]=te.useState({adult:0,child:0,senior:0}),[p,f]=te.useState(!1),[m,g]=te.useState(0);te.useEffect(()=>{v()},[]);const v=async()=>{try{const x=hs(Jr,"Product");(await Kl(x)).forEach(T=>{const M=T.data();M.name===e.name&&u({adult:M.adultPrice,child:M.childPrice,senior:M.seniorPrice})})}catch(x){console.error("Error fetching prices:",x)}},y=async()=>{try{const A=(await HT(Pp,cC)).user,T={userID:A.uid,name:A.displayName,profilePhoto:A.photoURL,isAuth:!0};localStorage.setItem("auth",JSON.stringify(T)),r("/"),window.location.reload()}catch(x){console.log(x.message)}},w=x=>{a(x),x>o&&l(x),E(x,o,h)},b=x=>{x<s&&a(x),l(x),E(s,x,h)},E=(x,A,T)=>{const D=new Date(x),P=new Date(A);let I=Math.ceil((P-D)/864e5)+1;I<=0&&(I=1);const B=(c.adult*T.adult+c.child*T.child+c.senior*T.senior)*I;g(B)},_=(x,A)=>{const T={...h,[x]:A?1:0};d(T),E(s,o,T)},C=async()=>{try{if(!n){f(!0);return}if(!Object.values(h).some(M=>M>0)){alert("Please select at least one age bracket.");return}const A=Object.keys(h).reduce((M,D)=>M+h[D]*c[D],0),T={};Object.keys(h).forEach(M=>{h[M]>0&&(T[M]=h[M])}),await i({name:e.name,description:e.description,price:A,totalAmountToPay:m,imageUrl:e.imageUrl,startDate:s,endDate:o,Agebracket:T,amountToPay:m,quantity:Object.values(h).reduce((M,D)=>M+D,0)}),alert(`Added ${e.name} to cart`),t()}catch(x){alert(x.message)}};return k.jsxs("div",{className:"fixed inset-0 flex items-center justify-center overflow-y-auto bg-black bg-opacity-50 z-50",children:[k.jsx("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl max-w-full w-full sm:max-w-lg sm:w-full h-full max-h-[80%] z-50",children:k.jsxs("div",{className:"p-4 flex flex-col h-full",children:[k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Product Confirmation"}),k.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:k.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:k.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),k.jsx("div",{className:"overflow-auto mt-4",children:k.jsx("form",{className:"w-full",children:k.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[k.jsx("div",{className:"mt-4",children:k.jsx("img",{src:e.imageUrl,alt:e.name,className:"w-20 h-10 object-cover rounded-md"})}),k.jsx("div",{className:"mt-4",children:k.jsx("label",{htmlFor:"name",className:"text-sm text-gray-500",children:e.name})}),k.jsxs("div",{className:"mt-4 col-span-2",children:[k.jsx("label",{className:"text-sm text-gray-500",children:"Age Bracket:"}),k.jsx("div",{className:"flex flex-col",children:["adult","child","senior"].map(x=>k.jsxs("div",{className:"flex items-center mt-2",children:[k.jsx("input",{type:"checkbox",id:`${x}-checkbox`,className:"mr-2",checked:h[x]>0,onChange:A=>_(x,A.target.checked)}),k.jsxs("label",{htmlFor:`${x}-checkbox`,className:"mr-2 text-gray-500",children:[x.charAt(0).toUpperCase()+x.slice(1)," (₱",c[x].toFixed(2),")"]}),k.jsx("input",{type:"number",min:"1",value:h[x],onChange:A=>_(x,A.target.value),className:"w-20 p-2 border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:h[x]<=0})]},x))})]}),k.jsx("div",{className:"mt-4 col-span-2",children:k.jsxs("label",{htmlFor:"description",className:"text-sm text-gray-500",children:["Description: ",e.description]})}),k.jsxs("div",{className:"mt-4",children:[k.jsx("label",{htmlFor:"start-date",className:"text-sm text-gray-500",children:"Select start date:"}),k.jsx(cH,{id:"start-date",selected:s,onChange:w,className:"block w-full mt-1 p-2 border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 cursor-pointer"})]}),k.jsxs("div",{className:"mt-4",children:[k.jsx("label",{htmlFor:"end-date",className:"text-sm text-gray-500",children:"Select end date:"}),k.jsx(cH,{id:"end-date",selected:o,onChange:b,className:"block w-full mt-1 p-2 border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 cursor-pointer"})]}),k.jsx("div",{className:"mt-4 col-span-2",children:k.jsxs("label",{htmlFor:"amount-to-pay",className:"text-md text-gray-500 font-bold ",children:["Amount to pay: ₱",m.toFixed(2)]})}),k.jsxs("div",{className:"flex flex-col mt-2 col-span-2",children:[k.jsx("span",{className:"font-semibold",children:"Highlights:"}),e.inputs&&e.inputs.map((x,A)=>k.jsxs("div",{className:"flex items-center",children:[k.jsx(b2e,{className:"mr-1"}),k.jsx("span",{children:x})]},A))]})]})})}),k.jsx("div",{className:"bg-gray-100 px-4 py-3 flex justify-end",children:k.jsx("button",{onClick:C,className:"w-full py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add to Cart"})})]})}),p&&k.jsx(aZ,{message:"You need to sign in before adding to cart.",onConfirm:y,onCancel:()=>f(!1),zIndex:60})]})},nje=()=>{const[e,t]=te.useState([]),[r,i]=te.useState(null);te.useEffect(()=>{n(),s3.init()},[]);const n=async()=>{try{const o=await Kl(hs(Jr,"Product")),l=[];o.forEach(c=>{l.push({id:c.id,...c.data()})}),t(l)}catch(o){console.error("Error fetching items:",o)}},s=o=>{i(o)},a=()=>{i(null)};return k.jsxs("div",{className:"container mx-auto p-4 bg-white mb-8 mt-9",children:[k.jsx("h1",{className:"text-2xl font-bold mb-4 text-[#008080] text-center",children:"Product List"}),k.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 cursor-pointer",children:e.map(o=>k.jsx("div",{className:"border border-gray-300 rounded-md p-4 bg-white shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1",onClick:()=>s(o),"data-aos":"fade-up","data-aos-delay":"100",children:k.jsxs("div",{className:"relative",children:[k.jsx("img",{src:o.imageUrl,alt:o.name,className:"mb-4 rounded-md object-cover w-full h-[200px]"}),k.jsxs("div",{className:"mt-4",children:[k.jsxs("p",{className:"text-lg font-semibold",children:["Destination: ",o.name]}),k.jsx("p",{className:"text-md",children:o.category}),k.jsxs("p",{className:"text-md overflow-hidden max-h-16",children:["Description: ",o.description.length>100?k.jsxs(k.Fragment,{children:[o.description.slice(0,100),"...",k.jsx("span",{className:"text-blue-500 cursor-pointer",onClick:()=>s(o),children:" See more"})]}):o.description]})]}),k.jsxs("div",{className:"flex justify-between items-center mt-4",children:[k.jsxs("p",{className:"font-semibold",children:["Price: ₱",o.childPrice," - ",o.adultPrice]}),k.jsx("p",{className:"font-semibold",children:o.inputs})]})]})},o.id))}),r&&k.jsx(lZ,{item:r,onClose:a})]})},sje=()=>{const[e,t]=te.useState([]),[r,i]=te.useState(null);te.useEffect(()=>{(async()=>{try{const c=(await Kl(hs(Jr,"checkout"))).docs.map(u=>u.data());t(c.map(u=>n(u)))}catch(l){console.error("Error fetching transactions:",l)}})()},[]);const n=o=>{try{const l=o.startDate instanceof Yr?o.startDate.toDate().toLocaleString():"N/A",c=o.endDate instanceof Yr?o.endDate.toDate().toLocaleString():"N/A";return{...o,startDate:l,endDate:c}}catch(l){return console.error("Error formatting transaction dates:",l),o}},s=(o,l,c,u)=>{const h=n({startDate:l,endDate:c});i({selectedOrders:o,...h,totalAmount:u})},a=()=>{i(null)};return k.jsxs("div",{className:"container mx-auto mt-10 max-h-screen overflow-auto relative",children:[k.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Transaction History"}),k.jsxs("table",{className:"border-collapse w-full",children:[k.jsx("thead",{children:k.jsxs("tr",{className:"bg-gray-200",children:[k.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Item"}),k.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Price"}),k.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),k.jsx("tbody",{children:e.map((o,l)=>k.jsxs("tr",{className:"border-b border-gray-300",children:[k.jsx("td",{className:"border border-gray-300 px-4 py-2",children:o.selectedOrders.map((c,u)=>k.jsxs("div",{className:"flex items-center",children:[k.jsx("img",{src:c.imageUrl,alt:c.name,className:"w-12 h-12 object-cover mr-2 mb-1"}),k.jsx("span",{children:c.name})," ",k.jsx("span",{children:c.quantity})," ",k.jsx("span",{children:c.totalAmount})]},u))}),k.jsx("td",{className:"border border-gray-300 px-4 py-2",children:o.totalAmount}),k.jsx("td",{className:"border border-gray-300 px-4 py-2",children:k.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:()=>s(o.selectedOrders,o.startDate,o.endDate,o.totalAmount),children:"View Receipt"})})]},l))})]}),r&&k.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 overflow-y-auto flex items-center justify-center bg-gray-700 bg-opacity-50",children:k.jsxs("div",{className:"bg-white p-4 rounded shadow-md max-w-md",children:[k.jsx("h2",{className:"text-lg font-bold mb-2",children:"Receipt"}),k.jsxs("ul",{children:[r.selectedOrders.map((o,l)=>k.jsxs("li",{className:"mb-3",children:[k.jsx("img",{src:o.imageUrl,className:"w-12 h-12 object-cover mr-2 mb-1",alt:o.name}),k.jsxs("p",{children:["Name: ",o.name]}),k.jsxs("p",{children:["Price: $",o.price]}),k.jsxs("p",{children:["Quantity: ",o.quantity]})]},l)),k.jsx("li",{children:k.jsxs("p",{children:["Total Amount: $",r.totalAmount]})})]}),k.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:a,children:"Close"})]})})]})};function cZ(e,t){return function(){return e.apply(t,arguments)}}const{toString:aje}=Object.prototype,{getPrototypeOf:tN}=Object,wC=(e=>t=>{const r=aje.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Zo=e=>(e=e.toLowerCase(),t=>wC(t)===e),xC=e=>t=>typeof t===e,{isArray:fv}=Array,yw=xC("undefined");function oje(e){return e!==null&&!yw(e)&&e.constructor!==null&&!yw(e.constructor)&&no(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const uZ=Zo("ArrayBuffer");function lje(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&uZ(e.buffer),t}const cje=xC("string"),no=xC("function"),hZ=xC("number"),bC=e=>e!==null&&typeof e=="object",uje=e=>e===!0||e===!1,v_=e=>{if(wC(e)!=="object")return!1;const t=tN(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},hje=Zo("Date"),dje=Zo("File"),pje=Zo("Blob"),fje=Zo("FileList"),mje=e=>bC(e)&&no(e.pipe),gje=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||no(e.append)&&((t=wC(e))==="formdata"||t==="object"&&no(e.toString)&&e.toString()==="[object FormData]"))},vje=Zo("URLSearchParams"),[yje,wje,xje,bje]=["ReadableStream","Request","Response","Headers"].map(Zo),_je=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hx(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,n;if(typeof e!="object"&&(e=[e]),fv(e))for(i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else{const s=r?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let o;for(i=0;i<a;i++)o=s[i],t.call(null,e[o],o,e)}}function dZ(e,t){t=t.toLowerCase();const r=Object.keys(e);let i=r.length,n;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const pZ=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,fZ=e=>!yw(e)&&e!==pZ;function NO(){const{caseless:e}=fZ(this)&&this||{},t={},r=(i,n)=>{const s=e&&dZ(t,n)||n;v_(t[s])&&v_(i)?t[s]=NO(t[s],i):v_(i)?t[s]=NO({},i):fv(i)?t[s]=i.slice():t[s]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&hx(arguments[i],r);return t}const Sje=(e,t,r,{allOwnKeys:i}={})=>(hx(t,(n,s)=>{r&&no(n)?e[s]=cZ(n,r):e[s]=n},{allOwnKeys:i}),e),Eje=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Tje=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Cje=(e,t,r,i)=>{let n,s,a;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)a=n[s],(!i||i(a,e,t))&&!o[a]&&(t[a]=e[a],o[a]=!0);e=r!==!1&&tN(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Aje=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},Mje=e=>{if(!e)return null;if(fv(e))return e;let t=e.length;if(!hZ(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Pje=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&tN(Uint8Array)),Dje=(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=i.next())&&!n.done;){const s=n.value;t.call(e,s[0],s[1])}},Ije=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},Oje=Zo("HTMLFormElement"),Rje=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,n){return i.toUpperCase()+n}),uH=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),kje=Zo("RegExp"),mZ=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};hx(r,(n,s)=>{let a;(a=t(n,s,e))!==!1&&(i[s]=a||n)}),Object.defineProperties(e,i)},Lje=e=>{mZ(e,(t,r)=>{if(no(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(no(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Nje=(e,t)=>{const r={},i=n=>{n.forEach(s=>{r[s]=!0})};return fv(e)?i(e):i(String(e).split(t)),r},zje=()=>{},Bje=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,BP="abcdefghijklmnopqrstuvwxyz",hH="0123456789",gZ={DIGIT:hH,ALPHA:BP,ALPHA_DIGIT:BP+BP.toUpperCase()+hH},Fje=(e=16,t=gZ.ALPHA_DIGIT)=>{let r="";const{length:i}=t;for(;e--;)r+=t[Math.random()*i|0];return r};function Uje(e){return!!(e&&no(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const jje=e=>{const t=new Array(10),r=(i,n)=>{if(bC(i)){if(t.indexOf(i)>=0)return;if(!("toJSON"in i)){t[n]=i;const s=fv(i)?[]:{};return hx(i,(a,o)=>{const l=r(a,n+1);!yw(l)&&(s[o]=l)}),t[n]=void 0,s}}return i};return r(e,0)},Vje=Zo("AsyncFunction"),Hje=e=>e&&(bC(e)||no(e))&&no(e.then)&&no(e.catch),De={isArray:fv,isArrayBuffer:uZ,isBuffer:oje,isFormData:gje,isArrayBufferView:lje,isString:cje,isNumber:hZ,isBoolean:uje,isObject:bC,isPlainObject:v_,isReadableStream:yje,isRequest:wje,isResponse:xje,isHeaders:bje,isUndefined:yw,isDate:hje,isFile:dje,isBlob:pje,isRegExp:kje,isFunction:no,isStream:mje,isURLSearchParams:vje,isTypedArray:Pje,isFileList:fje,forEach:hx,merge:NO,extend:Sje,trim:_je,stripBOM:Eje,inherits:Tje,toFlatObject:Cje,kindOf:wC,kindOfTest:Zo,endsWith:Aje,toArray:Mje,forEachEntry:Dje,matchAll:Ije,isHTMLForm:Oje,hasOwnProperty:uH,hasOwnProp:uH,reduceDescriptors:mZ,freezeMethods:Lje,toObjectSet:Nje,toCamelCase:Rje,noop:zje,toFiniteNumber:Bje,findKey:dZ,global:pZ,isContextDefined:fZ,ALPHABET:gZ,generateString:Fje,isSpecCompliantForm:Uje,toJSONObject:jje,isAsyncFn:Vje,isThenable:Hje};function Qt(e,t,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}De.inherits(Qt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const vZ=Qt.prototype,yZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{yZ[e]={value:e}});Object.defineProperties(Qt,yZ);Object.defineProperty(vZ,"isAxiosError",{value:!0});Qt.from=(e,t,r,i,n,s)=>{const a=Object.create(vZ);return De.toFlatObject(e,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),Qt.call(a,e.message,t,r,i,n),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const Wje=null;function zO(e){return De.isPlainObject(e)||De.isArray(e)}function wZ(e){return De.endsWith(e,"[]")?e.slice(0,-2):e}function dH(e,t,r){return e?e.concat(t).map(function(n,s){return n=wZ(n),!r&&s?"["+n+"]":n}).join(r?".":""):t}function Gje(e){return De.isArray(e)&&!e.some(zO)}const qje=De.toFlatObject(De,{},null,function(t){return/^is[A-Z]/.test(t)});function _C(e,t,r){if(!De.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=De.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!De.isUndefined(g[m])});const i=r.metaTokens,n=r.visitor||u,s=r.dots,a=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&De.isSpecCompliantForm(t);if(!De.isFunction(n))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(De.isDate(f))return f.toISOString();if(!l&&De.isBlob(f))throw new Qt("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(f)||De.isTypedArray(f)?l&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,m,g){let v=f;if(f&&!g&&typeof f=="object"){if(De.endsWith(m,"{}"))m=i?m:m.slice(0,-2),f=JSON.stringify(f);else if(De.isArray(f)&&Gje(f)||(De.isFileList(f)||De.endsWith(m,"[]"))&&(v=De.toArray(f)))return m=wZ(m),v.forEach(function(w,b){!(De.isUndefined(w)||w===null)&&t.append(a===!0?dH([m],b,s):a===null?m:m+"[]",c(w))}),!1}return zO(f)?!0:(t.append(dH(g,m,s),c(f)),!1)}const h=[],d=Object.assign(qje,{defaultVisitor:u,convertValue:c,isVisitable:zO});function p(f,m){if(!De.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(f),De.forEach(f,function(v,y){(!(De.isUndefined(v)||v===null)&&n.call(t,v,De.isString(y)?y.trim():y,m,d))===!0&&p(v,m?m.concat(y):[y])}),h.pop()}}if(!De.isObject(e))throw new TypeError("data must be an object");return p(e),t}function pH(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function rN(e,t){this._pairs=[],e&&_C(e,this,t)}const xZ=rN.prototype;xZ.append=function(t,r){this._pairs.push([t,r])};xZ.toString=function(t){const r=t?function(i){return t.call(this,i,pH)}:pH;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Yje(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bZ(e,t,r){if(!t)return e;const i=r&&r.encode||Yje,n=r&&r.serialize;let s;if(n?s=n(t,r):s=De.isURLSearchParams(t)?t.toString():new rN(t,r).toString(i),s){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class fH{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){De.forEach(this.handlers,function(i){i!==null&&t(i)})}}const _Z={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xje=typeof URLSearchParams<"u"?URLSearchParams:rN,$je=typeof FormData<"u"?FormData:null,Qje=typeof Blob<"u"?Blob:null,Kje={isBrowser:!0,classes:{URLSearchParams:Xje,FormData:$je,Blob:Qje},protocols:["http","https","file","blob","url","data"]},iN=typeof window<"u"&&typeof document<"u",Zje=(e=>iN&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Jje=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",eVe=iN&&window.location.href||"http://localhost",tVe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:iN,hasStandardBrowserEnv:Zje,hasStandardBrowserWebWorkerEnv:Jje,origin:eVe},Symbol.toStringTag,{value:"Module"})),Bo={...tVe,...Kje};function rVe(e,t){return _C(e,new Bo.classes.URLSearchParams,Object.assign({visitor:function(r,i,n,s){return Bo.isNode&&De.isBuffer(r)?(this.append(i,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function iVe(e){return De.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function nVe(e){const t={},r=Object.keys(e);let i;const n=r.length;let s;for(i=0;i<n;i++)s=r[i],t[s]=e[s];return t}function SZ(e){function t(r,i,n,s){let a=r[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=r.length;return a=!a&&De.isArray(n)?n.length:a,l?(De.hasOwnProp(n,a)?n[a]=[n[a],i]:n[a]=i,!o):((!n[a]||!De.isObject(n[a]))&&(n[a]=[]),t(r,i,n[a],s)&&De.isArray(n[a])&&(n[a]=nVe(n[a])),!o)}if(De.isFormData(e)&&De.isFunction(e.entries)){const r={};return De.forEachEntry(e,(i,n)=>{t(iVe(i),n,r,0)}),r}return null}function sVe(e,t,r){if(De.isString(e))try{return(t||JSON.parse)(e),De.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}const nN={transitional:_Z,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",n=i.indexOf("application/json")>-1,s=De.isObject(t);if(s&&De.isHTMLForm(t)&&(t=new FormData(t)),De.isFormData(t))return n?JSON.stringify(SZ(t)):t;if(De.isArrayBuffer(t)||De.isBuffer(t)||De.isStream(t)||De.isFile(t)||De.isBlob(t)||De.isReadableStream(t))return t;if(De.isArrayBufferView(t))return t.buffer;if(De.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return rVe(t,this.formSerializer).toString();if((o=De.isFileList(t))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return _C(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||n?(r.setContentType("application/json",!1),sVe(t)):t}],transformResponse:[function(t){const r=this.transitional||nN.transitional,i=r&&r.forcedJSONParsing,n=this.responseType==="json";if(De.isResponse(t)||De.isReadableStream(t))return t;if(t&&De.isString(t)&&(i&&!this.responseType||n)){const a=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(a)throw o.name==="SyntaxError"?Qt.from(o,Qt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bo.classes.FormData,Blob:Bo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};De.forEach(["delete","get","head","post","put","patch"],e=>{nN.headers[e]={}});const sN=nN,aVe=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),oVe=e=>{const t={};let r,i,n;return e&&e.split(`
`).forEach(function(a){n=a.indexOf(":"),r=a.substring(0,n).trim().toLowerCase(),i=a.substring(n+1).trim(),!(!r||t[r]&&aVe[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},mH=Symbol("internals");function vy(e){return e&&String(e).trim().toLowerCase()}function y_(e){return e===!1||e==null?e:De.isArray(e)?e.map(y_):String(e)}function lVe(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const cVe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function FP(e,t,r,i,n){if(De.isFunction(i))return i.call(this,t,r);if(n&&(t=r),!!De.isString(t)){if(De.isString(i))return t.indexOf(i)!==-1;if(De.isRegExp(i))return i.test(t)}}function uVe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function hVe(e,t){const r=De.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(n,s,a){return this[i].call(this,t,n,s,a)},configurable:!0})})}class SC{constructor(t){t&&this.set(t)}set(t,r,i){const n=this;function s(o,l,c){const u=vy(l);if(!u)throw new Error("header name must be a non-empty string");const h=De.findKey(n,u);(!h||n[h]===void 0||c===!0||c===void 0&&n[h]!==!1)&&(n[h||l]=y_(o))}const a=(o,l)=>De.forEach(o,(c,u)=>s(c,u,l));if(De.isPlainObject(t)||t instanceof this.constructor)a(t,r);else if(De.isString(t)&&(t=t.trim())&&!cVe(t))a(oVe(t),r);else if(De.isHeaders(t))for(const[o,l]of t.entries())s(l,o,i);else t!=null&&s(r,t,i);return this}get(t,r){if(t=vy(t),t){const i=De.findKey(this,t);if(i){const n=this[i];if(!r)return n;if(r===!0)return lVe(n);if(De.isFunction(r))return r.call(this,n,i);if(De.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=vy(t),t){const i=De.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||FP(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let n=!1;function s(a){if(a=vy(a),a){const o=De.findKey(i,a);o&&(!r||FP(i,i[o],o,r))&&(delete i[o],n=!0)}}return De.isArray(t)?t.forEach(s):s(t),n}clear(t){const r=Object.keys(this);let i=r.length,n=!1;for(;i--;){const s=r[i];(!t||FP(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){const r=this,i={};return De.forEach(this,(n,s)=>{const a=De.findKey(i,s);if(a){r[a]=y_(n),delete r[s];return}const o=t?uVe(s):String(s).trim();o!==s&&delete r[s],r[o]=y_(n),i[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return De.forEach(this,(i,n)=>{i!=null&&i!==!1&&(r[n]=t&&De.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(n=>i.set(n)),i}static accessor(t){const i=(this[mH]=this[mH]={accessors:{}}).accessors,n=this.prototype;function s(a){const o=vy(a);i[o]||(hVe(n,a),i[o]=!0)}return De.isArray(t)?t.forEach(s):s(t),this}}SC.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);De.reduceDescriptors(SC.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});De.freezeMethods(SC);const Fo=SC;function UP(e,t){const r=this||sN,i=t||r,n=Fo.from(i.headers);let s=i.data;return De.forEach(e,function(o){s=o.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function EZ(e){return!!(e&&e.__CANCEL__)}function mv(e,t,r){Qt.call(this,e??"canceled",Qt.ERR_CANCELED,t,r),this.name="CanceledError"}De.inherits(mv,Qt,{__CANCEL__:!0});function TZ(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new Qt("Request failed with status code "+r.status,[Qt.ERR_BAD_REQUEST,Qt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function dVe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function pVe(e,t){e=e||10;const r=new Array(e),i=new Array(e);let n=0,s=0,a;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=i[s];a||(a=c),r[n]=l,i[n]=c;let h=s,d=0;for(;h!==n;)d+=r[h++],h=h%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),c-a<t)return;const p=u&&c-u;return p?Math.round(d*1e3/p):void 0}}function fVe(e,t){let r=0;const i=1e3/t;let n=null;return function(){const a=this===!0,o=Date.now();if(a||o-r>i)return n&&(clearTimeout(n),n=null),r=o,e.apply(null,arguments);n||(n=setTimeout(()=>(n=null,r=Date.now(),e.apply(null,arguments)),i-(o-r)))}}const AE=(e,t,r=3)=>{let i=0;const n=pVe(50,250);return fVe(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-i,c=n(l),u=a<=o;i=a;const h={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&u?(o-a)/c:void 0,event:s,lengthComputable:o!=null};h[t?"download":"upload"]=!0,e(h)},r)},mVe=Bo.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let i;function n(s){let a=s;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return i=n(window.location.href),function(a){const o=De.isString(a)?n(a):a;return o.protocol===i.protocol&&o.host===i.host}}():function(){return function(){return!0}}(),gVe=Bo.hasStandardBrowserEnv?{write(e,t,r,i,n,s){const a=[e+"="+encodeURIComponent(t)];De.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),De.isString(i)&&a.push("path="+i),De.isString(n)&&a.push("domain="+n),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function vVe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function yVe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function CZ(e,t){return e&&!vVe(t)?yVe(e,t):t}const gH=e=>e instanceof Fo?{...e}:e;function Rp(e,t){t=t||{};const r={};function i(c,u,h){return De.isPlainObject(c)&&De.isPlainObject(u)?De.merge.call({caseless:h},c,u):De.isPlainObject(u)?De.merge({},u):De.isArray(u)?u.slice():u}function n(c,u,h){if(De.isUndefined(u)){if(!De.isUndefined(c))return i(void 0,c,h)}else return i(c,u,h)}function s(c,u){if(!De.isUndefined(u))return i(void 0,u)}function a(c,u){if(De.isUndefined(u)){if(!De.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function o(c,u,h){if(h in t)return i(c,u);if(h in e)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,u)=>n(gH(c),gH(u),!0)};return De.forEach(Object.keys(Object.assign({},e,t)),function(u){const h=l[u]||n,d=h(e[u],t[u],u);De.isUndefined(d)&&h!==o||(r[u]=d)}),r}const AZ=e=>{const t=Rp({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:s,headers:a,auth:o}=t;t.headers=a=Fo.from(a),t.url=bZ(CZ(t.baseURL,t.url),e.params,e.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(De.isFormData(r)){if(Bo.hasStandardBrowserEnv||Bo.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Bo.hasStandardBrowserEnv&&(i&&De.isFunction(i)&&(i=i(t)),i||i!==!1&&mVe(t.url))){const c=n&&s&&gVe.read(s);c&&a.set(n,c)}return t},wVe=typeof XMLHttpRequest<"u",xVe=wVe&&function(e){return new Promise(function(r,i){const n=AZ(e);let s=n.data;const a=Fo.from(n.headers).normalize();let{responseType:o}=n,l;function c(){n.cancelToken&&n.cancelToken.unsubscribe(l),n.signal&&n.signal.removeEventListener("abort",l)}let u=new XMLHttpRequest;u.open(n.method.toUpperCase(),n.url,!0),u.timeout=n.timeout;function h(){if(!u)return;const p=Fo.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:p,config:e,request:u};TZ(function(v){r(v),c()},function(v){i(v),c()},m),u=null}"onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(h)},u.onabort=function(){u&&(i(new Qt("Request aborted",Qt.ECONNABORTED,n,u)),u=null)},u.onerror=function(){i(new Qt("Network Error",Qt.ERR_NETWORK,n,u)),u=null},u.ontimeout=function(){let f=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const m=n.transitional||_Z;n.timeoutErrorMessage&&(f=n.timeoutErrorMessage),i(new Qt(f,m.clarifyTimeoutError?Qt.ETIMEDOUT:Qt.ECONNABORTED,n,u)),u=null},s===void 0&&a.setContentType(null),"setRequestHeader"in u&&De.forEach(a.toJSON(),function(f,m){u.setRequestHeader(m,f)}),De.isUndefined(n.withCredentials)||(u.withCredentials=!!n.withCredentials),o&&o!=="json"&&(u.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&u.addEventListener("progress",AE(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",AE(n.onUploadProgress)),(n.cancelToken||n.signal)&&(l=p=>{u&&(i(!p||p.type?new mv(null,e,u):p),u.abort(),u=null)},n.cancelToken&&n.cancelToken.subscribe(l),n.signal&&(n.signal.aborted?l():n.signal.addEventListener("abort",l)));const d=dVe(n.url);if(d&&Bo.protocols.indexOf(d)===-1){i(new Qt("Unsupported protocol "+d+":",Qt.ERR_BAD_REQUEST,e));return}u.send(s||null)})},bVe=(e,t)=>{let r=new AbortController,i;const n=function(l){if(!i){i=!0,a();const c=l instanceof Error?l:this.reason;r.abort(c instanceof Qt?c:new mv(c instanceof Error?c.message:c))}};let s=t&&setTimeout(()=>{n(new Qt(`timeout ${t} of ms exceeded`,Qt.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(l=>{l&&(l.removeEventListener?l.removeEventListener("abort",n):l.unsubscribe(n))}),e=null)};e.forEach(l=>l&&l.addEventListener&&l.addEventListener("abort",n));const{signal:o}=r;return o.unsubscribe=a,[o,()=>{s&&clearTimeout(s),s=null}]},_Ve=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let i=0,n;for(;i<r;)n=i+t,yield e.slice(i,n),i=n},SVe=async function*(e,t,r){for await(const i of e)yield*_Ve(ArrayBuffer.isView(i)?i:await r(String(i)),t)},vH=(e,t,r,i,n)=>{const s=SVe(e,t,n);let a=0;return new ReadableStream({type:"bytes",async pull(o){const{done:l,value:c}=await s.next();if(l){o.close(),i();return}let u=c.byteLength;r&&r(a+=u),o.enqueue(new Uint8Array(c))},cancel(o){return i(o),s.return()}},{highWaterMark:2})},yH=(e,t)=>{const r=e!=null;return i=>setTimeout(()=>t({lengthComputable:r,total:e,loaded:i}))},EC=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",MZ=EC&&typeof ReadableStream=="function",BO=EC&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),EVe=MZ&&(()=>{let e=!1;const t=new Request(Bo.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),wH=64*1024,FO=MZ&&!!(()=>{try{return De.isReadableStream(new Response("").body)}catch{}})(),ME={stream:FO&&(e=>e.body)};EC&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ME[t]&&(ME[t]=De.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new Qt(`Response type '${t}' is not supported`,Qt.ERR_NOT_SUPPORT,i)})})})(new Response);const TVe=async e=>{if(e==null)return 0;if(De.isBlob(e))return e.size;if(De.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(De.isArrayBufferView(e))return e.byteLength;if(De.isURLSearchParams(e)&&(e=e+""),De.isString(e))return(await BO(e)).byteLength},CVe=async(e,t)=>{const r=De.toFiniteNumber(e.getContentLength());return r??TVe(t)},AVe=EC&&(async e=>{let{url:t,method:r,data:i,signal:n,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:d}=AZ(e);c=c?(c+"").toLowerCase():"text";let[p,f]=n||s||a?bVe([n,s],a):[],m,g;const v=()=>{!m&&setTimeout(()=>{p&&p.unsubscribe()}),m=!0};let y;try{if(l&&EVe&&r!=="get"&&r!=="head"&&(y=await CVe(u,i))!==0){let _=new Request(t,{method:"POST",body:i,duplex:"half"}),C;De.isFormData(i)&&(C=_.headers.get("content-type"))&&u.setContentType(C),_.body&&(i=vH(_.body,wH,yH(y,AE(l)),null,BO))}De.isString(h)||(h=h?"cors":"omit"),g=new Request(t,{...d,signal:p,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",withCredentials:h});let w=await fetch(g);const b=FO&&(c==="stream"||c==="response");if(FO&&(o||b)){const _={};["status","statusText","headers"].forEach(x=>{_[x]=w[x]});const C=De.toFiniteNumber(w.headers.get("content-length"));w=new Response(vH(w.body,wH,o&&yH(C,AE(o,!0)),b&&v,BO),_)}c=c||"text";let E=await ME[De.findKey(ME,c)||"text"](w,e);return!b&&v(),f&&f(),await new Promise((_,C)=>{TZ(_,C,{data:E,headers:Fo.from(w.headers),status:w.status,statusText:w.statusText,config:e,request:g})})}catch(w){throw v(),w&&w.name==="TypeError"&&/fetch/i.test(w.message)?Object.assign(new Qt("Network Error",Qt.ERR_NETWORK,e,g),{cause:w.cause||w}):Qt.from(w,w&&w.code,e,g)}}),UO={http:Wje,xhr:xVe,fetch:AVe};De.forEach(UO,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const xH=e=>`- ${e}`,MVe=e=>De.isFunction(e)||e===null||e===!1,PZ={getAdapter:e=>{e=De.isArray(e)?e:[e];const{length:t}=e;let r,i;const n={};for(let s=0;s<t;s++){r=e[s];let a;if(i=r,!MVe(r)&&(i=UO[(a=String(r)).toLowerCase()],i===void 0))throw new Qt(`Unknown adapter '${a}'`);if(i)break;n[a||"#"+s]=i}if(!i){const s=Object.entries(n).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=t?s.length>1?`since :
`+s.map(xH).join(`
`):" "+xH(s[0]):"as no adapter specified";throw new Qt("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i},adapters:UO};function jP(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new mv(null,e)}function bH(e){return jP(e),e.headers=Fo.from(e.headers),e.data=UP.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),PZ.getAdapter(e.adapter||sN.adapter)(e).then(function(i){return jP(e),i.data=UP.call(e,e.transformResponse,i),i.headers=Fo.from(i.headers),i},function(i){return EZ(i)||(jP(e),i&&i.response&&(i.response.data=UP.call(e,e.transformResponse,i.response),i.response.headers=Fo.from(i.response.headers))),Promise.reject(i)})}const DZ="1.7.2",aN={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{aN[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const _H={};aN.transitional=function(t,r,i){function n(s,a){return"[Axios v"+DZ+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,o)=>{if(t===!1)throw new Qt(n(a," has been removed"+(r?" in "+r:"")),Qt.ERR_DEPRECATED);return r&&!_H[a]&&(_H[a]=!0,console.warn(n(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,a,o):!0}};function PVe(e,t,r){if(typeof e!="object")throw new Qt("options must be an object",Qt.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let n=i.length;for(;n-- >0;){const s=i[n],a=t[s];if(a){const o=e[s],l=o===void 0||a(o,s,e);if(l!==!0)throw new Qt("option "+s+" must be "+l,Qt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Qt("Unknown option "+s,Qt.ERR_BAD_OPTION)}}const jO={assertOptions:PVe,validators:aN},Uu=jO.validators;class PE{constructor(t){this.defaults=t,this.interceptors={request:new fH,response:new fH}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Rp(this.defaults,r);const{transitional:i,paramsSerializer:n,headers:s}=r;i!==void 0&&jO.assertOptions(i,{silentJSONParsing:Uu.transitional(Uu.boolean),forcedJSONParsing:Uu.transitional(Uu.boolean),clarifyTimeoutError:Uu.transitional(Uu.boolean)},!1),n!=null&&(De.isFunction(n)?r.paramsSerializer={serialize:n}:jO.assertOptions(n,{encode:Uu.function,serialize:Uu.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=s&&De.merge(s.common,s[r.method]);s&&De.forEach(["delete","get","head","post","put","patch","common"],f=>{delete s[f]}),r.headers=Fo.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(l=l&&m.synchronous,o.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,h=0,d;if(!l){const f=[bH.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,c),d=f.length,u=Promise.resolve(r);h<d;)u=u.then(f[h++],f[h++]);return u}d=o.length;let p=r;for(h=0;h<d;){const f=o[h++],m=o[h++];try{p=f(p)}catch(g){m.call(this,g);break}}try{u=bH.call(this,p)}catch(f){return Promise.reject(f)}for(h=0,d=c.length;h<d;)u=u.then(c[h++],c[h++]);return u}getUri(t){t=Rp(this.defaults,t);const r=CZ(t.baseURL,t.url);return bZ(r,t.params,t.paramsSerializer)}}De.forEach(["delete","get","head","options"],function(t){PE.prototype[t]=function(r,i){return this.request(Rp(i||{},{method:t,url:r,data:(i||{}).data}))}});De.forEach(["post","put","patch"],function(t){function r(i){return function(s,a,o){return this.request(Rp(o||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}PE.prototype[t]=r(),PE.prototype[t+"Form"]=r(!0)});const w_=PE;class oN{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const i=this;this.promise.then(n=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](n);i._listeners=null}),this.promise.then=n=>{let s;const a=new Promise(o=>{i.subscribe(o),s=o}).then(n);return a.cancel=function(){i.unsubscribe(s)},a},t(function(s,a,o){i.reason||(i.reason=new mv(s,a,o),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new oN(function(n){t=n}),cancel:t}}}const DVe=oN;function IVe(e){return function(r){return e.apply(null,r)}}function OVe(e){return De.isObject(e)&&e.isAxiosError===!0}const VO={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(VO).forEach(([e,t])=>{VO[t]=e});const RVe=VO;function IZ(e){const t=new w_(e),r=cZ(w_.prototype.request,t);return De.extend(r,w_.prototype,t,{allOwnKeys:!0}),De.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return IZ(Rp(e,n))},r}const Zi=IZ(sN);Zi.Axios=w_;Zi.CanceledError=mv;Zi.CancelToken=DVe;Zi.isCancel=EZ;Zi.VERSION=DZ;Zi.toFormData=_C;Zi.AxiosError=Qt;Zi.Cancel=Zi.CanceledError;Zi.all=function(t){return Promise.all(t)};Zi.spread=IVe;Zi.isAxiosError=OVe;Zi.mergeConfig=Rp;Zi.AxiosHeaders=Fo;Zi.formToJSON=e=>SZ(De.isHTMLForm(e)?new FormData(e):e);Zi.getAdapter=PZ.getAdapter;Zi.HttpStatusCode=RVe;Zi.default=Zi;const kVe=({cartItems:e,totalAmount:t,onCheckout:r,onCancel:i})=>{const[n,s]=te.useState(""),[a,o]=te.useState(""),[l,c]=te.useState(""),[u,h]=te.useState(!1),[d,p]=te.useState(""),[f,m]=te.useState(!1),g=rd();te.useEffect(()=>{const E=Pp.currentUser;E&&c(E.email)},[]),te.useEffect(()=>{if(e.length>0){const E=e[0],_=E.date||E.startDate;_&&p(EO(new Date(_),"MMMM dd, yyyy"))}},[e]);const v=E=>{const _=E.target.checked;h(_),m(_)},y=t*.1;console.log("Deposit Amount:",y);const w=async()=>{const E=t*.1,_=E*100;console.log("Deposit Amount (in pesos):",E),console.log("Deposit Amount (in cents):",_);const C={method:"POST",url:"https://api.paymongo.com/v1/links",headers:{accept:"application/json","content-type":"application/json",authorization:"Basic c2tfdGVzdF9pQVZzTnhDWUdMUDRrYUNZYUtwYVN6bVk6"},data:{data:{attributes:{amount:_,description:"Booking Deposit",remarks:"Refundable deposit of 10%"}}}};try{const x=await Zi.request(C);return console.log("API Response:",x.data),x.data.data.attributes.checkout_url}catch(x){return console.error("Error creating payment link:",x.response?x.response.data:x.message),alert("There was an error creating the payment link. Please try again."),null}},b=async E=>{if(E.preventDefault(),!u){alert("Please accept the terms and conditions to proceed.");return}if(!n.trim()||!a.trim()||!l.trim()||e.length===0||!t||!d.trim()){alert("One or more fields are missing");return}try{const _=new Date(d);if(isNaN(_.getTime())){alert("Invalid selectedDate format");return}const C=await w(),x={name:n.trim()||"",address:a.trim()||"",email:l.trim()||"",cartItems:e.map(T=>({id:T.id||"",name:T.name||"",location:T.location||"",quantity:T.quantity||0,amountToPay:T.amountToPay||0,imageUrl:T.imageUrl||""})),totalAmount:t||0,depositAmount:y||0,selectedDate:Yr.fromDate(_),createdAt:Yr.fromDate(new Date)};Object.keys(x).forEach(T=>{x[T]===void 0&&delete x[T]}),x.cartItems=x.cartItems.map(T=>(Object.keys(T).forEach(M=>{T[M]===void 0&&(T[M]="")}),T));const A=Ql(Jr,"checkout",n);await rNe(A,x),console.log("Checkout successful with ID: ",n),alert("Thank you for booking. Please wait until we process your needs.");for(const T of e){const M=Ql(Jr,"cart",T.id);await aC(M)}C&&(window.location.href=C,g("/"))}catch(_){console.error("Error processing checkout:",_),alert("There was an error processing your checkout. Please try again.")}};return k.jsx("div",{className:"flex items-center justify-center lg:flex-row lg:space-x-8 p-8 ml-16 w-[80%]",children:k.jsxs("div",{className:"lg:w-3/5 bg-white rounded-lg shadow p-6",children:[k.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Booking Checkout"}),k.jsx("div",{className:"mb-4 border rounded-lg overflow-hidden",children:e.map(E=>k.jsxs("div",{className:"flex items-center p-4 border-b",children:[k.jsx("img",{src:E.imageUrl,alt:E.name,className:"w-24 h-24 object-cover mr-4"}),k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-semibold",children:E.name}),k.jsx("p",{className:"text-gray-700",children:E.location}),k.jsxs("p",{className:"text-gray-700",children:["Quantity: ",E.quantity]}),k.jsxs("p",{className:"text-gray-700",children:["Price: ₱",E.amountToPay]})]})]},E.id))}),k.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mt-8",children:[k.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Booking Details"}),k.jsxs("form",{onSubmit:b,children:[k.jsxs("div",{className:"mb-4",children:[k.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Name"}),k.jsx("input",{type:"text",id:"name",value:n,onChange:E=>s(E.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),k.jsxs("div",{className:"mb-4",children:[k.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"address",children:"Address"}),k.jsx("input",{type:"text",id:"address",value:a,onChange:E=>o(E.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),k.jsxs("div",{className:"mb-4",children:[k.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),k.jsx("input",{type:"email",id:"email",value:l,onChange:E=>c(E.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,readOnly:!0})]}),k.jsxs("div",{className:"mb-4",children:[k.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"selected-date",children:"Selected Date"}),k.jsx("input",{type:"text",id:"selected-date",value:d,onChange:E=>p(E.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),k.jsx("div",{className:"mb-4",children:k.jsxs("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"terms",children:[k.jsx("input",{type:"checkbox",id:"terms",checked:u,onChange:v,className:"mr-2 leading-tight",required:!0}),"I accept the terms and conditions and agree to pay a refundable deposit of 10% (₱",(t*.1).toFixed(2),")"]})}),f&&k.jsxs("div",{className:"mb-4 bg-yellow-100 border border-yellow-500 text-yellow-700 px-4 py-3 rounded relative",children:[k.jsx("strong",{className:"font-bold",children:"Note:"}),k.jsx("span",{className:"block sm:inline",children:" A 10% deposit is required to process your booking. The remaining balance will be due upon completion of the booking process."})]}),k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Confirm Booking"}),k.jsx("button",{type:"button",onClick:i,className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Cancel"})]})]})]})]})})},LVe=()=>{const{userID:e}=ov(),[t,r]=te.useState([]);te.useState(0);const[i,n]=te.useState([]),[s,a]=te.useState(!1);te.useEffect(()=>{(async()=>{if(e){console.log("Fetching cart items for userID:",e);const m=OL(hs(Jr,"cart"),vh("userID","==",e));try{const g=await Kl(m);console.log("Number of cart documents:",g.size);const v=g.docs.map(y=>{const w=y.data(),{name:b,description:E,amountToPay:_,imageUrl:C,ageBracket:x,startDate:A,endDate:T,quantity:M,type:D,adultPrice:P,childPrice:I,seniorPrice:B,date:V}=w,N=A instanceof Yr?A.toDate():new Date(A),L=T instanceof Yr?T.toDate():new Date(T),W=V instanceof Yr?V.toDate():new Date(V);return{id:y.id,name:b,description:E,amountToPay:_,imageUrl:C,ageBracket:x,startDate:o(N)?N:null,endDate:o(L)?L:null,date:o(W)?W:null,quantity:M,type:D,adultPrice:P,childPrice:I,seniorPrice:B}});r(v),console.log("Cart Data:",v)}catch(g){console.error("Error fetching cart items:",g)}}})()},[e]);const o=f=>f instanceof Date&&!isNaN(f),l=async f=>{try{if(console.log("Attempting to remove item with ID:",f),!t.find(v=>v.id===f)){console.error("Item not found in cart:",f);return}const g=Ql(Jr,"cart",f);await aC(g),console.log(`Removed item from cart with ID: ${f}`),r(v=>v.filter(y=>y.id!==f)),n(v=>v.filter(y=>y!==f)),console.log("Item successfully removed and state updated")}catch(m){console.error("Error removing item from cart:",m)}},c=async(f,m)=>{try{const g=Ql(Jr,"cart",f);if(!t.find(y=>y.id===f)){console.error("Item not found in cart:",f);return}await kL(g,{quantity:m}),r(y=>y.map(w=>w.id===f?{...w,quantity:m}:w))}catch(g){console.error("Error updating quantity:",g)}},u=f=>{n(m=>m.includes(f)?m.filter(g=>g!==f):[...m,f])},h=()=>{i.length>0?a(!0):alert("Please select at least one item to proceed to checkout.")},d=async f=>{try{await ip(hs(Jr,"checkout"),f),console.log("Checkout successful");const m=t.map(g=>({...g,quantity:0}));r(m),n([]),a(!1)}catch(m){console.error("Error during checkout:",m)}},p=()=>i.reduce((f,m)=>{const g=t.find(v=>v.id===m);return f+(g?g.amountToPay*g.quantity:0)},0);return k.jsxs(k.Fragment,{children:[k.jsx(gK,{}),k.jsx("div",{className:"container mx-auto mt-28 px-4",children:s?k.jsx(kVe,{cartItems:t.filter(f=>i.includes(f.id)),totalAmount:p(),onCheckout:d,onCancel:()=>a(!1)}):k.jsx(k.Fragment,{children:t.length===0?k.jsx("p",{children:"Your cart is empty"}):k.jsxs("div",{className:"w-full",children:[k.jsxs("div",{className:"bg-white shadow rounded p-4 mb-4",children:[k.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your Cart"}),k.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between mb-4",children:[k.jsxs("div",{className:"flex items-center",children:[k.jsx("input",{type:"checkbox",className:"mr-2",checked:i.length===t.length,onChange:()=>{i.length===t.length?n([]):n(t.map(f=>f.id))}}),k.jsx("p",{className:"text-gray-700",children:"Select All"})]}),k.jsxs("p",{className:"text-xl font-semibold",children:["Subtotal: ₱",p().toFixed(2)]})]}),t.map(f=>k.jsxs("div",{className:"flex items-center justify-between border-t border-b py-4",children:[k.jsxs("div",{className:"flex items-center",children:[k.jsx("input",{type:"checkbox",className:"mr-2",checked:i.includes(f.id),onChange:()=>u(f.id)}),k.jsx("img",{src:f.imageUrl,alt:f.name,className:"w-16 h-16 object-cover mr-4"}),k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold",children:f.name}),k.jsxs("p",{className:"text-gray-700",children:["Price: ₱",f.amountToPay]}),f.startDate&&o(f.startDate)&&k.jsxs("p",{className:"text-gray-700",children:["Start Date: ",f.startDate.toLocaleDateString()]}),f.endDate&&o(f.endDate)&&k.jsxs("p",{className:"text-gray-700",children:["End Date: ",f.endDate.toLocaleDateString()]}),f.date&&o(f.date)&&k.jsxs("p",{className:"text-gray-700",children:["Date: ",f.date.toLocaleDateString()]})]})]}),k.jsxs("div",{className:"flex items-center",children:[k.jsx("label",{htmlFor:`quantity-${f.id}`,className:"text-gray-700 mr-2",children:"Qty:"}),k.jsx("input",{type:"number",id:`quantity-${f.id}`,value:f.quantity,onChange:m=>c(f.id,parseInt(m.target.value)),min:"1",className:"w-12 border border-gray-300 rounded-md py-1 px-2 mr-4"}),k.jsx("button",{onClick:()=>l(f.id),className:"text-red-500",children:"Remove"})]})]},f.id))]}),k.jsx("div",{className:"flex justify-end",children:k.jsx("button",{onClick:h,className:"bg-orange-500 text-white font-bold py-2 px-4 rounded",children:"Proceed to Checkout"})})]})})})]})},NVe=()=>{const e=hs(Jr,"cart"),{userID:t}=ov(),r=n=>{if(n instanceof Date||(n=new Date(n)),isNaN(n))throw new Error("Invalid date value");const s={year:"numeric",month:"short",day:"2-digit"};return n.toLocaleDateString("en-US",s)};return{addTransaction:async({name:n,description:s,imageUrl:a,category:o,price:l,amountToPay:c,date:u,quantity:h})=>{try{const d=r(u),p=OL(e,vh("userID","==",t),vh("name","==",n),vh("category","==",o),vh("date","==",d));return(await Kl(p)).empty?(await ip(e,{userID:t,name:n,description:s,imageUrl:a,category:o,price:l,amountToPay:c,date:d,quantity:h,createdAt:GQ()}),{success:!0,message:"Transaction added successfully."}):{success:!1,message:"Already added to cart."}}catch(d){return console.error("Error adding transaction:",d),{success:!1,message:"Error adding transaction."}}}}};function zVe({item:e,onClose:t}){const r=rd(),{addTransaction:i}=NVe(),{user:n}=oZ(),[s,a]=te.useState("adult"),[o,l]=te.useState(0),[c,u]=te.useState(!1),[h,d]=te.useState(0),[p,f]=te.useState(""),[m,g]=te.useState(""),v=5;te.useEffect(()=>{y()},[]),te.useEffect(()=>{w()},[s,o,e.price,p]);const y=async()=>{const T=Ql(Jr,"items",e.id),M=await tNe(T);if(M.exists()){const D=M.data();g(D.goodforstocks)}else console.log("No such document!")},w=()=>{let M=e.price*o;if(M===0||o===0)d(0);else{if(s!=="adult"){const D=M*v/100;M-=D}d(M)}},b=async(T,M,D)=>{const P=hs(Jr,"cart"),I=new Date(M).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"}),B=OL(P,vh("name","==",T),vh("date","==",I),vh("category","==",D));return!(await Kl(B)).empty},E=async(T,M,D)=>{try{if(!n){u(!0);return}let P=h;if(isNaN(P)||P<=0)throw new Error("Invalid amount to pay");if(!p)throw new Error("Please select a date");const I=new Date(p);if(await b(T,p,s)){alert("Record already exists");return}const V=await i({name:T,description:"Added to cart",imageUrl:M,category:s,price:D,amountToPay:P,date:I,quantity:o});V.success?(alert(`Added ${T} to cart`),t()):alert(V.message)}catch(P){alert(P.message)}},_=async()=>{try{const T=await HT(Pp,cC),M={userID:T.user.uid,name:T.user.displayName,profilePhoto:T.user.photoURL,isAuth:!0};localStorage.setItem("auth",JSON.stringify(M)),r("/"),window.location.reload()}catch(T){console.log(T)}},C=async()=>{u(!1),await _()},x=()=>{u(!1)},A=T=>{const M=Number(T.target.value);l(M)};return k.jsxs("div",{className:"fixed inset-0 flex items-center justify-center overflow-y-auto bg-black bg-opacity-50 z-50",children:[k.jsx("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl max-w-full w-full sm:max-w-lg sm:w-full h-full max-h-[80%] z-50",children:k.jsxs("div",{className:"p-4 flex flex-col h-full",children:[k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Package Confirmation"}),k.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:k.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:k.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),k.jsxs("div",{className:"overflow-auto mt-4 flex flex-col sm:flex-row",children:[k.jsx("div",{className:"sm:w-1/2 flex justify-center sm:items-center",children:k.jsx("img",{src:e.imageUrl,alt:e.name,className:"w-full sm:w-40 h-auto object-cover rounded-md"})}),k.jsxs("div",{className:"sm:w-1/2 sm:pl-4 flex flex-col sm:justify-center",children:[k.jsx("label",{htmlFor:"name",className:"text-sm text-gray-500",children:e.name}),k.jsxs("div",{className:"mt-4",children:[k.jsx("label",{className:"text-sm text-gray-500",children:"Age Bracket:"}),k.jsxs("select",{className:"block w-full mt-1 p-2 border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:s,onChange:T=>a(T.target.value),children:[k.jsx("option",{value:"adult",children:"Adult"}),k.jsx("option",{value:"child",children:"Child"}),k.jsx("option",{value:"senior",children:"Senior"})]})]}),k.jsx("div",{className:"mt-4",children:k.jsxs("label",{htmlFor:"description",className:"text-sm text-gray-500",children:["Description: ",e.description]})}),k.jsx("div",{className:"mt-4",children:k.jsxs("label",{htmlFor:"goodForStocks",className:"text-sm text-gray-500",children:["Good for Stocks: ",m]})}),k.jsxs("div",{className:"mt-4",children:[k.jsx("label",{htmlFor:"quantity",className:"text-sm text-gray-500",children:"Quantity:"}),k.jsx("input",{type:"number",min:"0",value:o,onChange:A,className:"border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring focus:ring-blue-500"})]}),k.jsxs("div",{className:"mt-4",children:[k.jsx("label",{htmlFor:"date",className:"text-sm text-gray-500",children:"Select Date:"}),k.jsxs("select",{className:"block w-full mt-1 p-2 border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:p,onChange:T=>f(T.target.value),children:[k.jsx("option",{value:"",children:"Select available date"}),e.datesAvailable.map(T=>k.jsx("option",{value:T,children:new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"})},T))]})]}),k.jsxs("div",{className:"flex items-center mt-4",children:[k.jsx("label",{htmlFor:"totalAmountToPay",className:"text-sm text-gray-500",children:"Total Amount to Pay:"}),k.jsxs("span",{className:"ml-2 text-lg font-semibold text-gray-800",children:["₱",h.toFixed(2)]})]})]})]}),k.jsx("div",{className:"mt-auto bg-gray-100 px-4 py-3 flex justify-end",children:k.jsx("button",{onClick:()=>E(e.name,e.imageUrl,e.price),className:"w-full py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add to Cart"})})]})}),c&&k.jsx(aZ,{message:"Please sign in to add items to the cart.",onConfirm:C,onCancel:x})]})}const BVe=()=>{const[e,t]=te.useState([]),[r,i]=te.useState(null),[n,s]=te.useState(!1);te.useEffect(()=>{a(),s3.init()},[]);const a=async()=>{try{const u=(await Kl(hs(Jr,"Package"))).docs.map(h=>({id:h.id,...h.data()}));t(u)}catch(c){console.error("Error fetching items:",c)}},o=c=>{i(c),s(!0)},l=()=>{i(null),s(!1)};return k.jsxs("div",{className:"container mx-auto p-4 bg-white mb-10 mt-9",children:[k.jsx("h1",{className:"text-3xl font-bold mb-6 text-center text-[#008080]",children:"Packages"}),k.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map(c=>k.jsx("div",{className:"border border-gray-300 rounded-md p-4 bg-white shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-1 cursor-pointer",onClick:()=>o(c),"data-aos":"fade-up","data-aos-delay":"100",children:k.jsxs("div",{className:"relative",children:[k.jsx("img",{src:c.imageUrl,alt:c.name,className:"mb-4 rounded-md object-cover w-full h-[200px]"}),k.jsxs("div",{className:"space-y-2 text-center",children:[k.jsx("p",{className:"text-lg font-semibold text-gray-800",children:c.name}),k.jsxs("p",{className:"text-lg font-semibold text-green-600",children:["₱",c.price]}),k.jsx("p",{className:"text-sm text-gray-500",children:c.description})]})]})},c.id))}),n&&k.jsx(zVe,{item:r,onClose:l})]})},FVe=()=>{const{name:e,profilePhoto:t}=ov();return k.jsxs("div",{className:"flex flex-col items-center h-96 mt-20",children:[k.jsx("h2",{children:e}),k.jsx("img",{src:t,alt:"",className:"h-10 w-10 object-cover rounded-full"}),k.jsx(n3,{to:"/Transactionhistory",children:k.jsx("button",{className:"flex p-4 mt-3 rounded-md bg-slate-500 h-9 items-center justify-center font-bold",children:"Transaction Record"})})]})},UVe=()=>{const[e,t]=te.useState(""),[r,i]=te.useState(""),[n,s]=te.useState(""),[a,o]=te.useState(""),[l,c]=te.useState(""),[u,h]=te.useState(""),[d,p]=te.useState(null),[f,m]=te.useState([]),[g,v]=te.useState(null),[y,w]=te.useState(""),[b,E]=te.useState(""),[_,C]=te.useState(""),[x,A]=te.useState(""),[T,M]=te.useState(""),[D,P]=te.useState(""),[I,B]=te.useState([""]),[V,N]=te.useState(""),[L,W]=te.useState([]),[G,X]=te.useState([]),[Q,ie]=te.useState([]),[J,se]=te.useState([]),[ee,ue]=te.useState(""),[oe,le]=te.useState("");te.useEffect(()=>{q(),de()},[]);const de=async()=>{try{const he=await Kl(hs(Jr,"Categories")),Ee=[];he.forEach(me=>{Ee.push(me.data().name)}),se(Ee)}catch(he){console.error("Error fetching categories:",he)}},xe=he=>{v(he.id),w(he.name),E(he.adultPrice.toString()),C(he.seniorPrice.toString()),A(he.childPrice.toString()),M(he.category),P(he.description),B(he.inputs||[""]),W(he.addOns||[]),ie(he.highlights||[])},_e=(he,Ee)=>{const me=[...I];me[he]=Ee,B(me)},Se=()=>{B([...I,""])},Le=he=>{const Ee=[...I];Ee.splice(he,1),B(Ee)},Oe=(he,Ee)=>{const me=[...G];me[he]=Ee,X(me)},Ye=()=>{X([...G,""])},$e=he=>{const Ee=[...G];Ee.splice(he,1),X(Ee)},He=(he,Ee)=>{const me=[...Q];me[he]=Ee,ie(me)},je=()=>{ie([...Q,""])},lt=he=>{const Ee=[...Q];Ee.splice(he,1),ie(Ee)},pe=async()=>{try{const he={name:y,adultPrice:parseFloat(b),seniorPrice:parseFloat(_),childPrice:parseFloat(x),category:T,description:D,inputs:I,addOns:L,highlights:Q};oe&&(he.category=oe,await ip(hs(Jr,"Categories"),{name:oe}),de()),await kL(Ql(Jr,"Product",g),he),console.log("Item updated successfully"),v(null),w(""),E(""),C(""),A(""),M(""),P(""),ie([]),W([]),q()}catch(he){console.error("Error updating item:",he)}},q=async()=>{try{const he=await Kl(hs(Jr,"Product")),Ee=[];he.forEach(me=>{Ee.push({id:me.id,...me.data()})}),m(Ee)}catch(he){console.error("Error fetching items:",he)}},j=he=>{const Ee=he.target.files[0];p(Ee)},ve=async he=>{try{const Ee=fK(mK,"images/"+he.name),me=await dK(Ee,he);return await pK(me.ref)}catch(Ee){throw console.error("Error uploading image:",Ee),Ee}},ze=async()=>{try{if(!e||!r||!n||!a||!u||!d){alert("Please fill out all required fields");return}let he="";ee?he=ee:l&&(he=l);const Ee=await ve(d),me={name:e,adultPrice:parseFloat(r),seniorPrice:parseFloat(n),childPrice:parseFloat(a),category:he,description:u,imageUrl:Ee,inputs:I,addOns:L,highlights:G};await ip(hs(Jr,"Product"),me),console.log("Item added successfully to the database"),ee&&(await ip(hs(Jr,"Categories"),{name:ee}),de()),t(""),i(""),s(""),o(""),c(""),h("");const Je=document.getElementById("file-input");Je&&(Je.value=""),B([""]),W([]),X([]),ue(""),q()}catch(he){console.error("Error adding item:",he)}},U=async he=>{try{await aC(Ql(Jr,"Product",he)),console.log("Item deleted successfully"),q()}catch(Ee){console.error("Error deleting item:",Ee)}},Fe=V?f.filter(he=>he.category===V):f;return k.jsxs("div",{className:"container bg-white mx-auto mt-10 p-6 border rounded-lg shadow-lg h-[900px] overflow-y-scroll",children:[k.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Admin Panel"}),k.jsxs("div",{className:"flex space-x-6",children:[k.jsxs("div",{className:"w-1/2",children:[k.jsxs("div",{className:"mb-6",children:[k.jsx("input",{type:"file",id:"file-input",onChange:j,className:"border border-gray-300 rounded-md py-2 px-4 w-full"}),d&&k.jsx("img",{src:d,alt:"Item",className:"mt-4 w-32 h-32 object-cover"})]}),k.jsx("div",{className:"mb-6",children:k.jsx("input",{type:"text",placeholder:"Item Name",value:e,onChange:he=>t(he.target.value),className:"border border-gray-300 rounded-md py-2 px-4 w-full"})}),k.jsx("div",{className:"mb-6",children:k.jsx("textarea",{placeholder:"Item Description",value:u,onChange:he=>h(he.target.value),className:"border border-gray-300 rounded-md py-2 px-4 w-full"})}),k.jsxs("div",{className:"mb-6",children:[k.jsxs("select",{value:l,onChange:he=>{c(he.target.value),ue("")},className:"border border-gray-300 rounded-md py-2 px-4 w-full mb-2",disabled:ee!=="",children:[k.jsx("option",{value:"",children:"Select Category"}),J.map((he,Ee)=>k.jsx("option",{value:he,children:he},Ee))]}),k.jsx("input",{type:"text",placeholder:"New Category",value:ee,onChange:he=>{ue(he.target.value),c("")},className:"border border-gray-300 rounded-md py-2 px-4 w-full",disabled:l!==""})]}),k.jsxs("div",{className:"mb-6",children:[k.jsx("input",{type:"text",placeholder:"Adult Price",value:r,onChange:he=>i(he.target.value),className:"border border-gray-300 rounded-md py-2 px-4 w-full mb-2"}),k.jsx("input",{type:"text",placeholder:"Senior Price",value:n,onChange:he=>s(he.target.value),className:"border border-gray-300 rounded-md py-2 px-4 w-full mb-2"}),k.jsx("input",{type:"text",placeholder:"Child Price",value:a,onChange:he=>o(he.target.value),className:"border border-gray-300 rounded-md py-2 px-4 w-full"})]})]}),k.jsx("div",{className:"w-1/2 space-y-6",children:k.jsxs("div",{children:[k.jsx("h3",{className:"font-bold mb-2",children:"Highlights"}),G.map((he,Ee)=>k.jsxs("div",{className:"flex mb-2",children:[k.jsx("input",{type:"text",placeholder:`Highlight ${Ee+1}`,value:he,onChange:me=>Oe(Ee,me.target.value),className:"border border-gray-300 rounded-md py-2 px-4 mr-2 flex-1"}),k.jsx("button",{onClick:()=>$e(Ee),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Remove"})]},Ee)),k.jsx("button",{onClick:Ye,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"+ Add Highlight"})]})})]}),k.jsx("div",{className:"flex justify-end mt-6",children:k.jsx("button",{onClick:ze,className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Add Item"})}),k.jsxs("div",{className:"mt-10",children:[k.jsx("h2",{className:"text-xl font-bold mb-2",children:"Edit Items"}),k.jsxs("select",{value:V,onChange:he=>N(he.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2",children:[k.jsx("option",{value:"",children:"All Categories"}),J.map((he,Ee)=>k.jsx("option",{value:he,children:he},Ee))]}),Fe.map(he=>k.jsx("div",{className:"border border-gray-300 rounded-md py-2 px-4 mb-2",children:g===he.id?k.jsxs("div",{children:[k.jsx("input",{type:"text",placeholder:"Item Name",value:y,onChange:Ee=>w(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("input",{type:"text",placeholder:"Adult Price",value:b,onChange:Ee=>E(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("input",{type:"text",placeholder:"Senior Price",value:_,onChange:Ee=>C(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("input",{type:"text",placeholder:"Child Price",value:x,onChange:Ee=>A(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsxs("select",{value:T,onChange:Ee=>M(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2",children:[k.jsx("option",{value:"",children:"Select Category"}),J.map((Ee,me)=>k.jsx("option",{value:Ee,children:Ee},me))]}),k.jsx("input",{type:"text",placeholder:"New Category",value:oe,onChange:Ee=>le(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("textarea",{placeholder:"Item Description",value:D,onChange:Ee=>P(Ee.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("button",{onClick:pe,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Save"}),k.jsx("button",{onClick:()=>v(null),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"}),Q.map((Ee,me)=>k.jsxs("div",{children:[k.jsx("input",{type:"text",placeholder:`Highlight ${me+1}`,value:Ee,onChange:Je=>He(me,Je.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("button",{onClick:()=>lt(me),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"Remove"})]},me)),k.jsx("button",{onClick:je,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"+ Add Highlight"}),I.map((Ee,me)=>k.jsxs("div",{children:[k.jsx("input",{type:"text",placeholder:`Input Field ${me+1}`,value:Ee,onChange:Je=>_e(me,Je.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mb-2"}),k.jsx("button",{onClick:()=>Le(me),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded",children:"Remove"})]},me)),k.jsx("button",{onClick:Se,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"+ Add Input Field"})]}):k.jsxs("div",{className:"border border-gray-200 rounded-md p-4 shadow-md flex flex-col md:flex-row",children:[k.jsxs("div",{className:"md:w-1/2 md:pr-4",children:[he.imageUrl&&k.jsx("img",{src:he.imageUrl,alt:"Uploaded",className:"w-full h-auto object-cover rounded-md mb-4"}),k.jsxs("p",{className:"font-semibold",children:["Name: ",he.name]}),k.jsxs("p",{children:["Description: ",he.description]}),k.jsxs("p",{children:["Category: ",he.category]}),k.jsxs("p",{children:["Adult Price: ",he.adultPrice]}),k.jsxs("p",{children:["Senior Price: ",he.seniorPrice]}),k.jsxs("p",{children:["Child Price: ",he.childPrice]})]}),k.jsxs("div",{className:"md:w-1/2 md:pl-4",children:[k.jsxs("div",{className:"mb-4",children:[k.jsx("p",{className:"font-semibold",children:"Highlights:"}),he.highlights&&he.highlights.map((Ee,me)=>k.jsx("p",{children:Ee},me))]}),k.jsxs("div",{className:"mt-auto flex justify-end",children:[k.jsx("button",{onClick:()=>xe(he),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2",children:"Edit"}),k.jsx("button",{onClick:()=>U(he.id),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Delete"})]})]})]})},he.id))]})]})};var OZ={},RZ={},TC={},kZ={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={animating:!1,autoplaying:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,dragging:!1,edgeDragged:!1,initialized:!1,lazyLoadedList:[],listHeight:null,listWidth:null,scrolling:!1,slideCount:null,slideHeight:null,slideWidth:null,swipeLeft:null,swiped:!1,swiping:!1,touchObject:{startX:0,startY:0,curX:0,curY:0},trackStyle:{},trackWidth:0,targetSlide:0};e.default=t})(kZ);var LZ={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=n(s,i(o)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return r.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)t.call(s,o)&&s[o]&&(a=n(a,o));return a}function n(s,a){return a?s?s+" "+a:s+a:s}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})(LZ);var CC=LZ.exports,tt={},lN={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(te);function r(n){return n&&n.__esModule?n:{default:n}}var i={accessibility:!0,adaptiveHeight:!1,afterChange:null,appendDots:function(s){return t.default.createElement("ul",{style:{display:"block"}},s)},arrows:!0,autoplay:!1,autoplaySpeed:3e3,beforeChange:null,centerMode:!1,centerPadding:"50px",className:"",cssEase:"ease",customPaging:function(s){return t.default.createElement("button",null,s+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:null,nextArrow:null,onEdge:null,onInit:null,onLazyLoadError:null,onReInit:null,pauseOnDotsHover:!1,pauseOnFocus:!1,pauseOnHover:!0,prevArrow:null,responsive:null,rows:1,rtl:!1,slide:"div",slidesPerRow:1,slidesToScroll:1,slidesToShow:1,speed:500,swipe:!0,swipeEvent:null,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0,asNavFor:null};e.default=i})(lN);Object.defineProperty(tt,"__esModule",{value:!0});tt.checkSpecKeys=tt.checkNavigable=tt.changeSlide=tt.canUseDOM=tt.canGoNext=void 0;tt.clamp=zZ;tt.extractObject=void 0;tt.filterSettings=t5e;tt.validSettings=tt.swipeStart=tt.swipeMove=tt.swipeEnd=tt.slidesOnRight=tt.slidesOnLeft=tt.slideHandler=tt.siblingDirection=tt.safePreventDefault=tt.lazyStartIndex=tt.lazySlidesOnRight=tt.lazySlidesOnLeft=tt.lazyEndIndex=tt.keyHandler=tt.initializedState=tt.getWidth=tt.getTrackLeft=tt.getTrackCSS=tt.getTrackAnimateCSS=tt.getTotalSlides=tt.getSwipeDirection=tt.getSlideCount=tt.getRequiredLazySlides=tt.getPreClones=tt.getPostClones=tt.getOnDemandLazySlides=tt.getNavigableIndexes=tt.getHeight=void 0;var jVe=NZ(te),VVe=NZ(lN);function NZ(e){return e&&e.__esModule?e:{default:e}}function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function SH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SH(Object(r),!0).forEach(function(i){HVe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function HVe(e,t,r){return t=WVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WVe(e){var t=GVe(e,"string");return ww(t)=="symbol"?t:String(t)}function GVe(e,t){if(ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(ww(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zZ(e,t,r){return Math.max(t,Math.min(e,r))}var $m=tt.safePreventDefault=function(t){var r=["onTouchStart","onTouchMove","onWheel"];r.includes(t._reactName)||t.preventDefault()},BZ=tt.getOnDemandLazySlides=function(t){for(var r=[],i=FZ(t),n=UZ(t),s=i;s<n;s++)t.lazyLoadedList.indexOf(s)<0&&r.push(s);return r};tt.getRequiredLazySlides=function(t){for(var r=[],i=FZ(t),n=UZ(t),s=i;s<n;s++)r.push(s);return r};var FZ=tt.lazyStartIndex=function(t){return t.currentSlide-qVe(t)},UZ=tt.lazyEndIndex=function(t){return t.currentSlide+YVe(t)},qVe=tt.lazySlidesOnLeft=function(t){return t.centerMode?Math.floor(t.slidesToShow/2)+(parseInt(t.centerPadding)>0?1:0):0},YVe=tt.lazySlidesOnRight=function(t){return t.centerMode?Math.floor((t.slidesToShow-1)/2)+1+(parseInt(t.centerPadding)>0?1:0):t.slidesToShow},HO=tt.getWidth=function(t){return t&&t.offsetWidth||0},jZ=tt.getHeight=function(t){return t&&t.offsetHeight||0},VZ=tt.getSwipeDirection=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i,n,s,a;return i=t.startX-t.curX,n=t.startY-t.curY,s=Math.atan2(n,i),a=Math.round(s*180/Math.PI),a<0&&(a=360-Math.abs(a)),a<=45&&a>=0||a<=360&&a>=315?"left":a>=135&&a<=225?"right":r===!0?a>=35&&a<=135?"up":"down":"vertical"},HZ=tt.canGoNext=function(t){var r=!0;return t.infinite||(t.centerMode&&t.currentSlide>=t.slideCount-1||t.slideCount<=t.slidesToShow||t.currentSlide>=t.slideCount-t.slidesToShow)&&(r=!1),r};tt.extractObject=function(t,r){var i={};return r.forEach(function(n){return i[n]=t[n]}),i};tt.initializedState=function(t){var r=jVe.default.Children.count(t.children),i=t.listRef,n=Math.ceil(HO(i)),s=t.trackRef&&t.trackRef.node,a=Math.ceil(HO(s)),o;if(t.vertical)o=n;else{var l=t.centerMode&&parseInt(t.centerPadding)*2;typeof t.centerPadding=="string"&&t.centerPadding.slice(-1)==="%"&&(l*=n/100),o=Math.ceil((n-l)/t.slidesToShow)}var c=i&&jZ(i.querySelector('[data-index="0"]')),u=c*t.slidesToShow,h=t.currentSlide===void 0?t.initialSlide:t.currentSlide;t.rtl&&t.currentSlide===void 0&&(h=r-1-t.initialSlide);var d=t.lazyLoadedList||[],p=BZ(ai(ai({},t),{},{currentSlide:h,lazyLoadedList:d}));d=d.concat(p);var f={slideCount:r,slideWidth:o,listWidth:n,trackWidth:a,currentSlide:h,slideHeight:c,listHeight:u,lazyLoadedList:d};return t.autoplaying===null&&t.autoplay&&(f.autoplaying="playing"),f};tt.slideHandler=function(t){var r=t.waitForAnimate,i=t.animating,n=t.fade,s=t.infinite,a=t.index,o=t.slideCount,l=t.lazyLoad,c=t.currentSlide,u=t.centerMode,h=t.slidesToScroll,d=t.slidesToShow,p=t.useCSS,f=t.lazyLoadedList;if(r&&i)return{};var m=a,g,v,y,w={},b={},E=s?a:zZ(a,0,o-1);if(n){if(!s&&(a<0||a>=o))return{};a<0?m=a+o:a>=o&&(m=a-o),l&&f.indexOf(m)<0&&(f=f.concat(m)),w={animating:!0,currentSlide:m,lazyLoadedList:f,targetSlide:m},b={animating:!1,targetSlide:m}}else g=m,m<0?(g=m+o,s?o%h!==0&&(g=o-o%h):g=0):!HZ(t)&&m>c?m=g=c:u&&m>=o?(m=s?o:o-1,g=s?0:o-1):m>=o&&(g=m-o,s?o%h!==0&&(g=0):g=o-d),!s&&m+d>=o&&(g=o-d),v=IE(ai(ai({},t),{},{slideIndex:m})),y=IE(ai(ai({},t),{},{slideIndex:g})),s||(v===y&&(m=g),v=y),l&&(f=f.concat(BZ(ai(ai({},t),{},{currentSlide:m})))),p?(w={animating:!0,currentSlide:g,trackStyle:WZ(ai(ai({},t),{},{left:v})),lazyLoadedList:f,targetSlide:E},b={animating:!1,currentSlide:g,trackStyle:DE(ai(ai({},t),{},{left:y})),swipeLeft:null,targetSlide:E}):w={currentSlide:g,trackStyle:DE(ai(ai({},t),{},{left:y})),lazyLoadedList:f,targetSlide:E};return{state:w,nextState:b}};tt.changeSlide=function(t,r){var i,n,s,a,o,l=t.slidesToScroll,c=t.slidesToShow,u=t.slideCount,h=t.currentSlide,d=t.targetSlide,p=t.lazyLoad,f=t.infinite;if(a=u%l!==0,i=a?0:(u-h)%l,r.message==="previous")s=i===0?l:c-i,o=h-s,p&&!f&&(n=h-s,o=n===-1?u-1:n),f||(o=d-l);else if(r.message==="next")s=i===0?l:i,o=h+s,p&&!f&&(o=(h+l)%u+i),f||(o=d+l);else if(r.message==="dots")o=r.index*r.slidesToScroll;else if(r.message==="children"){if(o=r.index,f){var m=KVe(ai(ai({},t),{},{targetSlide:o}));o>r.currentSlide&&m==="left"?o=o-u:o<r.currentSlide&&m==="right"&&(o=o+u)}}else r.message==="index"&&(o=Number(r.index));return o};tt.keyHandler=function(t,r,i){return t.target.tagName.match("TEXTAREA|INPUT|SELECT")||!r?"":t.keyCode===37?i?"next":"previous":t.keyCode===39?i?"previous":"next":""};tt.swipeStart=function(t,r,i){return t.target.tagName==="IMG"&&$m(t),!r||!i&&t.type.indexOf("mouse")!==-1?"":{dragging:!0,touchObject:{startX:t.touches?t.touches[0].pageX:t.clientX,startY:t.touches?t.touches[0].pageY:t.clientY,curX:t.touches?t.touches[0].pageX:t.clientX,curY:t.touches?t.touches[0].pageY:t.clientY}}};tt.swipeMove=function(t,r){var i=r.scrolling,n=r.animating,s=r.vertical,a=r.swipeToSlide,o=r.verticalSwiping,l=r.rtl,c=r.currentSlide,u=r.edgeFriction,h=r.edgeDragged,d=r.onEdge,p=r.swiped,f=r.swiping,m=r.slideCount,g=r.slidesToScroll,v=r.infinite,y=r.touchObject,w=r.swipeEvent,b=r.listHeight,E=r.listWidth;if(!i){if(n)return $m(t);s&&a&&o&&$m(t);var _,C={},x=IE(r);y.curX=t.touches?t.touches[0].pageX:t.clientX,y.curY=t.touches?t.touches[0].pageY:t.clientY,y.swipeLength=Math.round(Math.sqrt(Math.pow(y.curX-y.startX,2)));var A=Math.round(Math.sqrt(Math.pow(y.curY-y.startY,2)));if(!o&&!f&&A>10)return{scrolling:!0};o&&(y.swipeLength=A);var T=(l?-1:1)*(y.curX>y.startX?1:-1);o&&(T=y.curY>y.startY?1:-1);var M=Math.ceil(m/g),D=VZ(r.touchObject,o),P=y.swipeLength;return v||(c===0&&(D==="right"||D==="down")||c+1>=M&&(D==="left"||D==="up")||!HZ(r)&&(D==="left"||D==="up"))&&(P=y.swipeLength*u,h===!1&&d&&(d(D),C.edgeDragged=!0)),!p&&w&&(w(D),C.swiped=!0),s?_=x+P*(b/E)*T:l?_=x-P*T:_=x+P*T,o&&(_=x+P*T),C=ai(ai({},C),{},{touchObject:y,swipeLeft:_,trackStyle:DE(ai(ai({},r),{},{left:_}))}),Math.abs(y.curX-y.startX)<Math.abs(y.curY-y.startY)*.8||y.swipeLength>10&&(C.swiping=!0,$m(t)),C}};tt.swipeEnd=function(t,r){var i=r.dragging,n=r.swipe,s=r.touchObject,a=r.listWidth,o=r.touchThreshold,l=r.verticalSwiping,c=r.listHeight,u=r.swipeToSlide,h=r.scrolling,d=r.onSwipe,p=r.targetSlide,f=r.currentSlide,m=r.infinite;if(!i)return n&&$m(t),{};var g=l?c/o:a/o,v=VZ(s,l),y={dragging:!1,edgeDragged:!1,scrolling:!1,swiping:!1,swiped:!1,swipeLeft:null,touchObject:{}};if(h||!s.swipeLength)return y;if(s.swipeLength>g){$m(t),d&&d(v);var w,b,E=m?f:p;switch(v){case"left":case"up":b=E+TH(r),w=u?EH(r,b):b,y.currentDirection=0;break;case"right":case"down":b=E-TH(r),w=u?EH(r,b):b,y.currentDirection=1;break;default:w=E}y.triggerSlideHandler=w}else{var _=IE(r);y.trackStyle=WZ(ai(ai({},r),{},{left:_}))}return y};var XVe=tt.getNavigableIndexes=function(t){for(var r=t.infinite?t.slideCount*2:t.slideCount,i=t.infinite?t.slidesToShow*-1:0,n=t.infinite?t.slidesToShow*-1:0,s=[];i<r;)s.push(i),i=n+t.slidesToScroll,n+=Math.min(t.slidesToScroll,t.slidesToShow);return s},EH=tt.checkNavigable=function(t,r){var i=XVe(t),n=0;if(r>i[i.length-1])r=i[i.length-1];else for(var s in i){if(r<i[s]){r=n;break}n=i[s]}return r},TH=tt.getSlideCount=function(t){var r=t.centerMode?t.slideWidth*Math.floor(t.slidesToShow/2):0;if(t.swipeToSlide){var i,n=t.listRef,s=n.querySelectorAll&&n.querySelectorAll(".slick-slide")||[];if(Array.from(s).every(function(l){if(t.vertical){if(l.offsetTop+jZ(l)/2>t.swipeLeft*-1)return i=l,!1}else if(l.offsetLeft-r+HO(l)/2>t.swipeLeft*-1)return i=l,!1;return!0}),!i)return 0;var a=t.rtl===!0?t.slideCount-t.currentSlide:t.currentSlide,o=Math.abs(i.dataset.index-a)||1;return o}else return t.slidesToScroll},cN=tt.checkSpecKeys=function(t,r){return r.reduce(function(i,n){return i&&t.hasOwnProperty(n)},!0)?null:console.error("Keys Missing:",t)},DE=tt.getTrackCSS=function(t){cN(t,["left","variableWidth","slideCount","slidesToShow","slideWidth"]);var r,i,n=t.slideCount+2*t.slidesToShow;t.vertical?i=n*t.slideHeight:r=QVe(t)*t.slideWidth;var s={opacity:1,transition:"",WebkitTransition:""};if(t.useTransform){var a=t.vertical?"translate3d(0px, "+t.left+"px, 0px)":"translate3d("+t.left+"px, 0px, 0px)",o=t.vertical?"translate3d(0px, "+t.left+"px, 0px)":"translate3d("+t.left+"px, 0px, 0px)",l=t.vertical?"translateY("+t.left+"px)":"translateX("+t.left+"px)";s=ai(ai({},s),{},{WebkitTransform:a,transform:o,msTransform:l})}else t.vertical?s.top=t.left:s.left=t.left;return t.fade&&(s={opacity:1}),r&&(s.width=r),i&&(s.height=i),window&&!window.addEventListener&&window.attachEvent&&(t.vertical?s.marginTop=t.left+"px":s.marginLeft=t.left+"px"),s},WZ=tt.getTrackAnimateCSS=function(t){cN(t,["left","variableWidth","slideCount","slidesToShow","slideWidth","speed","cssEase"]);var r=DE(t);return t.useTransform?(r.WebkitTransition="-webkit-transform "+t.speed+"ms "+t.cssEase,r.transition="transform "+t.speed+"ms "+t.cssEase):t.vertical?r.transition="top "+t.speed+"ms "+t.cssEase:r.transition="left "+t.speed+"ms "+t.cssEase,r},IE=tt.getTrackLeft=function(t){if(t.unslick)return 0;cN(t,["slideIndex","trackRef","infinite","centerMode","slideCount","slidesToShow","slidesToScroll","slideWidth","listWidth","variableWidth","slideHeight"]);var r=t.slideIndex,i=t.trackRef,n=t.infinite,s=t.centerMode,a=t.slideCount,o=t.slidesToShow,l=t.slidesToScroll,c=t.slideWidth,u=t.listWidth,h=t.variableWidth,d=t.slideHeight,p=t.fade,f=t.vertical,m=0,g,v,y=0;if(p||t.slideCount===1)return 0;var w=0;if(n?(w=-x_(t),a%l!==0&&r+l>a&&(w=-(r>a?o-(r-a):a%l)),s&&(w+=parseInt(o/2))):(a%l!==0&&r+l>a&&(w=o-a%l),s&&(w=parseInt(o/2))),m=w*c,y=w*d,f?g=r*d*-1+y:g=r*c*-1+m,h===!0){var b,E=i&&i.node;if(b=r+x_(t),v=E&&E.childNodes[b],g=v?v.offsetLeft*-1:0,s===!0){b=n?r+x_(t):r,v=E&&E.children[b],g=0;for(var _=0;_<b;_++)g-=E&&E.children[_]&&E.children[_].offsetWidth;g-=parseInt(t.centerPadding),g+=v&&(u-v.offsetWidth)/2}}return g},x_=tt.getPreClones=function(t){return t.unslick||!t.infinite?0:t.variableWidth?t.slideCount:t.slidesToShow+(t.centerMode?1:0)},$Ve=tt.getPostClones=function(t){return t.unslick||!t.infinite?0:t.slideCount},QVe=tt.getTotalSlides=function(t){return t.slideCount===1?1:x_(t)+t.slideCount+$Ve(t)},KVe=tt.siblingDirection=function(t){return t.targetSlide>t.currentSlide?t.targetSlide>t.currentSlide+ZVe(t)?"left":"right":t.targetSlide<t.currentSlide-JVe(t)?"right":"left"},ZVe=tt.slidesOnRight=function(t){var r=t.slidesToShow,i=t.centerMode,n=t.rtl,s=t.centerPadding;if(i){var a=(r-1)/2+1;return parseInt(s)>0&&(a+=1),n&&r%2===0&&(a+=1),a}return n?0:r-1},JVe=tt.slidesOnLeft=function(t){var r=t.slidesToShow,i=t.centerMode,n=t.rtl,s=t.centerPadding;if(i){var a=(r-1)/2+1;return parseInt(s)>0&&(a+=1),!n&&r%2===0&&(a+=1),a}return n?r-1:0};tt.canUseDOM=function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)};var e5e=tt.validSettings=Object.keys(VVe.default);function t5e(e){return e5e.reduce(function(t,r){return e.hasOwnProperty(r)&&(t[r]=e[r]),t},{})}var AC={};Object.defineProperty(AC,"__esModule",{value:!0});AC.Track=void 0;var qu=GZ(te),VP=GZ(CC),HP=tt;function GZ(e){return e&&e.__esModule?e:{default:e}}function kg(e){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}function WO(){return WO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},WO.apply(this,arguments)}function r5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,YZ(i.key),i)}}function i5e(e,t,r){return t&&CH(e.prototype,t),r&&CH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function n5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GO(e,t)}function GO(e,t){return GO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},GO(e,t)}function s5e(e){var t=qZ();return function(){var i=OE(e),n;if(t){var s=OE(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return a5e(this,n)}}function a5e(e,t){if(t&&(kg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qO(e)}function qO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qZ=function(){return!!e})()}function OE(e){return OE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},OE(e)}function AH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function Xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AH(Object(r),!0).forEach(function(i){YO(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function YO(e,t,r){return t=YZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YZ(e){var t=o5e(e,"string");return kg(t)=="symbol"?t:String(t)}function o5e(e,t){if(kg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(kg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WP=function(t){var r,i,n,s,a;t.rtl?a=t.slideCount-1-t.index:a=t.index,n=a<0||a>=t.slideCount,t.centerMode?(s=Math.floor(t.slidesToShow/2),i=(a-t.currentSlide)%t.slideCount===0,a>t.currentSlide-s-1&&a<=t.currentSlide+s&&(r=!0)):r=t.currentSlide<=a&&a<t.currentSlide+t.slidesToShow;var o;t.targetSlide<0?o=t.targetSlide+t.slideCount:t.targetSlide>=t.slideCount?o=t.targetSlide-t.slideCount:o=t.targetSlide;var l=a===o;return{"slick-slide":!0,"slick-active":r,"slick-center":i,"slick-cloned":n,"slick-current":l}},l5e=function(t){var r={};return(t.variableWidth===void 0||t.variableWidth===!1)&&(r.width=t.slideWidth),t.fade&&(r.position="relative",t.vertical?r.top=-t.index*parseInt(t.slideHeight):r.left=-t.index*parseInt(t.slideWidth),r.opacity=t.currentSlide===t.index?1:0,r.zIndex=t.currentSlide===t.index?999:998,t.useCSS&&(r.transition="opacity "+t.speed+"ms "+t.cssEase+", visibility "+t.speed+"ms "+t.cssEase)),r},GP=function(t,r){return t.key||r},c5e=function(t){var r,i=[],n=[],s=[],a=qu.default.Children.count(t.children),o=(0,HP.lazyStartIndex)(t),l=(0,HP.lazyEndIndex)(t);return qu.default.Children.forEach(t.children,function(c,u){var h,d={message:"children",index:u,slidesToScroll:t.slidesToScroll,currentSlide:t.currentSlide};!t.lazyLoad||t.lazyLoad&&t.lazyLoadedList.indexOf(u)>=0?h=c:h=qu.default.createElement("div",null);var p=l5e(Xs(Xs({},t),{},{index:u})),f=h.props.className||"",m=WP(Xs(Xs({},t),{},{index:u}));if(i.push(qu.default.cloneElement(h,{key:"original"+GP(h,u),"data-index":u,className:(0,VP.default)(m,f),tabIndex:"-1","aria-hidden":!m["slick-active"],style:Xs(Xs({outline:"none"},h.props.style||{}),p),onClick:function(y){h.props&&h.props.onClick&&h.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(d)}})),t.infinite&&t.fade===!1){var g=a-u;g<=(0,HP.getPreClones)(t)&&(r=-g,r>=o&&(h=c),m=WP(Xs(Xs({},t),{},{index:r})),n.push(qu.default.cloneElement(h,{key:"precloned"+GP(h,r),"data-index":r,tabIndex:"-1",className:(0,VP.default)(m,f),"aria-hidden":!m["slick-active"],style:Xs(Xs({},h.props.style||{}),p),onClick:function(y){h.props&&h.props.onClick&&h.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(d)}}))),r=a+u,r<l&&(h=c),m=WP(Xs(Xs({},t),{},{index:r})),s.push(qu.default.cloneElement(h,{key:"postcloned"+GP(h,r),"data-index":r,tabIndex:"-1",className:(0,VP.default)(m,f),"aria-hidden":!m["slick-active"],style:Xs(Xs({},h.props.style||{}),p),onClick:function(y){h.props&&h.props.onClick&&h.props.onClick(y),t.focusOnSelect&&t.focusOnSelect(d)}}))}}),t.rtl?n.concat(i,s).reverse():n.concat(i,s)};AC.Track=function(e){n5e(r,e);var t=s5e(r);function r(){var i;r5e(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return i=t.call.apply(t,[this].concat(s)),YO(qO(i),"node",null),YO(qO(i),"handleRef",function(o){i.node=o}),i}return i5e(r,[{key:"render",value:function(){var n=c5e(this.props),s=this.props,a=s.onMouseEnter,o=s.onMouseOver,l=s.onMouseLeave,c={onMouseEnter:a,onMouseOver:o,onMouseLeave:l};return qu.default.createElement("div",WO({ref:this.handleRef,className:"slick-track",style:this.props.trackStyle},c),n)}}]),r}(qu.default.PureComponent);var MC={};function Lg(e){"@babel/helpers - typeof";return Lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lg(e)}Object.defineProperty(MC,"__esModule",{value:!0});MC.Dots=void 0;var Tb=XZ(te),u5e=XZ(CC),MH=tt;function XZ(e){return e&&e.__esModule?e:{default:e}}function PH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function h5e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PH(Object(r),!0).forEach(function(i){d5e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function d5e(e,t,r){return t=$Z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$Z(i.key),i)}}function f5e(e,t,r){return t&&DH(e.prototype,t),r&&DH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Z(e){var t=m5e(e,"string");return Lg(t)=="symbol"?t:String(t)}function m5e(e,t){if(Lg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(Lg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function g5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},XO(e,t)}function v5e(e){var t=QZ();return function(){var i=RE(e),n;if(t){var s=RE(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return y5e(this,n)}}function y5e(e,t){if(t&&(Lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w5e(e)}function w5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QZ=function(){return!!e})()}function RE(e){return RE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RE(e)}var x5e=function(t){var r;return t.infinite?r=Math.ceil(t.slideCount/t.slidesToScroll):r=Math.ceil((t.slideCount-t.slidesToShow)/t.slidesToScroll)+1,r};MC.Dots=function(e){g5e(r,e);var t=v5e(r);function r(){return p5e(this,r),t.apply(this,arguments)}return f5e(r,[{key:"clickHandler",value:function(n,s){s.preventDefault(),this.props.clickHandler(n)}},{key:"render",value:function(){for(var n=this.props,s=n.onMouseEnter,a=n.onMouseOver,o=n.onMouseLeave,l=n.infinite,c=n.slidesToScroll,u=n.slidesToShow,h=n.slideCount,d=n.currentSlide,p=x5e({slideCount:h,slidesToScroll:c,slidesToShow:u,infinite:l}),f={onMouseEnter:s,onMouseOver:a,onMouseLeave:o},m=[],g=0;g<p;g++){var v=(g+1)*c-1,y=l?v:(0,MH.clamp)(v,0,h-1),w=y-(c-1),b=l?w:(0,MH.clamp)(w,0,h-1),E=(0,u5e.default)({"slick-active":l?d>=b&&d<=y:d===b}),_={message:"dots",index:g,slidesToScroll:c,currentSlide:d},C=this.clickHandler.bind(this,_);m=m.concat(Tb.default.createElement("li",{key:g,className:E},Tb.default.cloneElement(this.props.customPaging(g),{onClick:C})))}return Tb.default.cloneElement(this.props.appendDots(m),h5e({className:this.props.dotsClass},f))}}]),r}(Tb.default.PureComponent);var Ng={};function zg(e){"@babel/helpers - typeof";return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zg(e)}Object.defineProperty(Ng,"__esModule",{value:!0});Ng.PrevArrow=Ng.NextArrow=void 0;var Qm=ZZ(te),KZ=ZZ(CC),b5e=tt;function ZZ(e){return e&&e.__esModule?e:{default:e}}function kE(){return kE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},kE.apply(this,arguments)}function IH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function LE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IH(Object(r),!0).forEach(function(i){_5e(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _5e(e,t,r){return t=tJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,tJ(i.key),i)}}function eJ(e,t,r){return t&&OH(e.prototype,t),r&&OH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tJ(e){var t=S5e(e,"string");return zg(t)=="symbol"?t:String(t)}function S5e(e,t){if(zg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(zg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$O(e,t)}function $O(e,t){return $O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},$O(e,t)}function iJ(e){var t=nJ();return function(){var i=NE(e),n;if(t){var s=NE(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return E5e(this,n)}}function E5e(e,t){if(t&&(zg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T5e(e)}function T5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nJ=function(){return!!e})()}function NE(e){return NE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},NE(e)}Ng.PrevArrow=function(e){rJ(r,e);var t=iJ(r);function r(){return JZ(this,r),t.apply(this,arguments)}return eJ(r,[{key:"clickHandler",value:function(n,s){s&&s.preventDefault(),this.props.clickHandler(n,s)}},{key:"render",value:function(){var n={"slick-arrow":!0,"slick-prev":!0},s=this.clickHandler.bind(this,{message:"previous"});!this.props.infinite&&(this.props.currentSlide===0||this.props.slideCount<=this.props.slidesToShow)&&(n["slick-disabled"]=!0,s=null);var a={key:"0","data-role":"none",className:(0,KZ.default)(n),style:{display:"block"},onClick:s},o={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},l;return this.props.prevArrow?l=Qm.default.cloneElement(this.props.prevArrow,LE(LE({},a),o)):l=Qm.default.createElement("button",kE({key:"0",type:"button"},a)," ","Previous"),l}}]),r}(Qm.default.PureComponent);Ng.NextArrow=function(e){rJ(r,e);var t=iJ(r);function r(){return JZ(this,r),t.apply(this,arguments)}return eJ(r,[{key:"clickHandler",value:function(n,s){s&&s.preventDefault(),this.props.clickHandler(n,s)}},{key:"render",value:function(){var n={"slick-arrow":!0,"slick-next":!0},s=this.clickHandler.bind(this,{message:"next"});(0,b5e.canGoNext)(this.props)||(n["slick-disabled"]=!0,s=null);var a={key:"1","data-role":"none",className:(0,KZ.default)(n),style:{display:"block"},onClick:s},o={currentSlide:this.props.currentSlide,slideCount:this.props.slideCount},l;return this.props.nextArrow?l=Qm.default.cloneElement(this.props.nextArrow,LE(LE({},a),o)):l=Qm.default.createElement("button",kE({key:"1",type:"button"},a)," ","Next"),l}}]),r}(Qm.default.PureComponent);var sJ=function(){if(typeof Map<"u")return Map;function e(t,r){var i=-1;return t.some(function(n,s){return n[0]===r?(i=s,!0):!1}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(r){var i=e(this.__entries__,r),n=this.__entries__[i];return n&&n[1]},t.prototype.set=function(r,i){var n=e(this.__entries__,r);~n?this.__entries__[n][1]=i:this.__entries__.push([r,i])},t.prototype.delete=function(r){var i=this.__entries__,n=e(i,r);~n&&i.splice(n,1)},t.prototype.has=function(r){return!!~e(this.__entries__,r)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(r,i){i===void 0&&(i=null);for(var n=0,s=this.__entries__;n<s.length;n++){var a=s[n];r.call(i,a[1],a[0])}},t}()}(),QO=typeof window<"u"&&typeof document<"u"&&window.document===document,zE=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),C5e=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(zE):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),A5e=2;function M5e(e,t){var r=!1,i=!1,n=0;function s(){r&&(r=!1,e()),i&&o()}function a(){C5e(s)}function o(){var l=Date.now();if(r){if(l-n<A5e)return;i=!0}else r=!0,i=!1,setTimeout(a,t);n=l}return o}var P5e=20,D5e=["top","right","bottom","left","width","height","size","weight"],I5e=typeof MutationObserver<"u",O5e=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=M5e(this.refresh.bind(this),P5e)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var r=this.observers_,i=r.indexOf(t);~i&&r.splice(i,1),!r.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return t.forEach(function(r){return r.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!QO||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),I5e?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!QO||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var r=t.propertyName,i=r===void 0?"":r,n=D5e.some(function(s){return!!~i.indexOf(s)});n&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),aJ=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},Bg=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||zE},oJ=PC(0,0,0,0);function BE(e){return parseFloat(e)||0}function RH(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce(function(i,n){var s=e["border-"+n+"-width"];return i+BE(s)},0)}function R5e(e){for(var t=["top","right","bottom","left"],r={},i=0,n=t;i<n.length;i++){var s=n[i],a=e["padding-"+s];r[s]=BE(a)}return r}function k5e(e){var t=e.getBBox();return PC(0,0,t.width,t.height)}function L5e(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return oJ;var i=Bg(e).getComputedStyle(e),n=R5e(i),s=n.left+n.right,a=n.top+n.bottom,o=BE(i.width),l=BE(i.height);if(i.boxSizing==="border-box"&&(Math.round(o+s)!==t&&(o-=RH(i,"left","right")+s),Math.round(l+a)!==r&&(l-=RH(i,"top","bottom")+a)),!z5e(e)){var c=Math.round(o+s)-t,u=Math.round(l+a)-r;Math.abs(c)!==1&&(o-=c),Math.abs(u)!==1&&(l-=u)}return PC(n.left,n.top,o,l)}var N5e=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof Bg(e).SVGGraphicsElement}:function(e){return e instanceof Bg(e).SVGElement&&typeof e.getBBox=="function"}}();function z5e(e){return e===Bg(e).document.documentElement}function B5e(e){return QO?N5e(e)?k5e(e):L5e(e):oJ}function F5e(e){var t=e.x,r=e.y,i=e.width,n=e.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return aJ(a,{x:t,y:r,width:i,height:n,top:r,right:t+i,bottom:n+r,left:t}),a}function PC(e,t,r,i){return{x:e,y:t,width:r,height:i}}var U5e=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=PC(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=B5e(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),j5e=function(){function e(t,r){var i=F5e(r);aJ(this,{target:t,contentRect:i})}return e}(),V5e=function(){function e(t,r,i){if(this.activeObservations_=[],this.observations_=new sJ,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=r,this.callbackCtx_=i}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Bg(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)||(r.set(t,new U5e(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof Bg(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(t)&&(r.delete(t),r.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&t.activeObservations_.push(r)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,r=this.activeObservations_.map(function(i){return new j5e(i.target,i.broadcastRect())});this.callback_.call(t,r,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),lJ=typeof WeakMap<"u"?new WeakMap:new sJ,cJ=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=O5e.getInstance(),i=new V5e(t,r,this);lJ.set(this,i)}return e}();["observe","unobserve","disconnect"].forEach(function(e){cJ.prototype[e]=function(){var t;return(t=lJ.get(this))[e].apply(t,arguments)}});var H5e=function(){return typeof zE.ResizeObserver<"u"?zE.ResizeObserver:cJ}();const W5e=Object.freeze(Object.defineProperty({__proto__:null,default:H5e},Symbol.toStringTag,{value:"Module"})),G5e=oW(W5e);Object.defineProperty(TC,"__esModule",{value:!0});TC.InnerSlider=void 0;var Ps=dx(te),q5e=dx(kZ),Y5e=dx(AX),X5e=dx(CC),li=tt,$5e=AC,Q5e=MC,kH=Ng,K5e=dx(G5e);function dx(e){return e&&e.__esModule?e:{default:e}}function kp(e){"@babel/helpers - typeof";return kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kp(e)}function FE(){return FE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},FE.apply(this,arguments)}function Z5e(e,t){if(e==null)return{};var r=J5e(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function J5e(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function LH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function Pt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LH(Object(r),!0).forEach(function(i){nr(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LH(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function e6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NH(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,hJ(i.key),i)}}function t6e(e,t,r){return t&&NH(e.prototype,t),r&&NH(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KO(e,t)}function KO(e,t){return KO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,n){return i.__proto__=n,i},KO(e,t)}function i6e(e){var t=uJ();return function(){var i=UE(e),n;if(t){var s=UE(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return n6e(this,n)}}function n6e(e,t){if(t&&(kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ir(e)}function ir(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uJ=function(){return!!e})()}function UE(e){return UE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UE(e)}function nr(e,t,r){return t=hJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hJ(e){var t=s6e(e,"string");return kp(t)=="symbol"?t:String(t)}function s6e(e,t){if(kp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t||"default");if(kp(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}TC.InnerSlider=function(e){r6e(r,e);var t=i6e(r);function r(i){var n;e6e(this,r),n=t.call(this,i),nr(ir(n),"listRefHandler",function(a){return n.list=a}),nr(ir(n),"trackRefHandler",function(a){return n.track=a}),nr(ir(n),"adaptHeight",function(){if(n.props.adaptiveHeight&&n.list){var a=n.list.querySelector('[data-index="'.concat(n.state.currentSlide,'"]'));n.list.style.height=(0,li.getHeight)(a)+"px"}}),nr(ir(n),"componentDidMount",function(){if(n.props.onInit&&n.props.onInit(),n.props.lazyLoad){var a=(0,li.getOnDemandLazySlides)(Pt(Pt({},n.props),n.state));a.length>0&&(n.setState(function(l){return{lazyLoadedList:l.lazyLoadedList.concat(a)}}),n.props.onLazyLoad&&n.props.onLazyLoad(a))}var o=Pt({listRef:n.list,trackRef:n.track},n.props);n.updateState(o,!0,function(){n.adaptHeight(),n.props.autoplay&&n.autoPlay("update")}),n.props.lazyLoad==="progressive"&&(n.lazyLoadTimer=setInterval(n.progressiveLazyLoad,1e3)),n.ro=new K5e.default(function(){n.state.animating?(n.onWindowResized(!1),n.callbackTimers.push(setTimeout(function(){return n.onWindowResized()},n.props.speed))):n.onWindowResized()}),n.ro.observe(n.list),document.querySelectorAll&&Array.prototype.forEach.call(document.querySelectorAll(".slick-slide"),function(l){l.onfocus=n.props.pauseOnFocus?n.onSlideFocus:null,l.onblur=n.props.pauseOnFocus?n.onSlideBlur:null}),window.addEventListener?window.addEventListener("resize",n.onWindowResized):window.attachEvent("onresize",n.onWindowResized)}),nr(ir(n),"componentWillUnmount",function(){n.animationEndCallback&&clearTimeout(n.animationEndCallback),n.lazyLoadTimer&&clearInterval(n.lazyLoadTimer),n.callbackTimers.length&&(n.callbackTimers.forEach(function(a){return clearTimeout(a)}),n.callbackTimers=[]),window.addEventListener?window.removeEventListener("resize",n.onWindowResized):window.detachEvent("onresize",n.onWindowResized),n.autoplayTimer&&clearInterval(n.autoplayTimer),n.ro.disconnect()}),nr(ir(n),"componentDidUpdate",function(a){if(n.checkImagesLoad(),n.props.onReInit&&n.props.onReInit(),n.props.lazyLoad){var o=(0,li.getOnDemandLazySlides)(Pt(Pt({},n.props),n.state));o.length>0&&(n.setState(function(u){return{lazyLoadedList:u.lazyLoadedList.concat(o)}}),n.props.onLazyLoad&&n.props.onLazyLoad(o))}n.adaptHeight();var l=Pt(Pt({listRef:n.list,trackRef:n.track},n.props),n.state),c=n.didPropsChange(a);c&&n.updateState(l,c,function(){n.state.currentSlide>=Ps.default.Children.count(n.props.children)&&n.changeSlide({message:"index",index:Ps.default.Children.count(n.props.children)-n.props.slidesToShow,currentSlide:n.state.currentSlide}),n.props.autoplay?n.autoPlay("update"):n.pause("paused")})}),nr(ir(n),"onWindowResized",function(a){n.debouncedResize&&n.debouncedResize.cancel(),n.debouncedResize=(0,Y5e.default)(function(){return n.resizeWindow(a)},50),n.debouncedResize()}),nr(ir(n),"resizeWindow",function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,o=!!(n.track&&n.track.node);if(o){var l=Pt(Pt({listRef:n.list,trackRef:n.track},n.props),n.state);n.updateState(l,a,function(){n.props.autoplay?n.autoPlay("update"):n.pause("paused")}),n.setState({animating:!1}),clearTimeout(n.animationEndCallback),delete n.animationEndCallback}}),nr(ir(n),"updateState",function(a,o,l){var c=(0,li.initializedState)(a);a=Pt(Pt(Pt({},a),c),{},{slideIndex:c.currentSlide});var u=(0,li.getTrackLeft)(a);a=Pt(Pt({},a),{},{left:u});var h=(0,li.getTrackCSS)(a);(o||Ps.default.Children.count(n.props.children)!==Ps.default.Children.count(a.children))&&(c.trackStyle=h),n.setState(c,l)}),nr(ir(n),"ssrInit",function(){if(n.props.variableWidth){var a=0,o=0,l=[],c=(0,li.getPreClones)(Pt(Pt(Pt({},n.props),n.state),{},{slideCount:n.props.children.length})),u=(0,li.getPostClones)(Pt(Pt(Pt({},n.props),n.state),{},{slideCount:n.props.children.length}));n.props.children.forEach(function(C){l.push(C.props.style.width),a+=C.props.style.width});for(var h=0;h<c;h++)o+=l[l.length-1-h],a+=l[l.length-1-h];for(var d=0;d<u;d++)a+=l[d];for(var p=0;p<n.state.currentSlide;p++)o+=l[p];var f={width:a+"px",left:-o+"px"};if(n.props.centerMode){var m="".concat(l[n.state.currentSlide],"px");f.left="calc(".concat(f.left," + (100% - ").concat(m,") / 2 ) ")}return{trackStyle:f}}var g=Ps.default.Children.count(n.props.children),v=Pt(Pt(Pt({},n.props),n.state),{},{slideCount:g}),y=(0,li.getPreClones)(v)+(0,li.getPostClones)(v)+g,w=100/n.props.slidesToShow*y,b=100/y,E=-b*((0,li.getPreClones)(v)+n.state.currentSlide)*w/100;n.props.centerMode&&(E+=(100-b*w/100)/2);var _={width:w+"%",left:E+"%"};return{slideWidth:b+"%",trackStyle:_}}),nr(ir(n),"checkImagesLoad",function(){var a=n.list&&n.list.querySelectorAll&&n.list.querySelectorAll(".slick-slide img")||[],o=a.length,l=0;Array.prototype.forEach.call(a,function(c){var u=function(){return++l&&l>=o&&n.onWindowResized()};if(!c.onclick)c.onclick=function(){return c.parentNode.focus()};else{var h=c.onclick;c.onclick=function(d){h(d),c.parentNode.focus()}}c.onload||(n.props.lazyLoad?c.onload=function(){n.adaptHeight(),n.callbackTimers.push(setTimeout(n.onWindowResized,n.props.speed))}:(c.onload=u,c.onerror=function(){u(),n.props.onLazyLoadError&&n.props.onLazyLoadError()}))})}),nr(ir(n),"progressiveLazyLoad",function(){for(var a=[],o=Pt(Pt({},n.props),n.state),l=n.state.currentSlide;l<n.state.slideCount+(0,li.getPostClones)(o);l++)if(n.state.lazyLoadedList.indexOf(l)<0){a.push(l);break}for(var c=n.state.currentSlide-1;c>=-(0,li.getPreClones)(o);c--)if(n.state.lazyLoadedList.indexOf(c)<0){a.push(c);break}a.length>0?(n.setState(function(u){return{lazyLoadedList:u.lazyLoadedList.concat(a)}}),n.props.onLazyLoad&&n.props.onLazyLoad(a)):n.lazyLoadTimer&&(clearInterval(n.lazyLoadTimer),delete n.lazyLoadTimer)}),nr(ir(n),"slideHandler",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=n.props,c=l.asNavFor,u=l.beforeChange,h=l.onLazyLoad,d=l.speed,p=l.afterChange,f=n.state.currentSlide,m=(0,li.slideHandler)(Pt(Pt(Pt({index:a},n.props),n.state),{},{trackRef:n.track,useCSS:n.props.useCSS&&!o})),g=m.state,v=m.nextState;if(g){u&&u(f,g.currentSlide);var y=g.lazyLoadedList.filter(function(w){return n.state.lazyLoadedList.indexOf(w)<0});h&&y.length>0&&h(y),!n.props.waitForAnimate&&n.animationEndCallback&&(clearTimeout(n.animationEndCallback),p&&p(f),delete n.animationEndCallback),n.setState(g,function(){c&&n.asNavForIndex!==a&&(n.asNavForIndex=a,c.innerSlider.slideHandler(a)),v&&(n.animationEndCallback=setTimeout(function(){var w=v.animating,b=Z5e(v,["animating"]);n.setState(b,function(){n.callbackTimers.push(setTimeout(function(){return n.setState({animating:w})},10)),p&&p(g.currentSlide),delete n.animationEndCallback})},d))})}}),nr(ir(n),"changeSlide",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l=Pt(Pt({},n.props),n.state),c=(0,li.changeSlide)(l,a);if(!(c!==0&&!c)&&(o===!0?n.slideHandler(c,o):n.slideHandler(c),n.props.autoplay&&n.autoPlay("update"),n.props.focusOnSelect)){var u=n.list.querySelectorAll(".slick-current");u[0]&&u[0].focus()}}),nr(ir(n),"clickHandler",function(a){n.clickable===!1&&(a.stopPropagation(),a.preventDefault()),n.clickable=!0}),nr(ir(n),"keyHandler",function(a){var o=(0,li.keyHandler)(a,n.props.accessibility,n.props.rtl);o!==""&&n.changeSlide({message:o})}),nr(ir(n),"selectHandler",function(a){n.changeSlide(a)}),nr(ir(n),"disableBodyScroll",function(){var a=function(l){l=l||window.event,l.preventDefault&&l.preventDefault(),l.returnValue=!1};window.ontouchmove=a}),nr(ir(n),"enableBodyScroll",function(){window.ontouchmove=null}),nr(ir(n),"swipeStart",function(a){n.props.verticalSwiping&&n.disableBodyScroll();var o=(0,li.swipeStart)(a,n.props.swipe,n.props.draggable);o!==""&&n.setState(o)}),nr(ir(n),"swipeMove",function(a){var o=(0,li.swipeMove)(a,Pt(Pt(Pt({},n.props),n.state),{},{trackRef:n.track,listRef:n.list,slideIndex:n.state.currentSlide}));o&&(o.swiping&&(n.clickable=!1),n.setState(o))}),nr(ir(n),"swipeEnd",function(a){var o=(0,li.swipeEnd)(a,Pt(Pt(Pt({},n.props),n.state),{},{trackRef:n.track,listRef:n.list,slideIndex:n.state.currentSlide}));if(o){var l=o.triggerSlideHandler;delete o.triggerSlideHandler,n.setState(o),l!==void 0&&(n.slideHandler(l),n.props.verticalSwiping&&n.enableBodyScroll())}}),nr(ir(n),"touchEnd",function(a){n.swipeEnd(a),n.clickable=!0}),nr(ir(n),"slickPrev",function(){n.callbackTimers.push(setTimeout(function(){return n.changeSlide({message:"previous"})},0))}),nr(ir(n),"slickNext",function(){n.callbackTimers.push(setTimeout(function(){return n.changeSlide({message:"next"})},0))}),nr(ir(n),"slickGoTo",function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a=Number(a),isNaN(a))return"";n.callbackTimers.push(setTimeout(function(){return n.changeSlide({message:"index",index:a,currentSlide:n.state.currentSlide},o)},0))}),nr(ir(n),"play",function(){var a;if(n.props.rtl)a=n.state.currentSlide-n.props.slidesToScroll;else if((0,li.canGoNext)(Pt(Pt({},n.props),n.state)))a=n.state.currentSlide+n.props.slidesToScroll;else return!1;n.slideHandler(a)}),nr(ir(n),"autoPlay",function(a){n.autoplayTimer&&clearInterval(n.autoplayTimer);var o=n.state.autoplaying;if(a==="update"){if(o==="hovered"||o==="focused"||o==="paused")return}else if(a==="leave"){if(o==="paused"||o==="focused")return}else if(a==="blur"&&(o==="paused"||o==="hovered"))return;n.autoplayTimer=setInterval(n.play,n.props.autoplaySpeed+50),n.setState({autoplaying:"playing"})}),nr(ir(n),"pause",function(a){n.autoplayTimer&&(clearInterval(n.autoplayTimer),n.autoplayTimer=null);var o=n.state.autoplaying;a==="paused"?n.setState({autoplaying:"paused"}):a==="focused"?(o==="hovered"||o==="playing")&&n.setState({autoplaying:"focused"}):o==="playing"&&n.setState({autoplaying:"hovered"})}),nr(ir(n),"onDotsOver",function(){return n.props.autoplay&&n.pause("hovered")}),nr(ir(n),"onDotsLeave",function(){return n.props.autoplay&&n.state.autoplaying==="hovered"&&n.autoPlay("leave")}),nr(ir(n),"onTrackOver",function(){return n.props.autoplay&&n.pause("hovered")}),nr(ir(n),"onTrackLeave",function(){return n.props.autoplay&&n.state.autoplaying==="hovered"&&n.autoPlay("leave")}),nr(ir(n),"onSlideFocus",function(){return n.props.autoplay&&n.pause("focused")}),nr(ir(n),"onSlideBlur",function(){return n.props.autoplay&&n.state.autoplaying==="focused"&&n.autoPlay("blur")}),nr(ir(n),"render",function(){var a=(0,X5e.default)("slick-slider",n.props.className,{"slick-vertical":n.props.vertical,"slick-initialized":!0}),o=Pt(Pt({},n.props),n.state),l=(0,li.extractObject)(o,["fade","cssEase","speed","infinite","centerMode","focusOnSelect","currentSlide","lazyLoad","lazyLoadedList","rtl","slideWidth","slideHeight","listHeight","vertical","slidesToShow","slidesToScroll","slideCount","trackStyle","variableWidth","unslick","centerPadding","targetSlide","useCSS"]),c=n.props.pauseOnHover;l=Pt(Pt({},l),{},{onMouseEnter:c?n.onTrackOver:null,onMouseLeave:c?n.onTrackLeave:null,onMouseOver:c?n.onTrackOver:null,focusOnSelect:n.props.focusOnSelect&&n.clickable?n.selectHandler:null});var u;if(n.props.dots===!0&&n.state.slideCount>=n.props.slidesToShow){var h=(0,li.extractObject)(o,["dotsClass","slideCount","slidesToShow","currentSlide","slidesToScroll","clickHandler","children","customPaging","infinite","appendDots"]),d=n.props.pauseOnDotsHover;h=Pt(Pt({},h),{},{clickHandler:n.changeSlide,onMouseEnter:d?n.onDotsLeave:null,onMouseOver:d?n.onDotsOver:null,onMouseLeave:d?n.onDotsLeave:null}),u=Ps.default.createElement(Q5e.Dots,h)}var p,f,m=(0,li.extractObject)(o,["infinite","centerMode","currentSlide","slideCount","slidesToShow","prevArrow","nextArrow"]);m.clickHandler=n.changeSlide,n.props.arrows&&(p=Ps.default.createElement(kH.PrevArrow,m),f=Ps.default.createElement(kH.NextArrow,m));var g=null;n.props.vertical&&(g={height:n.state.listHeight});var v=null;n.props.vertical===!1?n.props.centerMode===!0&&(v={padding:"0px "+n.props.centerPadding}):n.props.centerMode===!0&&(v={padding:n.props.centerPadding+" 0px"});var y=Pt(Pt({},g),v),w=n.props.touchMove,b={className:"slick-list",style:y,onClick:n.clickHandler,onMouseDown:w?n.swipeStart:null,onMouseMove:n.state.dragging&&w?n.swipeMove:null,onMouseUp:w?n.swipeEnd:null,onMouseLeave:n.state.dragging&&w?n.swipeEnd:null,onTouchStart:w?n.swipeStart:null,onTouchMove:n.state.dragging&&w?n.swipeMove:null,onTouchEnd:w?n.touchEnd:null,onTouchCancel:n.state.dragging&&w?n.swipeEnd:null,onKeyDown:n.props.accessibility?n.keyHandler:null},E={className:a,dir:"ltr",style:n.props.style};return n.props.unslick&&(b={className:"slick-list"},E={className:a}),Ps.default.createElement("div",E,n.props.unslick?"":p,Ps.default.createElement("div",FE({ref:n.listRefHandler},b),Ps.default.createElement($5e.Track,FE({ref:n.trackRefHandler},l),n.props.children)),n.props.unslick?"":f,n.props.unslick?"":u)}),n.list=null,n.track=null,n.state=Pt(Pt({},q5e.default),{},{currentSlide:n.props.initialSlide,targetSlide:n.props.initialSlide?n.props.initialSlide:0,slideCount:Ps.default.Children.count(n.props.children)}),n.callbackTimers=[],n.clickable=!0,n.debouncedResize=null;var s=n.ssrInit();return n.state=Pt(Pt({},n.state),s),n}return t6e(r,[{key:"didPropsChange",value:function(n){for(var s=!1,a=0,o=Object.keys(this.props);a<o.length;a++){var l=o[a];if(!n.hasOwnProperty(l)){s=!0;break}if(!(kp(n[l])==="object"||typeof n[l]=="function"||isNaN(n[l]))&&n[l]!==this.props[l]){s=!0;break}}return s||Ps.default.Children.count(this.props.children)!==Ps.default.Children.count(n.children)}}]),r}(Ps.default.Component);var a6e=function(e){return e.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()}).toLowerCase()},o6e=a6e,l6e=o6e,c6e=function(e){var t=/[height|width]$/;return t.test(e)},zH=function(e){var t="",r=Object.keys(e);return r.forEach(function(i,n){var s=e[i];i=l6e(i),c6e(i)&&typeof s=="number"&&(s=s+"px"),s===!0?t+=i:s===!1?t+="not "+i:t+="("+i+": "+s+")",n<r.length-1&&(t+=" and ")}),t},u6e=function(e){var t="";return typeof e=="string"?e:e instanceof Array?(e.forEach(function(r,i){t+=zH(r),i<e.length-1&&(t+=", ")}),t):zH(e)},h6e=u6e,qP,BH;function d6e(){if(BH)return qP;BH=1;function e(t){this.options=t,!t.deferSetup&&this.setup()}return e.prototype={constructor:e,setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(t){return this.options===t||this.options.match===t}},qP=e,qP}var YP,FH;function dJ(){if(FH)return YP;FH=1;function e(i,n){var s=0,a=i.length,o;for(s;s<a&&(o=n(i[s],s),o!==!1);s++);}function t(i){return Object.prototype.toString.apply(i)==="[object Array]"}function r(i){return typeof i=="function"}return YP={isFunction:r,isArray:t,each:e},YP}var XP,UH;function p6e(){if(UH)return XP;UH=1;var e=d6e(),t=dJ().each;function r(i,n){this.query=i,this.isUnconditional=n,this.handlers=[],this.mql=window.matchMedia(i);var s=this;this.listener=function(a){s.mql=a.currentTarget||a,s.assess()},this.mql.addListener(this.listener)}return r.prototype={constuctor:r,addHandler:function(i){var n=new e(i);this.handlers.push(n),this.matches()&&n.on()},removeHandler:function(i){var n=this.handlers;t(n,function(s,a){if(s.equals(i))return s.destroy(),!n.splice(a,1)})},matches:function(){return this.mql.matches||this.isUnconditional},clear:function(){t(this.handlers,function(i){i.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var i=this.matches()?"on":"off";t(this.handlers,function(n){n[i]()})}},XP=r,XP}var $P,jH;function f6e(){if(jH)return $P;jH=1;var e=p6e(),t=dJ(),r=t.each,i=t.isFunction,n=t.isArray;function s(){if(!window.matchMedia)throw new Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!window.matchMedia("only all").matches}return s.prototype={constructor:s,register:function(a,o,l){var c=this.queries,u=l&&this.browserIsIncapable;return c[a]||(c[a]=new e(a,u)),i(o)&&(o={match:o}),n(o)||(o=[o]),r(o,function(h){i(h)&&(h={match:h}),c[a].addHandler(h)}),this},unregister:function(a,o){var l=this.queries[a];return l&&(o?l.removeHandler(o):(l.clear(),delete this.queries[a])),this}},$P=s,$P}var QP,VH;function m6e(){if(VH)return QP;VH=1;var e=f6e();return QP=new e,QP}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=a(te),r=TC,i=a(h6e),n=a(lN),s=tt;function a(A){return A&&A.__esModule?A:{default:A}}function o(A){"@babel/helpers - typeof";return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},o(A)}function l(){return l=Object.assign?Object.assign.bind():function(A){for(var T=1;T<arguments.length;T++){var M=arguments[T];for(var D in M)Object.prototype.hasOwnProperty.call(M,D)&&(A[D]=M[D])}return A},l.apply(this,arguments)}function c(A,T){var M=Object.keys(A);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols(A);T&&(D=D.filter(function(P){return Object.getOwnPropertyDescriptor(A,P).enumerable})),M.push.apply(M,D)}return M}function u(A){for(var T=1;T<arguments.length;T++){var M=arguments[T]!=null?arguments[T]:{};T%2?c(Object(M),!0).forEach(function(D){E(A,D,M[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(M)):c(Object(M)).forEach(function(D){Object.defineProperty(A,D,Object.getOwnPropertyDescriptor(M,D))})}return A}function h(A,T){if(!(A instanceof T))throw new TypeError("Cannot call a class as a function")}function d(A,T){for(var M=0;M<T.length;M++){var D=T[M];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(A,_(D.key),D)}}function p(A,T,M){return T&&d(A.prototype,T),M&&d(A,M),Object.defineProperty(A,"prototype",{writable:!1}),A}function f(A,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create(T&&T.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),Object.defineProperty(A,"prototype",{writable:!1}),T&&m(A,T)}function m(A,T){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,P){return D.__proto__=P,D},m(A,T)}function g(A){var T=w();return function(){var D=b(A),P;if(T){var I=b(this).constructor;P=Reflect.construct(D,arguments,I)}else P=D.apply(this,arguments);return v(this,P)}}function v(A,T){if(T&&(o(T)==="object"||typeof T=="function"))return T;if(T!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(A)}function y(A){if(A===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A}function w(){try{var A=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(w=function(){return!!A})()}function b(A){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(M){return M.__proto__||Object.getPrototypeOf(M)},b(A)}function E(A,T,M){return T=_(T),T in A?Object.defineProperty(A,T,{value:M,enumerable:!0,configurable:!0,writable:!0}):A[T]=M,A}function _(A){var T=C(A,"string");return o(T)=="symbol"?T:String(T)}function C(A,T){if(o(A)!="object"||!A)return A;var M=A[Symbol.toPrimitive];if(M!==void 0){var D=M.call(A,T||"default");if(o(D)!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(A)}var x=(0,s.canUseDOM)()&&m6e();e.default=function(A){f(M,A);var T=g(M);function M(D){var P;return h(this,M),P=T.call(this,D),E(y(P),"innerSliderRefHandler",function(I){return P.innerSlider=I}),E(y(P),"slickPrev",function(){return P.innerSlider.slickPrev()}),E(y(P),"slickNext",function(){return P.innerSlider.slickNext()}),E(y(P),"slickGoTo",function(I){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return P.innerSlider.slickGoTo(I,B)}),E(y(P),"slickPause",function(){return P.innerSlider.pause("paused")}),E(y(P),"slickPlay",function(){return P.innerSlider.autoPlay("play")}),P.state={breakpoint:null},P._responsiveMediaHandlers=[],P}return p(M,[{key:"media",value:function(P,I){x.register(P,I),this._responsiveMediaHandlers.push({query:P,handler:I})}},{key:"componentDidMount",value:function(){var P=this;if(this.props.responsive){var I=this.props.responsive.map(function(V){return V.breakpoint});I.sort(function(V,N){return V-N}),I.forEach(function(V,N){var L;N===0?L=(0,i.default)({minWidth:0,maxWidth:V}):L=(0,i.default)({minWidth:I[N-1]+1,maxWidth:V}),(0,s.canUseDOM)()&&P.media(L,function(){P.setState({breakpoint:V})})});var B=(0,i.default)({minWidth:I.slice(-1)[0]});(0,s.canUseDOM)()&&this.media(B,function(){P.setState({breakpoint:null})})}}},{key:"componentWillUnmount",value:function(){this._responsiveMediaHandlers.forEach(function(P){x.unregister(P.query,P.handler)})}},{key:"render",value:function(){var P=this,I,B;this.state.breakpoint?(B=this.props.responsive.filter(function(se){return se.breakpoint===P.state.breakpoint}),I=B[0].settings==="unslick"?"unslick":u(u(u({},n.default),this.props),B[0].settings)):I=u(u({},n.default),this.props),I.centerMode&&(I.slidesToScroll>1,I.slidesToScroll=1),I.fade&&(I.slidesToShow>1,I.slidesToScroll>1,I.slidesToShow=1,I.slidesToScroll=1);var V=t.default.Children.toArray(this.props.children);V=V.filter(function(se){return typeof se=="string"?!!se.trim():!!se}),I.variableWidth&&(I.rows>1||I.slidesPerRow>1)&&(console.warn("variableWidth is not supported in case of rows > 1 or slidesPerRow > 1"),I.variableWidth=!1);for(var N=[],L=null,W=0;W<V.length;W+=I.rows*I.slidesPerRow){for(var G=[],X=W;X<W+I.rows*I.slidesPerRow;X+=I.slidesPerRow){for(var Q=[],ie=X;ie<X+I.slidesPerRow&&(I.variableWidth&&V[ie].props.style&&(L=V[ie].props.style.width),!(ie>=V.length));ie+=1)Q.push(t.default.cloneElement(V[ie],{key:100*W+10*X+ie,tabIndex:-1,style:{width:"".concat(100/I.slidesPerRow,"%"),display:"inline-block"}}));G.push(t.default.createElement("div",{key:10*W+X},Q))}I.variableWidth?N.push(t.default.createElement("div",{key:W,style:{width:L}},G)):N.push(t.default.createElement("div",{key:W},G))}if(I==="unslick"){var J="regular slider "+(this.props.className||"");return t.default.createElement("div",{className:J},V)}else N.length<=I.slidesToShow&&!I.infinite&&(I.unslick=!0);return t.default.createElement(r.InnerSlider,l({style:this.props.style,ref:this.innerSliderRefHandler},(0,s.filterSettings)(I)),N)}}]),M}(t.default.Component)})(RZ);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(RZ);function r(i){return i&&i.__esModule?i:{default:i}}e.default=t.default})(OZ);const g6e=Ug(OZ),v6e="/YoloTravelerAsia/assets/testimonial-CHSlDGyg.png",y6e="/YoloTravelerAsia/assets/naz-D3llv1cs.jpg",w6e="/YoloTravelerAsia/assets/th-DkopY3aA.jpg",x6e="/YoloTravelerAsia/assets/pagudpud-CkNM5JJ_.jpeg",b6e="/YoloTravelerAsia/assets/drone-BWhrqedQ.jpeg",_6e="/YoloTravelerAsia/assets/outoftown-D3BKI_TB.jpeg",S6e="/YoloTravelerAsia/assets/swimming-Doqy4oGB.jpeg";var ZO={exports:{}},Lp={},JO={exports:{}},Jo={},eR={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var r="none",i="contents",n=/input|select|textarea|button|object|iframe/;function s(h,d){return d.getPropertyValue("overflow")!=="visible"||h.scrollWidth<=0&&h.scrollHeight<=0}function a(h){var d=h.offsetWidth<=0&&h.offsetHeight<=0;if(d&&!h.innerHTML)return!0;try{var p=window.getComputedStyle(h),f=p.getPropertyValue("display");return d?f!==i&&s(h,p):f===r}catch{return console.warn("Failed to inspect element style"),!1}}function o(h){for(var d=h,p=h.getRootNode&&h.getRootNode();d&&d!==document.body;){if(p&&d===p&&(d=p.host.parentNode),a(d))return!1;d=d.parentNode}return!0}function l(h,d){var p=h.nodeName.toLowerCase(),f=n.test(p)&&!h.disabled||p==="a"&&h.href||d;return f&&o(h)}function c(h){var d=h.getAttribute("tabindex");d===null&&(d=void 0);var p=isNaN(d);return(p||d>=0)&&l(h,!p)}function u(h){var d=[].slice.call(h.querySelectorAll("*"),0).reduce(function(p,f){return p.concat(f.shadowRoot?u(f.shadowRoot):[f])},[]);return d.filter(c)}e.exports=t.default})(eR,eR.exports);var pJ=eR.exports;Object.defineProperty(Jo,"__esModule",{value:!0});Jo.resetState=A6e;Jo.log=M6e;Jo.handleBlur=xw;Jo.handleFocus=bw;Jo.markForFocusLater=P6e;Jo.returnFocus=D6e;Jo.popWithoutFocus=I6e;Jo.setupScopedFocus=O6e;Jo.teardownScopedFocus=R6e;var E6e=pJ,T6e=C6e(E6e);function C6e(e){return e&&e.__esModule?e:{default:e}}var Fg=[],bm=null,tR=!1;function A6e(){Fg=[]}function M6e(){}function xw(){tR=!0}function bw(){if(tR){if(tR=!1,!bm)return;setTimeout(function(){if(!bm.contains(document.activeElement)){var e=(0,T6e.default)(bm)[0]||bm;e.focus()}},0)}}function P6e(){Fg.push(document.activeElement)}function D6e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{Fg.length!==0&&(t=Fg.pop(),t.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function I6e(){Fg.length>0&&Fg.pop()}function O6e(e){bm=e,window.addEventListener?(window.addEventListener("blur",xw,!1),document.addEventListener("focus",bw,!0)):(window.attachEvent("onBlur",xw),document.attachEvent("onFocus",bw))}function R6e(){bm=null,window.addEventListener?(window.removeEventListener("blur",xw),document.removeEventListener("focus",bw)):(window.detachEvent("onBlur",xw),document.detachEvent("onFocus",bw))}var rR={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=pJ,i=n(r);function n(o){return o&&o.__esModule?o:{default:o}}function s(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return o.activeElement.shadowRoot?s(o.activeElement.shadowRoot):o.activeElement}function a(o,l){var c=(0,i.default)(o);if(!c.length){l.preventDefault();return}var u=void 0,h=l.shiftKey,d=c[0],p=c[c.length-1],f=s();if(o===f){if(!h)return;u=p}if(p===f&&!h&&(u=d),d===f&&h&&(u=p),u){l.preventDefault(),u.focus();return}var m=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),g=m!=null&&m[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(g){var v=c.indexOf(f);if(v>-1&&(v+=h?-1:1),u=c[v],typeof u>"u"){l.preventDefault(),u=h?p:d,u.focus();return}l.preventDefault(),u.focus()}}e.exports=t.default})(rR,rR.exports);var k6e=rR.exports,el={},L6e=function(){},N6e=L6e,Uo={},fJ={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=r:window.ExecutionEnvironment=r})()})(fJ);var z6e=fJ.exports;Object.defineProperty(Uo,"__esModule",{value:!0});Uo.canUseDOM=Uo.SafeNodeList=Uo.SafeHTMLCollection=void 0;var B6e=z6e,F6e=U6e(B6e);function U6e(e){return e&&e.__esModule?e:{default:e}}var DC=F6e.default,j6e=DC.canUseDOM?window.HTMLElement:{};Uo.SafeHTMLCollection=DC.canUseDOM?window.HTMLCollection:{};Uo.SafeNodeList=DC.canUseDOM?window.NodeList:{};Uo.canUseDOM=DC.canUseDOM;Uo.default=j6e;Object.defineProperty(el,"__esModule",{value:!0});el.resetState=q6e;el.log=Y6e;el.assertNodeList=mJ;el.setElement=X6e;el.validateElement=uN;el.hide=$6e;el.show=Q6e;el.documentNotReadyOrSSRTesting=K6e;var V6e=N6e,H6e=G6e(V6e),W6e=Uo;function G6e(e){return e&&e.__esModule?e:{default:e}}var Ya=null;function q6e(){Ya&&(Ya.removeAttribute?Ya.removeAttribute("aria-hidden"):Ya.length!=null?Ya.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(Ya).forEach(function(e){return e.removeAttribute("aria-hidden")})),Ya=null}function Y6e(){}function mJ(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function X6e(e){var t=e;if(typeof t=="string"&&W6e.canUseDOM){var r=document.querySelectorAll(t);mJ(r,t),t=r}return Ya=t||Ya,Ya}function uN(e){var t=e||Ya;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,H6e.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function $6e(e){var t=!0,r=!1,i=void 0;try{for(var n=uN(e)[Symbol.iterator](),s;!(t=(s=n.next()).done);t=!0){var a=s.value;a.setAttribute("aria-hidden","true")}}catch(o){r=!0,i=o}finally{try{!t&&n.return&&n.return()}finally{if(r)throw i}}}function Q6e(e){var t=!0,r=!1,i=void 0;try{for(var n=uN(e)[Symbol.iterator](),s;!(t=(s=n.next()).done);t=!0){var a=s.value;a.removeAttribute("aria-hidden")}}catch(o){r=!0,i=o}finally{try{!t&&n.return&&n.return()}finally{if(r)throw i}}}function K6e(){Ya=null}var gv={};Object.defineProperty(gv,"__esModule",{value:!0});gv.resetState=Z6e;gv.log=J6e;var p0={},f0={};function HH(e,t){e.classList.remove(t)}function Z6e(){var e=document.getElementsByTagName("html")[0];for(var t in p0)HH(e,p0[t]);var r=document.body;for(var i in f0)HH(r,f0[i]);p0={},f0={}}function J6e(){}var eHe=function(t,r){return t[r]||(t[r]=0),t[r]+=1,r},tHe=function(t,r){return t[r]&&(t[r]-=1),r},rHe=function(t,r,i){i.forEach(function(n){eHe(r,n),t.add(n)})},iHe=function(t,r,i){i.forEach(function(n){tHe(r,n),r[n]===0&&t.remove(n)})};gv.add=function(t,r){return rHe(t.classList,t.nodeName.toLowerCase()=="html"?p0:f0,r.split(" "))};gv.remove=function(t,r){return iHe(t.classList,t.nodeName.toLowerCase()=="html"?p0:f0,r.split(" "))};var vv={};Object.defineProperty(vv,"__esModule",{value:!0});vv.log=sHe;vv.resetState=aHe;function nHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var gJ=function e(){var t=this;nHe(this,e),this.register=function(r){t.openInstances.indexOf(r)===-1&&(t.openInstances.push(r),t.emit("register"))},this.deregister=function(r){var i=t.openInstances.indexOf(r);i!==-1&&(t.openInstances.splice(i,1),t.emit("deregister"))},this.subscribe=function(r){t.subscribers.push(r)},this.emit=function(r){t.subscribers.forEach(function(i){return i(r,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},jE=new gJ;function sHe(){console.log("portalOpenInstances ----------"),console.log(jE.openInstances.length),jE.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function aHe(){jE=new gJ}vv.default=jE;var hN={};Object.defineProperty(hN,"__esModule",{value:!0});hN.resetState=uHe;hN.log=hHe;var oHe=vv,lHe=cHe(oHe);function cHe(e){return e&&e.__esModule?e:{default:e}}var ns=void 0,Eo=void 0,lp=[];function uHe(){for(var e=[ns,Eo],t=0;t<e.length;t++){var r=e[t];r&&r.parentNode&&r.parentNode.removeChild(r)}ns=Eo=null,lp=[]}function hHe(){console.log("bodyTrap ----------"),console.log(lp.length);for(var e=[ns,Eo],t=0;t<e.length;t++){var r=e[t],i=r||{};console.log(i.nodeName,i.className,i.id)}console.log("edn bodyTrap ----------")}function WH(){lp.length!==0&&lp[lp.length-1].focusContent()}function dHe(e,t){!ns&&!Eo&&(ns=document.createElement("div"),ns.setAttribute("data-react-modal-body-trap",""),ns.style.position="absolute",ns.style.opacity="0",ns.setAttribute("tabindex","0"),ns.addEventListener("focus",WH),Eo=ns.cloneNode(),Eo.addEventListener("focus",WH)),lp=t,lp.length>0?(document.body.firstChild!==ns&&document.body.insertBefore(ns,document.body.firstChild),document.body.lastChild!==Eo&&document.body.appendChild(Eo)):(ns.parentElement&&ns.parentElement.removeChild(ns),Eo.parentElement&&Eo.parentElement.removeChild(Eo))}lHe.default.subscribe(dHe);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(I){for(var B=1;B<arguments.length;B++){var V=arguments[B];for(var N in V)Object.prototype.hasOwnProperty.call(V,N)&&(I[N]=V[N])}return I},i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},n=function(){function I(B,V){for(var N=0;N<V.length;N++){var L=V[N];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(B,L.key,L)}}return function(B,V,N){return V&&I(B.prototype,V),N&&I(B,N),B}}(),s=te,a=xK,o=E(a),l=Jo,c=b(l),u=k6e,h=E(u),d=el,p=b(d),f=gv,m=b(f),g=Uo,v=E(g),y=vv,w=E(y);function b(I){if(I&&I.__esModule)return I;var B={};if(I!=null)for(var V in I)Object.prototype.hasOwnProperty.call(I,V)&&(B[V]=I[V]);return B.default=I,B}function E(I){return I&&I.__esModule?I:{default:I}}function _(I,B){if(!(I instanceof B))throw new TypeError("Cannot call a class as a function")}function C(I,B){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:I}function x(I,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);I.prototype=Object.create(B&&B.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(I,B):I.__proto__=B)}var A={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},T=function(B){return B.code==="Tab"||B.keyCode===9},M=function(B){return B.code==="Escape"||B.keyCode===27},D=0,P=function(I){x(B,I);function B(V){_(this,B);var N=C(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,V));return N.setOverlayRef=function(L){N.overlay=L,N.props.overlayRef&&N.props.overlayRef(L)},N.setContentRef=function(L){N.content=L,N.props.contentRef&&N.props.contentRef(L)},N.afterClose=function(){var L=N.props,W=L.appElement,G=L.ariaHideApp,X=L.htmlOpenClassName,Q=L.bodyOpenClassName,ie=L.parentSelector,J=ie&&ie().ownerDocument||document;Q&&m.remove(J.body,Q),X&&m.remove(J.getElementsByTagName("html")[0],X),G&&D>0&&(D-=1,D===0&&p.show(W)),N.props.shouldFocusAfterRender&&(N.props.shouldReturnFocusAfterClose?(c.returnFocus(N.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),N.props.onAfterClose&&N.props.onAfterClose(),w.default.deregister(N)},N.open=function(){N.beforeOpen(),N.state.afterOpen&&N.state.beforeClose?(clearTimeout(N.closeTimer),N.setState({beforeClose:!1})):(N.props.shouldFocusAfterRender&&(c.setupScopedFocus(N.node),c.markForFocusLater()),N.setState({isOpen:!0},function(){N.openAnimationFrame=requestAnimationFrame(function(){N.setState({afterOpen:!0}),N.props.isOpen&&N.props.onAfterOpen&&N.props.onAfterOpen({overlayEl:N.overlay,contentEl:N.content})})}))},N.close=function(){N.props.closeTimeoutMS>0?N.closeWithTimeout():N.closeWithoutTimeout()},N.focusContent=function(){return N.content&&!N.contentHasFocus()&&N.content.focus({preventScroll:!0})},N.closeWithTimeout=function(){var L=Date.now()+N.props.closeTimeoutMS;N.setState({beforeClose:!0,closesAt:L},function(){N.closeTimer=setTimeout(N.closeWithoutTimeout,N.state.closesAt-Date.now())})},N.closeWithoutTimeout=function(){N.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},N.afterClose)},N.handleKeyDown=function(L){T(L)&&(0,h.default)(N.content,L),N.props.shouldCloseOnEsc&&M(L)&&(L.stopPropagation(),N.requestClose(L))},N.handleOverlayOnClick=function(L){N.shouldClose===null&&(N.shouldClose=!0),N.shouldClose&&N.props.shouldCloseOnOverlayClick&&(N.ownerHandlesClose()?N.requestClose(L):N.focusContent()),N.shouldClose=null},N.handleContentOnMouseUp=function(){N.shouldClose=!1},N.handleOverlayOnMouseDown=function(L){!N.props.shouldCloseOnOverlayClick&&L.target==N.overlay&&L.preventDefault()},N.handleContentOnClick=function(){N.shouldClose=!1},N.handleContentOnMouseDown=function(){N.shouldClose=!1},N.requestClose=function(L){return N.ownerHandlesClose()&&N.props.onRequestClose(L)},N.ownerHandlesClose=function(){return N.props.onRequestClose},N.shouldBeClosed=function(){return!N.state.isOpen&&!N.state.beforeClose},N.contentHasFocus=function(){return document.activeElement===N.content||N.content.contains(document.activeElement)},N.buildClassName=function(L,W){var G=(typeof W>"u"?"undefined":i(W))==="object"?W:{base:A[L],afterOpen:A[L]+"--after-open",beforeClose:A[L]+"--before-close"},X=G.base;return N.state.afterOpen&&(X=X+" "+G.afterOpen),N.state.beforeClose&&(X=X+" "+G.beforeClose),typeof W=="string"&&W?X+" "+W:X},N.attributesFromObject=function(L,W){return Object.keys(W).reduce(function(G,X){return G[L+"-"+X]=W[X],G},{})},N.state={afterOpen:!1,beforeClose:!1},N.shouldClose=null,N.moveFromContentToOverlay=null,N}return n(B,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(N,L){this.props.isOpen&&!N.isOpen?this.open():!this.props.isOpen&&N.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!L.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var N=this.props,L=N.appElement,W=N.ariaHideApp,G=N.htmlOpenClassName,X=N.bodyOpenClassName,Q=N.parentSelector,ie=Q&&Q().ownerDocument||document;X&&m.add(ie.body,X),G&&m.add(ie.getElementsByTagName("html")[0],G),W&&(D+=1,p.hide(L)),w.default.register(this)}},{key:"render",value:function(){var N=this.props,L=N.id,W=N.className,G=N.overlayClassName,X=N.defaultStyles,Q=N.children,ie=W?{}:X.content,J=G?{}:X.overlay;if(this.shouldBeClosed())return null;var se={ref:this.setOverlayRef,className:this.buildClassName("overlay",G),style:r({},J,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},ee=r({id:L,ref:this.setContentRef,style:r({},ie,this.props.style.content),className:this.buildClassName("content",W),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",r({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),ue=this.props.contentElement(ee,Q);return this.props.overlayElement(se,ue)}}]),B}(s.Component);P.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},P.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(v.default),o.default.instanceOf(g.SafeHTMLCollection),o.default.instanceOf(g.SafeNodeList),o.default.arrayOf(o.default.instanceOf(v.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},t.default=P,e.exports=t.default})(JO,JO.exports);var pHe=JO.exports;function vJ(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function yJ(e){function t(r){var i=this.constructor.getDerivedStateFromProps(e,r);return i??null}this.setState(t.bind(this))}function wJ(e,t){try{var r=this.props,i=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,i)}finally{this.props=r,this.state=i}}vJ.__suppressDeprecationWarning=!0;yJ.__suppressDeprecationWarning=!0;wJ.__suppressDeprecationWarning=!0;function fHe(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,i=null,n=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?i="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(i="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?n="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(n="UNSAFE_componentWillUpdate"),r!==null||i!==null||n!==null){var s=e.displayName||e.name,a=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+a+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(i!==null?`
  `+i:"")+(n!==null?`
  `+n:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=vJ,t.componentWillReceiveProps=yJ),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=wJ;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,u,h){var d=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:h;o.call(this,c,u,d)}}return e}const mHe=Object.freeze(Object.defineProperty({__proto__:null,polyfill:fHe},Symbol.toStringTag,{value:"Module"})),gHe=oW(mHe);Object.defineProperty(Lp,"__esModule",{value:!0});Lp.bodyOpenClassName=Lp.portalClassName=void 0;var GH=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},vHe=function(){function e(t,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),xJ=te,VE=px(xJ),yHe=Mw,HE=px(yHe),wHe=xK,Ht=px(wHe),xHe=pHe,qH=px(xHe),bHe=el,_He=EHe(bHe),wh=Uo,YH=px(wh),SHe=gHe;function EHe(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function px(e){return e&&e.__esModule?e:{default:e}}function THe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XH(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function CHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var AHe=Lp.portalClassName="ReactModalPortal",MHe=Lp.bodyOpenClassName="ReactModal__Body--open",Cd=wh.canUseDOM&&HE.default.createPortal!==void 0,$H=function(t){return document.createElement(t)},QH=function(){return Cd?HE.default.createPortal:HE.default.unstable_renderSubtreeIntoContainer};function Cb(e){return e()}var fx=function(e){CHe(t,e);function t(){var r,i,n,s;THe(this,t);for(var a=arguments.length,o=Array(a),l=0;l<a;l++)o[l]=arguments[l];return s=(i=(n=XH(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(o))),n),n.removePortal=function(){!Cd&&HE.default.unmountComponentAtNode(n.node);var c=Cb(n.props.parentSelector);c&&c.contains(n.node)?c.removeChild(n.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},n.portalRef=function(c){n.portal=c},n.renderPortal=function(c){var u=QH(),h=u(n,VE.default.createElement(qH.default,GH({defaultStyles:t.defaultStyles},c)),n.node);n.portalRef(h)},i),XH(n,s)}return vHe(t,[{key:"componentDidMount",value:function(){if(wh.canUseDOM){Cd||(this.node=$H("div")),this.node.className=this.props.portalClassName;var i=Cb(this.props.parentSelector);i.appendChild(this.node),!Cd&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(i){var n=Cb(i.parentSelector),s=Cb(this.props.parentSelector);return{prevParent:n,nextParent:s}}},{key:"componentDidUpdate",value:function(i,n,s){if(wh.canUseDOM){var a=this.props,o=a.isOpen,l=a.portalClassName;i.portalClassName!==l&&(this.node.className=l);var c=s.prevParent,u=s.nextParent;u!==c&&(c.removeChild(this.node),u.appendChild(this.node)),!(!i.isOpen&&!o)&&!Cd&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!wh.canUseDOM||!this.node||!this.portal)){var i=this.portal.state,n=Date.now(),s=i.isOpen&&this.props.closeTimeoutMS&&(i.closesAt||n+this.props.closeTimeoutMS);s?(i.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,s-n)):this.removePortal()}}},{key:"render",value:function(){if(!wh.canUseDOM||!Cd)return null;!this.node&&Cd&&(this.node=$H("div"));var i=QH();return i(VE.default.createElement(qH.default,GH({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(i){_He.setElement(i)}}]),t}(xJ.Component);fx.propTypes={isOpen:Ht.default.bool.isRequired,style:Ht.default.shape({content:Ht.default.object,overlay:Ht.default.object}),portalClassName:Ht.default.string,bodyOpenClassName:Ht.default.string,htmlOpenClassName:Ht.default.string,className:Ht.default.oneOfType([Ht.default.string,Ht.default.shape({base:Ht.default.string.isRequired,afterOpen:Ht.default.string.isRequired,beforeClose:Ht.default.string.isRequired})]),overlayClassName:Ht.default.oneOfType([Ht.default.string,Ht.default.shape({base:Ht.default.string.isRequired,afterOpen:Ht.default.string.isRequired,beforeClose:Ht.default.string.isRequired})]),appElement:Ht.default.oneOfType([Ht.default.instanceOf(YH.default),Ht.default.instanceOf(wh.SafeHTMLCollection),Ht.default.instanceOf(wh.SafeNodeList),Ht.default.arrayOf(Ht.default.instanceOf(YH.default))]),onAfterOpen:Ht.default.func,onRequestClose:Ht.default.func,closeTimeoutMS:Ht.default.number,ariaHideApp:Ht.default.bool,shouldFocusAfterRender:Ht.default.bool,shouldCloseOnOverlayClick:Ht.default.bool,shouldReturnFocusAfterClose:Ht.default.bool,preventScroll:Ht.default.bool,parentSelector:Ht.default.func,aria:Ht.default.object,data:Ht.default.object,role:Ht.default.string,contentLabel:Ht.default.string,shouldCloseOnEsc:Ht.default.bool,overlayRef:Ht.default.func,contentRef:Ht.default.func,id:Ht.default.string,overlayElement:Ht.default.func,contentElement:Ht.default.func};fx.defaultProps={isOpen:!1,portalClassName:AHe,bodyOpenClassName:MHe,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,r){return VE.default.createElement("div",t,r)},contentElement:function(t,r){return VE.default.createElement("div",t,r)}};fx.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,SHe.polyfill)(fx);Lp.default=fx;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Lp,i=n(r);function n(s){return s&&s.__esModule?s:{default:s}}t.default=i.default,e.exports=t.default})(ZO,ZO.exports);var PHe=ZO.exports;const DHe=Ug(PHe),IHe={backgroundImage:`url(${v6e.src})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},OHe=[{id:1,name:"Nazarene Eroa",text:"The Smooth ang transaction dito tapos ang ganda ng experience. Highly recommended!",img:y6e,commentImg:x6e},{id:2,name:"James",text:"YoloTravelerAsia made planning my trip to Asia effortless with its stunning visuals and seamless booking process. Highly recommended!",img:w6e,commentImg:b6e},{id:3,name:"Jessica",text:"The personalized service and diverse travel packages on YoloTravelerAsia ensured my vacation was unforgettable. Fantastic experience!",img:"https://picsum.photos/103/103",commentImg:_6e},{id:4,name:"Chazzy",text:"Exploring Asia with YoloTravelerAsia was a breeze. The site’s user-friendly design and beautiful destinations made my trip planning enjoyable and easy.",img:"https://picsum.photos/104/104",commentImg:S6e}],RHe=()=>{const[e,t]=te.useState(!1),[r,i]=te.useState(null),n=o=>{i(o),t(!0)},s=()=>{t(!1)},a={dots:!0,arrows:!1,infinite:!0,speed:500,slidesToScroll:1,autoplay:!0,autoplaySpeed:2e3,cssEase:"linear",pauseOnHover:!0,pauseOnFocus:!0,responsive:[{breakpoint:1e4,settings:{slidesToShow:3,slidesToScroll:1,infinite:!0}},{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0}},{breakpoint:640,settings:{slidesToShow:1,slidesToScroll:1}}]};return k.jsxs("div",{style:{...IHe,height:"420px",overflow:"hidden"},children:[k.jsx("div",{className:"bg-[#e4e3e3] text-[#008080] h-full p-7",children:k.jsxs("div",{className:"container h-full flex flex-col justify-center","data-aos":"fade-up",children:[k.jsx("div",{className:"text-center mb-4",children:k.jsx("h1",{className:"text-2xl font-bold",children:"Testimonials"})}),k.jsx("div",{children:k.jsx(g6e,{...a,children:OHe.map(({id:o,name:l,text:c,img:u,commentImg:h})=>k.jsx("div",{className:"my-2",children:k.jsxs("div",{className:"flex flex-col gap-4 shadow-lg py-6 px-5 mx-2 rounded-3xl bg-gray-300 text-dark relative",children:[k.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h&&k.jsx("img",{src:h,alt:"comment",className:"w-52 h-28 object-cover rounded-md cursor-pointer",onClick:()=>n(h)}),k.jsx("p",{className:"text-sm text-center",children:c})]}),k.jsxs("div",{className:"flex items-center gap-3",children:[k.jsx("img",{src:u,alt:l,className:"rounded-full w-16 h-16 object-cover"}),k.jsxs("div",{className:"space-y-1",children:[k.jsx("h1",{className:"text-sm font-bold dark:text-primary font-cursive",children:l}),k.jsx("p",{className:"text-xs font-bold text-white",children:"Developer"})]})]})]})},o))})})]})}),k.jsxs(DHe,{isOpen:e,onRequestClose:s,contentLabel:"Image Modal",className:"modal",overlayClassName:"overlay",children:[k.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-white text-2xl",children:"×"}),k.jsx("img",{src:r,alt:"Selected",className:"w-full h-auto"})]}),k.jsx("style",{jsx:!0,children:`
        .modal {
          position: relative;
          width: 80%;
          max-width: 600px;
          margin: 100px auto;
          background: #fff;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
          
        }

        .overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.75);
          
        }

        .modal img {
          max-width: 100%;
          border-radius: 10px;
         
    
        }

        .modal button {
          background: none;
          border: none;
          font-size: 2rem;
          color: #333;
          cursor: pointer;
        }
      `})]})};function kHe(e){return rc({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"},child:[]}]})(e)}function LHe(e){return rc({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"},child:[]}]})(e)}function NHe(e){return rc({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19.3 16.9c.4-.7.7-1.5.7-2.4 0-2.5-2-4.5-4.5-4.5S11 12 11 14.5s2 4.5 4.5 4.5c.9 0 1.7-.3 2.4-.7l3.2 3.2 1.4-1.4-3.2-3.2zm-3.8.1c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zM12 20v2C6.48 22 2 17.52 2 12S6.48 2 12 2c4.84 0 8.87 3.44 9.8 8h-2.07A8 8 0 0 0 15 4.59V5c0 1.1-.9 2-2 2h-2v2c0 .55-.45 1-1 1H8v2h2v3H9l-4.79-4.79C4.08 10.79 4 11.38 4 12c0 4.41 3.59 8 8 8z"},child:[]}]})(e)}const zHe=()=>k.jsxs("div",{className:"bg-black text-white",children:[k.jsx("div",{className:"bg-[#dad9d9] text-[#008080]",children:k.jsxs("div",{"data-aos":"fade-up",className:"container mx-auto text-center py-6 lg:py-10 text-lg lg:text-2xl font-bold space-y-2",children:[k.jsx("p",{className:"uppercase",children:"We are ready to take your booking 24/7"}),k.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"(042)731-1638"})]})}),k.jsxs("div",{"data-aos":"fade-up",className:"container mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-12 py-6 md:py-12",children:[k.jsxs("div",{className:"space-y-4",children:[k.jsx("h1",{className:"text-xl lg:text-2xl py-3 font-bold uppercase border-b-4 border-[#ff6809]",children:"About"}),k.jsx("p",{className:"text-sm lg:text-base",children:"Our team is committed to providing personalized services to ensure your journey is seamless and enjoyable. Whether you are looking for adventure, relaxation, or cultural exploration, we have the perfect trip for you."})]}),k.jsxs("div",{className:"space-y-4",children:[k.jsx("h1",{className:"text-xl lg:text-2xl py-3 font-bold uppercase border-b-4 border-[#ff6809]",children:"Contact"}),k.jsxs("div",{className:"flex items-start gap-4 text-sm lg:text-base",children:[k.jsx(_2e,{className:"text-xl lg:text-2xl"}),k.jsx("p",{children:"San Diego Poblacion, Gumaca, Philippines, 4307"})]}),k.jsxs("div",{className:"flex items-start gap-4 text-sm lg:text-base",children:[k.jsx(kHe,{className:"text-xl lg:text-2xl"}),k.jsx("p",{children:"(042)731-1638"})]}),k.jsxs("div",{className:"flex items-start gap-4 text-sm lg:text-base",children:[k.jsx(LHe,{className:"text-xl lg:text-2xl"}),k.jsx("p",{children:"yolotravelerasia@gmail.com"})]}),k.jsxs("div",{className:"flex items-start gap-4 text-lg lg:text-base",children:[k.jsx(x2e,{}),k.jsx("a",{href:"https://www.facebook.com/people/Yolotravelerasia/100065144013518/",children:"  Yolotravelerasia"})]})]})]}),k.jsx("p",{className:"text-center py-4 text-xs lg:text-sm",children:"© 2024 Yolo Traveler. All rights reserved."})]}),BHe=()=>{const[e,t]=te.useState(""),[r,i]=te.useState(""),[n,s]=te.useState(""),[a,o]=te.useState(""),[l,c]=te.useState(""),[u,h]=te.useState(null),[d,p]=te.useState([]),[f,m]=te.useState(["Boracay","Palawan","Bohol","Mayon"]),[g,v]=te.useState(null),[y,w]=te.useState(""),[b,E]=te.useState(""),[_,C]=te.useState(""),[x,A]=te.useState(""),[T,M]=te.useState([""]),[D,P]=te.useState([""]),[I,B]=te.useState([""]);te.useState("");const[V,N]=te.useState(""),[L,W]=te.useState([""]),[G,X]=te.useState("");te.useEffect(()=>{Le()},[]);const Q=pe=>{X(pe)},ie=pe=>{v(pe.id),w(pe.name),E(pe.price.toString()),C(pe.category),A(pe.description),M(pe.inputs||[""]),B(pe.datesAvailable||[""]),N(pe.goodForStocks||""),W(pe.placesToVisit||"")},J=(pe,q)=>{const j=[...T];j[pe]=q,M(j)},se=()=>{M([...T,""])},ee=pe=>{const q=[...T];q.splice(pe,1),M(q)},ue=(pe,q)=>{const j=[...D];j[pe]=q,P(j)},oe=()=>{P([...D,""])},le=pe=>{const q=[...D];q.splice(pe,1),P(q)},de=(pe,q)=>{const j=[...I];j[pe]=q,B(j)},xe=()=>{B([...I,""])},_e=pe=>{const q=[...I];q.splice(pe,1),B(q)},Se=async()=>{try{const pe={name:y,price:parseFloat(b),category:_,description:x,inputs:T,datesAvailable:I,goodForStocks:parseInt(V),placesToVisit:L,note:G};await kL(Ql(Jr,"Package",g),pe),console.log("Item updated successfully"),v(null),w(""),E(""),C(""),A(""),N(""),W(""),M([""]),B([""]),Le()}catch(pe){console.error("Error updating item:",pe)}},Le=async()=>{try{const pe=await Kl(hs(Jr,"Package")),q=[];pe.forEach(j=>{q.push({id:j.id,...j.data()})}),p(q)}catch(pe){console.error("Error fetching items:",pe)}},Oe=pe=>{const q=pe.target.files[0];h(q)},Ye=async pe=>{try{const q=fK(mK,"images/"+pe.name),j=await dK(q,pe);return await pK(j.ref)}catch(q){throw console.error("Error uploading image:",q),q}},$e=async()=>{try{if(!e||!r||!n&&!a||!l||!u||!D){alert("Please fill out all required fields");return}const pe=await Ye(u),q=a||n,j={name:e,price:parseFloat(r),category:q,description:l,imageUrl:pe,inputs:T,datesAvailable:D,goodForStocks:parseInt(V),placesToVisit:L,note:G};await ip(hs(Jr,"Package"),j),console.log("Item added successfully to the database"),a&&(m([...f,a]),o("")),t(""),i(""),s(""),c(""),N(""),W("");const ve=document.getElementById("file-input");ve&&(ve.value=""),M([""]),P([""]),Le()}catch(pe){console.error("Error adding item:",pe)}},He=async pe=>{try{await aC(Ql(Jr,"Package",pe)),console.log("Item deleted successfully"),Le()}catch(q){console.error("Error deleting item:",q)}},je=()=>g!==null?k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold mb-2",children:"Dates Available"}),I.map((pe,q)=>k.jsxs("div",{className:"flex items-center mb-2",children:[k.jsx("input",{type:"date",value:pe,min:new Date().toISOString().split("T")[0],onChange:j=>de(q,j.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mr-2"}),q===I.length-1&&k.jsx("button",{onClick:xe,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded",children:"+ Add Date"}),q!==I.length-1&&k.jsx("button",{onClick:()=>_e(q),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"- Remove Date"})]},q))]}):k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold mb-2",children:"Dates Available"}),D.map((pe,q)=>k.jsxs("div",{className:"flex items-center mb-2",children:[k.jsx("input",{type:"date",value:pe,min:new Date().toISOString().split("T")[0],onChange:j=>ue(q,j.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mr-2"}),q===D.length-1&&k.jsx("button",{onClick:oe,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded",children:"+ Add Date"}),q!==D.length-1&&k.jsx("button",{onClick:()=>le(q),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"- Remove Date"})]},q))]}),lt=()=>k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold mb-2",children:"Highlights"}),T.map((pe,q)=>k.jsxs("div",{className:"flex items-center mb-2",children:[k.jsx("input",{type:"text",value:pe,onChange:j=>J(q,j.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mr-2",placeholder:"Input field"}),q===T.length-1&&k.jsx("button",{onClick:se,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded",children:"+ Add Highlights"}),q!==T.length-1&&k.jsx("button",{onClick:()=>ee(q),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"- Remove Highlights"})]},q))]});return k.jsxs("div",{className:"package-management    ml-12 ",children:[k.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Package Management"}),k.jsxs("div",{className:"mb-4",children:[k.jsx("h2",{className:"text-xl font-bold mb-2",children:"Add Item"}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Name:"}),k.jsx("input",{type:"text",value:e,onChange:pe=>t(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Price:"}),k.jsx("input",{type:"number",value:r,onChange:pe=>i(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Category:"}),k.jsxs("div",{className:"flex",children:[k.jsxs("select",{value:n,onChange:pe=>s(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mr-2",children:[k.jsx("option",{value:"",children:"Select a category"}),f.map(pe=>k.jsx("option",{value:pe,children:pe},pe))]}),k.jsx("input",{type:"text",placeholder:"Add new category",value:a,onChange:pe=>o(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Description:"}),k.jsx("textarea",{value:l,onChange:pe=>c(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Image:"}),k.jsx("input",{id:"file-input",type:"file",onChange:Oe,className:"border border-gray-300 rounded-md py-1 px-2"})]}),je(),lt(),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Good For Stocks:"}),k.jsx("input",{type:"number",value:V,onChange:pe=>N(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Places to Visit:"}),k.jsx("textarea",{value:L,onChange:pe=>W(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Note:"}),k.jsx("textarea",{value:G,onChange:pe=>Q(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsx("button",{onClick:$e,className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Add Item"})]}),k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-2",children:"Items"}),d.map(pe=>k.jsx("div",{className:"border border-gray-300 rounded-md p-4 mb-2",children:k.jsxs("div",{className:"flex justify-between items-center",children:[k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold mb-1",children:pe.name}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Price: $",pe.price]}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Category: ",pe.category]}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Description: ",pe.description]}),pe.imageUrl&&k.jsx("img",{src:pe.imageUrl,alt:pe.name,className:"w-20 h-20 object-cover mb-1"}),pe.datesAvailable&&k.jsxs("div",{children:[k.jsx("h4",{className:"font-bold",children:"Dates Available:"}),k.jsx("ul",{children:pe.datesAvailable.map((q,j)=>k.jsx("li",{children:q},j))})]}),pe.inputs&&k.jsxs("div",{children:[k.jsx("h4",{className:"font-bold",children:"Highlights :"}),k.jsx("ul",{children:pe.inputs.map((q,j)=>k.jsx("li",{children:q},j))})]}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Good For Stocks: ",pe.goodForStocks]}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Places to Visit: ",pe.placesToVisit]}),k.jsxs("p",{className:"text-gray-700 mb-1",children:["Note: ",pe.note]})]}),k.jsxs("div",{children:[k.jsx("button",{onClick:()=>ie(pe),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded mr-2",children:"Edit"}),k.jsx("button",{onClick:()=>He(pe.id),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded",children:"Delete"})]})]})},pe.id))]}),g&&k.jsxs("div",{className:"mt-4",children:[k.jsx("h2",{className:"text-xl font-bold mb-2",children:"Edit Item"}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Name:"}),k.jsx("input",{type:"text",value:y,onChange:pe=>w(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Price:"}),k.jsx("input",{type:"number",value:b,onChange:pe=>E(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Category:"}),k.jsxs("div",{className:"flex",children:[k.jsxs("select",{value:_,onChange:pe=>C(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2 mr-2",children:[k.jsx("option",{value:"",children:"Select a category"}),f.map(pe=>k.jsx("option",{value:pe,children:pe},pe))]}),k.jsx("input",{type:"text",placeholder:"Add new category",value:_,onChange:pe=>setEditNewCategory(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Item Description:"}),k.jsx("textarea",{value:x,onChange:pe=>A(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Image:"}),k.jsx("input",{id:"file-input",type:"file",onChange:Oe,className:"border border-gray-300 rounded-md py-1 px-2"})]}),je(),lt(),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Good For Stocks:"}),k.jsx("input",{type:"number",value:V,onChange:pe=>N(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Places to Visit:"}),k.jsx("textarea",{value:L,onChange:pe=>SetPlacesToVisit(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsxs("div",{className:"mb-2",children:[k.jsx("label",{className:"block font-bold mb-1",children:"Note:"}),k.jsx("textarea",{value:G,onChange:pe=>X(pe.target.value),className:"border border-gray-300 rounded-md py-1 px-2"})]}),k.jsx("button",{onClick:Se,className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Update Item"})]})]})};function KH(e){return e!==null&&typeof e=="object"&&"constructor"in e&&e.constructor===Object}function dN(e,t){e===void 0&&(e={}),t===void 0&&(t={}),Object.keys(t).forEach(r=>{typeof e[r]>"u"?e[r]=t[r]:KH(t[r])&&KH(e[r])&&Object.keys(t[r]).length>0&&dN(e[r],t[r])})}const bJ={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function ru(){const e=typeof document<"u"?document:{};return dN(e,bJ),e}const FHe={document:bJ,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(e){return typeof setTimeout>"u"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout>"u"||clearTimeout(e)}};function Ia(){const e=typeof window<"u"?window:{};return dN(e,FHe),e}function UHe(e){return e===void 0&&(e=""),e.trim().split(" ").filter(t=>!!t.trim())}function jHe(e){const t=e;Object.keys(t).forEach(r=>{try{t[r]=null}catch{}try{delete t[r]}catch{}})}function iR(e,t){return t===void 0&&(t=0),setTimeout(e,t)}function WE(){return Date.now()}function VHe(e){const t=Ia();let r;return t.getComputedStyle&&(r=t.getComputedStyle(e,null)),!r&&e.currentStyle&&(r=e.currentStyle),r||(r=e.style),r}function HHe(e,t){t===void 0&&(t="x");const r=Ia();let i,n,s;const a=VHe(e);return r.WebKitCSSMatrix?(n=a.transform||a.webkitTransform,n.split(",").length>6&&(n=n.split(", ").map(o=>o.replace(",",".")).join(", ")),s=new r.WebKitCSSMatrix(n==="none"?"":n)):(s=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=s.toString().split(",")),t==="x"&&(r.WebKitCSSMatrix?n=s.m41:i.length===16?n=parseFloat(i[12]):n=parseFloat(i[4])),t==="y"&&(r.WebKitCSSMatrix?n=s.m42:i.length===16?n=parseFloat(i[13]):n=parseFloat(i[5])),n||0}function Ab(e){return typeof e=="object"&&e!==null&&e.constructor&&Object.prototype.toString.call(e).slice(8,-1)==="Object"}function WHe(e){return typeof window<"u"&&typeof window.HTMLElement<"u"?e instanceof HTMLElement:e&&(e.nodeType===1||e.nodeType===11)}function va(){const e=Object(arguments.length<=0?void 0:arguments[0]),t=["__proto__","constructor","prototype"];for(let r=1;r<arguments.length;r+=1){const i=r<0||arguments.length<=r?void 0:arguments[r];if(i!=null&&!WHe(i)){const n=Object.keys(Object(i)).filter(s=>t.indexOf(s)<0);for(let s=0,a=n.length;s<a;s+=1){const o=n[s],l=Object.getOwnPropertyDescriptor(i,o);l!==void 0&&l.enumerable&&(Ab(e[o])&&Ab(i[o])?i[o].__swiper__?e[o]=i[o]:va(e[o],i[o]):!Ab(e[o])&&Ab(i[o])?(e[o]={},i[o].__swiper__?e[o]=i[o]:va(e[o],i[o])):e[o]=i[o])}}}return e}function Mb(e,t,r){e.style.setProperty(t,r)}function _J(e){let{swiper:t,targetPosition:r,side:i}=e;const n=Ia(),s=-t.translate;let a=null,o;const l=t.params.speed;t.wrapperEl.style.scrollSnapType="none",n.cancelAnimationFrame(t.cssModeFrameID);const c=r>s?"next":"prev",u=(d,p)=>c==="next"&&d>=p||c==="prev"&&d<=p,h=()=>{o=new Date().getTime(),a===null&&(a=o);const d=Math.max(Math.min((o-a)/l,1),0),p=.5-Math.cos(d*Math.PI)/2;let f=s+p*(r-s);if(u(f,r)&&(f=r),t.wrapperEl.scrollTo({[i]:f}),u(f,r)){t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.scrollSnapType="",setTimeout(()=>{t.wrapperEl.style.overflow="",t.wrapperEl.scrollTo({[i]:f})}),n.cancelAnimationFrame(t.cssModeFrameID);return}t.cssModeFrameID=n.requestAnimationFrame(h)};h()}function pN(e){return e.querySelector(".swiper-slide-transform")||e.shadowRoot&&e.shadowRoot.querySelector(".swiper-slide-transform")||e}function Il(e,t){return t===void 0&&(t=""),[...e.children].filter(r=>r.matches(t))}function GE(e){try{console.warn(e);return}catch{}}function _w(e,t){t===void 0&&(t=[]);const r=document.createElement(e);return r.classList.add(...Array.isArray(t)?t:UHe(t)),r}function GHe(e,t){const r=[];for(;e.previousElementSibling;){const i=e.previousElementSibling;t?i.matches(t)&&r.push(i):r.push(i),e=i}return r}function qHe(e,t){const r=[];for(;e.nextElementSibling;){const i=e.nextElementSibling;t?i.matches(t)&&r.push(i):r.push(i),e=i}return r}function xh(e,t){return Ia().getComputedStyle(e,null).getPropertyValue(t)}function ZH(e){let t=e,r;if(t){for(r=0;(t=t.previousSibling)!==null;)t.nodeType===1&&(r+=1);return r}}function YHe(e,t){const r=[];let i=e.parentElement;for(;i;)t?i.matches(t)&&r.push(i):r.push(i),i=i.parentElement;return r}function JH(e,t,r){const i=Ia();return r?e[t==="width"?"offsetWidth":"offsetHeight"]+parseFloat(i.getComputedStyle(e,null).getPropertyValue(t==="width"?"margin-right":"margin-top"))+parseFloat(i.getComputedStyle(e,null).getPropertyValue(t==="width"?"margin-left":"margin-bottom")):e.offsetWidth}function yc(e){return(Array.isArray(e)?e:[e]).filter(t=>!!t)}let KP;function XHe(){const e=Ia(),t=ru();return{smoothScroll:t.documentElement&&t.documentElement.style&&"scrollBehavior"in t.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch)}}function SJ(){return KP||(KP=XHe()),KP}let ZP;function $He(e){let{userAgent:t}=e===void 0?{}:e;const r=SJ(),i=Ia(),n=i.navigator.platform,s=t||i.navigator.userAgent,a={ios:!1,android:!1},o=i.screen.width,l=i.screen.height,c=s.match(/(Android);?[\s\/]+([\d.]+)?/);let u=s.match(/(iPad).*OS\s([\d_]+)/);const h=s.match(/(iPod)(.*OS\s([\d_]+))?/),d=!u&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),p=n==="Win32";let f=n==="MacIntel";const m=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!u&&f&&r.touch&&m.indexOf(`${o}x${l}`)>=0&&(u=s.match(/(Version)\/([\d.]+)/),u||(u=[0,1,"13_0_0"]),f=!1),c&&!p&&(a.os="android",a.android=!0),(u||d||h)&&(a.os="ios",a.ios=!0),a}function EJ(e){return e===void 0&&(e={}),ZP||(ZP=$He(e)),ZP}let JP;function QHe(){const e=Ia(),t=EJ();let r=!1;function i(){const o=e.navigator.userAgent.toLowerCase();return o.indexOf("safari")>=0&&o.indexOf("chrome")<0&&o.indexOf("android")<0}if(i()){const o=String(e.navigator.userAgent);if(o.includes("Version/")){const[l,c]=o.split("Version/")[1].split(" ")[0].split(".").map(u=>Number(u));r=l<16||l===16&&c<2}}const n=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),s=i(),a=s||n&&t.ios;return{isSafari:r||s,needPerspectiveFix:r,need3dFix:a,isWebView:n}}function KHe(){return JP||(JP=QHe()),JP}function ZHe(e){let{swiper:t,on:r,emit:i}=e;const n=Ia();let s=null,a=null;const o=()=>{!t||t.destroyed||!t.initialized||(i("beforeResize"),i("resize"))},l=()=>{!t||t.destroyed||!t.initialized||(s=new ResizeObserver(h=>{a=n.requestAnimationFrame(()=>{const{width:d,height:p}=t;let f=d,m=p;h.forEach(g=>{let{contentBoxSize:v,contentRect:y,target:w}=g;w&&w!==t.el||(f=y?y.width:(v[0]||v).inlineSize,m=y?y.height:(v[0]||v).blockSize)}),(f!==d||m!==p)&&o()})}),s.observe(t.el))},c=()=>{a&&n.cancelAnimationFrame(a),s&&s.unobserve&&t.el&&(s.unobserve(t.el),s=null)},u=()=>{!t||t.destroyed||!t.initialized||i("orientationchange")};r("init",()=>{if(t.params.resizeObserver&&typeof n.ResizeObserver<"u"){l();return}n.addEventListener("resize",o),n.addEventListener("orientationchange",u)}),r("destroy",()=>{c(),n.removeEventListener("resize",o),n.removeEventListener("orientationchange",u)})}function JHe(e){let{swiper:t,extendParams:r,on:i,emit:n}=e;const s=[],a=Ia(),o=function(u,h){h===void 0&&(h={});const d=a.MutationObserver||a.WebkitMutationObserver,p=new d(f=>{if(t.__preventObserver__)return;if(f.length===1){n("observerUpdate",f[0]);return}const m=function(){n("observerUpdate",f[0])};a.requestAnimationFrame?a.requestAnimationFrame(m):a.setTimeout(m,0)});p.observe(u,{attributes:typeof h.attributes>"u"?!0:h.attributes,childList:typeof h.childList>"u"?!0:h.childList,characterData:typeof h.characterData>"u"?!0:h.characterData}),s.push(p)},l=()=>{if(t.params.observer){if(t.params.observeParents){const u=YHe(t.hostEl);for(let h=0;h<u.length;h+=1)o(u[h])}o(t.hostEl,{childList:t.params.observeSlideChildren}),o(t.wrapperEl,{attributes:!1})}},c=()=>{s.forEach(u=>{u.disconnect()}),s.splice(0,s.length)};r({observer:!1,observeParents:!1,observeSlideChildren:!1}),i("init",l),i("destroy",c)}var eWe={on(e,t,r){const i=this;if(!i.eventsListeners||i.destroyed||typeof t!="function")return i;const n=r?"unshift":"push";return e.split(" ").forEach(s=>{i.eventsListeners[s]||(i.eventsListeners[s]=[]),i.eventsListeners[s][n](t)}),i},once(e,t,r){const i=this;if(!i.eventsListeners||i.destroyed||typeof t!="function")return i;function n(){i.off(e,n),n.__emitterProxy&&delete n.__emitterProxy;for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];t.apply(i,a)}return n.__emitterProxy=t,i.on(e,n,r)},onAny(e,t){const r=this;if(!r.eventsListeners||r.destroyed||typeof e!="function")return r;const i=t?"unshift":"push";return r.eventsAnyListeners.indexOf(e)<0&&r.eventsAnyListeners[i](e),r},offAny(e){const t=this;if(!t.eventsListeners||t.destroyed||!t.eventsAnyListeners)return t;const r=t.eventsAnyListeners.indexOf(e);return r>=0&&t.eventsAnyListeners.splice(r,1),t},off(e,t){const r=this;return!r.eventsListeners||r.destroyed||!r.eventsListeners||e.split(" ").forEach(i=>{typeof t>"u"?r.eventsListeners[i]=[]:r.eventsListeners[i]&&r.eventsListeners[i].forEach((n,s)=>{(n===t||n.__emitterProxy&&n.__emitterProxy===t)&&r.eventsListeners[i].splice(s,1)})}),r},emit(){const e=this;if(!e.eventsListeners||e.destroyed||!e.eventsListeners)return e;let t,r,i;for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return typeof s[0]=="string"||Array.isArray(s[0])?(t=s[0],r=s.slice(1,s.length),i=e):(t=s[0].events,r=s[0].data,i=s[0].context||e),r.unshift(i),(Array.isArray(t)?t:t.split(" ")).forEach(l=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach(c=>{c.apply(i,[l,...r])}),e.eventsListeners&&e.eventsListeners[l]&&e.eventsListeners[l].forEach(c=>{c.apply(i,r)})}),e}};function tWe(){const e=this;let t,r;const i=e.el;typeof e.params.width<"u"&&e.params.width!==null?t=e.params.width:t=i.clientWidth,typeof e.params.height<"u"&&e.params.height!==null?r=e.params.height:r=i.clientHeight,!(t===0&&e.isHorizontal()||r===0&&e.isVertical())&&(t=t-parseInt(xh(i,"padding-left")||0,10)-parseInt(xh(i,"padding-right")||0,10),r=r-parseInt(xh(i,"padding-top")||0,10)-parseInt(xh(i,"padding-bottom")||0,10),Number.isNaN(t)&&(t=0),Number.isNaN(r)&&(r=0),Object.assign(e,{width:t,height:r,size:e.isHorizontal()?t:r}))}function rWe(){const e=this;function t(T,M){return parseFloat(T.getPropertyValue(e.getDirectionLabel(M))||0)}const r=e.params,{wrapperEl:i,slidesEl:n,size:s,rtlTranslate:a,wrongRTL:o}=e,l=e.virtual&&r.virtual.enabled,c=l?e.virtual.slides.length:e.slides.length,u=Il(n,`.${e.params.slideClass}, swiper-slide`),h=l?e.virtual.slides.length:u.length;let d=[];const p=[],f=[];let m=r.slidesOffsetBefore;typeof m=="function"&&(m=r.slidesOffsetBefore.call(e));let g=r.slidesOffsetAfter;typeof g=="function"&&(g=r.slidesOffsetAfter.call(e));const v=e.snapGrid.length,y=e.slidesGrid.length;let w=r.spaceBetween,b=-m,E=0,_=0;if(typeof s>"u")return;typeof w=="string"&&w.indexOf("%")>=0?w=parseFloat(w.replace("%",""))/100*s:typeof w=="string"&&(w=parseFloat(w)),e.virtualSize=-w,u.forEach(T=>{a?T.style.marginLeft="":T.style.marginRight="",T.style.marginBottom="",T.style.marginTop=""}),r.centeredSlides&&r.cssMode&&(Mb(i,"--swiper-centered-offset-before",""),Mb(i,"--swiper-centered-offset-after",""));const C=r.grid&&r.grid.rows>1&&e.grid;C?e.grid.initSlides(u):e.grid&&e.grid.unsetSlides();let x;const A=r.slidesPerView==="auto"&&r.breakpoints&&Object.keys(r.breakpoints).filter(T=>typeof r.breakpoints[T].slidesPerView<"u").length>0;for(let T=0;T<h;T+=1){x=0;let M;if(u[T]&&(M=u[T]),C&&e.grid.updateSlide(T,M,u),!(u[T]&&xh(M,"display")==="none")){if(r.slidesPerView==="auto"){A&&(u[T].style[e.getDirectionLabel("width")]="");const D=getComputedStyle(M),P=M.style.transform,I=M.style.webkitTransform;if(P&&(M.style.transform="none"),I&&(M.style.webkitTransform="none"),r.roundLengths)x=e.isHorizontal()?JH(M,"width",!0):JH(M,"height",!0);else{const B=t(D,"width"),V=t(D,"padding-left"),N=t(D,"padding-right"),L=t(D,"margin-left"),W=t(D,"margin-right"),G=D.getPropertyValue("box-sizing");if(G&&G==="border-box")x=B+L+W;else{const{clientWidth:X,offsetWidth:Q}=M;x=B+V+N+L+W+(Q-X)}}P&&(M.style.transform=P),I&&(M.style.webkitTransform=I),r.roundLengths&&(x=Math.floor(x))}else x=(s-(r.slidesPerView-1)*w)/r.slidesPerView,r.roundLengths&&(x=Math.floor(x)),u[T]&&(u[T].style[e.getDirectionLabel("width")]=`${x}px`);u[T]&&(u[T].swiperSlideSize=x),f.push(x),r.centeredSlides?(b=b+x/2+E/2+w,E===0&&T!==0&&(b=b-s/2-w),T===0&&(b=b-s/2-w),Math.abs(b)<1/1e3&&(b=0),r.roundLengths&&(b=Math.floor(b)),_%r.slidesPerGroup===0&&d.push(b),p.push(b)):(r.roundLengths&&(b=Math.floor(b)),(_-Math.min(e.params.slidesPerGroupSkip,_))%e.params.slidesPerGroup===0&&d.push(b),p.push(b),b=b+x+w),e.virtualSize+=x+w,E=x,_+=1}}if(e.virtualSize=Math.max(e.virtualSize,s)+g,a&&o&&(r.effect==="slide"||r.effect==="coverflow")&&(i.style.width=`${e.virtualSize+w}px`),r.setWrapperSize&&(i.style[e.getDirectionLabel("width")]=`${e.virtualSize+w}px`),C&&e.grid.updateWrapperSize(x,d),!r.centeredSlides){const T=[];for(let M=0;M<d.length;M+=1){let D=d[M];r.roundLengths&&(D=Math.floor(D)),d[M]<=e.virtualSize-s&&T.push(D)}d=T,Math.floor(e.virtualSize-s)-Math.floor(d[d.length-1])>1&&d.push(e.virtualSize-s)}if(l&&r.loop){const T=f[0]+w;if(r.slidesPerGroup>1){const M=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/r.slidesPerGroup),D=T*r.slidesPerGroup;for(let P=0;P<M;P+=1)d.push(d[d.length-1]+D)}for(let M=0;M<e.virtual.slidesBefore+e.virtual.slidesAfter;M+=1)r.slidesPerGroup===1&&d.push(d[d.length-1]+T),p.push(p[p.length-1]+T),e.virtualSize+=T}if(d.length===0&&(d=[0]),w!==0){const T=e.isHorizontal()&&a?"marginLeft":e.getDirectionLabel("marginRight");u.filter((M,D)=>!r.cssMode||r.loop?!0:D!==u.length-1).forEach(M=>{M.style[T]=`${w}px`})}if(r.centeredSlides&&r.centeredSlidesBounds){let T=0;f.forEach(D=>{T+=D+(w||0)}),T-=w;const M=T-s;d=d.map(D=>D<=0?-m:D>M?M+g:D)}if(r.centerInsufficientSlides){let T=0;f.forEach(D=>{T+=D+(w||0)}),T-=w;const M=(r.slidesOffsetBefore||0)+(r.slidesOffsetAfter||0);if(T+M<s){const D=(s-T-M)/2;d.forEach((P,I)=>{d[I]=P-D}),p.forEach((P,I)=>{p[I]=P+D})}}if(Object.assign(e,{slides:u,snapGrid:d,slidesGrid:p,slidesSizesGrid:f}),r.centeredSlides&&r.cssMode&&!r.centeredSlidesBounds){Mb(i,"--swiper-centered-offset-before",`${-d[0]}px`),Mb(i,"--swiper-centered-offset-after",`${e.size/2-f[f.length-1]/2}px`);const T=-e.snapGrid[0],M=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map(D=>D+T),e.slidesGrid=e.slidesGrid.map(D=>D+M)}if(h!==c&&e.emit("slidesLengthChange"),d.length!==v&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),p.length!==y&&e.emit("slidesGridLengthChange"),r.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!l&&!r.cssMode&&(r.effect==="slide"||r.effect==="fade")){const T=`${r.containerModifierClass}backface-hidden`,M=e.el.classList.contains(T);h<=r.maxBackfaceHiddenSlides?M||e.el.classList.add(T):M&&e.el.classList.remove(T)}}function iWe(e){const t=this,r=[],i=t.virtual&&t.params.virtual.enabled;let n=0,s;typeof e=="number"?t.setTransition(e):e===!0&&t.setTransition(t.params.speed);const a=o=>i?t.slides[t.getSlideIndexByData(o)]:t.slides[o];if(t.params.slidesPerView!=="auto"&&t.params.slidesPerView>1)if(t.params.centeredSlides)(t.visibleSlides||[]).forEach(o=>{r.push(o)});else for(s=0;s<Math.ceil(t.params.slidesPerView);s+=1){const o=t.activeIndex+s;if(o>t.slides.length&&!i)break;r.push(a(o))}else r.push(a(t.activeIndex));for(s=0;s<r.length;s+=1)if(typeof r[s]<"u"){const o=r[s].offsetHeight;n=o>n?o:n}(n||n===0)&&(t.wrapperEl.style.height=`${n}px`)}function nWe(){const e=this,t=e.slides,r=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let i=0;i<t.length;i+=1)t[i].swiperSlideOffset=(e.isHorizontal()?t[i].offsetLeft:t[i].offsetTop)-r-e.cssOverflowAdjustment()}const eW=(e,t,r)=>{t&&!e.classList.contains(r)?e.classList.add(r):!t&&e.classList.contains(r)&&e.classList.remove(r)};function sWe(e){e===void 0&&(e=this&&this.translate||0);const t=this,r=t.params,{slides:i,rtlTranslate:n,snapGrid:s}=t;if(i.length===0)return;typeof i[0].swiperSlideOffset>"u"&&t.updateSlidesOffset();let a=-e;n&&(a=e),t.visibleSlidesIndexes=[],t.visibleSlides=[];let o=r.spaceBetween;typeof o=="string"&&o.indexOf("%")>=0?o=parseFloat(o.replace("%",""))/100*t.size:typeof o=="string"&&(o=parseFloat(o));for(let l=0;l<i.length;l+=1){const c=i[l];let u=c.swiperSlideOffset;r.cssMode&&r.centeredSlides&&(u-=i[0].swiperSlideOffset);const h=(a+(r.centeredSlides?t.minTranslate():0)-u)/(c.swiperSlideSize+o),d=(a-s[0]+(r.centeredSlides?t.minTranslate():0)-u)/(c.swiperSlideSize+o),p=-(a-u),f=p+t.slidesSizesGrid[l],m=p>=0&&p<=t.size-t.slidesSizesGrid[l],g=p>=0&&p<t.size-1||f>1&&f<=t.size||p<=0&&f>=t.size;g&&(t.visibleSlides.push(c),t.visibleSlidesIndexes.push(l)),eW(c,g,r.slideVisibleClass),eW(c,m,r.slideFullyVisibleClass),c.progress=n?-h:h,c.originalProgress=n?-d:d}}function aWe(e){const t=this;if(typeof e>"u"){const u=t.rtlTranslate?-1:1;e=t&&t.translate&&t.translate*u||0}const r=t.params,i=t.maxTranslate()-t.minTranslate();let{progress:n,isBeginning:s,isEnd:a,progressLoop:o}=t;const l=s,c=a;if(i===0)n=0,s=!0,a=!0;else{n=(e-t.minTranslate())/i;const u=Math.abs(e-t.minTranslate())<1,h=Math.abs(e-t.maxTranslate())<1;s=u||n<=0,a=h||n>=1,u&&(n=0),h&&(n=1)}if(r.loop){const u=t.getSlideIndexByData(0),h=t.getSlideIndexByData(t.slides.length-1),d=t.slidesGrid[u],p=t.slidesGrid[h],f=t.slidesGrid[t.slidesGrid.length-1],m=Math.abs(e);m>=d?o=(m-d)/f:o=(m+f-p)/f,o>1&&(o-=1)}Object.assign(t,{progress:n,progressLoop:o,isBeginning:s,isEnd:a}),(r.watchSlidesProgress||r.centeredSlides&&r.autoHeight)&&t.updateSlidesProgress(e),s&&!l&&t.emit("reachBeginning toEdge"),a&&!c&&t.emit("reachEnd toEdge"),(l&&!s||c&&!a)&&t.emit("fromEdge"),t.emit("progress",n)}const eD=(e,t,r)=>{t&&!e.classList.contains(r)?e.classList.add(r):!t&&e.classList.contains(r)&&e.classList.remove(r)};function oWe(){const e=this,{slides:t,params:r,slidesEl:i,activeIndex:n}=e,s=e.virtual&&r.virtual.enabled,a=e.grid&&r.grid&&r.grid.rows>1,o=h=>Il(i,`.${r.slideClass}${h}, swiper-slide${h}`)[0];let l,c,u;if(s)if(r.loop){let h=n-e.virtual.slidesBefore;h<0&&(h=e.virtual.slides.length+h),h>=e.virtual.slides.length&&(h-=e.virtual.slides.length),l=o(`[data-swiper-slide-index="${h}"]`)}else l=o(`[data-swiper-slide-index="${n}"]`);else a?(l=t.filter(h=>h.column===n)[0],u=t.filter(h=>h.column===n+1)[0],c=t.filter(h=>h.column===n-1)[0]):l=t[n];l&&(a||(u=qHe(l,`.${r.slideClass}, swiper-slide`)[0],r.loop&&!u&&(u=t[0]),c=GHe(l,`.${r.slideClass}, swiper-slide`)[0],r.loop&&!c===0&&(c=t[t.length-1]))),t.forEach(h=>{eD(h,h===l,r.slideActiveClass),eD(h,h===u,r.slideNextClass),eD(h,h===c,r.slidePrevClass)}),e.emitSlidesClasses()}const b_=(e,t)=>{if(!e||e.destroyed||!e.params)return;const r=()=>e.isElement?"swiper-slide":`.${e.params.slideClass}`,i=t.closest(r());if(i){let n=i.querySelector(`.${e.params.lazyPreloaderClass}`);!n&&e.isElement&&(i.shadowRoot?n=i.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{i.shadowRoot&&(n=i.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`),n&&n.remove())})),n&&n.remove()}},tD=(e,t)=>{if(!e.slides[t])return;const r=e.slides[t].querySelector('[loading="lazy"]');r&&r.removeAttribute("loading")},nR=e=>{if(!e||e.destroyed||!e.params)return;let t=e.params.lazyPreloadPrevNext;const r=e.slides.length;if(!r||!t||t<0)return;t=Math.min(t,r);const i=e.params.slidesPerView==="auto"?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),n=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const a=n,o=[a-t];o.push(...Array.from({length:t}).map((l,c)=>a+i+c)),e.slides.forEach((l,c)=>{o.includes(l.column)&&tD(e,c)});return}const s=n+i-1;if(e.params.rewind||e.params.loop)for(let a=n-t;a<=s+t;a+=1){const o=(a%r+r)%r;(o<n||o>s)&&tD(e,o)}else for(let a=Math.max(n-t,0);a<=Math.min(s+t,r-1);a+=1)a!==n&&(a>s||a<n)&&tD(e,a)};function lWe(e){const{slidesGrid:t,params:r}=e,i=e.rtlTranslate?e.translate:-e.translate;let n;for(let s=0;s<t.length;s+=1)typeof t[s+1]<"u"?i>=t[s]&&i<t[s+1]-(t[s+1]-t[s])/2?n=s:i>=t[s]&&i<t[s+1]&&(n=s+1):i>=t[s]&&(n=s);return r.normalizeSlideIndex&&(n<0||typeof n>"u")&&(n=0),n}function cWe(e){const t=this,r=t.rtlTranslate?t.translate:-t.translate,{snapGrid:i,params:n,activeIndex:s,realIndex:a,snapIndex:o}=t;let l=e,c;const u=p=>{let f=p-t.virtual.slidesBefore;return f<0&&(f=t.virtual.slides.length+f),f>=t.virtual.slides.length&&(f-=t.virtual.slides.length),f};if(typeof l>"u"&&(l=lWe(t)),i.indexOf(r)>=0)c=i.indexOf(r);else{const p=Math.min(n.slidesPerGroupSkip,l);c=p+Math.floor((l-p)/n.slidesPerGroup)}if(c>=i.length&&(c=i.length-1),l===s&&!t.params.loop){c!==o&&(t.snapIndex=c,t.emit("snapIndexChange"));return}if(l===s&&t.params.loop&&t.virtual&&t.params.virtual.enabled){t.realIndex=u(l);return}const h=t.grid&&n.grid&&n.grid.rows>1;let d;if(t.virtual&&n.virtual.enabled&&n.loop)d=u(l);else if(h){const p=t.slides.filter(m=>m.column===l)[0];let f=parseInt(p.getAttribute("data-swiper-slide-index"),10);Number.isNaN(f)&&(f=Math.max(t.slides.indexOf(p),0)),d=Math.floor(f/n.grid.rows)}else if(t.slides[l]){const p=t.slides[l].getAttribute("data-swiper-slide-index");p?d=parseInt(p,10):d=l}else d=l;Object.assign(t,{previousSnapIndex:o,snapIndex:c,previousRealIndex:a,realIndex:d,previousIndex:s,activeIndex:l}),t.initialized&&nR(t),t.emit("activeIndexChange"),t.emit("snapIndexChange"),(t.initialized||t.params.runCallbacksOnInit)&&(a!==d&&t.emit("realIndexChange"),t.emit("slideChange"))}function uWe(e,t){const r=this,i=r.params;let n=e.closest(`.${i.slideClass}, swiper-slide`);!n&&r.isElement&&t&&t.length>1&&t.includes(e)&&[...t.slice(t.indexOf(e)+1,t.length)].forEach(o=>{!n&&o.matches&&o.matches(`.${i.slideClass}, swiper-slide`)&&(n=o)});let s=!1,a;if(n){for(let o=0;o<r.slides.length;o+=1)if(r.slides[o]===n){s=!0,a=o;break}}if(n&&s)r.clickedSlide=n,r.virtual&&r.params.virtual.enabled?r.clickedIndex=parseInt(n.getAttribute("data-swiper-slide-index"),10):r.clickedIndex=a;else{r.clickedSlide=void 0,r.clickedIndex=void 0;return}i.slideToClickedSlide&&r.clickedIndex!==void 0&&r.clickedIndex!==r.activeIndex&&r.slideToClickedSlide()}var hWe={updateSize:tWe,updateSlides:rWe,updateAutoHeight:iWe,updateSlidesOffset:nWe,updateSlidesProgress:sWe,updateProgress:aWe,updateSlidesClasses:oWe,updateActiveIndex:cWe,updateClickedSlide:uWe};function dWe(e){e===void 0&&(e=this.isHorizontal()?"x":"y");const t=this,{params:r,rtlTranslate:i,translate:n,wrapperEl:s}=t;if(r.virtualTranslate)return i?-n:n;if(r.cssMode)return n;let a=HHe(s,e);return a+=t.cssOverflowAdjustment(),i&&(a=-a),a||0}function pWe(e,t){const r=this,{rtlTranslate:i,params:n,wrapperEl:s,progress:a}=r;let o=0,l=0;const c=0;r.isHorizontal()?o=i?-e:e:l=e,n.roundLengths&&(o=Math.floor(o),l=Math.floor(l)),r.previousTranslate=r.translate,r.translate=r.isHorizontal()?o:l,n.cssMode?s[r.isHorizontal()?"scrollLeft":"scrollTop"]=r.isHorizontal()?-o:-l:n.virtualTranslate||(r.isHorizontal()?o-=r.cssOverflowAdjustment():l-=r.cssOverflowAdjustment(),s.style.transform=`translate3d(${o}px, ${l}px, ${c}px)`);let u;const h=r.maxTranslate()-r.minTranslate();h===0?u=0:u=(e-r.minTranslate())/h,u!==a&&r.updateProgress(e),r.emit("setTranslate",r.translate,t)}function fWe(){return-this.snapGrid[0]}function mWe(){return-this.snapGrid[this.snapGrid.length-1]}function gWe(e,t,r,i,n){e===void 0&&(e=0),t===void 0&&(t=this.params.speed),r===void 0&&(r=!0),i===void 0&&(i=!0);const s=this,{params:a,wrapperEl:o}=s;if(s.animating&&a.preventInteractionOnTransition)return!1;const l=s.minTranslate(),c=s.maxTranslate();let u;if(i&&e>l?u=l:i&&e<c?u=c:u=e,s.updateProgress(u),a.cssMode){const h=s.isHorizontal();if(t===0)o[h?"scrollLeft":"scrollTop"]=-u;else{if(!s.support.smoothScroll)return _J({swiper:s,targetPosition:-u,side:h?"left":"top"}),!0;o.scrollTo({[h?"left":"top"]:-u,behavior:"smooth"})}return!0}return t===0?(s.setTransition(0),s.setTranslate(u),r&&(s.emit("beforeTransitionStart",t,n),s.emit("transitionEnd"))):(s.setTransition(t),s.setTranslate(u),r&&(s.emit("beforeTransitionStart",t,n),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(d){!s||s.destroyed||d.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,r&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}var vWe={getTranslate:dWe,setTranslate:pWe,minTranslate:fWe,maxTranslate:mWe,translateTo:gWe};function yWe(e,t){const r=this;r.params.cssMode||(r.wrapperEl.style.transitionDuration=`${e}ms`,r.wrapperEl.style.transitionDelay=e===0?"0ms":""),r.emit("setTransition",e,t)}function TJ(e){let{swiper:t,runCallbacks:r,direction:i,step:n}=e;const{activeIndex:s,previousIndex:a}=t;let o=i;if(o||(s>a?o="next":s<a?o="prev":o="reset"),t.emit(`transition${n}`),r&&s!==a){if(o==="reset"){t.emit(`slideResetTransition${n}`);return}t.emit(`slideChangeTransition${n}`),o==="next"?t.emit(`slideNextTransition${n}`):t.emit(`slidePrevTransition${n}`)}}function wWe(e,t){e===void 0&&(e=!0);const r=this,{params:i}=r;i.cssMode||(i.autoHeight&&r.updateAutoHeight(),TJ({swiper:r,runCallbacks:e,direction:t,step:"Start"}))}function xWe(e,t){e===void 0&&(e=!0);const r=this,{params:i}=r;r.animating=!1,!i.cssMode&&(r.setTransition(0),TJ({swiper:r,runCallbacks:e,direction:t,step:"End"}))}var bWe={setTransition:yWe,transitionStart:wWe,transitionEnd:xWe};function _We(e,t,r,i,n){e===void 0&&(e=0),r===void 0&&(r=!0),typeof e=="string"&&(e=parseInt(e,10));const s=this;let a=e;a<0&&(a=0);const{params:o,snapGrid:l,slidesGrid:c,previousIndex:u,activeIndex:h,rtlTranslate:d,wrapperEl:p,enabled:f}=s;if(!f&&!i&&!n||s.destroyed||s.animating&&o.preventInteractionOnTransition)return!1;typeof t>"u"&&(t=s.params.speed);const m=Math.min(s.params.slidesPerGroupSkip,a);let g=m+Math.floor((a-m)/s.params.slidesPerGroup);g>=l.length&&(g=l.length-1);const v=-l[g];if(o.normalizeSlideIndex)for(let w=0;w<c.length;w+=1){const b=-Math.floor(v*100),E=Math.floor(c[w]*100),_=Math.floor(c[w+1]*100);typeof c[w+1]<"u"?b>=E&&b<_-(_-E)/2?a=w:b>=E&&b<_&&(a=w+1):b>=E&&(a=w)}if(s.initialized&&a!==h&&(!s.allowSlideNext&&(d?v>s.translate&&v>s.minTranslate():v<s.translate&&v<s.minTranslate())||!s.allowSlidePrev&&v>s.translate&&v>s.maxTranslate()&&(h||0)!==a))return!1;a!==(u||0)&&r&&s.emit("beforeSlideChangeStart"),s.updateProgress(v);let y;if(a>h?y="next":a<h?y="prev":y="reset",d&&-v===s.translate||!d&&v===s.translate)return s.updateActiveIndex(a),o.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),o.effect!=="slide"&&s.setTranslate(v),y!=="reset"&&(s.transitionStart(r,y),s.transitionEnd(r,y)),!1;if(o.cssMode){const w=s.isHorizontal(),b=d?v:-v;if(t===0){const E=s.virtual&&s.params.virtual.enabled;E&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),E&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{p[w?"scrollLeft":"scrollTop"]=b})):p[w?"scrollLeft":"scrollTop"]=b,E&&requestAnimationFrame(()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1})}else{if(!s.support.smoothScroll)return _J({swiper:s,targetPosition:b,side:w?"left":"top"}),!0;p.scrollTo({[w?"left":"top"]:b,behavior:"smooth"})}return!0}return s.setTransition(t),s.setTranslate(v),s.updateActiveIndex(a),s.updateSlidesClasses(),s.emit("beforeTransitionStart",t,i),s.transitionStart(r,y),t===0?s.transitionEnd(r,y):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(b){!s||s.destroyed||b.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(r,y))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0}function SWe(e,t,r,i){e===void 0&&(e=0),r===void 0&&(r=!0),typeof e=="string"&&(e=parseInt(e,10));const n=this;if(n.destroyed)return;typeof t>"u"&&(t=n.params.speed);const s=n.grid&&n.params.grid&&n.params.grid.rows>1;let a=e;if(n.params.loop)if(n.virtual&&n.params.virtual.enabled)a=a+n.virtual.slidesBefore;else{let o;if(s){const d=a*n.params.grid.rows;o=n.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===d)[0].column}else o=n.getSlideIndexByData(a);const l=s?Math.ceil(n.slides.length/n.params.grid.rows):n.slides.length,{centeredSlides:c}=n.params;let u=n.params.slidesPerView;u==="auto"?u=n.slidesPerViewDynamic():(u=Math.ceil(parseFloat(n.params.slidesPerView,10)),c&&u%2===0&&(u=u+1));let h=l-o<u;if(c&&(h=h||o<Math.ceil(u/2)),i&&c&&n.params.slidesPerView!=="auto"&&!s&&(h=!1),h){const d=c?o<n.activeIndex?"prev":"next":o-n.activeIndex-1<n.params.slidesPerView?"next":"prev";n.loopFix({direction:d,slideTo:!0,activeSlideIndex:d==="next"?o+1:o-l+1,slideRealIndex:d==="next"?n.realIndex:void 0})}if(s){const d=a*n.params.grid.rows;a=n.slides.filter(p=>p.getAttribute("data-swiper-slide-index")*1===d)[0].column}else a=n.getSlideIndexByData(a)}return requestAnimationFrame(()=>{n.slideTo(a,t,r,i)}),n}function EWe(e,t,r){t===void 0&&(t=!0);const i=this,{enabled:n,params:s,animating:a}=i;if(!n||i.destroyed)return i;typeof e>"u"&&(e=i.params.speed);let o=s.slidesPerGroup;s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(o=Math.max(i.slidesPerViewDynamic("current",!0),1));const l=i.activeIndex<s.slidesPerGroupSkip?1:o,c=i.virtual&&s.virtual.enabled;if(s.loop){if(a&&!c&&s.loopPreventsSliding)return!1;if(i.loopFix({direction:"next"}),i._clientLeft=i.wrapperEl.clientLeft,i.activeIndex===i.slides.length-1&&s.cssMode)return requestAnimationFrame(()=>{i.slideTo(i.activeIndex+l,e,t,r)}),!0}return s.rewind&&i.isEnd?i.slideTo(0,e,t,r):i.slideTo(i.activeIndex+l,e,t,r)}function TWe(e,t,r){t===void 0&&(t=!0);const i=this,{params:n,snapGrid:s,slidesGrid:a,rtlTranslate:o,enabled:l,animating:c}=i;if(!l||i.destroyed)return i;typeof e>"u"&&(e=i.params.speed);const u=i.virtual&&n.virtual.enabled;if(n.loop){if(c&&!u&&n.loopPreventsSliding)return!1;i.loopFix({direction:"prev"}),i._clientLeft=i.wrapperEl.clientLeft}const h=o?i.translate:-i.translate;function d(v){return v<0?-Math.floor(Math.abs(v)):Math.floor(v)}const p=d(h),f=s.map(v=>d(v));let m=s[f.indexOf(p)-1];if(typeof m>"u"&&n.cssMode){let v;s.forEach((y,w)=>{p>=y&&(v=w)}),typeof v<"u"&&(m=s[v>0?v-1:v])}let g=0;if(typeof m<"u"&&(g=a.indexOf(m),g<0&&(g=i.activeIndex-1),n.slidesPerView==="auto"&&n.slidesPerGroup===1&&n.slidesPerGroupAuto&&(g=g-i.slidesPerViewDynamic("previous",!0)+1,g=Math.max(g,0))),n.rewind&&i.isBeginning){const v=i.params.virtual&&i.params.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1;return i.slideTo(v,e,t,r)}else if(n.loop&&i.activeIndex===0&&n.cssMode)return requestAnimationFrame(()=>{i.slideTo(g,e,t,r)}),!0;return i.slideTo(g,e,t,r)}function CWe(e,t,r){t===void 0&&(t=!0);const i=this;if(!i.destroyed)return typeof e>"u"&&(e=i.params.speed),i.slideTo(i.activeIndex,e,t,r)}function AWe(e,t,r,i){t===void 0&&(t=!0),i===void 0&&(i=.5);const n=this;if(n.destroyed)return;typeof e>"u"&&(e=n.params.speed);let s=n.activeIndex;const a=Math.min(n.params.slidesPerGroupSkip,s),o=a+Math.floor((s-a)/n.params.slidesPerGroup),l=n.rtlTranslate?n.translate:-n.translate;if(l>=n.snapGrid[o]){const c=n.snapGrid[o],u=n.snapGrid[o+1];l-c>(u-c)*i&&(s+=n.params.slidesPerGroup)}else{const c=n.snapGrid[o-1],u=n.snapGrid[o];l-c<=(u-c)*i&&(s-=n.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,n.slidesGrid.length-1),n.slideTo(s,e,t,r)}function MWe(){const e=this;if(e.destroyed)return;const{params:t,slidesEl:r}=e,i=t.slidesPerView==="auto"?e.slidesPerViewDynamic():t.slidesPerView;let n=e.clickedIndex,s;const a=e.isElement?"swiper-slide":`.${t.slideClass}`;if(t.loop){if(e.animating)return;s=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),t.centeredSlides?n<e.loopedSlides-i/2||n>e.slides.length-e.loopedSlides+i/2?(e.loopFix(),n=e.getSlideIndex(Il(r,`${a}[data-swiper-slide-index="${s}"]`)[0]),iR(()=>{e.slideTo(n)})):e.slideTo(n):n>e.slides.length-i?(e.loopFix(),n=e.getSlideIndex(Il(r,`${a}[data-swiper-slide-index="${s}"]`)[0]),iR(()=>{e.slideTo(n)})):e.slideTo(n)}else e.slideTo(n)}var PWe={slideTo:_We,slideToLoop:SWe,slideNext:EWe,slidePrev:TWe,slideReset:CWe,slideToClosest:AWe,slideToClickedSlide:MWe};function DWe(e){const t=this,{params:r,slidesEl:i}=t;if(!r.loop||t.virtual&&t.params.virtual.enabled)return;const n=()=>{Il(i,`.${r.slideClass}, swiper-slide`).forEach((h,d)=>{h.setAttribute("data-swiper-slide-index",d)})},s=t.grid&&r.grid&&r.grid.rows>1,a=r.slidesPerGroup*(s?r.grid.rows:1),o=t.slides.length%a!==0,l=s&&t.slides.length%r.grid.rows!==0,c=u=>{for(let h=0;h<u;h+=1){const d=t.isElement?_w("swiper-slide",[r.slideBlankClass]):_w("div",[r.slideClass,r.slideBlankClass]);t.slidesEl.append(d)}};if(o){if(r.loopAddBlankSlides){const u=a-t.slides.length%a;c(u),t.recalcSlides(),t.updateSlides()}else GE("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");n()}else if(l){if(r.loopAddBlankSlides){const u=r.grid.rows-t.slides.length%r.grid.rows;c(u),t.recalcSlides(),t.updateSlides()}else GE("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");n()}else n();t.loopFix({slideRealIndex:e,direction:r.centeredSlides?void 0:"next"})}function IWe(e){let{slideRealIndex:t,slideTo:r=!0,direction:i,setTranslate:n,activeSlideIndex:s,byController:a,byMousewheel:o}=e===void 0?{}:e;const l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");const{slides:c,allowSlidePrev:u,allowSlideNext:h,slidesEl:d,params:p}=l,{centeredSlides:f}=p;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&p.virtual.enabled){r&&(!p.centeredSlides&&l.snapIndex===0?l.slideTo(l.virtual.slides.length,0,!1,!0):p.centeredSlides&&l.snapIndex<p.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0)),l.allowSlidePrev=u,l.allowSlideNext=h,l.emit("loopFix");return}let m=p.slidesPerView;m==="auto"?m=l.slidesPerViewDynamic():(m=Math.ceil(parseFloat(p.slidesPerView,10)),f&&m%2===0&&(m=m+1));const g=p.slidesPerGroupAuto?m:p.slidesPerGroup;let v=g;v%g!==0&&(v+=g-v%g),v+=p.loopAdditionalSlides,l.loopedSlides=v;const y=l.grid&&p.grid&&p.grid.rows>1;c.length<m+v?GE("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):y&&p.grid.fill==="row"&&GE("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const w=[],b=[];let E=l.activeIndex;typeof s>"u"?s=l.getSlideIndex(c.filter(P=>P.classList.contains(p.slideActiveClass))[0]):E=s;const _=i==="next"||!i,C=i==="prev"||!i;let x=0,A=0;const T=y?Math.ceil(c.length/p.grid.rows):c.length,D=(y?c[s].column:s)+(f&&typeof n>"u"?-m/2+.5:0);if(D<v){x=Math.max(v-D,g);for(let P=0;P<v-D;P+=1){const I=P-Math.floor(P/T)*T;if(y){const B=T-I-1;for(let V=c.length-1;V>=0;V-=1)c[V].column===B&&w.push(V)}else w.push(T-I-1)}}else if(D+m>T-v){A=Math.max(D-(T-v*2),g);for(let P=0;P<A;P+=1){const I=P-Math.floor(P/T)*T;y?c.forEach((B,V)=>{B.column===I&&b.push(V)}):b.push(I)}}if(l.__preventObserver__=!0,requestAnimationFrame(()=>{l.__preventObserver__=!1}),C&&w.forEach(P=>{c[P].swiperLoopMoveDOM=!0,d.prepend(c[P]),c[P].swiperLoopMoveDOM=!1}),_&&b.forEach(P=>{c[P].swiperLoopMoveDOM=!0,d.append(c[P]),c[P].swiperLoopMoveDOM=!1}),l.recalcSlides(),p.slidesPerView==="auto"?l.updateSlides():y&&(w.length>0&&C||b.length>0&&_)&&l.slides.forEach((P,I)=>{l.grid.updateSlide(I,P,l.slides)}),p.watchSlidesProgress&&l.updateSlidesOffset(),r){if(w.length>0&&C){if(typeof t>"u"){const P=l.slidesGrid[E],B=l.slidesGrid[E+x]-P;o?l.setTranslate(l.translate-B):(l.slideTo(E+Math.ceil(x),0,!1,!0),n&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-B,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-B))}else if(n){const P=y?w.length/p.grid.rows:w.length;l.slideTo(l.activeIndex+P,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(b.length>0&&_)if(typeof t>"u"){const P=l.slidesGrid[E],B=l.slidesGrid[E-A]-P;o?l.setTranslate(l.translate-B):(l.slideTo(E-A,0,!1,!0),n&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-B,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-B))}else{const P=y?b.length/p.grid.rows:b.length;l.slideTo(l.activeIndex-P,0,!1,!0)}}if(l.allowSlidePrev=u,l.allowSlideNext=h,l.controller&&l.controller.control&&!a){const P={slideRealIndex:t,direction:i,setTranslate:n,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach(I=>{!I.destroyed&&I.params.loop&&I.loopFix({...P,slideTo:I.params.slidesPerView===p.slidesPerView?r:!1})}):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix({...P,slideTo:l.controller.control.params.slidesPerView===p.slidesPerView?r:!1})}l.emit("loopFix")}function OWe(){const e=this,{params:t,slidesEl:r}=e;if(!t.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const i=[];e.slides.forEach(n=>{const s=typeof n.swiperSlideIndex>"u"?n.getAttribute("data-swiper-slide-index")*1:n.swiperSlideIndex;i[s]=n}),e.slides.forEach(n=>{n.removeAttribute("data-swiper-slide-index")}),i.forEach(n=>{r.append(n)}),e.recalcSlides(),e.slideTo(e.realIndex,0)}var RWe={loopCreate:DWe,loopFix:IWe,loopDestroy:OWe};function kWe(e){const t=this;if(!t.params.simulateTouch||t.params.watchOverflow&&t.isLocked||t.params.cssMode)return;const r=t.params.touchEventsTarget==="container"?t.el:t.wrapperEl;t.isElement&&(t.__preventObserver__=!0),r.style.cursor="move",r.style.cursor=e?"grabbing":"grab",t.isElement&&requestAnimationFrame(()=>{t.__preventObserver__=!1})}function LWe(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e[e.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1}))}var NWe={setGrabCursor:kWe,unsetGrabCursor:LWe};function zWe(e,t){t===void 0&&(t=this);function r(i){if(!i||i===ru()||i===Ia())return null;i.assignedSlot&&(i=i.assignedSlot);const n=i.closest(e);return!n&&!i.getRootNode?null:n||r(i.getRootNode().host)}return r(t)}function tW(e,t,r){const i=Ia(),{params:n}=e,s=n.edgeSwipeDetection,a=n.edgeSwipeThreshold;return s&&(r<=a||r>=i.innerWidth-a)?s==="prevent"?(t.preventDefault(),!0):!1:!0}function BWe(e){const t=this,r=ru();let i=e;i.originalEvent&&(i=i.originalEvent);const n=t.touchEventsData;if(i.type==="pointerdown"){if(n.pointerId!==null&&n.pointerId!==i.pointerId)return;n.pointerId=i.pointerId}else i.type==="touchstart"&&i.targetTouches.length===1&&(n.touchId=i.targetTouches[0].identifier);if(i.type==="touchstart"){tW(t,i,i.targetTouches[0].pageX);return}const{params:s,touches:a,enabled:o}=t;if(!o||!s.simulateTouch&&i.pointerType==="mouse"||t.animating&&s.preventInteractionOnTransition)return;!t.animating&&s.cssMode&&s.loop&&t.loopFix();let l=i.target;if(s.touchEventsTarget==="wrapper"&&!t.wrapperEl.contains(l)||"which"in i&&i.which===3||"button"in i&&i.button>0||n.isTouched&&n.isMoved)return;const c=!!s.noSwipingClass&&s.noSwipingClass!=="",u=i.composedPath?i.composedPath():i.path;c&&i.target&&i.target.shadowRoot&&u&&(l=u[0]);const h=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,d=!!(i.target&&i.target.shadowRoot);if(s.noSwiping&&(d?zWe(h,l):l.closest(h))){t.allowClick=!0;return}if(s.swipeHandler&&!l.closest(s.swipeHandler))return;a.currentX=i.pageX,a.currentY=i.pageY;const p=a.currentX,f=a.currentY;if(!tW(t,i,p))return;Object.assign(n,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),a.startX=p,a.startY=f,n.touchStartTime=WE(),t.allowClick=!0,t.updateSize(),t.swipeDirection=void 0,s.threshold>0&&(n.allowThresholdMove=!1);let m=!0;l.matches(n.focusableElements)&&(m=!1,l.nodeName==="SELECT"&&(n.isTouched=!1)),r.activeElement&&r.activeElement.matches(n.focusableElements)&&r.activeElement!==l&&r.activeElement.blur();const g=m&&t.allowTouchMove&&s.touchStartPreventDefault;(s.touchStartForcePreventDefault||g)&&!l.isContentEditable&&i.preventDefault(),s.freeMode&&s.freeMode.enabled&&t.freeMode&&t.animating&&!s.cssMode&&t.freeMode.onTouchStart(),t.emit("touchStart",i)}function FWe(e){const t=ru(),r=this,i=r.touchEventsData,{params:n,touches:s,rtlTranslate:a,enabled:o}=r;if(!o||!n.simulateTouch&&e.pointerType==="mouse")return;let l=e;if(l.originalEvent&&(l=l.originalEvent),l.type==="pointermove"&&(i.touchId!==null||l.pointerId!==i.pointerId))return;let c;if(l.type==="touchmove"){if(c=[...l.changedTouches].filter(_=>_.identifier===i.touchId)[0],!c||c.identifier!==i.touchId)return}else c=l;if(!i.isTouched){i.startMoving&&i.isScrolling&&r.emit("touchMoveOpposite",l);return}const u=c.pageX,h=c.pageY;if(l.preventedByNestedSwiper){s.startX=u,s.startY=h;return}if(!r.allowTouchMove){l.target.matches(i.focusableElements)||(r.allowClick=!1),i.isTouched&&(Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h}),i.touchStartTime=WE());return}if(n.touchReleaseOnEdges&&!n.loop){if(r.isVertical()){if(h<s.startY&&r.translate<=r.maxTranslate()||h>s.startY&&r.translate>=r.minTranslate()){i.isTouched=!1,i.isMoved=!1;return}}else if(u<s.startX&&r.translate<=r.maxTranslate()||u>s.startX&&r.translate>=r.minTranslate())return}if(t.activeElement&&l.target===t.activeElement&&l.target.matches(i.focusableElements)){i.isMoved=!0,r.allowClick=!1;return}i.allowTouchCallbacks&&r.emit("touchMove",l),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=u,s.currentY=h;const d=s.currentX-s.startX,p=s.currentY-s.startY;if(r.params.threshold&&Math.sqrt(d**2+p**2)<r.params.threshold)return;if(typeof i.isScrolling>"u"){let _;r.isHorizontal()&&s.currentY===s.startY||r.isVertical()&&s.currentX===s.startX?i.isScrolling=!1:d*d+p*p>=25&&(_=Math.atan2(Math.abs(p),Math.abs(d))*180/Math.PI,i.isScrolling=r.isHorizontal()?_>n.touchAngle:90-_>n.touchAngle)}if(i.isScrolling&&r.emit("touchMoveOpposite",l),typeof i.startMoving>"u"&&(s.currentX!==s.startX||s.currentY!==s.startY)&&(i.startMoving=!0),i.isScrolling||l.type==="touchmove"&&i.preventTouchMoveFromPointerMove){i.isTouched=!1;return}if(!i.startMoving)return;r.allowClick=!1,!n.cssMode&&l.cancelable&&l.preventDefault(),n.touchMoveStopPropagation&&!n.nested&&l.stopPropagation();let f=r.isHorizontal()?d:p,m=r.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;n.oneWayMovement&&(f=Math.abs(f)*(a?1:-1),m=Math.abs(m)*(a?1:-1)),s.diff=f,f*=n.touchRatio,a&&(f=-f,m=-m);const g=r.touchesDirection;r.swipeDirection=f>0?"prev":"next",r.touchesDirection=m>0?"prev":"next";const v=r.params.loop&&!n.cssMode,y=r.touchesDirection==="next"&&r.allowSlideNext||r.touchesDirection==="prev"&&r.allowSlidePrev;if(!i.isMoved){if(v&&y&&r.loopFix({direction:r.swipeDirection}),i.startTranslate=r.getTranslate(),r.setTransition(0),r.animating){const _=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});r.wrapperEl.dispatchEvent(_)}i.allowMomentumBounce=!1,n.grabCursor&&(r.allowSlideNext===!0||r.allowSlidePrev===!0)&&r.setGrabCursor(!0),r.emit("sliderFirstMove",l)}let w;if(new Date().getTime(),i.isMoved&&i.allowThresholdMove&&g!==r.touchesDirection&&v&&y&&Math.abs(f)>=1){Object.assign(s,{startX:u,startY:h,currentX:u,currentY:h,startTranslate:i.currentTranslate}),i.loopSwapReset=!0,i.startTranslate=i.currentTranslate;return}r.emit("sliderMove",l),i.isMoved=!0,i.currentTranslate=f+i.startTranslate;let b=!0,E=n.resistanceRatio;if(n.touchReleaseOnEdges&&(E=0),f>0?(v&&y&&!w&&i.allowThresholdMove&&i.currentTranslate>(n.centeredSlides?r.minTranslate()-r.slidesSizesGrid[r.activeIndex+1]:r.minTranslate())&&r.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),i.currentTranslate>r.minTranslate()&&(b=!1,n.resistance&&(i.currentTranslate=r.minTranslate()-1+(-r.minTranslate()+i.startTranslate+f)**E))):f<0&&(v&&y&&!w&&i.allowThresholdMove&&i.currentTranslate<(n.centeredSlides?r.maxTranslate()+r.slidesSizesGrid[r.slidesSizesGrid.length-1]:r.maxTranslate())&&r.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:r.slides.length-(n.slidesPerView==="auto"?r.slidesPerViewDynamic():Math.ceil(parseFloat(n.slidesPerView,10)))}),i.currentTranslate<r.maxTranslate()&&(b=!1,n.resistance&&(i.currentTranslate=r.maxTranslate()+1-(r.maxTranslate()-i.startTranslate-f)**E))),b&&(l.preventedByNestedSwiper=!0),!r.allowSlideNext&&r.swipeDirection==="next"&&i.currentTranslate<i.startTranslate&&(i.currentTranslate=i.startTranslate),!r.allowSlidePrev&&r.swipeDirection==="prev"&&i.currentTranslate>i.startTranslate&&(i.currentTranslate=i.startTranslate),!r.allowSlidePrev&&!r.allowSlideNext&&(i.currentTranslate=i.startTranslate),n.threshold>0)if(Math.abs(f)>n.threshold||i.allowThresholdMove){if(!i.allowThresholdMove){i.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,i.currentTranslate=i.startTranslate,s.diff=r.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY;return}}else{i.currentTranslate=i.startTranslate;return}!n.followFinger||n.cssMode||((n.freeMode&&n.freeMode.enabled&&r.freeMode||n.watchSlidesProgress)&&(r.updateActiveIndex(),r.updateSlidesClasses()),n.freeMode&&n.freeMode.enabled&&r.freeMode&&r.freeMode.onTouchMove(),r.updateProgress(i.currentTranslate),r.setTranslate(i.currentTranslate))}function UWe(e){const t=this,r=t.touchEventsData;let i=e;i.originalEvent&&(i=i.originalEvent);let n;if(i.type==="touchend"||i.type==="touchcancel"){if(n=[...i.changedTouches].filter(E=>E.identifier===r.touchId)[0],!n||n.identifier!==r.touchId)return}else{if(r.touchId!==null||i.pointerId!==r.pointerId)return;n=i}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(i.type)&&!(["pointercancel","contextmenu"].includes(i.type)&&(t.browser.isSafari||t.browser.isWebView)))return;r.pointerId=null,r.touchId=null;const{params:a,touches:o,rtlTranslate:l,slidesGrid:c,enabled:u}=t;if(!u||!a.simulateTouch&&i.pointerType==="mouse")return;if(r.allowTouchCallbacks&&t.emit("touchEnd",i),r.allowTouchCallbacks=!1,!r.isTouched){r.isMoved&&a.grabCursor&&t.setGrabCursor(!1),r.isMoved=!1,r.startMoving=!1;return}a.grabCursor&&r.isMoved&&r.isTouched&&(t.allowSlideNext===!0||t.allowSlidePrev===!0)&&t.setGrabCursor(!1);const h=WE(),d=h-r.touchStartTime;if(t.allowClick){const E=i.path||i.composedPath&&i.composedPath();t.updateClickedSlide(E&&E[0]||i.target,E),t.emit("tap click",i),d<300&&h-r.lastClickTime<300&&t.emit("doubleTap doubleClick",i)}if(r.lastClickTime=WE(),iR(()=>{t.destroyed||(t.allowClick=!0)}),!r.isTouched||!r.isMoved||!t.swipeDirection||o.diff===0&&!r.loopSwapReset||r.currentTranslate===r.startTranslate&&!r.loopSwapReset){r.isTouched=!1,r.isMoved=!1,r.startMoving=!1;return}r.isTouched=!1,r.isMoved=!1,r.startMoving=!1;let p;if(a.followFinger?p=l?t.translate:-t.translate:p=-r.currentTranslate,a.cssMode)return;if(a.freeMode&&a.freeMode.enabled){t.freeMode.onTouchEnd({currentPos:p});return}const f=p>=-t.maxTranslate()&&!t.params.loop;let m=0,g=t.slidesSizesGrid[0];for(let E=0;E<c.length;E+=E<a.slidesPerGroupSkip?1:a.slidesPerGroup){const _=E<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;typeof c[E+_]<"u"?(f||p>=c[E]&&p<c[E+_])&&(m=E,g=c[E+_]-c[E]):(f||p>=c[E])&&(m=E,g=c[c.length-1]-c[c.length-2])}let v=null,y=null;a.rewind&&(t.isBeginning?y=a.virtual&&a.virtual.enabled&&t.virtual?t.virtual.slides.length-1:t.slides.length-1:t.isEnd&&(v=0));const w=(p-c[m])/g,b=m<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;if(d>a.longSwipesMs){if(!a.longSwipes){t.slideTo(t.activeIndex);return}t.swipeDirection==="next"&&(w>=a.longSwipesRatio?t.slideTo(a.rewind&&t.isEnd?v:m+b):t.slideTo(m)),t.swipeDirection==="prev"&&(w>1-a.longSwipesRatio?t.slideTo(m+b):y!==null&&w<0&&Math.abs(w)>a.longSwipesRatio?t.slideTo(y):t.slideTo(m))}else{if(!a.shortSwipes){t.slideTo(t.activeIndex);return}t.navigation&&(i.target===t.navigation.nextEl||i.target===t.navigation.prevEl)?i.target===t.navigation.nextEl?t.slideTo(m+b):t.slideTo(m):(t.swipeDirection==="next"&&t.slideTo(v!==null?v:m+b),t.swipeDirection==="prev"&&t.slideTo(y!==null?y:m))}}function rW(){const e=this,{params:t,el:r}=e;if(r&&r.offsetWidth===0)return;t.breakpoints&&e.setBreakpoint();const{allowSlideNext:i,allowSlidePrev:n,snapGrid:s}=e,a=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const o=a&&t.loop;(t.slidesPerView==="auto"||t.slidesPerView>1)&&e.isEnd&&!e.isBeginning&&!e.params.centeredSlides&&!o?e.slideTo(e.slides.length-1,0,!1,!0):e.params.loop&&!a?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout(()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()},500)),e.allowSlidePrev=n,e.allowSlideNext=i,e.params.watchOverflow&&s!==e.snapGrid&&e.checkOverflow()}function jWe(e){const t=this;t.enabled&&(t.allowClick||(t.params.preventClicks&&e.preventDefault(),t.params.preventClicksPropagation&&t.animating&&(e.stopPropagation(),e.stopImmediatePropagation())))}function VWe(){const e=this,{wrapperEl:t,rtlTranslate:r,enabled:i}=e;if(!i)return;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-t.scrollLeft:e.translate=-t.scrollTop,e.translate===0&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();let n;const s=e.maxTranslate()-e.minTranslate();s===0?n=0:n=(e.translate-e.minTranslate())/s,n!==e.progress&&e.updateProgress(r?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function HWe(e){const t=this;b_(t,e.target),!(t.params.cssMode||t.params.slidesPerView!=="auto"&&!t.params.autoHeight)&&t.update()}function WWe(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const CJ=(e,t)=>{const r=ru(),{params:i,el:n,wrapperEl:s,device:a}=e,o=!!i.nested,l=t==="on"?"addEventListener":"removeEventListener",c=t;!n||typeof n=="string"||(r[l]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:o}),n[l]("touchstart",e.onTouchStart,{passive:!1}),n[l]("pointerdown",e.onTouchStart,{passive:!1}),r[l]("touchmove",e.onTouchMove,{passive:!1,capture:o}),r[l]("pointermove",e.onTouchMove,{passive:!1,capture:o}),r[l]("touchend",e.onTouchEnd,{passive:!0}),r[l]("pointerup",e.onTouchEnd,{passive:!0}),r[l]("pointercancel",e.onTouchEnd,{passive:!0}),r[l]("touchcancel",e.onTouchEnd,{passive:!0}),r[l]("pointerout",e.onTouchEnd,{passive:!0}),r[l]("pointerleave",e.onTouchEnd,{passive:!0}),r[l]("contextmenu",e.onTouchEnd,{passive:!0}),(i.preventClicks||i.preventClicksPropagation)&&n[l]("click",e.onClick,!0),i.cssMode&&s[l]("scroll",e.onScroll),i.updateOnWindowResize?e[c](a.ios||a.android?"resize orientationchange observerUpdate":"resize observerUpdate",rW,!0):e[c]("observerUpdate",rW,!0),n[l]("load",e.onLoad,{capture:!0}))};function GWe(){const e=this,{params:t}=e;e.onTouchStart=BWe.bind(e),e.onTouchMove=FWe.bind(e),e.onTouchEnd=UWe.bind(e),e.onDocumentTouchStart=WWe.bind(e),t.cssMode&&(e.onScroll=VWe.bind(e)),e.onClick=jWe.bind(e),e.onLoad=HWe.bind(e),CJ(e,"on")}function qWe(){CJ(this,"off")}var YWe={attachEvents:GWe,detachEvents:qWe};const iW=(e,t)=>e.grid&&t.grid&&t.grid.rows>1;function XWe(){const e=this,{realIndex:t,initialized:r,params:i,el:n}=e,s=i.breakpoints;if(!s||s&&Object.keys(s).length===0)return;const a=e.getBreakpoint(s,e.params.breakpointsBase,e.el);if(!a||e.currentBreakpoint===a)return;const l=(a in s?s[a]:void 0)||e.originalParams,c=iW(e,i),u=iW(e,l),h=e.params.grabCursor,d=l.grabCursor,p=i.enabled;c&&!u?(n.classList.remove(`${i.containerModifierClass}grid`,`${i.containerModifierClass}grid-column`),e.emitContainerClasses()):!c&&u&&(n.classList.add(`${i.containerModifierClass}grid`),(l.grid.fill&&l.grid.fill==="column"||!l.grid.fill&&i.grid.fill==="column")&&n.classList.add(`${i.containerModifierClass}grid-column`),e.emitContainerClasses()),h&&!d?e.unsetGrabCursor():!h&&d&&e.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(w=>{if(typeof l[w]>"u")return;const b=i[w]&&i[w].enabled,E=l[w]&&l[w].enabled;b&&!E&&e[w].disable(),!b&&E&&e[w].enable()});const f=l.direction&&l.direction!==i.direction,m=i.loop&&(l.slidesPerView!==i.slidesPerView||f),g=i.loop;f&&r&&e.changeDirection(),va(e.params,l);const v=e.params.enabled,y=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),p&&!v?e.disable():!p&&v&&e.enable(),e.currentBreakpoint=a,e.emit("_beforeBreakpoint",l),r&&(m?(e.loopDestroy(),e.loopCreate(t),e.updateSlides()):!g&&y?(e.loopCreate(t),e.updateSlides()):g&&!y&&e.loopDestroy()),e.emit("breakpoint",l)}function $We(e,t,r){if(t===void 0&&(t="window"),!e||t==="container"&&!r)return;let i=!1;const n=Ia(),s=t==="window"?n.innerHeight:r.clientHeight,a=Object.keys(e).map(o=>{if(typeof o=="string"&&o.indexOf("@")===0){const l=parseFloat(o.substr(1));return{value:s*l,point:o}}return{value:o,point:o}});a.sort((o,l)=>parseInt(o.value,10)-parseInt(l.value,10));for(let o=0;o<a.length;o+=1){const{point:l,value:c}=a[o];t==="window"?n.matchMedia(`(min-width: ${c}px)`).matches&&(i=l):c<=r.clientWidth&&(i=l)}return i||"max"}var QWe={setBreakpoint:XWe,getBreakpoint:$We};function KWe(e,t){const r=[];return e.forEach(i=>{typeof i=="object"?Object.keys(i).forEach(n=>{i[n]&&r.push(t+n)}):typeof i=="string"&&r.push(t+i)}),r}function ZWe(){const e=this,{classNames:t,params:r,rtl:i,el:n,device:s}=e,a=KWe(["initialized",r.direction,{"free-mode":e.params.freeMode&&r.freeMode.enabled},{autoheight:r.autoHeight},{rtl:i},{grid:r.grid&&r.grid.rows>1},{"grid-column":r.grid&&r.grid.rows>1&&r.grid.fill==="column"},{android:s.android},{ios:s.ios},{"css-mode":r.cssMode},{centered:r.cssMode&&r.centeredSlides},{"watch-progress":r.watchSlidesProgress}],r.containerModifierClass);t.push(...a),n.classList.add(...t),e.emitContainerClasses()}function JWe(){const e=this,{el:t,classNames:r}=e;!t||typeof t=="string"||(t.classList.remove(...r),e.emitContainerClasses())}var eGe={addClasses:ZWe,removeClasses:JWe};function tGe(){const e=this,{isLocked:t,params:r}=e,{slidesOffsetBefore:i}=r;if(i){const n=e.slides.length-1,s=e.slidesGrid[n]+e.slidesSizesGrid[n]+i*2;e.isLocked=e.size>s}else e.isLocked=e.snapGrid.length===1;r.allowSlideNext===!0&&(e.allowSlideNext=!e.isLocked),r.allowSlidePrev===!0&&(e.allowSlidePrev=!e.isLocked),t&&t!==e.isLocked&&(e.isEnd=!1),t!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}var rGe={checkOverflow:tGe},sR={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function iGe(e,t){return function(i){i===void 0&&(i={});const n=Object.keys(i)[0],s=i[n];if(typeof s!="object"||s===null){va(t,i);return}if(e[n]===!0&&(e[n]={enabled:!0}),n==="navigation"&&e[n]&&e[n].enabled&&!e[n].prevEl&&!e[n].nextEl&&(e[n].auto=!0),["pagination","scrollbar"].indexOf(n)>=0&&e[n]&&e[n].enabled&&!e[n].el&&(e[n].auto=!0),!(n in e&&"enabled"in s)){va(t,i);return}typeof e[n]=="object"&&!("enabled"in e[n])&&(e[n].enabled=!0),e[n]||(e[n]={enabled:!1}),va(t,i)}}const rD={eventsEmitter:eWe,update:hWe,translate:vWe,transition:bWe,slide:PWe,loop:RWe,grabCursor:NWe,events:YWe,breakpoints:QWe,checkOverflow:rGe,classes:eGe},iD={};let fN=class _c{constructor(){let t,r;for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];n.length===1&&n[0].constructor&&Object.prototype.toString.call(n[0]).slice(8,-1)==="Object"?r=n[0]:[t,r]=n,r||(r={}),r=va({},r),t&&!r.el&&(r.el=t);const a=ru();if(r.el&&typeof r.el=="string"&&a.querySelectorAll(r.el).length>1){const u=[];return a.querySelectorAll(r.el).forEach(h=>{const d=va({},r,{el:h});u.push(new _c(d))}),u}const o=this;o.__swiper__=!0,o.support=SJ(),o.device=EJ({userAgent:r.userAgent}),o.browser=KHe(),o.eventsListeners={},o.eventsAnyListeners=[],o.modules=[...o.__modules__],r.modules&&Array.isArray(r.modules)&&o.modules.push(...r.modules);const l={};o.modules.forEach(u=>{u({params:r,swiper:o,extendParams:iGe(r,l),on:o.on.bind(o),once:o.once.bind(o),off:o.off.bind(o),emit:o.emit.bind(o)})});const c=va({},sR,l);return o.params=va({},c,iD,r),o.originalParams=va({},o.params),o.passedParams=va({},r),o.params&&o.params.on&&Object.keys(o.params.on).forEach(u=>{o.on(u,o.params.on[u])}),o.params&&o.params.onAny&&o.onAny(o.params.onAny),Object.assign(o,{enabled:o.params.enabled,el:t,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return o.params.direction==="horizontal"},isVertical(){return o.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:o.params.allowSlideNext,allowSlidePrev:o.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:o.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:o.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),o.emit("_swiper"),o.params.init&&o.init(),o}getDirectionLabel(t){return this.isHorizontal()?t:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[t]}getSlideIndex(t){const{slidesEl:r,params:i}=this,n=Il(r,`.${i.slideClass}, swiper-slide`),s=ZH(n[0]);return ZH(t)-s}getSlideIndexByData(t){return this.getSlideIndex(this.slides.filter(r=>r.getAttribute("data-swiper-slide-index")*1===t)[0])}recalcSlides(){const t=this,{slidesEl:r,params:i}=t;t.slides=Il(r,`.${i.slideClass}, swiper-slide`)}enable(){const t=this;t.enabled||(t.enabled=!0,t.params.grabCursor&&t.setGrabCursor(),t.emit("enable"))}disable(){const t=this;t.enabled&&(t.enabled=!1,t.params.grabCursor&&t.unsetGrabCursor(),t.emit("disable"))}setProgress(t,r){const i=this;t=Math.min(Math.max(t,0),1);const n=i.minTranslate(),a=(i.maxTranslate()-n)*t+n;i.translateTo(a,typeof r>"u"?0:r),i.updateActiveIndex(),i.updateSlidesClasses()}emitContainerClasses(){const t=this;if(!t.params._emitClasses||!t.el)return;const r=t.el.className.split(" ").filter(i=>i.indexOf("swiper")===0||i.indexOf(t.params.containerModifierClass)===0);t.emit("_containerClasses",r.join(" "))}getSlideClasses(t){const r=this;return r.destroyed?"":t.className.split(" ").filter(i=>i.indexOf("swiper-slide")===0||i.indexOf(r.params.slideClass)===0).join(" ")}emitSlidesClasses(){const t=this;if(!t.params._emitClasses||!t.el)return;const r=[];t.slides.forEach(i=>{const n=t.getSlideClasses(i);r.push({slideEl:i,classNames:n}),t.emit("_slideClass",i,n)}),t.emit("_slideClasses",r)}slidesPerViewDynamic(t,r){t===void 0&&(t="current"),r===void 0&&(r=!1);const i=this,{params:n,slides:s,slidesGrid:a,slidesSizesGrid:o,size:l,activeIndex:c}=i;let u=1;if(typeof n.slidesPerView=="number")return n.slidesPerView;if(n.centeredSlides){let h=s[c]?Math.ceil(s[c].swiperSlideSize):0,d;for(let p=c+1;p<s.length;p+=1)s[p]&&!d&&(h+=Math.ceil(s[p].swiperSlideSize),u+=1,h>l&&(d=!0));for(let p=c-1;p>=0;p-=1)s[p]&&!d&&(h+=s[p].swiperSlideSize,u+=1,h>l&&(d=!0))}else if(t==="current")for(let h=c+1;h<s.length;h+=1)(r?a[h]+o[h]-a[c]<l:a[h]-a[c]<l)&&(u+=1);else for(let h=c-1;h>=0;h-=1)a[c]-a[h]<l&&(u+=1);return u}update(){const t=this;if(!t||t.destroyed)return;const{snapGrid:r,params:i}=t;i.breakpoints&&t.setBreakpoint(),[...t.el.querySelectorAll('[loading="lazy"]')].forEach(a=>{a.complete&&b_(t,a)}),t.updateSize(),t.updateSlides(),t.updateProgress(),t.updateSlidesClasses();function n(){const a=t.rtlTranslate?t.translate*-1:t.translate,o=Math.min(Math.max(a,t.maxTranslate()),t.minTranslate());t.setTranslate(o),t.updateActiveIndex(),t.updateSlidesClasses()}let s;if(i.freeMode&&i.freeMode.enabled&&!i.cssMode)n(),i.autoHeight&&t.updateAutoHeight();else{if((i.slidesPerView==="auto"||i.slidesPerView>1)&&t.isEnd&&!i.centeredSlides){const a=t.virtual&&i.virtual.enabled?t.virtual.slides:t.slides;s=t.slideTo(a.length-1,0,!1,!0)}else s=t.slideTo(t.activeIndex,0,!1,!0);s||n()}i.watchOverflow&&r!==t.snapGrid&&t.checkOverflow(),t.emit("update")}changeDirection(t,r){r===void 0&&(r=!0);const i=this,n=i.params.direction;return t||(t=n==="horizontal"?"vertical":"horizontal"),t===n||t!=="horizontal"&&t!=="vertical"||(i.el.classList.remove(`${i.params.containerModifierClass}${n}`),i.el.classList.add(`${i.params.containerModifierClass}${t}`),i.emitContainerClasses(),i.params.direction=t,i.slides.forEach(s=>{t==="vertical"?s.style.width="":s.style.height=""}),i.emit("changeDirection"),r&&i.update()),i}changeLanguageDirection(t){const r=this;r.rtl&&t==="rtl"||!r.rtl&&t==="ltr"||(r.rtl=t==="rtl",r.rtlTranslate=r.params.direction==="horizontal"&&r.rtl,r.rtl?(r.el.classList.add(`${r.params.containerModifierClass}rtl`),r.el.dir="rtl"):(r.el.classList.remove(`${r.params.containerModifierClass}rtl`),r.el.dir="ltr"),r.update())}mount(t){const r=this;if(r.mounted)return!0;let i=t||r.params.el;if(typeof i=="string"&&(i=document.querySelector(i)),!i)return!1;i.swiper=r,i.parentNode&&i.parentNode.host&&i.parentNode.host.nodeName===r.params.swiperElementNodeName.toUpperCase()&&(r.isElement=!0);const n=()=>`.${(r.params.wrapperClass||"").trim().split(" ").join(".")}`;let a=i&&i.shadowRoot&&i.shadowRoot.querySelector?i.shadowRoot.querySelector(n()):Il(i,n())[0];return!a&&r.params.createElements&&(a=_w("div",r.params.wrapperClass),i.append(a),Il(i,`.${r.params.slideClass}`).forEach(o=>{a.append(o)})),Object.assign(r,{el:i,wrapperEl:a,slidesEl:r.isElement&&!i.parentNode.host.slideSlots?i.parentNode.host:a,hostEl:r.isElement?i.parentNode.host:i,mounted:!0,rtl:i.dir.toLowerCase()==="rtl"||xh(i,"direction")==="rtl",rtlTranslate:r.params.direction==="horizontal"&&(i.dir.toLowerCase()==="rtl"||xh(i,"direction")==="rtl"),wrongRTL:xh(a,"display")==="-webkit-box"}),!0}init(t){const r=this;if(r.initialized||r.mount(t)===!1)return r;r.emit("beforeInit"),r.params.breakpoints&&r.setBreakpoint(),r.addClasses(),r.updateSize(),r.updateSlides(),r.params.watchOverflow&&r.checkOverflow(),r.params.grabCursor&&r.enabled&&r.setGrabCursor(),r.params.loop&&r.virtual&&r.params.virtual.enabled?r.slideTo(r.params.initialSlide+r.virtual.slidesBefore,0,r.params.runCallbacksOnInit,!1,!0):r.slideTo(r.params.initialSlide,0,r.params.runCallbacksOnInit,!1,!0),r.params.loop&&r.loopCreate(),r.attachEvents();const n=[...r.el.querySelectorAll('[loading="lazy"]')];return r.isElement&&n.push(...r.hostEl.querySelectorAll('[loading="lazy"]')),n.forEach(s=>{s.complete?b_(r,s):s.addEventListener("load",a=>{b_(r,a.target)})}),nR(r),r.initialized=!0,nR(r),r.emit("init"),r.emit("afterInit"),r}destroy(t,r){t===void 0&&(t=!0),r===void 0&&(r=!0);const i=this,{params:n,el:s,wrapperEl:a,slides:o}=i;return typeof i.params>"u"||i.destroyed||(i.emit("beforeDestroy"),i.initialized=!1,i.detachEvents(),n.loop&&i.loopDestroy(),r&&(i.removeClasses(),s&&typeof s!="string"&&s.removeAttribute("style"),a&&a.removeAttribute("style"),o&&o.length&&o.forEach(l=>{l.classList.remove(n.slideVisibleClass,n.slideFullyVisibleClass,n.slideActiveClass,n.slideNextClass,n.slidePrevClass),l.removeAttribute("style"),l.removeAttribute("data-swiper-slide-index")})),i.emit("destroy"),Object.keys(i.eventsListeners).forEach(l=>{i.off(l)}),t!==!1&&(i.el&&typeof i.el!="string"&&(i.el.swiper=null),jHe(i)),i.destroyed=!0),null}static extendDefaults(t){va(iD,t)}static get extendedDefaults(){return iD}static get defaults(){return sR}static installModule(t){_c.prototype.__modules__||(_c.prototype.__modules__=[]);const r=_c.prototype.__modules__;typeof t=="function"&&r.indexOf(t)<0&&r.push(t)}static use(t){return Array.isArray(t)?(t.forEach(r=>_c.installModule(r)),_c):(_c.installModule(t),_c)}};Object.keys(rD).forEach(e=>{Object.keys(rD[e]).forEach(t=>{fN.prototype[t]=rD[e][t]})});fN.use([ZHe,JHe]);const AJ=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function Np(e){return typeof e=="object"&&e!==null&&e.constructor&&Object.prototype.toString.call(e).slice(8,-1)==="Object"&&!e.__swiper__}function Km(e,t){const r=["__proto__","constructor","prototype"];Object.keys(t).filter(i=>r.indexOf(i)<0).forEach(i=>{typeof e[i]>"u"?e[i]=t[i]:Np(t[i])&&Np(e[i])&&Object.keys(t[i]).length>0?t[i].__swiper__?e[i]=t[i]:Km(e[i],t[i]):e[i]=t[i]})}function MJ(e){return e===void 0&&(e={}),e.navigation&&typeof e.navigation.nextEl>"u"&&typeof e.navigation.prevEl>"u"}function PJ(e){return e===void 0&&(e={}),e.pagination&&typeof e.pagination.el>"u"}function DJ(e){return e===void 0&&(e={}),e.scrollbar&&typeof e.scrollbar.el>"u"}function IJ(e){e===void 0&&(e="");const t=e.split(" ").map(i=>i.trim()).filter(i=>!!i),r=[];return t.forEach(i=>{r.indexOf(i)<0&&r.push(i)}),r.join(" ")}function nGe(e){return e===void 0&&(e=""),e?e.includes("swiper-wrapper")?e:`swiper-wrapper ${e}`:"swiper-wrapper"}function sGe(e){let{swiper:t,slides:r,passedParams:i,changedParams:n,nextEl:s,prevEl:a,scrollbarEl:o,paginationEl:l}=e;const c=n.filter(A=>A!=="children"&&A!=="direction"&&A!=="wrapperClass"),{params:u,pagination:h,navigation:d,scrollbar:p,virtual:f,thumbs:m}=t;let g,v,y,w,b,E,_,C;n.includes("thumbs")&&i.thumbs&&i.thumbs.swiper&&u.thumbs&&!u.thumbs.swiper&&(g=!0),n.includes("controller")&&i.controller&&i.controller.control&&u.controller&&!u.controller.control&&(v=!0),n.includes("pagination")&&i.pagination&&(i.pagination.el||l)&&(u.pagination||u.pagination===!1)&&h&&!h.el&&(y=!0),n.includes("scrollbar")&&i.scrollbar&&(i.scrollbar.el||o)&&(u.scrollbar||u.scrollbar===!1)&&p&&!p.el&&(w=!0),n.includes("navigation")&&i.navigation&&(i.navigation.prevEl||a)&&(i.navigation.nextEl||s)&&(u.navigation||u.navigation===!1)&&d&&!d.prevEl&&!d.nextEl&&(b=!0);const x=A=>{t[A]&&(t[A].destroy(),A==="navigation"?(t.isElement&&(t[A].prevEl.remove(),t[A].nextEl.remove()),u[A].prevEl=void 0,u[A].nextEl=void 0,t[A].prevEl=void 0,t[A].nextEl=void 0):(t.isElement&&t[A].el.remove(),u[A].el=void 0,t[A].el=void 0))};n.includes("loop")&&t.isElement&&(u.loop&&!i.loop?E=!0:!u.loop&&i.loop?_=!0:C=!0),c.forEach(A=>{if(Np(u[A])&&Np(i[A]))Object.assign(u[A],i[A]),(A==="navigation"||A==="pagination"||A==="scrollbar")&&"enabled"in i[A]&&!i[A].enabled&&x(A);else{const T=i[A];(T===!0||T===!1)&&(A==="navigation"||A==="pagination"||A==="scrollbar")?T===!1&&x(A):u[A]=i[A]}}),c.includes("controller")&&!v&&t.controller&&t.controller.control&&u.controller&&u.controller.control&&(t.controller.control=u.controller.control),n.includes("children")&&r&&f&&u.virtual.enabled?(f.slides=r,f.update(!0)):n.includes("virtual")&&f&&u.virtual.enabled&&(r&&(f.slides=r),f.update(!0)),n.includes("children")&&r&&u.loop&&(C=!0),g&&m.init()&&m.update(!0),v&&(t.controller.control=u.controller.control),y&&(t.isElement&&(!l||typeof l=="string")&&(l=document.createElement("div"),l.classList.add("swiper-pagination"),l.part.add("pagination"),t.el.appendChild(l)),l&&(u.pagination.el=l),h.init(),h.render(),h.update()),w&&(t.isElement&&(!o||typeof o=="string")&&(o=document.createElement("div"),o.classList.add("swiper-scrollbar"),o.part.add("scrollbar"),t.el.appendChild(o)),o&&(u.scrollbar.el=o),p.init(),p.updateSize(),p.setTranslate()),b&&(t.isElement&&((!s||typeof s=="string")&&(s=document.createElement("div"),s.classList.add("swiper-button-next"),s.innerHTML=t.hostEl.constructor.nextButtonSvg,s.part.add("button-next"),t.el.appendChild(s)),(!a||typeof a=="string")&&(a=document.createElement("div"),a.classList.add("swiper-button-prev"),a.innerHTML=t.hostEl.constructor.prevButtonSvg,a.part.add("button-prev"),t.el.appendChild(a))),s&&(u.navigation.nextEl=s),a&&(u.navigation.prevEl=a),d.init(),d.update()),n.includes("allowSlideNext")&&(t.allowSlideNext=i.allowSlideNext),n.includes("allowSlidePrev")&&(t.allowSlidePrev=i.allowSlidePrev),n.includes("direction")&&t.changeDirection(i.direction,!1),(E||C)&&t.loopDestroy(),(_||C)&&t.loopCreate(),t.update()}function aGe(e,t){e===void 0&&(e={}),t===void 0&&(t=!0);const r={on:{}},i={},n={};Km(r,sR),r._emitClasses=!0,r.init=!1;const s={},a=AJ.map(l=>l.replace(/_/,"")),o=Object.assign({},e);return Object.keys(o).forEach(l=>{typeof e[l]>"u"||(a.indexOf(l)>=0?Np(e[l])?(r[l]={},n[l]={},Km(r[l],e[l]),Km(n[l],e[l])):(r[l]=e[l],n[l]=e[l]):l.search(/on[A-Z]/)===0&&typeof e[l]=="function"?t?i[`${l[2].toLowerCase()}${l.substr(3)}`]=e[l]:r.on[`${l[2].toLowerCase()}${l.substr(3)}`]=e[l]:s[l]=e[l])}),["navigation","pagination","scrollbar"].forEach(l=>{r[l]===!0&&(r[l]={}),r[l]===!1&&delete r[l]}),{params:r,passedParams:n,rest:s,events:i}}function oGe(e,t){let{el:r,nextEl:i,prevEl:n,paginationEl:s,scrollbarEl:a,swiper:o}=e;MJ(t)&&i&&n&&(o.params.navigation.nextEl=i,o.originalParams.navigation.nextEl=i,o.params.navigation.prevEl=n,o.originalParams.navigation.prevEl=n),PJ(t)&&s&&(o.params.pagination.el=s,o.originalParams.pagination.el=s),DJ(t)&&a&&(o.params.scrollbar.el=a,o.originalParams.scrollbar.el=a),o.init(r)}function lGe(e,t,r,i,n){const s=[];if(!t)return s;const a=l=>{s.indexOf(l)<0&&s.push(l)};if(r&&i){const l=i.map(n),c=r.map(n);l.join("")!==c.join("")&&a("children"),i.length!==r.length&&a("children")}return AJ.filter(l=>l[0]==="_").map(l=>l.replace(/_/,"")).forEach(l=>{if(l in e&&l in t)if(Np(e[l])&&Np(t[l])){const c=Object.keys(e[l]),u=Object.keys(t[l]);c.length!==u.length?a(l):(c.forEach(h=>{e[l][h]!==t[l][h]&&a(l)}),u.forEach(h=>{e[l][h]!==t[l][h]&&a(l)}))}else e[l]!==t[l]&&a(l)}),s}const cGe=e=>{!e||e.destroyed||!e.params.virtual||e.params.virtual&&!e.params.virtual.enabled||(e.updateSlides(),e.updateProgress(),e.updateSlidesClasses(),e.parallax&&e.params.parallax&&e.params.parallax.enabled&&e.parallax.setTranslate())};function qE(){return qE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},qE.apply(this,arguments)}function OJ(e){return e.type&&e.type.displayName&&e.type.displayName.includes("SwiperSlide")}function RJ(e){const t=[];return fe.Children.toArray(e).forEach(r=>{OJ(r)?t.push(r):r.props&&r.props.children&&RJ(r.props.children).forEach(i=>t.push(i))}),t}function uGe(e){const t=[],r={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return fe.Children.toArray(e).forEach(i=>{if(OJ(i))t.push(i);else if(i.props&&i.props.slot&&r[i.props.slot])r[i.props.slot].push(i);else if(i.props&&i.props.children){const n=RJ(i.props.children);n.length>0?n.forEach(s=>t.push(s)):r["container-end"].push(i)}else r["container-end"].push(i)}),{slides:t,slots:r}}function hGe(e,t,r){if(!r)return null;const i=u=>{let h=u;return u<0?h=t.length+u:h>=t.length&&(h=h-t.length),h},n=e.isHorizontal()?{[e.rtlTranslate?"right":"left"]:`${r.offset}px`}:{top:`${r.offset}px`},{from:s,to:a}=r,o=e.params.loop?-t.length:0,l=e.params.loop?t.length*2:t.length,c=[];for(let u=o;u<l;u+=1)u>=s&&u<=a&&c.push(t[i(u)]);return c.map((u,h)=>fe.cloneElement(u,{swiper:e,style:n,key:u.props.virtualIndex||u.key||`slide-${h}`}))}function m0(e,t){return typeof window>"u"?te.useEffect(e,t):te.useLayoutEffect(e,t)}const nW=te.createContext(null),dGe=te.createContext(null),kJ=te.forwardRef(function(e,t){let{className:r,tag:i="div",wrapperTag:n="div",children:s,onSwiper:a,...o}=e===void 0?{}:e,l=!1;const[c,u]=te.useState("swiper"),[h,d]=te.useState(null),[p,f]=te.useState(!1),m=te.useRef(!1),g=te.useRef(null),v=te.useRef(null),y=te.useRef(null),w=te.useRef(null),b=te.useRef(null),E=te.useRef(null),_=te.useRef(null),C=te.useRef(null),{params:x,passedParams:A,rest:T,events:M}=aGe(o),{slides:D,slots:P}=uGe(s),I=()=>{f(!p)};Object.assign(x.on,{_containerClasses(W,G){u(G)}});const B=()=>{Object.assign(x.on,M),l=!0;const W={...x};if(delete W.wrapperClass,v.current=new fN(W),v.current.virtual&&v.current.params.virtual.enabled){v.current.virtual.slides=D;const G={cache:!1,slides:D,renderExternal:d,renderExternalUpdate:!1};Km(v.current.params.virtual,G),Km(v.current.originalParams.virtual,G)}};g.current||B(),v.current&&v.current.on("_beforeBreakpoint",I);const V=()=>{l||!M||!v.current||Object.keys(M).forEach(W=>{v.current.on(W,M[W])})},N=()=>{!M||!v.current||Object.keys(M).forEach(W=>{v.current.off(W,M[W])})};te.useEffect(()=>()=>{v.current&&v.current.off("_beforeBreakpoint",I)}),te.useEffect(()=>{!m.current&&v.current&&(v.current.emitSlidesClasses(),m.current=!0)}),m0(()=>{if(t&&(t.current=g.current),!!g.current)return v.current.destroyed&&B(),oGe({el:g.current,nextEl:b.current,prevEl:E.current,paginationEl:_.current,scrollbarEl:C.current,swiper:v.current},x),a&&!v.current.destroyed&&a(v.current),()=>{v.current&&!v.current.destroyed&&v.current.destroy(!0,!1)}},[]),m0(()=>{V();const W=lGe(A,y.current,D,w.current,G=>G.key);return y.current=A,w.current=D,W.length&&v.current&&!v.current.destroyed&&sGe({swiper:v.current,slides:D,passedParams:A,changedParams:W,nextEl:b.current,prevEl:E.current,scrollbarEl:C.current,paginationEl:_.current}),()=>{N()}}),m0(()=>{cGe(v.current)},[h]);function L(){return x.virtual?hGe(v.current,D,h):D.map((W,G)=>fe.cloneElement(W,{swiper:v.current,swiperSlideIndex:G}))}return fe.createElement(i,qE({ref:g,className:IJ(`${c}${r?` ${r}`:""}`)},T),fe.createElement(dGe.Provider,{value:v.current},P["container-start"],fe.createElement(n,{className:nGe(x.wrapperClass)},P["wrapper-start"],L(),P["wrapper-end"]),MJ(x)&&fe.createElement(fe.Fragment,null,fe.createElement("div",{ref:E,className:"swiper-button-prev"}),fe.createElement("div",{ref:b,className:"swiper-button-next"})),DJ(x)&&fe.createElement("div",{ref:C,className:"swiper-scrollbar"}),PJ(x)&&fe.createElement("div",{ref:_,className:"swiper-pagination"}),P["container-end"]))});kJ.displayName="Swiper";const LJ=te.forwardRef(function(e,t){let{tag:r="div",children:i,className:n="",swiper:s,zoom:a,lazy:o,virtualIndex:l,swiperSlideIndex:c,...u}=e===void 0?{}:e;const h=te.useRef(null),[d,p]=te.useState("swiper-slide"),[f,m]=te.useState(!1);function g(b,E,_){E===h.current&&p(_)}m0(()=>{if(typeof c<"u"&&(h.current.swiperSlideIndex=c),t&&(t.current=h.current),!(!h.current||!s)){if(s.destroyed){d!=="swiper-slide"&&p("swiper-slide");return}return s.on("_slideClass",g),()=>{s&&s.off("_slideClass",g)}}}),m0(()=>{s&&h.current&&!s.destroyed&&p(s.getSlideClasses(h.current))},[s]);const v={isActive:d.indexOf("swiper-slide-active")>=0,isVisible:d.indexOf("swiper-slide-visible")>=0,isPrev:d.indexOf("swiper-slide-prev")>=0,isNext:d.indexOf("swiper-slide-next")>=0},y=()=>typeof i=="function"?i(v):i,w=()=>{m(!0)};return fe.createElement(r,qE({ref:h,className:IJ(`${d}${n?` ${n}`:""}`),"data-swiper-slide-index":l,onLoad:w},u),a&&fe.createElement(nW.Provider,{value:v},fe.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof a=="number"?a:void 0},y(),o&&!f&&fe.createElement("div",{className:"swiper-lazy-preloader"}))),!a&&fe.createElement(nW.Provider,{value:v},y(),o&&!f&&fe.createElement("div",{className:"swiper-lazy-preloader"})))});LJ.displayName="SwiperSlide";function pGe(e,t,r,i){return e.params.createElements&&Object.keys(i).forEach(n=>{if(!r[n]&&r.auto===!0){let s=Il(e.el,`.${i[n]}`)[0];s||(s=_w("div",i[n]),s.className=i[n],e.el.append(s)),r[n]=s,t[n]=s}}),r}function fGe(e){let{swiper:t,extendParams:r,on:i,emit:n}=e;r({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),t.navigation={nextEl:null,prevEl:null};function s(f){let m;return f&&typeof f=="string"&&t.isElement&&(m=t.el.querySelector(f),m)?m:(f&&(typeof f=="string"&&(m=[...document.querySelectorAll(f)]),t.params.uniqueNavElements&&typeof f=="string"&&m&&m.length>1&&t.el.querySelectorAll(f).length===1?m=t.el.querySelector(f):m&&m.length===1&&(m=m[0])),f&&!m?f:m)}function a(f,m){const g=t.params.navigation;f=yc(f),f.forEach(v=>{v&&(v.classList[m?"add":"remove"](...g.disabledClass.split(" ")),v.tagName==="BUTTON"&&(v.disabled=m),t.params.watchOverflow&&t.enabled&&v.classList[t.isLocked?"add":"remove"](g.lockClass))})}function o(){const{nextEl:f,prevEl:m}=t.navigation;if(t.params.loop){a(m,!1),a(f,!1);return}a(m,t.isBeginning&&!t.params.rewind),a(f,t.isEnd&&!t.params.rewind)}function l(f){f.preventDefault(),!(t.isBeginning&&!t.params.loop&&!t.params.rewind)&&(t.slidePrev(),n("navigationPrev"))}function c(f){f.preventDefault(),!(t.isEnd&&!t.params.loop&&!t.params.rewind)&&(t.slideNext(),n("navigationNext"))}function u(){const f=t.params.navigation;if(t.params.navigation=pGe(t,t.originalParams.navigation,t.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(f.nextEl||f.prevEl))return;let m=s(f.nextEl),g=s(f.prevEl);Object.assign(t.navigation,{nextEl:m,prevEl:g}),m=yc(m),g=yc(g);const v=(y,w)=>{y&&y.addEventListener("click",w==="next"?c:l),!t.enabled&&y&&y.classList.add(...f.lockClass.split(" "))};m.forEach(y=>v(y,"next")),g.forEach(y=>v(y,"prev"))}function h(){let{nextEl:f,prevEl:m}=t.navigation;f=yc(f),m=yc(m);const g=(v,y)=>{v.removeEventListener("click",y==="next"?c:l),v.classList.remove(...t.params.navigation.disabledClass.split(" "))};f.forEach(v=>g(v,"next")),m.forEach(v=>g(v,"prev"))}i("init",()=>{t.params.navigation.enabled===!1?p():(u(),o())}),i("toEdge fromEdge lock unlock",()=>{o()}),i("destroy",()=>{h()}),i("enable disable",()=>{let{nextEl:f,prevEl:m}=t.navigation;if(f=yc(f),m=yc(m),t.enabled){o();return}[...f,...m].filter(g=>!!g).forEach(g=>g.classList.add(t.params.navigation.lockClass))}),i("click",(f,m)=>{let{nextEl:g,prevEl:v}=t.navigation;g=yc(g),v=yc(v);const y=m.target;let w=v.includes(y)||g.includes(y);if(t.isElement&&!w){const b=m.path||m.composedPath&&m.composedPath();b&&(w=b.find(E=>g.includes(E)||v.includes(E)))}if(t.params.navigation.hideOnClick&&!w){if(t.pagination&&t.params.pagination&&t.params.pagination.clickable&&(t.pagination.el===y||t.pagination.el.contains(y)))return;let b;g.length?b=g[0].classList.contains(t.params.navigation.hiddenClass):v.length&&(b=v[0].classList.contains(t.params.navigation.hiddenClass)),n(b===!0?"navigationShow":"navigationHide"),[...g,...v].filter(E=>!!E).forEach(E=>E.classList.toggle(t.params.navigation.hiddenClass))}});const d=()=>{t.el.classList.remove(...t.params.navigation.navigationDisabledClass.split(" ")),u(),o()},p=()=>{t.el.classList.add(...t.params.navigation.navigationDisabledClass.split(" ")),h()};Object.assign(t.navigation,{enable:d,disable:p,update:o,init:u,destroy:h})}function mGe(e){let{swiper:t,extendParams:r,on:i,emit:n,params:s}=e;t.autoplay={running:!1,paused:!1,timeLeft:0},r({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let a,o,l=s&&s.autoplay?s.autoplay.delay:3e3,c=s&&s.autoplay?s.autoplay.delay:3e3,u,h=new Date().getTime(),d,p,f,m,g,v,y;function w(L){!t||t.destroyed||!t.wrapperEl||L.target===t.wrapperEl&&(t.wrapperEl.removeEventListener("transitionend",w),!(y||L.detail&&L.detail.bySwiperTouchMove)&&T())}const b=()=>{if(t.destroyed||!t.autoplay.running)return;t.autoplay.paused?d=!0:d&&(c=u,d=!1);const L=t.autoplay.paused?u:h+c-new Date().getTime();t.autoplay.timeLeft=L,n("autoplayTimeLeft",L,L/l),o=requestAnimationFrame(()=>{b()})},E=()=>{let L;return t.virtual&&t.params.virtual.enabled?L=t.slides.filter(G=>G.classList.contains("swiper-slide-active"))[0]:L=t.slides[t.activeIndex],L?parseInt(L.getAttribute("data-swiper-autoplay"),10):void 0},_=L=>{if(t.destroyed||!t.autoplay.running)return;cancelAnimationFrame(o),b();let W=typeof L>"u"?t.params.autoplay.delay:L;l=t.params.autoplay.delay,c=t.params.autoplay.delay;const G=E();!Number.isNaN(G)&&G>0&&typeof L>"u"&&(W=G,l=G,c=G),u=W;const X=t.params.speed,Q=()=>{!t||t.destroyed||(t.params.autoplay.reverseDirection?!t.isBeginning||t.params.loop||t.params.rewind?(t.slidePrev(X,!0,!0),n("autoplay")):t.params.autoplay.stopOnLastSlide||(t.slideTo(t.slides.length-1,X,!0,!0),n("autoplay")):!t.isEnd||t.params.loop||t.params.rewind?(t.slideNext(X,!0,!0),n("autoplay")):t.params.autoplay.stopOnLastSlide||(t.slideTo(0,X,!0,!0),n("autoplay")),t.params.cssMode&&(h=new Date().getTime(),requestAnimationFrame(()=>{_()})))};return W>0?(clearTimeout(a),a=setTimeout(()=>{Q()},W)):requestAnimationFrame(()=>{Q()}),W},C=()=>{h=new Date().getTime(),t.autoplay.running=!0,_(),n("autoplayStart")},x=()=>{t.autoplay.running=!1,clearTimeout(a),cancelAnimationFrame(o),n("autoplayStop")},A=(L,W)=>{if(t.destroyed||!t.autoplay.running)return;clearTimeout(a),L||(v=!0);const G=()=>{n("autoplayPause"),t.params.autoplay.waitForTransition?t.wrapperEl.addEventListener("transitionend",w):T()};if(t.autoplay.paused=!0,W){g&&(u=t.params.autoplay.delay),g=!1,G();return}u=(u||t.params.autoplay.delay)-(new Date().getTime()-h),!(t.isEnd&&u<0&&!t.params.loop)&&(u<0&&(u=0),G())},T=()=>{t.isEnd&&u<0&&!t.params.loop||t.destroyed||!t.autoplay.running||(h=new Date().getTime(),v?(v=!1,_(u)):_(),t.autoplay.paused=!1,n("autoplayResume"))},M=()=>{if(t.destroyed||!t.autoplay.running)return;const L=ru();L.visibilityState==="hidden"&&(v=!0,A(!0)),L.visibilityState==="visible"&&T()},D=L=>{L.pointerType==="mouse"&&(v=!0,y=!0,!(t.animating||t.autoplay.paused)&&A(!0))},P=L=>{L.pointerType==="mouse"&&(y=!1,t.autoplay.paused&&T())},I=()=>{t.params.autoplay.pauseOnMouseEnter&&(t.el.addEventListener("pointerenter",D),t.el.addEventListener("pointerleave",P))},B=()=>{t.el&&typeof t.el!="string"&&(t.el.removeEventListener("pointerenter",D),t.el.removeEventListener("pointerleave",P))},V=()=>{ru().addEventListener("visibilitychange",M)},N=()=>{ru().removeEventListener("visibilitychange",M)};i("init",()=>{t.params.autoplay.enabled&&(I(),V(),C())}),i("destroy",()=>{B(),N(),t.autoplay.running&&x()}),i("_freeModeStaticRelease",()=>{(f||v)&&T()}),i("_freeModeNoMomentumRelease",()=>{t.params.autoplay.disableOnInteraction?x():A(!0,!0)}),i("beforeTransitionStart",(L,W,G)=>{t.destroyed||!t.autoplay.running||(G||!t.params.autoplay.disableOnInteraction?A(!0,!0):x())}),i("sliderFirstMove",()=>{if(!(t.destroyed||!t.autoplay.running)){if(t.params.autoplay.disableOnInteraction){x();return}p=!0,f=!1,v=!1,m=setTimeout(()=>{v=!0,f=!0,A(!0)},200)}}),i("touchEnd",()=>{if(!(t.destroyed||!t.autoplay.running||!p)){if(clearTimeout(m),clearTimeout(a),t.params.autoplay.disableOnInteraction){f=!1,p=!1;return}f&&t.params.cssMode&&T(),f=!1,p=!1}}),i("slideChange",()=>{t.destroyed||!t.autoplay.running||(g=!0)}),Object.assign(t.autoplay,{start:C,stop:x,pause:A,resume:T})}function gGe(e){const{effect:t,swiper:r,on:i,setTranslate:n,setTransition:s,overwriteParams:a,perspective:o,recreateShadows:l,getEffectParams:c}=e;i("beforeInit",()=>{if(r.params.effect!==t)return;r.classNames.push(`${r.params.containerModifierClass}${t}`),o&&o()&&r.classNames.push(`${r.params.containerModifierClass}3d`);const h=a?a():{};Object.assign(r.params,h),Object.assign(r.originalParams,h)}),i("setTranslate",()=>{r.params.effect===t&&n()}),i("setTransition",(h,d)=>{r.params.effect===t&&s(d)}),i("transitionEnd",()=>{if(r.params.effect===t&&l){if(!c||!c().slideShadows)return;r.slides.forEach(h=>{h.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(d=>d.remove())}),l()}});let u;i("virtualUpdate",()=>{r.params.effect===t&&(r.slides.length||(u=!0),requestAnimationFrame(()=>{u&&r.slides&&r.slides.length&&(n(),u=!1)}))})}function vGe(e,t){const r=pN(t);return r!==t&&(r.style.backfaceVisibility="hidden",r.style["-webkit-backface-visibility"]="hidden"),r}function sW(e,t,r){const i=`swiper-slide-shadow${r?`-${r}`:""}${e?` swiper-slide-shadow-${e}`:""}`,n=pN(t);let s=n.querySelector(`.${i.split(" ").join(".")}`);return s||(s=_w("div",i.split(" ")),n.append(s)),s}function yGe(e){let{swiper:t,extendParams:r,on:i}=e;r({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),gGe({effect:"coverflow",swiper:t,on:i,setTranslate:()=>{const{width:a,height:o,slides:l,slidesSizesGrid:c}=t,u=t.params.coverflowEffect,h=t.isHorizontal(),d=t.translate,p=h?-d+a/2:-d+o/2,f=h?u.rotate:-u.rotate,m=u.depth;for(let g=0,v=l.length;g<v;g+=1){const y=l[g],w=c[g],b=y.swiperSlideOffset,E=(p-b-w/2)/w,_=typeof u.modifier=="function"?u.modifier(E):E*u.modifier;let C=h?f*_:0,x=h?0:f*_,A=-m*Math.abs(_),T=u.stretch;typeof T=="string"&&T.indexOf("%")!==-1&&(T=parseFloat(u.stretch)/100*w);let M=h?0:T*_,D=h?T*_:0,P=1-(1-u.scale)*Math.abs(_);Math.abs(D)<.001&&(D=0),Math.abs(M)<.001&&(M=0),Math.abs(A)<.001&&(A=0),Math.abs(C)<.001&&(C=0),Math.abs(x)<.001&&(x=0),Math.abs(P)<.001&&(P=0),t.browser&&t.browser.need3dFix&&(Math.abs(C)/90%2===1&&(C+=.001),Math.abs(x)/90%2===1&&(x+=.001));const I=`translate3d(${D}px,${M}px,${A}px)  rotateX(${x}deg) rotateY(${C}deg) scale(${P})`,B=vGe(u,y);if(B.style.transform=I,y.style.zIndex=-Math.abs(Math.round(_))+1,u.slideShadows){let V=h?y.querySelector(".swiper-slide-shadow-left"):y.querySelector(".swiper-slide-shadow-top"),N=h?y.querySelector(".swiper-slide-shadow-right"):y.querySelector(".swiper-slide-shadow-bottom");V||(V=sW("coverflow",y,h?"left":"top")),N||(N=sW("coverflow",y,h?"right":"bottom")),V&&(V.style.opacity=_>0?_:0),N&&(N.style.opacity=-_>0?-_:0)}}},setTransition:a=>{t.slides.map(l=>pN(l)).forEach(l=>{l.style.transitionDuration=`${a}ms`,l.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(c=>{c.style.transitionDuration=`${a}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}const wGe="/YoloTravelerAsia/assets/pic1-RqsvUbtu.jpg",xGe="/YoloTravelerAsia/assets/pic2-Bm-5Y2M0.jpg",bGe="/YoloTravelerAsia/assets/pic3-1qpFio6J.jpg",_Ge="/YoloTravelerAsia/assets/pic4-DXZo30Eh.png",SGe="/YoloTravelerAsia/assets/pic5-CmHPeJCz.jpg",EGe="/YoloTravelerAsia/assets/pic6-_BZSgA71.jpg",aW=[wGe,xGe,bGe,_Ge,SGe,EGe];function NJ(){const[e,t]=te.useState(0);return te.useEffect(()=>{const r=()=>{const i=window.innerHeight,n=window.innerWidth,s=document.querySelector(".swiper-container");s&&(s.style.height=`${i*.5}px`,s.style.width=`${n*.8}px`)};return r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),k.jsx("div",{className:"relative flex items-center justify-center  w-full h-[75%] bg-cover bg-center transition-all duration-500 ease-in-out  mt-16 ",style:{backgroundImage:`url(${aW[e]})`},children:k.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-50",children:[k.jsxs("div",{className:"text-center my-8 w-full px-4",children:[k.jsxs("h1",{className:"text-3xl md:text-5xl font-bold text-white sea-waves-animation font-sans",children:[k.jsx("span",{className:"text-secondary",children:"Seize "}),k.jsx("span",{className:"text-secondary",children:"The "}),k.jsx("span",{className:"text-primary",children:"Moment, "}),k.jsx("span",{className:"text-primary",children:"Explore "}),k.jsx("span",{className:"text-fourth",children:"Fearlessly"})]}),k.jsx("div",{className:"flex justify-center mt-2 w-full",children:k.jsx("h3",{className:"text-lg md:text-xl text-white",children:"- YoloTravellerAsia"})})]}),k.jsx(kJ,{effect:"coverflow",grabCursor:!0,centeredSlides:!0,loop:!0,slidesPerView:"auto",coverflowEffect:{rotate:0,stretch:0,depth:100,modifier:2.5},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev",clickable:!0},autoplay:{delay:2e3,disableOnInteraction:!1},modules:[yGe,fGe,mGe],className:"swiper-container w-max-lg h-max mb-5",onSlideChange:r=>t(r.realIndex),children:aW.map((r,i)=>k.jsx(LJ,{className:"flex items-center justify-center md:w-[30rem] md:h-[20rem] ",children:k.jsx("img",{src:r,alt:`slide_image_${i+1}`,className:"w-full h-full object-cover rounded-2xl"})},i))}),k.jsx("div",{className:"absolute bottom-0 w-full h-[100px] bg-gradient-to-b from-transparent to-black pointer-events-none"})]})})}const TGe="/YoloTravelerAsia/assets/mamrosie-B1HlYzWP.jpeg",CGe="/YoloTravelerAsia/assets/chazz-kRPkp7Od.jpg",AGe="/YoloTravelerAsia/assets/jess-CJrNxmCX.jpeg",MGe=()=>k.jsx("div",{className:"flex items-center justify-center text-center bg-[#F5F5F5] py-8","data-aos":"fade-up","data-aos-delay":"100",children:k.jsxs("div",{className:"flex flex-col p-6 m-4 max-w-full md:max-w-4xl",children:[k.jsx("div",{className:"text-3xl text-[#008080]  font-bold mb-4",children:"Meet the Tour Guide"}),k.jsx("div",{className:"text-sm md:text-xl mb-6 text-[#202830]",children:"Our dedicated CEO who ensures your journey is seamless and enjoyable."}),k.jsxs("div",{className:"flex items-center justify-center mb-6","data-aos":"fade-up","data-aos-delay":"100",children:[k.jsx("div",{className:"h-64 w-64  rounded-full overflow-hidden border-2 border-gray-300",children:k.jsx("img",{src:TGe,alt:"Rosie Glenda",className:"object-cover h-full w-full"})}),k.jsxs("div",{className:"flex flex-col text-center md:text-left mt-4 md:mt-0",children:[k.jsx("div",{className:"text-lg font-medium text-[#202830] cursor-pointer hover:text-stone-400",children:"Rosie Glenda"}),k.jsx("div",{className:"italic text-[#202830]",children:"Business Owner"})]})]}),k.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 md:p-6 w-full",children:[k.jsxs("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-x-4 md:space-y-0","data-aos":"fade-up","data-aos-delay":"100",children:[k.jsx("div",{className:"h-64 w-64 rounded-full overflow-hidden border-2 border-gray-300",children:k.jsx("img",{src:CGe,alt:"Chazz",className:"object-cover h-full w-full"})}),k.jsxs("div",{className:"flex flex-col items-center md:items-start mt-4 md:mt-0",children:[k.jsx("div",{className:"text-lg font-medium text-[#202830] cursor-pointer hover:text-stone-400",children:"Daniel"}),k.jsx("div",{className:"italic text-[#202830]",children:"Tour Guide"})]})]}),k.jsxs("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-x-4 md:space-y-0","data-aos":"fade-up","data-aos-delay":"100",children:[k.jsx("div",{className:"h-64 w-64 rounded-full overflow-hidden border-2 border-gray-300",children:k.jsx("img",{src:AGe,alt:"Jess",className:"object-cover h-full w-full"})}),k.jsxs("div",{className:"flex flex-col items-center md:items-start mt-4 md:mt-0",children:[k.jsx("div",{className:"text-lg font-medium text-[#202830] cursor-pointer hover:text-stone-400",children:"Jessica"}),k.jsx("div",{className:"italic text-[#202830]",children:"Tour Guide"})]})]})]})]})}),PGe="/YoloTravelerAsia/assets/borabora-Bg7GvBi4.jpg",DGe="/YoloTravelerAsia/assets/maldives-CRjYNTxQ.jpg",IGe="/YoloTravelerAsia/assets/mayon-61xXcWjr.jpg",OGe="/YoloTravelerAsia/assets/LU-BWyf3xTz.webp",RGe="/YoloTravelerAsia/assets/Baguio-Brbxm4yn.jpg",kGe=()=>k.jsxs(k.Fragment,{children:[k.jsxs("div",{className:"max-w-[1240px] mx-auto py-16 px-4 text-center","data-aos":"fade-up",children:[k.jsx("h1",{children:"Best-Inclusive Part of World"}),k.jsx("h3",{className:"py-4",children:"On the Asia's Best Countries"}),k.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 py-4 gap-2 md:gap-4",children:[k.jsx("a",{href:"https://www.britannica.com/place/Mayon-Volcano",target:"_blank",rel:"noopener noreferrer",className:"col-span-2 md:col-span-3 row-span-2",children:k.jsx("img",{className:"w-full h-full object-cover",src:IGe,alt:"Mayon","data-aos":"fade-right"})}),k.jsx("a",{href:"https://en.wikivoyage.org/wiki/Bora_Bora",target:"_blank",rel:"noopener noreferrer",children:k.jsx("img",{className:"w-full h-full object-cover",src:PGe,alt:"Bora Bora","data-aos":"fade-up"})}),k.jsx("a",{href:"https://guidetothephilippines.ph/articles/what-to-experience/baguio-city-tourist-spots",target:"_blank",rel:"noopener noreferrer",children:k.jsx("img",{className:"w-full h-full object-cover",src:RGe,alt:"Baguio","data-aos":"fade-down"})}),k.jsx("a",{href:"https://www.detourista.com/guide/la-union-best-places/",target:"_blank",rel:"noopener noreferrer",children:k.jsx("img",{className:"w-full h-full object-cover",src:OGe,alt:"LU","data-aos":"fade-left"})}),k.jsx("a",{href:"https://en.wikipedia.org/wiki/Boracay",target:"_blank",rel:"noopener noreferrer",children:k.jsx("img",{className:"w-full h-full object-cover",src:DGe,alt:"Maldives","data-aos":"fade-right"})})]})]}),k.jsx("div",{className:"max-w-[1240px] mx-auto flex items-center justify-center gap-4 px-4 py-16","data-aos":"fade-up",children:k.jsxs("div",{className:"lg:col-span-2 flex flex-col justify-evenly",children:[k.jsxs("div",{"data-aos":"fade-up",children:[k.jsx("h2",{children:"LUXURY INCLUDED VACATIONS FOR PEOPLE"}),k.jsx("p",{className:"py-4",children:"At Yolo Traveler Asia, we specialize in curating unforgettable experiences across the most breathtaking destinations in Asia. Our bespoke travel services are designed to cater to the discerning traveler seeking the pinnacle of luxury, comfort, and adventure. From the serene beaches of Bali and the cultural wonders of Japan to the lush landscapes of Thailand and the vibrant cities of Vietnam, our curated itineraries promise a journey like no other."})]}),k.jsx("div",{className:"grid sm:grid-cols-2 gap-8 py-4","data-aos":"fade-up",children:k.jsxs("div",{className:"flex flex-col lg:flex-row items-center text-center","data-aos":"fade-right",children:[k.jsx("button",{children:k.jsx(NHe,{size:50})}),k.jsxs("div",{children:[k.jsx("h3",{className:"py-2",children:"LEADING SERVICE"}),k.jsx("p",{className:"py-1",children:"ALL-INCLUSIVE COMPANY FOR 20 YEARS IN-A-ROW"})]})]})})]})})]}),LGe=()=>{const e=rd();return te.useEffect(()=>{const t={signInSuccessUrl:"https://nazdev20.github.io/YoloTravelerAsia/",signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID],callbacks:{signInSuccessWithAuthResult:()=>(e("/"),!1)}},r=firebaseui.auth.AuthUI.getInstance()||new firebaseui.auth.AuthUI(firebase.auth());return r.start("#firebaseui-auth-container",t),()=>{r.delete()}},[e]),k.jsx("div",{id:"firebaseui-auth-container"})},NGe=({children:e})=>k.jsxs(k.Fragment,{children:[k.jsx(gK,{}),k.jsx("div",{id:"1",children:k.jsx(NJ,{})}),k.jsxs("div",{id:"2",children:[k.jsx(u2e,{}),k.jsx(kGe,{})]}),k.jsx(nje,{}),k.jsx(BVe,{}),k.jsx("div",{id:"4",children:k.jsx(MGe,{})}),k.jsx("div",{id:"3",children:k.jsx(RHe,{})}),k.jsx("div",{id:"5",children:k.jsx(zHe,{})})]});function zGe(){return te.useEffect(()=>{s3.init({offset:100,duration:600,easing:"ease-in-sine",delay:100})},[]),k.jsx("div",{className:"App",children:k.jsx(xie,{children:k.jsxs(tB,{children:[k.jsx(pl,{path:"/list",element:k.jsx(LVe,{})}),k.jsx(pl,{path:"/profile",element:k.jsx(FVe,{})}),k.jsx(pl,{path:"/home",element:k.jsx(NJ,{})}),k.jsx(pl,{path:"*",element:k.jsx(NGe,{children:k.jsxs(tB,{children:[k.jsx(pl,{path:"/auth",element:k.jsx(LGe,{})}),k.jsx(pl,{path:"/package",element:k.jsx(BHe,{})}),k.jsx(pl,{path:"/product",element:k.jsx(UVe,{})}),k.jsx(pl,{path:"/transactionhistory",element:k.jsx(sje,{})}),k.jsx(pl,{path:"/popup",element:k.jsx(lZ,{})})]})})})]})})})}nD.createRoot(document.getElementById("root")).render(k.jsx(fe.StrictMode,{children:k.jsx(zGe,{})}));export{yy as c,Ug as g};
